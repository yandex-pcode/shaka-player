(function(){var innerGlobal=typeof window!="undefined"?window:global;var exportTo={};(function(window,global){var p,aa="function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,d){b!=Array.prototype&&b!=Object.prototype&&(b[c]=d.value)},ba="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ca(){ca=function(){};ba.Symbol||(ba.Symbol=da)}var da=function(){var b=0;return function(c){return"jscomp_symbol_"+(c||"")+b++}}();
function ea(){ca();var b=ba.Symbol.iterator;b||(b=ba.Symbol.iterator=ba.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&aa(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return fa(this)}});ea=function(){}}function fa(b){var c=0;return ha(function(){return c<b.length?{done:!1,value:b[c++]}:{done:!0}})}function ha(b){ea();b={next:b};b[ba.Symbol.iterator]=function(){return this};return b}function r(b){ea();var c=b[Symbol.iterator];return c?c.call(b):fa(b)}
function ia(b,c){if(c){for(var d=ba,e=b.split("."),f=0;f<e.length-1;f++){var g=e[f];g in d||(d[g]={});d=d[g]}e=e[e.length-1];f=d[e];g=c(f);g!=f&&null!=g&&aa(d,e,{configurable:!0,writable:!0,value:g})}}
ia("Promise",function(b){function c(b){this.b=0;this.g=void 0;this.a=[];var c=this.c();try{b(c.resolve,c.reject)}catch(l){c.reject(l)}}function d(){this.a=null}function e(b){return b instanceof c?b:new c(function(c){c(b)})}if(b)return b;d.prototype.b=function(b){null==this.a&&(this.a=[],this.f());this.a.push(b)};d.prototype.f=function(){var b=this;this.c(function(){b.h()})};var f=ba.setTimeout;d.prototype.c=function(b){f(b,0)};d.prototype.h=function(){for(;this.a&&this.a.length;){var b=this.a;this.a=
[];for(var c=0;c<b.length;++c){var d=b[c];b[c]=null;try{d()}catch(m){this.g(m)}}}this.a=null};d.prototype.g=function(b){this.c(function(){throw b;})};c.prototype.c=function(){function b(b){return function(e){d||(d=!0,b.call(c,e))}}var c=this,d=!1;return{resolve:b(this.s),reject:b(this.f)}};c.prototype.s=function(b){if(b===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(b instanceof c)this.v(b);else{a:switch(typeof b){case "object":var d=null!=b;break a;case "function":d=!0;
break a;default:d=!1}d?this.l(b):this.h(b)}};c.prototype.l=function(b){var c=void 0;try{c=b.then}catch(l){this.f(l);return}"function"==typeof c?this.C(c,b):this.h(b)};c.prototype.f=function(b){this.i(2,b)};c.prototype.h=function(b){this.i(1,b)};c.prototype.i=function(b,c){if(0!=this.b)throw Error("Cannot settle("+b+", "+c+"): Promise already settled in state"+this.b);this.b=b;this.g=c;this.j()};c.prototype.j=function(){if(null!=this.a){for(var b=0;b<this.a.length;++b)g.b(this.a[b]);this.a=null}};
var g=new d;c.prototype.v=function(b){var c=this.c();b.Gb(c.resolve,c.reject)};c.prototype.C=function(b,c){var d=this.c();try{b.call(c,d.resolve,d.reject)}catch(m){d.reject(m)}};c.prototype.then=function(b,d){function e(b,c){return"function"==typeof b?function(c){try{f(b(c))}catch(K){g(K)}}:c}var f,g,h=new c(function(b,c){f=b;g=c});this.Gb(e(b,f),e(d,g));return h};c.prototype["catch"]=function(b){return this.then(void 0,b)};c.prototype.Gb=function(b,c){function d(){switch(e.b){case 1:b(e.g);break;
case 2:c(e.g);break;default:throw Error("Unexpected state: "+e.b);}}var e=this;null==this.a?g.b(d):this.a.push(d)};c.resolve=e;c.reject=function(b){return new c(function(c,d){d(b)})};c.race=function(b){return new c(function(c,d){for(var f=r(b),g=f.next();!g.done;g=f.next())e(g.value).Gb(c,d)})};c.all=function(b){var d=r(b),f=d.next();return f.done?e([]):new c(function(b,c){function g(c){return function(d){h[c]=d;k--;0==k&&b(h)}}var h=[],k=0;do h.push(void 0),k++,e(f.value).Gb(g(h.length-1),c),f=d.next();
while(!f.done)})};return c});ia("Promise.prototype.finally",function(b){return b?b:function(b){return this.then(function(c){return Promise.resolve(b()).then(function(){return c})},function(c){return Promise.resolve(b()).then(function(){throw c;})})}});function ka(b){function c(c){return b.next(c)}function d(c){return b["throw"](c)}return new Promise(function(e,f){function g(b){b.done?e(b.value):Promise.resolve(b.value).then(c,d).then(g,f)}g(b.next())})}function t(b){return ka(b())}
function la(b){for(var c,d=[];!(c=b.next()).done;)d.push(c.value);return d}var ma="function"==typeof Object.create?Object.create:function(b){function c(){}c.prototype=b;return new c},na;if("function"==typeof Object.setPrototypeOf)na=Object.setPrototypeOf;else{var oa;a:{var pa={yd:!0},qa={};try{qa.__proto__=pa;oa=qa.yd;break a}catch(b){}oa=!1}na=oa?function(b,c){b.__proto__=c;if(b.__proto__!==c)throw new TypeError(b+" is not extensible");return b}:null}var ra=na;
function ta(b){return b instanceof Array?b:la(r(b))}function ua(){this.c=!1;this.a=null;this.O=void 0;this.m=1;this.g=this.T=0;this.b=null}function va(b){if(b.c)throw new TypeError("Generator is already running");b.c=!0}ua.prototype.f=function(b){this.O=b};function wa(b,c){b.b={Rc:c,ge:!0};b.m=b.T||b.g}ua.prototype["return"]=function(b){this.b={"return":b};this.m=this.g};function u(b,c,d){b.m=d;return{value:c}}function w(b){b.m=0}function xa(b,c){b.m=c;b.T=0}
function ya(b){b.T=0;var c=b.b.Rc;b.b=null;return c}function za(b){this.a=new ua;this.b=b}function Ca(b,c){va(b.a);var d=b.a.a;if(d)return Da(b,"return"in d?d["return"]:function(b){return{value:b,done:!0}},c,b.a["return"]);b.a["return"](c);return Ea(b)}
function Da(b,c,d,e){try{var f=c.call(b.a.a,d);if(!(f instanceof Object))throw new TypeError("Iterator result "+f+" is not an object");if(!f.done)return b.a.c=!1,f;var g=f.value}catch(h){return b.a.a=null,wa(b.a,h),Ea(b)}b.a.a=null;e.call(b.a,g);return Ea(b)}
function Ea(b){for(;b.a.m;)try{var c=b.b(b.a);if(c)return b.a.c=!1,{value:c.value,done:!1}}catch(d){b.a.O=void 0,wa(b.a,d)}b.a.c=!1;if(b.a.b){c=b.a.b;b.a.b=null;if(c.ge)throw c.Rc;return{value:c["return"],done:!0}}return{value:void 0,done:!0}}
function Fa(b){this.next=function(c){va(b.a);b.a.a?c=Da(b,b.a.a.next,c,b.a.f):(b.a.f(c),c=Ea(b));return c};this["throw"]=function(c){va(b.a);b.a.a?c=Da(b,b.a.a["throw"],c,b.a.f):(wa(b.a,c),c=Ea(b));return c};this["return"]=function(c){return Ca(b,c)};ea();this[Symbol.iterator]=function(){return this}}function y(b,c){Fa.prototype=b.prototype;return new Fa(new za(c))}function Ga(b,c){return Object.prototype.hasOwnProperty.call(b,c)}
ia("WeakMap",function(b){function c(b){this.a=(g+=Math.random()+1).toString();if(b){ca();ea();b=r(b);for(var c;!(c=b.next()).done;)c=c.value,this.set(c[0],c[1])}}function d(b){Ga(b,f)||aa(b,f,{value:{}})}function e(b){var c=Object[b];c&&(Object[b]=function(b){d(b);return c(b)})}if(function(){if(!b||!Object.seal)return!1;try{var c=Object.seal({}),d=Object.seal({}),e=new b([[c,2],[d,3]]);if(2!=e.get(c)||3!=e.get(d))return!1;e["delete"](c);e.set(d,4);return!e.has(c)&&4==e.get(d)}catch(m){return!1}}())return b;
var f="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var g=0;c.prototype.set=function(b,c){d(b);if(!Ga(b,f))throw Error("WeakMap key fail: "+b);b[f][this.a]=c;return this};c.prototype.get=function(b){return Ga(b,f)?b[f][this.a]:void 0};c.prototype.has=function(b){return Ga(b,f)&&Ga(b[f],this.a)};c.prototype["delete"]=function(b){return Ga(b,f)&&Ga(b[f],this.a)?delete b[f][this.a]:!1};return c});
ia("Map",function(b){function c(){var b={};return b.va=b.next=b.head=b}function d(b,c){var d=b.a;return ha(function(){if(d){for(;d.head!=b.a;)d=d.va;for(;d.next!=d.head;)return d=d.next,{done:!1,value:c(d)};d=null}return{done:!0,value:void 0}})}function e(b,c){var d=c&&typeof c;"object"==d||"function"==d?g.has(c)?d=g.get(c):(d=""+ ++h,g.set(c,d)):d="p_"+c;var e=b.b[d];if(e&&Ga(b.b,d))for(var f=0;f<e.length;f++){var k=e[f];if(c!==c&&k.key!==k.key||c===k.key)return{id:d,list:e,index:f,R:k}}return{id:d,
list:e,index:-1,R:void 0}}function f(b){this.b={};this.a=c();this.size=0;if(b){b=r(b);for(var d;!(d=b.next()).done;)d=d.value,this.set(d[0],d[1])}}if(function(){if(!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),d=new b(r([[c,"s"]]));if("s"!=d.get(c)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var e=d.entries(),f=e.next();if(f.done||f.value[0]!=c||"s"!=f.value[1])return!1;f=e.next();return f.done||4!=f.value[0].x||
"t"!=f.value[1]||!e.next().done?!1:!0}catch(q){return!1}}())return b;ca();ea();var g=new WeakMap;f.prototype.set=function(b,c){var d=e(this,b);d.list||(d.list=this.b[d.id]=[]);d.R?d.R.value=c:(d.R={next:this.a,va:this.a.va,head:this.a,key:b,value:c},d.list.push(d.R),this.a.va.next=d.R,this.a.va=d.R,this.size++);return this};f.prototype["delete"]=function(b){b=e(this,b);return b.R&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.b[b.id],b.R.va.next=b.R.next,b.R.next.va=b.R.va,b.R.head=
null,this.size--,!0):!1};f.prototype.clear=function(){this.b={};this.a=this.a.va=c();this.size=0};f.prototype.has=function(b){return!!e(this,b).R};f.prototype.get=function(b){return(b=e(this,b).R)&&b.value};f.prototype.entries=function(){return d(this,function(b){return[b.key,b.value]})};f.prototype.keys=function(){return d(this,function(b){return b.key})};f.prototype.values=function(){return d(this,function(b){return b.value})};f.prototype.forEach=function(b,c){for(var d=this.entries(),e;!(e=d.next()).done;)e=
e.value,b.call(c,e[1],e[0],this)};f.prototype[Symbol.iterator]=f.prototype.entries;var h=0;return f});
ia("Set",function(b){function c(b){this.a=new Map;if(b){b=r(b);for(var c;!(c=b.next()).done;)this.add(c.value)}this.size=this.a.size}if(function(){if(!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),e=new b(r([c]));if(!e.has(c)||1!=e.size||e.add(c)!=e||1!=e.size||e.add({x:4})!=e||2!=e.size)return!1;var f=e.entries(),g=f.next();if(g.done||g.value[0]!=c||g.value[1]!=c)return!1;g=f.next();return g.done||g.value[0]==c||4!=g.value[0].x||
g.value[1]!=g.value[0]?!1:f.next().done}catch(h){return!1}}())return b;ca();ea();c.prototype.add=function(b){this.a.set(b,b);this.size=this.a.size;return this};c.prototype["delete"]=function(b){b=this.a["delete"](b);this.size=this.a.size;return b};c.prototype.clear=function(){this.a.clear();this.size=0};c.prototype.has=function(b){return this.a.has(b)};c.prototype.entries=function(){return this.a.entries()};c.prototype.values=function(){return this.a.values()};c.prototype.keys=c.prototype.values;
c.prototype[Symbol.iterator]=c.prototype.values;c.prototype.forEach=function(b,c){var d=this;this.a.forEach(function(e){return b.call(c,e,e,d)})};return c});function Ha(b,c){ea();b instanceof String&&(b+="");var d=0,e={next:function(){if(d<b.length){var f=d++;return{value:c(f,b[f]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e}ia("Array.prototype.keys",function(b){return b?b:function(){return Ha(this,function(b){return b})}});
ia("Object.is",function(b){return b?b:function(b,d){return b===d?0!==b||1/b===1/d:b!==b&&d!==d}});ia("Array.prototype.includes",function(b){return b?b:function(b,d){var c=this;c instanceof String&&(c=String(c));var f=c.length,g=d||0;for(0>g&&(g=Math.max(g+f,0));g<f;g++){var h=c[g];if(h===b||Object.is(h,b))return!0}return!1}});
function Ia(b,c,d){if(null==b)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return b+""}ia("String.prototype.includes",function(b){return b?b:function(b,d){return-1!==Ia(this,b,"includes").indexOf(b,d||0)}});
ia("Array.from",function(b){return b?b:function(b,d,e){ea();d=null!=d?d:function(b){return b};var c=[],g=b[Symbol.iterator];if("function"==typeof g)for(b=g.call(b);!(g=b.next()).done;)c.push(d.call(e,g.value));else{g=b.length;for(var h=0;h<g;h++)c.push(d.call(e,b[h]))}return c}});ia("String.prototype.startsWith",function(b){return b?b:function(b,d){for(var c=Ia(this,b,"startsWith"),f=c.length,g=b.length,h=Math.max(0,Math.min(d|0,c.length)),k=0;k<g&&h<f;)if(c[h++]!=b[k++])return!1;return k>=g}});
ia("Array.prototype.find",function(b){return b?b:function(b,d){a:{var c=this;c instanceof String&&(c=String(c));for(var f=c.length,g=0;g<f;g++){var h=c[g];if(b.call(d,h,g,c)){c=h;break a}}c=void 0}return c}});var Ja=this;Ja.a=!0;function z(b,c){var d=b.split("."),e=Ja;d[0]in e||!e.execScript||e.execScript("var "+d[0]);for(var f;d.length&&(f=d.shift());)d.length||void 0===c?e[f]?e=e[f]:e=e[f]={}:e[f]=c}
function Ka(b,c){function d(){}d.prototype=c.prototype;b.Ve=c.prototype;b.prototype=new d;b.prototype.constructor=b;b.gf=function(b,d,g){return c.prototype[d].apply(b,Array.prototype.slice.call(arguments,2))}};/*

 Copyright 2016 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
function La(b){this.c=Math.exp(Math.log(.5)/b);this.b=this.a=0}function Ma(b,c,d){var e=Math.pow(b.c,c);d=d*(1-e)+e*b.a;isNaN(d)||(b.a=d,b.b+=c)}function Oa(b){return b.a/(1-Math.pow(b.c,b.b))};function Pa(){this.b=new La(2);this.c=new La(5);this.a=0}Pa.prototype.getBandwidthEstimate=function(b){return 128E3>this.a?b:Math.min(Oa(this.b),Oa(this.c))};function Qa(){}function Ra(){}function A(b){for(var c=[],d=0;d<arguments.length;++d)c[d]=arguments[d];(d=window.__unsafeShakaLogger)&&d.apply(null,["error"].concat(ta(c)))}function B(b){for(var c=[],d=0;d<arguments.length;++d)c[d]=arguments[d];(d=window.__unsafeShakaLogger)&&d.apply(null,["warning"].concat(ta(c)))}function C(b){for(var c=[],d=0;d<arguments.length;++d)c[d]=arguments[d];(d=window.__unsafeShakaLogger)&&d.apply(null,["warning"].concat(ta(c)))}
function D(b){for(var c=[],d=0;d<arguments.length;++d)c[d]=arguments[d];(d=window.__unsafeShakaLogger)&&d.apply(null,["debug"].concat(ta(c)))}function F(b){for(var c=[],d=0;d<arguments.length;++d)c[d]=arguments[d];(d=window.__unsafeShakaLogger)&&d.apply(null,["v1"].concat(ta(c)))}function G(b){for(var c=[],d=0;d<arguments.length;++d)c[d]=arguments[d];(d=window.__unsafeShakaLogger)&&d.apply(null,["v2"].concat(ta(c)))}window.console&&window.console.log.bind&&(Ra=console.warn.bind(console),Qa=console.error.bind(console));var Sa=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function Ta(b){var c;b instanceof Ta?(Ua(this,b.qa),this.Ta=b.Ta,this.ma=b.ma,Xa(this,b.ob),this.la=b.la,Ya(this,b.a.clone()),this.La=b.La):b&&(c=String(b).match(Sa))?(Ua(this,c[1]||"",!0),this.Ta=Za(c[2]||""),this.ma=Za(c[3]||"",!0),Xa(this,c[4]),this.la=Za(c[5]||"",!0),Ya(this,c[6]||"",!0),this.La=Za(c[7]||"")):this.a=new $a(null)}p=Ta.prototype;p.qa="";p.Ta="";p.ma="";p.ob=null;p.la="";p.La="";
p.toString=function(){var b=[],c=this.qa;c&&b.push(ab(c,cb,!0),":");if(c=this.ma){b.push("//");var d=this.Ta;d&&b.push(ab(d,cb,!0),"@");b.push(encodeURIComponent(c).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));c=this.ob;null!=c&&b.push(":",String(c))}if(c=this.la)this.ma&&"/"!=c.charAt(0)&&b.push("/"),b.push(ab(c,"/"==c.charAt(0)?db:eb,!0));(c=this.a.toString())&&b.push("?",c);(c=this.La)&&b.push("#",ab(c,fb));return b.join("")};
p.resolve=function(b){var c=this.clone();"data"===c.qa&&(c=new Ta);var d=!!b.qa;d?Ua(c,b.qa):d=!!b.Ta;d?c.Ta=b.Ta:d=!!b.ma;d?c.ma=b.ma:d=null!=b.ob;var e=b.la;if(d)Xa(c,b.ob);else if(d=!!b.la){if("/"!=e.charAt(0))if(this.ma&&!this.la)e="/"+e;else{var f=c.la.lastIndexOf("/");-1!=f&&(e=c.la.substr(0,f+1)+e)}if(".."==e||"."==e)e="";else if(-1!=e.indexOf("./")||-1!=e.indexOf("/.")){f=0==e.lastIndexOf("/",0);e=e.split("/");for(var g=[],h=0;h<e.length;){var k=e[h++];"."==k?f&&h==e.length&&g.push(""):".."==
k?((1<g.length||1==g.length&&""!=g[0])&&g.pop(),f&&h==e.length&&g.push("")):(g.push(k),f=!0)}e=g.join("/")}}d?c.la=e:d=""!==b.a.toString();d?Ya(c,b.a.clone()):d=!!b.La;d&&(c.La=b.La);return c};p.clone=function(){return new Ta(this)};function Ua(b,c,d){b.qa=d?Za(c,!0):c;b.qa&&(b.qa=b.qa.replace(/:$/,""))}function Xa(b,c){if(c){c=Number(c);if(isNaN(c)||0>c)throw Error("Bad port number "+c);b.ob=c}else b.ob=null}function Ya(b,c,d){c instanceof $a?b.a=c:(d||(c=ab(c,gb)),b.a=new $a(c))}
function Za(b,c){return b?c?decodeURI(b):decodeURIComponent(b):""}function ab(b,c,d){return"string"==typeof b?(b=encodeURI(b).replace(c,hb),d&&(b=b.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b):null}function hb(b){b=b.charCodeAt(0);return"%"+(b>>4&15).toString(16)+(b&15).toString(16)}var cb=/[#\/\?@]/g,eb=/[#\?:]/g,db=/[#\?]/g,gb=/[#\?@]/g,fb=/#/g;function $a(b){this.a=b||null}p=$a.prototype;p.da=null;p.Ib=null;
p.add=function(b,c){if(!this.da&&(this.da={},this.Ib=0,this.a))for(var d=this.a.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null;if(0<=f){var h=d[e].substring(0,f);g=d[e].substring(f+1)}else h=d[e];h=decodeURIComponent(h.replace(/\+/g," "));g=g||"";this.add(h,decodeURIComponent(g.replace(/\+/g," ")))}this.a=null;(d=this.da.hasOwnProperty(b)&&this.da[b])||(this.da[b]=d=[]);d.push(c);this.Ib++;return this};
p.toString=function(){if(this.a)return this.a;if(!this.da)return"";var b=[],c;for(c in this.da)for(var d=encodeURIComponent(c),e=this.da[c],f=0;f<e.length;f++){var g=d;""!==e[f]&&(g+="="+encodeURIComponent(e[f]));b.push(g)}return this.a=b.join("&")};p.clone=function(){var b=new $a;b.a=this.a;if(this.da){var c={},d;for(d in this.da)c[d]=this.da[d].concat();b.da=c;b.Ib=this.Ib}return b};function ib(b){this.b=b;this.a=null}ib.prototype.V=function(b){var c=this;this.stop();var d=!0,e=null;this.a=function(){window.clearTimeout(e);d=!1};e=window.setTimeout(function(){d&&c.b()},1E3*b);return this};ib.prototype.stop=function(){this.a&&(this.a(),this.a=null)};function H(b){this.b=b;this.a=null}z("shaka.util.Timer",H);H.prototype.We=function(){this.stop();this.b();return this};H.prototype.tickNow=H.prototype.We;H.prototype.V=function(b){var c=this;this.stop();this.a=(new ib(function(){c.b()})).V(b);return this};H.prototype.tickAfter=H.prototype.V;H.prototype.Ga=function(b){var c=this;this.stop();this.a=(new ib(function(){c.a.V(b);c.b()})).V(b);return this};H.prototype.tickEvery=H.prototype.Ga;H.prototype.stop=function(){this.a&&(this.a.stop(),this.a=null)};
H.prototype.stop=H.prototype.stop;function jb(b,c){var d=kb();this.i=null==b.maxAttempts?d.maxAttempts:b.maxAttempts;this.f=null==b.baseDelay?d.baseDelay:b.baseDelay;this.h=null==b.fuzzFactor?d.fuzzFactor:b.fuzzFactor;this.g=null==b.backoffFactor?d.backoffFactor:b.backoffFactor;this.a=0;this.b=this.f;if(this.c=void 0===c?!1:c)this.a=1}
function lb(b){return t(function d(){var e,f;return y(d,function(d){switch(d.m){case 1:if(b.a>=b.i)if(b.c)b.a=1,b.b=b.f;else return d["return"](Promise.reject());e=b.a;b.a++;if(0==e)return d["return"]();f=b.b*(1+(2*Math.random()-1)*b.h);return u(d,new Promise(function(b){(new H(b)).V(f/1E3)}),2);case 2:b.b*=b.g,w(d)}})})}function kb(){return{maxAttempts:2,baseDelay:1E3,backoffFactor:2,fuzzFactor:.5,timeout:0}};function I(b,c,d,e){for(var f=[],g=3;g<arguments.length;++g)f[g-3]=arguments[g];this.severity=b;this.category=c;this.code=d;this.data=f;this.handled=!1}z("shaka.util.Error",I);I.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")};I.Severity={RECOVERABLE:1,CRITICAL:2};I.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9};
I.Code={UNSUPPORTED_SCHEME:1E3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,UNKNOWN_DATA_URI_ENCODING:1005,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2E3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3E3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,
EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,
UNABLE_TO_GUESS_MANIFEST_TYPE:4E3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,
HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,INVALID_STREAMS_CHOSEN:5005,
NO_RECOGNIZED_KEY_SYSTEMS:6E3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,LOAD_INTERRUPTED:7E3,OPERATION_ABORTED:7001,
NO_VIDEO_ELEMENT:7002,CAST_API_UNAVAILABLE:8E3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,CAST_RECEIVER_APP_ID_MISSING:8007,STORAGE_NOT_SUPPORTED:9E3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,
NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013};function mb(){var b,c,d=new Promise(function(d,f){b=d;c=f});d.resolve=b;d.reject=c;return d}mb.prototype.resolve=function(){};mb.prototype.reject=function(){};function J(b,c){this.promise=b;this.ad=c;this.a=!1}z("shaka.util.AbortableOperation",J);function pb(b){return new J(Promise.reject(b),function(){return Promise.resolve()})}J.failed=pb;function qb(){var b=Promise.reject(new I(2,7,7001));b["catch"](function(){});return new J(b,function(){return Promise.resolve()})}J.aborted=qb;function rb(b){return new J(Promise.resolve(b),function(){return Promise.resolve()})}J.completed=rb;
function sb(b){return new J(b,function(){return b["catch"](function(){})})}J.notAbortable=sb;J.prototype.abort=function(){this.a=!0;return this.ad()};J.prototype.abort=J.prototype.abort;function tb(b){return new J(Promise.all(b.map(function(b){return b.promise})),function(){return Promise.all(b.map(function(b){return b.abort()}))})}J.all=tb;J.prototype["finally"]=function(b){this.promise.then(function(){return b(!0)},function(){return b(!1)});return this};J.prototype["finally"]=J.prototype["finally"];
J.prototype.Y=function(b,c){function d(){f.reject(new I(2,7,7001));return e.abort()}var e=this,f=new mb;this.promise.then(function(c){e.a?f.reject(new I(2,7,7001)):b?d=ub(b,c,f):f.resolve(c)},function(b){c?d=ub(c,b,f):f.reject(b)});return new J(f,function(){return d()})};J.prototype.chain=J.prototype.Y;
function ub(b,c,d){try{var e=b(c);if(e&&e.promise&&e.abort)return d.resolve(e.promise),function(){return e.abort()};d.resolve(e);return function(){return Promise.resolve(e).then(function(){})["catch"](function(){})}}catch(f){return d.reject(f),function(){return Promise.resolve()}}};function L(b,c){c=void 0===c?{}:c;for(var d in c)this[d]=c[d];this.defaultPrevented=this.cancelable=this.bubbles=!1;this.timeStamp=window.performance&&window.performance.now?window.performance.now():Date.now();this.type=b;this.isTrusted=!1;this.target=this.currentTarget=null;this.a=!1}L.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)};L.prototype.stopImmediatePropagation=function(){this.a=!0};L.prototype.stopPropagation=function(){};function vb(){this.a={}}vb.prototype.push=function(b,c){this.a.hasOwnProperty(b)?this.a[b].push(c):this.a[b]=[c]};vb.prototype.get=function(b){return(b=this.a[b])?b.slice():null};vb.prototype.remove=function(b,c){var d=this.a[b];if(d)for(var e=0;e<d.length;++e)d[e]==c&&(d.splice(e,1),--e)};vb.prototype.forEach=function(b){for(var c in this.a)b(c,this.a[c])};function wb(){this.dc=new vb;this.Vc=this}wb.prototype.addEventListener=function(b,c){this.dc.push(b,c)};wb.prototype.removeEventListener=function(b,c){this.dc.remove(b,c)};wb.prototype.dispatchEvent=function(b){for(var c=this.dc.get(b.type)||[],d=0;d<c.length;++d){b.target=this.Vc;b.currentTarget=this.Vc;var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(this,b)}catch(f){A("Uncaught exception in event handler",f,f?f.message:null,f?f.stack:null)}if(b.a)break}return b.defaultPrevented};function xb(b){function c(b){switch(typeof b){case "undefined":case "boolean":case "number":case "string":case "symbol":case "function":return b;default:if(!b||b.buffer&&b.buffer.constructor==ArrayBuffer)return b;if(d.has(b))return null;var e=b.constructor==Array;if(b.constructor!=Object&&!e)return null;d.add(b);var g=e?[]:{},h;for(h in b)g[h]=c(b[h]);e&&(g.length=b.length);return g}}var d=new Set;return c(b)};function yb(b,c){var d=b.indexOf(c);-1<d&&b.splice(d,1)}function zb(b,c){var d=0;b.forEach(function(b){d+=c(b)?1:0});return d};function Ab(){this.a=[]}function Bb(b,c){b.a.push(c["finally"](function(){yb(b.a,c)}))}Ab.prototype.destroy=function(){var b=[];this.a.forEach(function(c){c.promise["catch"](function(){});b.push(c.abort())});this.a=[];return Promise.all(b)};function M(b){wb.call(this);this.f=!1;this.g=new Ab;this.a=new Set;this.b=new Set;this.c=b||null}Ka(M,wb);z("shaka.net.NetworkingEngine",M);M.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4};M.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var Cb={};function Db(b,c,d){d=d||3;var e=Cb[b];if(!e||d>=e.priority)Cb[b]={priority:d,Ae:c}}M.registerScheme=Db;M.unregisterScheme=function(b){delete Cb[b]};M.prototype.Ce=function(b){this.a.add(b)};M.prototype.registerRequestFilter=M.prototype.Ce;
M.prototype.Ze=function(b){this.a["delete"](b)};M.prototype.unregisterRequestFilter=M.prototype.Ze;M.prototype.Ed=function(){this.a.clear()};M.prototype.clearAllRequestFilters=M.prototype.Ed;M.prototype.De=function(b){this.b.add(b)};M.prototype.registerResponseFilter=M.prototype.De;M.prototype.$e=function(b){this.b["delete"](b)};M.prototype.unregisterResponseFilter=M.prototype.$e;M.prototype.Fd=function(){this.b.clear()};M.prototype.clearAllResponseFilters=M.prototype.Fd;
function Eb(b,c){return{uris:b,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:c,licenseRequestType:null,sessionId:null,loadedBytes:0}}M.prototype.destroy=function(){this.f=!0;this.a.clear();this.b.clear();return this.g.destroy()};M.prototype.destroy=M.prototype.destroy;
M.prototype.request=function(b,c,d){var e=this,f=new Fb;if(this.f){var g=Promise.reject(new I(2,7,7001));g["catch"](function(){});return new Gb(g,function(){return Promise.resolve()},f)}c.method=c.method||"GET";c.headers=c.headers||{};c.retryParameters=c.retryParameters?xb(c.retryParameters):kb();c.uris=xb(c.uris);g=Hb(this,b,c);var h=g.Y(function(){return Ib(e,b,c,new jb(c.retryParameters,!1),0,null,f,d)}),k=h.Y(function(c){return Jb(e,b,c)}),l=Date.now(),m=0;g.promise.then(function(){m=Date.now()-
l},function(){});var n=0;h.promise.then(function(){n=Date.now()},function(){});g=k.Y(function(c){var f=Date.now()-n,g=c.response;g.timeMs+=m;g.timeMs+=f;c.ee||!e.c||g.fromCache||1!=b||(e.c(g.timeMs,g.data.byteLength),d&&d(g.timeMs,g.data.byteLength,0,g.data));return g},function(b){b&&(b.severity=2);throw b;});g=new Gb(g.promise,g.ad,f);Bb(this.g,g);return g};M.prototype.request=M.prototype.request;
function Hb(b,c,d){var e=rb(void 0),f={};b=r(b.a);for(var g=b.next();!g.done;f={Cc:f.Cc},g=b.next())f.Cc=g.value,e=e.Y(function(b){return function(){return b.Cc(c,d)}}(f));return e.Y(void 0,function(b){if(b&&7001==b.code)throw b;throw new I(2,1,1006,b);})}
function Ib(b,c,d,e,f,g,h,k){var l=new Ta(d.uris[f]),m=l.qa,n=!1;m||(m=location.protocol,m=m.slice(0,-1),Ua(l,m),d.uris[f]=l.toString());var q=(m=Cb[m])?m.Ae:null;if(!q)return pb(new I(2,1,1E3,l));var v;return sb(lb(e)).Y(function(){if(b.f)return qb();v=Date.now();0<d.loadedBytes&&(d.headers.Range="bytes="+d.loadedBytes+"-");return q(d.uris[f],d,c,function(e,f,g,l){b.c&&1==c&&(b.c(e,f),n=!0,h.a=g,k&&(d.loadedBytes+=f,k(e,f,g,l)))})}).Y(function(b){void 0==b.timeMs&&(b.timeMs=Date.now()-v);return{response:b,
ee:n}},function(l){if(l&&7001==l.code)throw l;if(b.f)return qb();if(l&&1==l.severity)return b.dispatchEvent(new L("retry",{error:l instanceof I?l:null})),f=(f+1)%d.uris.length,Ib(b,c,d,e,f,l,h,k);throw l||g;})}function Jb(b,c,d){var e=rb(void 0);b=r(b.b);for(var f=b.next();!f.done;f=b.next())e=e.Y(f.value.bind(null,c,d.response));return e.Y(function(){return d},function(b){if(b&&7001==b.code)throw b;var c=2;b instanceof I&&(c=b.severity);throw new I(c,1,1007,b);})}function Fb(){this.a=0}
M.NumBytesRemainingClass=Fb;function Gb(b,c,d){J.call(this,b,c);this.b=d}var Kb=Gb;Kb.prototype=ma(J.prototype);Kb.prototype.constructor=Kb;if(ra)ra(Kb,J);else for(var Lb in J)if("prototype"!=Lb)if(Object.defineProperties){var Mb=Object.getOwnPropertyDescriptor(J,Lb);Mb&&Object.defineProperty(Kb,Lb,Mb)}else Kb[Lb]=J[Lb];Kb.Ve=J.prototype;M.PendingRequest=Gb;Gb.all=tb;Gb.notAbortable=sb;Gb.completed=rb;Gb.aborted=qb;Gb.failed=pb;function Nb(){}z("shaka.util.IReleasable",Nb);Nb.prototype.release=function(){};function O(){this.a=new vb}z("shaka.util.EventManager",O);O.prototype.release=function(){this.yb();this.a=null};O.prototype.release=O.prototype.release;O.prototype.w=function(b,c,d,e){this.a&&(b=new Rb(b,c,d,e),this.a.push(c,b))};O.prototype.listen=O.prototype.w;O.prototype.ea=function(b,c,d,e){function f(e){g.aa(b,c,f);d(e)}var g=this;this.w(b,c,f,e)};O.prototype.listenOnce=O.prototype.ea;
O.prototype.aa=function(b,c,d){if(this.a){var e=this.a.get(c)||[];e=r(e);for(var f=e.next();!f.done;f=e.next())f=f.value,f.target!=b||d!=f.listener&&d||(f.aa(),this.a.remove(c,f))}};O.prototype.unlisten=O.prototype.aa;O.prototype.yb=function(){if(this.a){var b=this.a,c=[],d;for(d in b.a)c.push.apply(c,b.a[d]);b=r(c);for(c=b.next();!c.done;c=b.next())c.value.aa();this.a.a={}}};O.prototype.removeAll=O.prototype.yb;
function Rb(b,c,d,e){this.target=b;this.type=c;this.listener=d;this.a=Sb(b,e);this.target.addEventListener(c,d,this.a)}Rb.prototype.aa=function(){this.target.removeEventListener(this.type,this.listener,this.a);this.listener=this.target=null;this.a=!1};Rb.prototype.unlisten=Rb.prototype.aa;function Sb(b,c){if(void 0==c)return!1;if("boolean"==typeof c)return c;var d=new Set(["passive","capture"]);Object.keys(c).filter(function(b){return!d.has(b)});return Tb(b)?c:c.capture||!1}
function Tb(b){var c=Ub;if(void 0==c){c=!1;try{var d={},e={get:function(){c=!0;return!1}};Object.defineProperty(d,"passive",e);Object.defineProperty(d,"capture",e);e=function(){};b.addEventListener("test",e,d);b.removeEventListener("test",e,d)}catch(f){c=!1}Ub=c}return c||!1}var Ub=void 0;function Vb(b){b=new Uint8Array(b);if((new DataView(b.buffer,b.byteOffset,b.byteLength)).getUint32(0,!0)+4!=b.byteLength)throw new RangeError("Malformed FairPlay init data");b=Wb(b.subarray(4),!0);return(new Ta(b)).ma}z("shaka.util.FairPlayUtils.defaultGetContentId",Vb);
function Xb(b,c,d){function e(b){(new DataView(g.buffer)).setUint32(h,b.byteLength,!0);h+=4;f(b)}function f(b){g.set(b,h);h+=b.byteLength}if(!d||!d.byteLength)throw new I(2,6,6015);c="string"==typeof c?new Uint8Array(Yb(c,!0)):new Uint8Array(c);var g=new Uint8Array(8+b.byteLength+c.byteLength+d.byteLength),h=0;f(new Uint8Array(b));e(c);e(new Uint8Array(d));return g}z("shaka.util.FairPlayUtils.initDataTransform",Xb);function Zb(b,c){for(var d=r(b),e=d.next();!e.done;e=d.next())if(!c(e.value))return!1;return!0};function $b(b){var c=new Map;Object.keys(b).forEach(function(d){c.set(d,b[d])});return c}function ac(b){var c={};b.forEach(function(b,e){c[e]=b});return c};function bc(b,c){var d=b;c&&(d+='; codecs="'+c+'"');return d}function cc(b){var c=[b.mimeType];dc.forEach(function(d,e){var f=b[e];f&&c.push(d+'="'+f+'"')});return c.join(";")}function ec(b){b=b.split(".");var c=b[0];b.pop();return[c,b.join(".")]}var dc=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function fc(){return window.MediaSource&&MediaSource.isTypeSupported?!0:!1}function gc(b){return""!=hc().canPlayType(b)}function ic(b){return(navigator.userAgent||"").includes(b)}function hc(){if(jc)return jc;kc||(kc=new H(function(){jc=null}));(jc=document.querySelector("video")||document.querySelector("audio"))||(jc=document.createElement("video"));kc.V(1);return jc}var kc=null,jc=null;function lc(b){if(!b)return"";b=new Uint8Array(b);239==b[0]&&187==b[1]&&191==b[2]&&(b=b.subarray(3));b=mc(b);b=escape(b);try{return decodeURIComponent(b)}catch(c){throw new I(2,2,2004);}}z("shaka.util.StringUtils.fromUTF8",lc);
function Wb(b,c,d){if(!b)return"";if(!d&&0!=b.byteLength%2)throw A("Data has an incorrect length, must be even."),new I(2,2,2004);if(b instanceof ArrayBuffer)var e=b;else d=new Uint8Array(b.byteLength),d.set(new Uint8Array(b)),e=d.buffer;b=Math.floor(b.byteLength/2);d=new Uint16Array(b);e=new DataView(e);for(var f=0;f<b;f++)d[f]=e.getUint16(2*f,c);return mc(d)}z("shaka.util.StringUtils.fromUTF16",Wb);
function nc(b){var c=new Uint8Array(b);if(239==c[0]&&187==c[1]&&191==c[2])return lc(c);if(254==c[0]&&255==c[1])return Wb(c.subarray(2),!1);if(255==c[0]&&254==c[1])return Wb(c.subarray(2),!0);var d=function(b,c){return b.byteLength<=c||32<=b[c]&&126>=b[c]}.bind(null,c);D("Unable to find byte-order-mark, making an educated guess.");if(0==c[0]&&0==c[2])return Wb(b,!1);if(0==c[1]&&0==c[3])return Wb(b,!0);if(d(0)&&d(1)&&d(2)&&d(3))return lc(b);throw new I(2,2,2003);}
z("shaka.util.StringUtils.fromBytesAutoDetect",nc);function oc(b){b=encodeURIComponent(b);b=unescape(b);for(var c=new Uint8Array(b.length),d=0;d<b.length;++d)c[d]=b.charCodeAt(d);return c.buffer}z("shaka.util.StringUtils.toUTF8",oc);function Yb(b,c){for(var d=new Uint8Array(2*b.length),e=new DataView(d.buffer),f=0;f<b.length;++f)e.setUint16(2*f,b.charCodeAt(f),c);return d.buffer}z("shaka.util.StringUtils.toUTF16",Yb);
function mc(b){if(!pc)for(var c=function(b){try{var c=new Uint8Array(b);ta(c);return!0}catch(g){return!1}},d={size:65536};0<d.size;d={size:d.size},d.size/=2)if(c(d.size)){pc=function(b){return function(c){for(var d="",e=0;e<c.length;e+=b.size)d+=String.fromCharCode.apply(String,ta(c.subarray(e,e+b.size)));return d}}(d);break}return pc(b)}var pc=null;function qc(b,c){var d=mc(b);c=void 0==c?!0:c;d=window.btoa(d).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")}z("shaka.util.Uint8ArrayUtils.toBase64",qc);function rc(b){b=window.atob(b.replace(/-/g,"+").replace(/_/g,"/"));for(var c=new Uint8Array(b.length),d=0;d<b.length;++d)c[d]=b.charCodeAt(d);return c}z("shaka.util.Uint8ArrayUtils.fromBase64",rc);function sc(b){for(var c=new Uint8Array(b.length/2),d=0;d<b.length;d+=2)c[d/2]=window.parseInt(b.substr(d,2),16);return c}
z("shaka.util.Uint8ArrayUtils.fromHex",sc);function tc(b){for(var c="",d=0;d<b.length;++d){var e=b[d].toString(16);1==e.length&&(e="0"+e);c+=e}return c}z("shaka.util.Uint8ArrayUtils.toHex",tc);function uc(b,c){if(!b&&!c)return!0;if(!b||!c||b.length!=c.length)return!1;for(var d=0;d<b.length;++d)if(b[d]!=c[d])return!1;return!0}z("shaka.util.Uint8ArrayUtils.equal",uc);
function vc(b){for(var c=[],d=0;d<arguments.length;++d)c[d]=arguments[d];for(var e=d=0;e<c.length;++e)d+=c[e].length;d=new Uint8Array(d);for(var f=e=0;f<c.length;++f)d.set(c[f],e),e+=c[f].length;return d}z("shaka.util.Uint8ArrayUtils.concat",vc);function wc(b){var c=this;this.C=b;this.s=new Set;this.j=this.h=null;this.W=!1;this.a=null;this.i=new O;this.c=new Map;this.v=[];this.l=new mb;this.b=null;this.g=function(d){c.l.reject(d);b.onError(d)};this.ja=new Map;this.ba=new Map;this.P=new H(function(){return xc(c)});this.f=!1;this.ha=new mb;this.N=!1;this.I=[];this.ia=!1;this.ca=(new H(function(){yc(c)})).Ga(1);this.l["catch"](function(){})}p=wc.prototype;
p.destroy=function(){var b=this;return t(function d(){return y(d,function(d){switch(d.m){case 1:if(b.f)return u(d,b.ha,0);b.f=!0;return u(d,zc(b),4);case 4:b.ha.resolve(),d.m=0}})})};
function zc(b){return t(function d(){var e;return y(d,function(d){switch(d.m){case 1:return b.i.release(),b.i=null,b.l.reject(),b.ca.stop(),b.ca=null,b.P.stop(),b.P=null,e=Array.from(b.c.keys()),b.c.clear(),u(d,Promise.all(e.map(function(b){return Promise.resolve().then(function(){return t(function k(){return y(k,function(d){switch(d.m){case 1:return F("Closing session",b.sessionId),d.T=2,u(d,Ac(b),4);case 4:xa(d,0);break;case 2:ya(d),w(d)}})})})})),2);case 2:if(!b.j){d.m=3;break}d.T=4;return u(d,
b.j.setMediaKeys(null),6);case 6:xa(d,5);break;case 4:ya(d);case 5:b.j=null;case 3:b.a=null,b.s.clear(),b.h=null,b.v=[],b.b=null,b.g=null,b.C=null,w(d)}})})}p.configure=function(b){this.b=b};function Bc(b,c,d){b.v=d;b.N=0<d.length;return Cc(b,c)}
function Cc(b,c){var d=c.some(function(b){return 0<b.drmInfos.length});if(!d){var e=$b(b.b.servers);Dc(c,e)}var f=Ec(b);if(f){var g=r(c);for(e=g.next();!e.done;e=g.next())e.value.drmInfos=[f]}f=r(c);for(e=f.next();!e.done;e=f.next())for(e=r(e.value.drmInfos),g=e.next();!g.done;g=e.next())Fc(g.value,$b(b.b.servers),$b(b.b.advanced||{}));e=Ic(b,c);if(!e.size)return b.W=!0,Promise.resolve();e=Jc(b,e);return d?e:e["catch"](function(){})}
p.qb=function(b){var c=this;if(!this.h)return this.i.ea(b,"encrypted",function(){c.g(new I(2,6,6010))}),Promise.resolve();this.j=b;this.i.ea(this.j,"play",function(){for(var b=0;b<c.I.length;b++)Kc(c,c.I[b]);c.ia=!0;c.I=[]});b=this.j.setMediaKeys(this.h);b=b["catch"](function(b){return Promise.reject(new I(2,6,6003,b.message))});var d=Lc(this);return Promise.all([b,d]).then(function(){if(c.f)return Promise.reject();Mc(c);c.a.initData.length||c.v.length||c.i.w(c.j,"encrypted",function(b){return Nc(c,
b.initDataType,new Uint8Array(b.initData))})})["catch"](function(b){if(!c.f)return Promise.reject(b)})};
function Lc(b){return t(function d(){var e,f;return y(d,function(d){switch(d.m){case 1:if(!(b.h&&b.a&&b.a.serverCertificate&&b.a.serverCertificate.length)){d.m=0;break}d.T=3;return u(d,b.h.setServerCertificate(b.a.serverCertificate),5);case 5:(e=d.O)||B("Server certificates are not supported by the key system.  The server certificate has been ignored.");xa(d,0);break;case 3:return f=ya(d),d["return"](Promise.reject(new I(2,6,6004,f.message)))}})})}
function Mc(b){var c=b.a?b.a.initData:[];c.forEach(function(c){return Oc(b,c.initDataType,c.initData)});b.v.forEach(function(c){return Pc(b,c)});c.length||b.v.length||b.l.resolve()}function Nc(b,c,d){var e=b.c.values();e=r(e);for(var f=e.next();!f.done;f=e.next())if(uc(d,f.value.initData)){D("Ignoring duplicate init data.");return}Oc(b,c,d)}p.keySystem=function(){return this.a?this.a.keySystem:""};function Qc(b,c){return ic("Edge/")?!0:b.s.has(c)}
p.nc=function(){var b=Infinity,c=this.c.keys();c=r(c);for(var d=c.next();!d.done;d=c.next())d=d.value,isNaN(d.expiration)||(b=Math.min(b,d.expiration));return b};
function Ic(b,c){for(var d=new Set,e=r(c),f=e.next();!f.done;f=e.next()){var g=r(f.value.drmInfos);for(f=g.next();!f.done;f=g.next())d.add(f.value)}e=r(d);for(f=e.next();!f.done;f=e.next())Fc(f.value,$b(b.b.servers),$b(b.b.advanced||{}));g=b.N?"required":"optional";var h=b.N?["persistent-license"]:["temporary"];e=new Map;d=r(d);for(f=d.next();!f.done;f=d.next())f=f.value,e.set(f.keySystem,{audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:g,sessionTypes:h,
label:f.keySystem,drmInfos:[]});d=r(c);for(f=d.next();!f.done;f=d.next()){f=f.value;g=f.audio;h=f.video;var k=g?bc(g.mimeType,g.codecs):"",l=h?bc(h.mimeType,h.codecs):"",m=r(f.drmInfos);for(f=m.next();!f.done;f=m.next()){f=f.value;var n=e.get(f.keySystem);n.drmInfos.push(f);f.distinctiveIdentifierRequired&&(n.distinctiveIdentifier="required");f.persistentStateRequired&&(n.persistentState="required");g&&n.audioCapabilities.push({robustness:f.audioRobustness||"",contentType:k});h&&n.videoCapabilities.push({robustness:f.videoRobustness||
"",contentType:l})}}return e}
function Jc(b,c){if(1==c.size&&c.has(""))return Promise.reject(new I(2,6,6E3));for(var d=r(c.values()),e=d.next();!e.done;e=d.next())e=e.value,0==e.audioCapabilities.length&&delete e.audioCapabilities,0==e.videoCapabilities.length&&delete e.videoCapabilities;var f=d=new mb;[!0,!1].forEach(function(b){var d=this;c.forEach(function(c,e){c.drmInfos.some(function(b){return!!b.licenseServerUri})==b&&(f=f["catch"](function(){if(!this.f)return navigator.requestMediaKeySystemAccess(e,[c])}.bind(d)))})}.bind(b));
f=f["catch"](function(){return Promise.reject(new I(2,6,6001))});f=f.then(function(b){if(this.f)return Promise.reject();this.s.clear();var d=b.getConfiguration(),e=d.videoCapabilities||[],f=r(d.audioCapabilities||[]);for(d=f.next();!d.done;d=f.next())this.s.add(d.value.contentType);e=r(e);for(d=e.next();!d.done;d=e.next())this.s.add(d.value.contentType);e=b.keySystem;d=c.get(b.keySystem);f=[];var g=[],n=[],q=[];Rc(d.drmInfos,f,g,n,q);1<g.length&&B("Multiple unique server certificates found! Only the first will be used.");
1<f.length&&B("Multiple unique license server URIs found! Only the first will be used.");this.a={keySystem:e,licenseServerUri:f[0],distinctiveIdentifierRequired:"required"==d.distinctiveIdentifier,persistentStateRequired:"required"==d.persistentState,audioRobustness:d.audioCapabilities?d.audioCapabilities[0].robustness:"",videoRobustness:d.videoCapabilities?d.videoCapabilities[0].robustness:"",serverCertificate:g[0],initData:n,keyIds:q};return this.a.licenseServerUri?b.createMediaKeys():Promise.reject(new I(2,
6,6012,this.a.keySystem))}.bind(b)).then(function(b){if(this.f)return Promise.reject();C("Created MediaKeys object for key system",this.a.keySystem);this.h=b;this.W=!0}.bind(b))["catch"](function(b){if(!this.f)return this.a=null,this.s.clear(),b instanceof I?Promise.reject(b):Promise.reject(new I(2,6,6002,b.message))}.bind(b));d.reject();return f}
function Ec(b){b=$b(b.b.clearKeys);if(0==b.size)return null;var c=[],d=[];b.forEach(function(b,e){var f=sc(e),g=sc(b);f={kty:"oct",kid:qc(f,!1),k:qc(g,!1)};c.push(f);d.push(f.kid)});b=JSON.stringify({keys:c});var e=JSON.stringify({kids:d});e=[{initData:new Uint8Array(oc(e)),initDataType:"keyids"}];return{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+window.btoa(b),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,
initData:e,keyIds:[]}}
function Pc(b,c){try{F("Attempting to load an offline session",c);var d=b.h.createSession("persistent-license")}catch(g){var e=new I(2,6,6005,g.message);b.g(e);return Promise.reject(e)}b.i.w(d,"message",b.fd.bind(b));b.i.w(d,"keystatuseschange",b.ed.bind(b));var f={initData:null,loaded:!1,xc:Infinity,Ha:null};b.c.set(d,f);return d.load(c).then(function(b){if(this.f)return Promise.reject();G("Loaded offline session",c,b);if(b)return f.loaded=!0,Sc(this)&&this.l.resolve(),d;this.c["delete"](d);this.g(new I(2,
6,6013))}.bind(b),function(b){this.f||(this.c["delete"](d),this.g(new I(2,6,6005,b.message)))}.bind(b))}
function Oc(b,c,d){try{if(b.N){F("Creating new persistent session");var e=b.h.createSession("persistent-license")}else F("Creating new temporary session"),e=b.h.createSession()}catch(h){b.g(new I(2,6,6005,h.message));return}b.i.w(e,"message",b.fd.bind(b));b.i.w(e,"keystatuseschange",b.ed.bind(b));b.c.set(e,{initData:d,loaded:!1,xc:Infinity,Ha:null});try{if(b.b.initDataTransform)d=b.b.initDataTransform(d);else if(b.keySystem().startsWith("com.apple.fps")){var f=b.a.serverCertificate,g=Vb(d);d=Xb(d,
g,f)}}catch(h){c=h;h instanceof I||(c=new I(2,6,6016,h));b.g(c);return}e.generateRequest(c,d.buffer)["catch"](function(c){if(!b.f){b.c["delete"](e);if(c.errorCode&&c.errorCode.systemCode){var d=c.errorCode.systemCode;0>d&&(d+=Math.pow(2,32));d="0x"+d.toString(16)}b.g(new I(2,6,6006,c.message,c,d))}})}p.fd=function(b){this.b.delayLicenseRequestUntilPlayed&&this.j.paused&&!this.ia?this.I.push(b):Kc(this,b)};
function Kc(b,c){var d=c.target;G("Sending license request for session",d.sessionId);var e=b.c.get(d),f=b.a.licenseServerUri,g=b.b.advanced[b.a.keySystem];"individualization-request"==c.messageType&&g&&g.individualizationServer&&(f=g.individualizationServer);f=Eb([f],b.b.retryParameters);f.body=c.message;f.method="POST";f.licenseRequestType=c.messageType;f.sessionId=d.sessionId;"com.microsoft.playready"!=b.a.keySystem&&"com.chromecast.playready"!=b.a.keySystem||Tc(f);b.a.keySystem.startsWith("com.apple.fps")&&
b.b.fairPlayTransform&&Uc(f);b.C.Rb.request(2,f).promise.then(function(b){if(this.f)return Promise.reject();this.a.keySystem.startsWith("com.apple.fps")&&this.b.fairPlayTransform&&Vc(b);return d.update(b.data).then(function(){var b=this;this.C.onEvent(new L("drmsessionupdate"));e&&(e.Ha&&e.Ha.resolve(),(new H(function(){e.loaded=!0;Sc(b)&&b.l.resolve()})).V(Wc))}.bind(this))}.bind(b),function(b){this.f||(b=new I(2,6,6007,b),this.g(b),e&&e.Ha&&e.Ha.reject(b))}.bind(b))["catch"](function(b){this.f||
(b=new I(2,6,6008,b.message),this.g(b),e&&e.Ha&&e.Ha.reject(b))}.bind(b))}
function Tc(b){var c=Wb(b.body,!0,!0);if(c.includes("PlayReadyKeyMessage")){D("Unwrapping PlayReady request.");c=(new DOMParser).parseFromString(c,"application/xml");for(var d=c.getElementsByTagName("HttpHeader"),e=0;e<d.length;++e)b.headers[d[e].querySelector("name").textContent]=d[e].querySelector("value").textContent;b.body=rc(c.querySelector("Challenge").textContent).buffer}else D("PlayReady request is already unwrapped."),b.headers["Content-Type"]="text/xml; charset=utf-8"}
function Uc(b){var c=new Uint8Array(b.body);c="spc="+qc(c);b.headers["Content-Type"]="application/x-www-form-urlencoded";b.body=oc(c)}function Vc(b){try{var c=lc(b.data)}catch(d){return}c=c.trim();"<ckc>"===c.substr(0,5)&&"</ckc>"===c.substr(-6)&&(c=c.slice(5,-6));try{c=JSON.parse(c).ckc}catch(d){}b.data=rc(c).buffer}
p.ed=function(b){b=b.target;G("Key status changed for session",b.sessionId);var c=this.c.get(b),d=!1;b.keyStatuses.forEach(function(b,e){if("string"==typeof e){var f=e;e=b;b=f}if("com.microsoft.playready"==this.a.keySystem&&16==e.byteLength&&!ic("Tizen")){f=new DataView(e);var g=f.getUint32(0,!0),l=f.getUint16(4,!0),m=f.getUint16(6,!0);f.setUint32(0,g,!1);f.setUint16(4,l,!1);f.setUint16(6,m,!1)}"com.microsoft.playready"==this.a.keySystem&&"status-pending"==b&&(b="usable");"status-pending"!=b&&(c.loaded=
!0);"expired"==b&&(d=!0);f=tc(new Uint8Array(e));this.ja.set(f,b)}.bind(this));var e=b.expiration-Date.now();(0>e||d&&1E3>e)&&c&&!c.Ha&&(D("Session has expired",b.sessionId),this.c["delete"](b),b.close()["catch"](function(){}));Sc(this)&&(this.l.resolve(),this.P.V(Xc))};function xc(b){var c=b.ja,d=b.ba;d.clear();c.forEach(function(b,c){return d.set(c,b)});c=Array.from(d.values());c.length&&c.every(function(b){return"expired"==b})&&b.g(new I(2,6,6014));b.C.dd(ac(d))}
function Yc(){function b(b){return t(function h(){var c,f,m;return y(h,function(h){switch(h.m){case 1:return h.T=2,u(h,navigator.requestMediaKeySystemAccess(b,d),4);case 4:return c=h.O,m=(f=c.getConfiguration().sessionTypes)?f.includes("persistent-license"):!1,ic("Tizen 3")&&(m=!1),e.set(b,{persistentState:m}),u(h,c.createMediaKeys(),5);case 5:xa(h,0);break;case 2:ya(h),e.set(b,null),w(h)}})})}var c=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],d=[{videoCapabilities:c,
persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:c}],e=new Map;c="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").map(function(c){return b(c)});return Promise.all(c).then(function(){return ac(e)})}
function Zc(b,c){var d=c.audio,e=c.video;if(d&&d.encrypted&&!Qc(b,bc(d.mimeType,d.codecs))||e&&e.encrypted&&!Qc(b,bc(e.mimeType,e.codecs)))return!1;var f=b.keySystem();return 0==c.drmInfos.length||c.drmInfos.some(function(b){return b.keySystem==f})}
function $c(b,c){if(!b.length)return c;if(!c.length)return b;for(var d=[],e=0;e<b.length;e++)for(var f=0;f<c.length;f++)if(b[e].keySystem==c[f].keySystem){var g=b[e];f=c[f];var h=[];h=h.concat(g.initData||[]);h=h.concat(f.initData||[]);var k=[];k=k.concat(g.keyIds);k=k.concat(f.keyIds);d.push({keySystem:g.keySystem,licenseServerUri:g.licenseServerUri||f.licenseServerUri,distinctiveIdentifierRequired:g.distinctiveIdentifierRequired||f.distinctiveIdentifierRequired,persistentStateRequired:g.persistentStateRequired||
f.persistentStateRequired,videoRobustness:g.videoRobustness||f.videoRobustness,audioRobustness:g.audioRobustness||f.audioRobustness,serverCertificate:g.serverCertificate||f.serverCertificate,initData:h,keyIds:k});break}return d}function yc(b){b.c.forEach(function(c,d){var e=c.xc,f=d.expiration;isNaN(f)&&(f=Infinity);f!=e&&(b.C.onExpirationUpdated(d.sessionId,f),c.xc=f)})}function Sc(b){b=b.c.values();return Zb(b,function(b){return b.loaded})}
function Dc(b,c){var d=[];c.forEach(function(b,c){d.push({keySystem:c,licenseServerUri:b,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})});for(var e=r(b),f=e.next();!f.done;f=e.next())f.value.drmInfos=d}
function Rc(b,c,d,e,f){b.forEach(function(b){c.includes(b.licenseServerUri)||c.push(b.licenseServerUri);b.serverCertificate&&(d.some(function(c){return uc(c,b.serverCertificate)})||d.push(b.serverCertificate));b.initData&&b.initData.forEach(function(b){e.some(function(c){return c.keyId&&c.keyId==b.keyId?!0:c.initDataType==b.initDataType&&uc(c.initData,b.initData)})||e.push(b)});if(b.keyIds)for(var g=0;g<b.keyIds.length;++g)f.includes(b.keyIds[g])||f.push(b.keyIds[g])})}
function Fc(b,c,d){if(b.keySystem&&("org.w3.clearkey"!=b.keySystem||!b.licenseServerUri)){c.size&&(c=c.get(b.keySystem)||"",b.licenseServerUri=c);b.keyIds||(b.keyIds=[]);if(d=d.get(b.keySystem))b.distinctiveIdentifierRequired||(b.distinctiveIdentifierRequired=d.distinctiveIdentifierRequired),b.persistentStateRequired||(b.persistentStateRequired=d.persistentStateRequired),b.videoRobustness||(b.videoRobustness=d.videoRobustness),b.audioRobustness||(b.audioRobustness=d.audioRobustness),b.serverCertificate||
(b.serverCertificate=d.serverCertificate);window.cast&&window.cast.__platform__&&"com.microsoft.playready"==b.keySystem&&(b.keySystem="com.chromecast.playready")}}function Ac(b){return t(function d(){var e,f;return y(d,function(d){switch(d.m){case 1:return e=new Promise(function(b){(new H(b)).V(ad)}),u(d,Promise.race([b.close().then(function(){return!0}),e.then(function(){return!1})]),2);case 2:(f=d.O)||B("Timeout waiting for session close"),w(d)}})})}var ad=1,Wc=5,Xc=.5;function bd(){this.a=new muxjs.mp4.CaptionParser;this.g=[];this.f={}}bd.prototype.init=function(b){var c=muxjs.mp4.probe;b=new Uint8Array(b);this.g=c.videoTrackIds(b);this.f=c.timescale(b);this.a.init()};bd.prototype.b=function(b,c){var d=new Uint8Array(b);(d=this.a.parse(d,this.g,this.f))&&d.captions&&c(d.captions);this.a.clearParsedCaptions()};bd.prototype.c=function(){this.a.resetCaptionStream()};function cd(){}cd.prototype.init=function(){};cd.prototype.b=function(){};cd.prototype.c=function(){};function dd(b){return!b||1==b.length&&1E-6>b.end(0)-b.start(0)?null:b.length?b.end(b.length-1):null}function ed(b,c,d){d=void 0===d?0:d;return!b||!b.length||1==b.length&&1E-6>b.end(0)-b.start(0)||c>b.end(b.length-1)?!1:c+d>=b.start(0)}function fd(b,c){if(!b||!b.length||1==b.length&&1E-6>b.end(0)-b.start(0))return 0;for(var d=0,e=b.length-1;0<=e&&b.end(e)>c;--e)d+=b.end(e)-Math.max(b.start(e),c);return d}
function gd(b){if(!b)return[];for(var c=[],d=0;d<b.length;d++)c.push({start:b.start(d),end:b.end(d)});return c};var hd={Gd:function(b,c){return b.reduce(function(b,c,f){return c["catch"](b.bind(null,f))}.bind(null,c),Promise.reject())},Nc:function(b,c){return b.concat(c)},Sb:function(){},Ba:function(b){return null!=b}};function id(b,c){if(0==c.length)return b;var d=c.map(function(b){return new Ta(b)});return b.map(function(b){return new Ta(b)}).map(function(b){return d.map(b.resolve.bind(b))}).reduce(hd.Nc,[]).map(function(b){return b.toString()})}function jd(b,c){return{keySystem:b,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:c||[],keyIds:[]}}var kd={Lc:"video",xd:"audio",Ja:"text",df:"application"},ld=1/15;function md(){this.a=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0});this.b=null;this.g=[];this.c=[];this.f=!1;this.a.on("data",this.i.bind(this));this.a.on("done",this.h.bind(this))}md.prototype.destroy=function(){this.a.dispose();this.a=null;return Promise.resolve()};function nd(b,c){return window.muxjs&&"mp2t"==b.toLowerCase().split(";")[0].split("/")[1]?c?MediaSource.isTypeSupported(od(c,b)):MediaSource.isTypeSupported(od("audio",b))||MediaSource.isTypeSupported(od("video",b)):!1}
function od(b,c){var d=c.replace(/mp2t/i,"mp4");"audio"==b&&(d=d.replace("video","audio"));var e=/avc1\.(66|77|100)\.(\d+)/.exec(d);if(e){var f="avc1.",g=e[1],h=Number(e[2]);f=("66"==g?f+"4200":"77"==g?f+"4d00":f+"6400")+(h>>4).toString(16);f+=(h&15).toString(16);d=d.replace(e[0],f)}return d}function pd(b,c){b.f=!0;b.b=new mb;b.g=[];b.c=[];var d=new Uint8Array(c);b.a.push(d);b.a.flush();b.f&&b.b.reject(new I(2,3,3018));return b.b}
md.prototype.i=function(b){this.c=b.captions;var c=new Uint8Array(b.data.byteLength+b.initSegment.byteLength);c.set(b.initSegment,0);c.set(b.data,b.initSegment.byteLength);this.g.push(c)};md.prototype.h=function(){var b={data:vc.apply(null,this.g),captions:this.c};this.b.resolve(b);this.f=!1};function qd(b,c,d){this.startTime=b;this.direction=rd;this.endTime=c;this.payload=d;this.region=new sd;this.position=null;this.positionAlign=td;this.size=100;this.textAlign=ud;this.writingMode=vd;this.lineInterpretation=wd;this.line=null;this.lineHeight="";this.lineAlign=xd;this.displayAlign=yd;this.fontSize=this.backgroundImage=this.backgroundColor=this.color="";this.fontWeight=zd;this.fontStyle=Ad;this.fontFamily="";this.textDecoration=[];this.wrapLine=!0;this.id=""}z("shaka.text.Cue",qd);
var td="auto";qd.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:td};var ud="center",Bd={LEFT:"left",RIGHT:"right",CENTER:ud,START:"start",END:"end"};qd.textAlign=Bd;var yd="after",Cd={BEFORE:"before",CENTER:"center",AFTER:yd};qd.displayAlign=Cd;var rd="ltr";qd.direction={HORIZONTAL_LEFT_TO_RIGHT:rd,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var vd="horizontal-tb";qd.writingMode={HORIZONTAL_TOP_TO_BOTTOM:vd,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};
var wd=0;qd.lineInterpretation={LINE_NUMBER:wd,PERCENTAGE:1};var xd="start",Dd={CENTER:"center",START:xd,END:"end"};qd.lineAlign=Dd;var zd=400;qd.fontWeight={NORMAL:zd,BOLD:700};var Ad="normal",Ed={NORMAL:Ad,ITALIC:"italic",OBLIQUE:"oblique"};qd.fontStyle=Ed;qd.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"};
function sd(){this.id="";this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0;this.height=this.width=100;this.viewportAnchorUnits=this.widthUnits=this.heightUnits=Fd;this.scroll=Gd}z("shaka.text.CueRegion",sd);var Fd=1;sd.units={PX:0,PERCENTAGE:Fd,LINES:2};var Gd="";sd.scrollMode={NONE:Gd,UP:"up"};function Hd(b){this.g=null;this.c=b;this.f=this.l=0;this.h=Infinity;this.b=this.a=null;this.j="";this.i=new Map}var Id={};z("shaka.text.TextEngine.registerParser",function(b,c){Id[b]=c});z("shaka.text.TextEngine.unregisterParser",function(b){delete Id[b]});function Jd(b){return Id[b]||window.muxjs&&"application/cea-608"==b?!0:!1}Hd.prototype.destroy=function(){this.c=this.g=null;this.i.clear();return Promise.resolve()};
Hd.prototype.Nb=function(b){var c={periodStart:0,segmentStart:null,segmentEnd:0};try{return this.g.parseMedia(new Uint8Array(b),c)[0].startTime}catch(d){throw new I(2,2,2009,d);}};
function Kd(b,c,d,e){return Promise.resolve().then(function(){if(this.g&&this.c)if(null==d||null==e)this.g.parseInit(new Uint8Array(c));else{var b={periodStart:this.l,segmentStart:d,segmentEnd:e};b=this.g.parseMedia(new Uint8Array(c),b).filter(function(b){return b.startTime>=this.f&&b.startTime<this.h}.bind(this));this.c.append(b);null==this.a&&(this.a=Math.max(d,this.f));this.b=Math.min(e,this.h)}}.bind(b))}
Hd.prototype.remove=function(b,c){return Promise.resolve().then(function(){!this.c||!this.c.remove(b,c)||null==this.a||c<=this.a||b>=this.b||(b<=this.a&&c>=this.b?this.a=this.b=null:b<=this.a&&c<this.b?this.a=c:b>this.a&&c>=this.b&&(this.b=b))}.bind(this))};Hd.prototype.Ad=function(b){this.c.append(b)};Hd.prototype.appendCues=Hd.prototype.Ad;
Hd.prototype.Zb=function(b,c){this.j=b;var d=this.i.get(b);if(d)for(var e=r(d.keys()),f=e.next();!f.done;f=e.next())if(f=d.get(f.value))f=f.filter(function(b){return b.endTime<=c}),this.c.append(f)};Hd.prototype.setSelectedClosedCaptionId=Hd.prototype.Zb;
function Ld(b,c,d,e,f){var g=d+" "+e,h=new Map;c=r(c);for(var k=c.next();!k.done;k=c.next()){var l=k.value;k=l.stream;h.has(k)||h.set(k,new Map);h.get(k).has(g)||h.get(k).set(g,[]);l.startTime+=f;l.endTime+=f;l.startTime>=b.f&&l.startTime<b.h&&(l=new qd(l.startTime,l.endTime,l.text),h.get(k).get(g).push(l),k==b.j&&b.c.append([l]))}f=r(h.keys());for(g=f.next();!g.done;g=f.next())for(g=g.value,b.i.has(g)||b.i.set(g,new Map),c=r(h.get(g).keys()),k=c.next();!k.done;k=c.next())k=k.value,l=h.get(g).get(k),
b.i.get(g).set(k,l);b.a=null==b.a?Math.max(d,b.f):Math.min(b.a,Math.max(d,b.f));b.b=Math.max(b.b,Math.min(e,b.h))};function Md(b,c,d){this.f=b;this.g=d;this.b={};this.a=null;this.c={};this.i=new O;this.v=!1;this.j={};this.l=c;b=this.s=new mb;c=new MediaSource;this.i.ea(c,"sourceopen",b.resolve);this.f.src=Nd(c);this.h=c}var Nd=window.URL.createObjectURL;function Od(b){var c=bc(b.mimeType,b.codecs),d=cc(b);return Jd(c)||MediaSource.isTypeSupported(d)||nd(c,b.type)}p=Md.prototype;
p.destroy=function(){var b=this;this.v=!0;var c=[],d;for(d in this.c){var e=this.c[d],f=e[0];this.c[d]=e.slice(0,1);f&&c.push(f.p["catch"](hd.Sb));for(f=1;f<e.length;++f)e[f].p.reject()}this.a&&c.push(this.a.destroy());this.g&&c.push(this.g.destroy());for(var g in this.j)c.push(this.j[g].destroy());return Promise.all(c).then(function(){b.i&&(b.i.release(),b.i=null);b.f&&(b.f.removeAttribute("src"),b.f.load(),b.f=null);b.h=null;b.a=null;b.g=null;b.b={};b.j={};b.l=null;b.c={}})};
p.init=function(b,c){var d=this;return t(function f(){var g;return y(f,function(f){switch(f.m){case 1:return g=kd,u(f,d.s,2);case 2:b.forEach(function(b,f){var h=bc(b.mimeType,b.codecs);f==g.Ja?Pd(d,h):(!c&&MediaSource.isTypeSupported(h)||!nd(h,f)||(d.j[f]=new md,h=od(f,h)),h=d.h.addSourceBuffer(h),d.i.w(h,"error",d.Ue.bind(d,f)),d.i.w(h,"updateend",d.lb.bind(d,f)),d.b[f]=h,d.c[f]=[])}),w(f)}})})};function Pd(b,c){b.a||(b.a=new Hd(b.g));"application/cea-608"!=c&&(b.a.g=new Id[c])}
function Qd(b){return b.h?"ended"==b.h.readyState:!0}function Rd(b,c){if("text"==c)var d=b.a.a;else d=Sd(b,c),d=!d||1==d.length&&1E-6>d.end(0)-d.start(0)?null:1==d.length&&0>d.start(0)?0:d.length?d.start(0):null;return d}function Td(b,c){return"text"==c?b.a.b:dd(Sd(b,c))}function Ud(b,c,d){if("text"==c)return b=b.a,null==b.b||b.b<d?0:b.b-Math.max(d,b.a);b=Sd(b,c);return fd(b,d)}
p.lc=function(b){b.total=gd(this.f.buffered);b.audio=gd(Sd(this,"audio"));b.video=gd(Sd(this,"video"));b.text=[];if(this.a){var c=this.a.a,d=this.a.b;null!=c&&null!=d&&b.text.push({start:c,end:d})}};function Sd(b,c){try{return b.b[c].buffered}catch(d){return c in b.b&&A("failed to get buffered range for "+c,d),null}}
function Vd(b,c,d,e,f,g){if("text"==c)return Kd(b.a,d,e,f);if(b.j[c])return pd(b.j[c],d).then(function(b){this.a||Pd(this,"text/vtt");b.captions&&Ld(this.a,b.captions,e,f,this.b.video.timestampOffset);return Wd(this,c,this.ud.bind(this,c,b.data.buffer))}.bind(b));g&&window.muxjs&&(b.a||Pd(b,"text/vtt"),null==e&&null==f?b.l.init(d):b.l.b(d,function(c){c.length&&Ld(b.a,c,e,f,b.b.video.timestampOffset)}));return Wd(b,c,b.ud.bind(b,c,d))}p.Zb=function(b){var c=Td(this,"video")||0;this.a.Zb(b,c)};
p.remove=function(b,c,d){return"text"==b?this.a.remove(c,d):Wd(this,b,this.nd.bind(this,b,c,d))};function Xd(b,c){if("text"==c){if(!b.a)return Promise.resolve();b.l.c();return b.a.remove(0,Infinity)}return Wd(b,c,b.nd.bind(b,c,0,b.h.duration))}p.flush=function(b){return"text"==b?Promise.resolve():Wd(this,b,this.Jd.bind(this,b))};
function Yd(b,c,d,e,f){return"text"==c?(b.a.l=d,b=b.a,b.f=e,b.h=f,Promise.resolve()):Promise.all([Wd(b,c,b.zd.bind(b,c)),Wd(b,c,b.Te.bind(b,c,d)),Wd(b,c,b.Pe.bind(b,c,e,f))])}p.endOfStream=function(b){return Zd(this,function(){Qd(this)||(b?this.h.endOfStream(b):this.h.endOfStream())}.bind(this))};p.Ra=function(b){return Zd(this,function(){this.h.duration=b}.bind(this))};p.Z=function(){return this.h.duration};p.ud=function(b,c){this.b[b].appendBuffer(c)};
p.nd=function(b,c,d){d<=c?this.lb(b):this.b[b].remove(c,d)};p.zd=function(b){var c=this.b[b].appendWindowStart,d=this.b[b].appendWindowEnd;this.b[b].abort();this.b[b].appendWindowStart=c;this.b[b].appendWindowEnd=d;this.lb(b)};p.Jd=function(b){this.f.currentTime-=.001;this.lb(b)};p.Te=function(b,c){0>c&&(c+=.001);this.b[b].timestampOffset=c;this.lb(b)};p.Pe=function(b,c,d){this.b[b].appendWindowStart=0;this.b[b].appendWindowEnd=d;this.b[b].appendWindowStart=c;this.lb(b)};
p.Ue=function(b){this.c[b][0].p.reject(new I(2,3,3014,this.f.error?this.f.error.code:0))};p.lb=function(b){var c=this.c[b][0];c&&(c.p.resolve(),$d(this,b))};function Wd(b,c,d){if(b.v)return Promise.reject();d={start:d,p:new mb};b.c[c].push(d);if(1==b.c[c].length)try{d.start()}catch(e){"QuotaExceededError"==e.name?d.p.reject(new I(2,3,3017,c)):d.p.reject(new I(2,3,3015,e)),$d(b,c)}return d.p}
function Zd(b,c){if(b.v)return Promise.reject();var d=[],e;for(e in b.b){var f=new mb,g={start:function(b){b.resolve()}.bind(null,f),p:f};b.c[e].push(g);d.push(f);1==b.c[e].length&&g.start()}return Promise.all(d).then(function(){try{c()}catch(l){var b=Promise.reject(new I(2,3,3015,l))}for(var d in this.b)$d(this,d);return b}.bind(b),function(b){throw b;}.bind(b))}function $d(b,c){b.c[c].shift();var d=b.c[c][0];if(d)try{d.start()}catch(e){d.p.reject(new I(2,3,3015,e)),$d(b,c)}};function ae(b,c){b=P(b);c=P(c);return b.split("-")[0]==c.split("-")[0]}function be(b,c){b=P(b);c=P(c);var d=b.split("-"),e=c.split("-");return d[0]==e[0]&&1==d.length&&2==e.length}function P(b){b=b.split("-");b=r(b);var c=b.next().value;c=void 0===c?"":c;var d=b.next().value;d=void 0===d?"":d;b=la(b);c=c.toLowerCase();c=ce.get(c)||c;d=d.toUpperCase();return[d?c+"-"+d:c].concat(ta(b)).join("-")}
function de(b){return b.language?P(b.language):b.audio&&b.audio.language?P(b.audio.language):b.video&&b.video.language?P(b.video.language):"und"}
function ee(b,c){for(var d=P(b),e=new Set,f=r(c),g=f.next();!g.done;g=f.next())e.add(P(g.value));f=r(e);for(g=f.next();!g.done;g=f.next())if(g=g.value,g==d)return g;f=r(e);for(g=f.next();!g.done;g=f.next())if(g=g.value,be(g,d))return g;f=r(e);for(g=f.next();!g.done;g=f.next()){var h=g=g.value,k=d;h=P(h);k=P(k);h=h.split("-");k=k.split("-");if(2==h.length&&2==k.length&&h[0]==k[0])return g}e=r(e);for(g=e.next();!g.done;g=e.next())if(f=g.value,be(d,f))return f;return null}
var ce=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze",
"cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice",
"is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao",
"mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san",
"sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie",
"vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function fe(b,c,d){function e(b,c,d){return b>=c&&b<=d}var f=b.video;return f&&f.width&&f.height&&!(e(f.width,c.minWidth,Math.min(c.maxWidth,d.width))&&e(f.height,c.minHeight,Math.min(c.maxHeight,d.height))&&e(f.width*f.height,c.minPixels,c.maxPixels))||!e(b.bandwidth,c.minBandwidth,c.maxBandwidth)?!1:!0}function ge(b,c,d){var e=!1;b.forEach(function(b){var f=b.allowedByApplication;b.allowedByApplication=fe(b,c,d);f!=b.allowedByApplication&&(e=!0)});return e}
function he(b,c,d,e){e.variants=e.variants.filter(function(e){if(b&&b.W&&!Zc(b,e))return D("Dropping variant - not compatible with key system",e),!1;var f=e.audio;e=e.video;return f&&!Od(f)?(D("Dropping variant - audio not compatible with platform",ie(f)),!1):e&&!Od(e)?(D("Dropping variant - video not compatible with platform",ie(e)),!1):f&&c&&!je(f,c)?(D("Droping variant - not compatible with active audio","active audio",ie(c),"variant.audio",ie(f)),!1):e&&d&&!je(e,d)?(D("Droping variant - not compatible with active video",
"active video",ie(d),"variant.video",ie(e)),!1):!0});e.textStreams=e.textStreams.filter(function(b){var c=Jd(bc(b.mimeType,b.codecs));c||D("Dropping text stream. Is not supported by the platform.",b);return c})}function je(b,c){return b.mimeType!=c.mimeType||b.codecs.split(".")[0]!=c.codecs.split(".")[0]?!1:!0}
function ke(b){var c=b.audio,d=b.video,e=c?c.codecs:null,f=d?d.codecs:null,g=[];f&&g.push(f);e&&g.push(e);var h=[];d&&h.push(d.mimeType);c&&h.push(c.mimeType);h=h[0]||null;var k=[];c&&k.push(c.kind);d&&k.push(d.kind);k=k[0]||null;var l=new Set;c&&c.roles.forEach(function(b){return l.add(b)});d&&d.roles.forEach(function(b){return l.add(b)});b={id:b.id,active:!1,type:"variant",bandwidth:b.bandwidth,language:b.language,label:null,kind:k,width:null,height:null,frameRate:null,mimeType:h,codecs:g.join(", "),
audioCodec:e,videoCodec:f,primary:b.primary,roles:Array.from(l),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null};d&&(b.videoId=d.id,b.originalVideoId=d.originalId,b.width=d.width||null,b.height=d.height||null,b.frameRate=d.frameRate||null,b.videoBandwidth=d.bandwidth||null);c&&(b.audioId=c.id,b.originalAudioId=c.originalId,b.channelsCount=c.channelsCount,b.audioBandwidth=c.bandwidth||
null,b.label=c.label,b.audioRoles=c.roles);return b}function le(b){return{id:b.id,active:!1,type:"text",bandwidth:0,language:b.language,label:b.label,kind:b.kind||null,width:null,height:null,frameRate:null,mimeType:b.mimeType,codecs:b.codecs||null,audioCodec:null,videoCodec:null,primary:b.primary,roles:b.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:b.originalId}}
function me(b){b.__shaka_id||(b.__shaka_id=ne++);return b.__shaka_id}var ne=0;function oe(b){return{id:me(b),active:!1,type:"",bandwidth:0,language:P(b.language),label:b.label,kind:b.kind,width:null,height:null,frameRate:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}}
function pe(b){return b.allowedByApplication&&b.allowedByKeySystem}function qe(b,c){var d=b.filter(function(b){return b.audio&&b.audio.channelsCount}),e=new Map;d=r(d);for(var f=d.next();!f.done;f=d.next()){f=f.value;var g=f.audio.channelsCount;e.has(g)||e.set(g,[]);e.get(g).push(f)}d=Array.from(e.keys());if(0==d.length)return b;f=d.filter(function(b){return b<=c});return f.length?e.get(Math.max.apply(null,f)):e.get(Math.min.apply(null,d))}
function re(b,c,d){var e=b,f=b.filter(function(b){return b.primary});f.length&&(e=f);var g=e.length?e[0].language:"";e=e.filter(function(b){return b.language==g});if(c){var h=ee(P(c),b.map(function(b){return b.language}));h&&(e=b.filter(function(b){return P(b.language)==h}))}if(d){b=se(e,d);if(b.length)return b;B("No exact match for the text role could be found.")}else if(b=e.filter(function(b){return 0==b.roles.length}),b.length)return b;b=e.map(function(b){return b.roles}).reduce(hd.Nc,[]);return b.length?
se(e,b[0]):e}function se(b,c){return b.filter(function(b){return b.roles.includes(c)})}function te(b,c,d){for(var e=0;e<d.length;e++)if(d[e].audio==b&&d[e].video==c)return d[e];return null}function ue(b){var c=[];b.audio&&c.push(b.audio);b.video&&c.push(b.video);return c}
function ie(b){return"audio"==b.type?"type=audio codecs="+b.codecs+" bandwidth="+b.bandwidth+" channelsCount="+b.channelsCount:"video"==b.type?"type=video codecs="+b.codecs+" bandwidth="+b.bandwidth+" frameRate="+b.frameRate+" width="+b.width+" height="+b.height:"unexpected stream type"};function Q(){this.h=null;this.c=!1;this.b=new Pa;this.g=[];this.i=!1;this.a=this.f=null}z("shaka.abr.SimpleAbrManager",Q);Q.prototype.stop=function(){this.h=null;this.c=!1;this.g=[];this.f=null};Q.prototype.stop=Q.prototype.stop;Q.prototype.init=function(b){this.h=b};Q.prototype.init=Q.prototype.init;
Q.prototype.chooseVariant=function(){var b=ve(this.a.restrictions,this.g),c=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);this.g.length&&!b.length&&(B("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),b=ve(null,this.g),b=[b[0]]);for(var d=b[0]||null,e=0;e<b.length;++e){var f=b[e],g=f.bandwidth/this.a.bandwidthDowngradeTarget,h=(b[e+1]||{bandwidth:Infinity}).bandwidth/this.a.bandwidthUpgradeTarget;G("Bandwidth ranges:",(f.bandwidth/1E6).toFixed(3),(g/1E6).toFixed(3),
(h/1E6).toFixed(3));c>=g&&c<=h&&(d=f)}this.f=Date.now();return d};Q.prototype.chooseVariant=Q.prototype.chooseVariant;Q.prototype.enable=function(){this.c=!0};Q.prototype.enable=Q.prototype.enable;Q.prototype.disable=function(){this.c=!1};Q.prototype.disable=Q.prototype.disable;
Q.prototype.segmentDownloaded=function(b,c){G("Segment downloaded:","deltaTimeMs="+b,"numBytes="+c,"lastTimeChosenMs="+this.f,"enabled="+this.c);var d=this.b;if(!(16E3>c)){var e=8E3*c/b,f=b/1E3;d.a+=c;Ma(d.b,f,e);Ma(d.c,f,e)}if(null!=this.f&&this.c)a:{G("Suggesting Streams...");if(!this.i){if(!(128E3<=this.b.a)){G("Still waiting for a good estimate...");break a}this.i=!0}else if(Date.now()-this.f<1E3*this.a.switchInterval){G("Still within switch interval...");break a}d=this.chooseVariant();e=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);
D("Calling switch_(), bandwidth="+Math.round(e/1E3)+" kbps");this.h(d)}};Q.prototype.segmentDownloaded=Q.prototype.segmentDownloaded;Q.prototype.getBandwidthEstimate=function(){return this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate)};Q.prototype.getBandwidthEstimate=Q.prototype.getBandwidthEstimate;Q.prototype.setVariants=function(b){this.g=b};Q.prototype.setVariants=Q.prototype.setVariants;Q.prototype.configure=function(b){this.a=b};Q.prototype.configure=Q.prototype.configure;
function ve(b,c){b&&(c=c.filter(function(c){return fe(c,b,{width:Infinity,height:Infinity})}));return c.sort(function(b,c){return b.bandwidth-c.bandwidth})};function R(b,c){this.D=b;this.b=c==we;this.a=0}z("shaka.util.DataViewReader",R);var we=1;R.Endianness={ef:0,ff:we};R.prototype.oa=function(){return this.a<this.D.byteLength};R.prototype.hasMoreData=R.prototype.oa;R.prototype.U=function(){return this.a};R.prototype.getPosition=R.prototype.U;R.prototype.Qd=function(){return this.D.byteLength};R.prototype.getLength=R.prototype.Qd;R.prototype.Ac=function(){try{var b=this.D.getUint8(this.a);this.a+=1;return b}catch(c){xe()}};R.prototype.readUint8=R.prototype.Ac;
R.prototype.kd=function(){try{var b=this.D.getUint16(this.a,this.b);this.a+=2;return b}catch(c){xe()}};R.prototype.readUint16=R.prototype.kd;R.prototype.B=function(){try{var b=this.D.getUint32(this.a,this.b);this.a+=4;return b}catch(c){xe()}};R.prototype.readUint32=R.prototype.B;R.prototype.jd=function(){try{var b=this.D.getInt32(this.a,this.b);this.a+=4;return b}catch(c){xe()}};R.prototype.readInt32=R.prototype.jd;
R.prototype.xb=function(){try{if(this.b){var b=this.D.getUint32(this.a,!0);var c=this.D.getUint32(this.a+4,!0)}else c=this.D.getUint32(this.a,!1),b=this.D.getUint32(this.a+4,!1)}catch(d){xe()}if(2097151<c)throw new I(2,3,3001);this.a+=8;return c*Math.pow(2,32)+b};R.prototype.readUint64=R.prototype.xb;R.prototype.Qa=function(b){this.a+b>this.D.byteLength&&xe();var c=new Uint8Array(this.D.buffer,this.D.byteOffset+this.a,b);this.a+=b;return new Uint8Array(c)};R.prototype.readBytes=R.prototype.Qa;
R.prototype.H=function(b){this.a+b>this.D.byteLength&&xe();this.a+=b};R.prototype.skip=R.prototype.H;R.prototype.Je=function(b){this.a<b&&xe();this.a-=b};R.prototype.rewind=R.prototype.Je;R.prototype.seek=function(b){(0>b||b>this.D.byteLength)&&xe();this.a=b};R.prototype.seek=R.prototype.seek;R.prototype.zc=function(){for(var b=this.a;this.oa()&&0!=this.D.getUint8(this.a);)this.a+=1;b=new Uint8Array(this.D.buffer,this.D.byteOffset+b,this.a-b);this.a+=1;return lc(b)};
R.prototype.readTerminatedString=R.prototype.zc;function xe(){throw new I(2,3,3E3);};function S(){this.c=[];this.b=[];this.a=!1}z("shaka.util.Mp4Parser",S);S.prototype.K=function(b,c){var d=ye(b);this.c[d]=0;this.b[d]=c;return this};S.prototype.box=S.prototype.K;S.prototype.na=function(b,c){var d=ye(b);this.c[d]=1;this.b[d]=c;return this};S.prototype.fullBox=S.prototype.na;S.prototype.stop=function(){this.a=!0};S.prototype.stop=S.prototype.stop;
S.prototype.parse=function(b,c){var d=new Uint8Array(b);d=new R(new DataView(d.buffer,d.byteOffset,d.byteLength),0);for(this.a=!1;d.oa()&&!this.a;)this.Wb(0,d,c)};S.prototype.parse=S.prototype.parse;
S.prototype.Wb=function(b,c,d){var e=c.U(),f=c.B(),g=c.B();G("Parsing MP4 box",ze(g));switch(f){case 0:f=c.D.byteLength-e;break;case 1:f=c.xb()}var h=this.b[g];if(h){var k=null,l=null;1==this.c[g]&&(l=c.B(),k=l>>>24,l&=16777215);g=e+f;d&&g>c.D.byteLength&&(g=c.D.byteLength);g-=c.U();c=0<g?c.Qa(g):new Uint8Array(0);c=new R(new DataView(c.buffer,c.byteOffset,c.byteLength),0);h({parser:this,partialOkay:d||!1,version:k,flags:l,reader:c,size:f,start:e+b})}else c.H(Math.min(e+f-c.U(),c.D.byteLength-c.U()))};
S.prototype.parseNext=S.prototype.Wb;function Ae(b){for(;b.reader.oa()&&!b.parser.a;)b.parser.Wb(b.start,b.reader,b.partialOkay)}S.children=Ae;function Be(b){for(var c=b.reader.B();0<c&&!b.parser.a;--c)b.parser.Wb(b.start,b.reader,b.partialOkay)}S.sampleDescription=Be;function Ce(b){return function(c){b(c.reader.Qa(c.reader.D.byteLength-c.reader.U()))}}S.allData=Ce;function ye(b){for(var c=0,d=0;d<b.length;d++)c=c<<8|b.charCodeAt(d);return c}
function ze(b){return String.fromCharCode(b>>24&255,b>>16&255,b>>8&255,b&255)}S.typeToString=ze;function De(b){this.f=[];this.b=[];this.a=[];(new S).na("pssh",this.c.bind(this)).parse(b.buffer);0==this.a.length&&B("No pssh box found!")}
De.prototype.c=function(b){if(1<b.version)B("Unrecognized PSSH version found!");else{var c=tc(b.reader.Qa(16)),d=[];if(0<b.version)for(var e=b.reader.B(),f=0;f<e;++f){var g=tc(b.reader.Qa(16));d.push(g)}e=b.reader.B();b.reader.H(e);this.b.push.apply(this.b,d);this.f.push(c);this.a.push({start:b.start,end:b.start+b.size-1});b.reader.U()!=b.reader.D.byteLength&&B("Mismatch between box size and data size!")}};var T={Jb:function(b,c){var d=T.L(b,c);return 1!=d.length?null:d[0]},kc:function(b,c,d){b=T.Tc(b,c,d);return 1!=b.length?null:b[0]},L:function(b,c){return Array.prototype.filter.call(b.childNodes,function(b){return b instanceof Element&&b.tagName==c})},Tc:function(b,c,d){return Array.prototype.filter.call(b.childNodes,function(b){return b instanceof Element&&b.localName==d&&b.namespaceURI==c})},getAttributeNS:function(b,c,d){return b.hasAttributeNS(c,d)?b.getAttributeNS(c,d):null},Kb:function(b){return Array.prototype.every.call(b.childNodes,
function(b){return b.nodeType==Node.TEXT_NODE||b.nodeType==Node.CDATA_SECTION_NODE})?b.textContent.trim():null},F:function(b,c,d,e){e=void 0===e?null:e;var f=null;b=b.getAttribute(c);null!=b&&(f=d(b));return null==f?e:f},xe:function(b){if(!b)return null;/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(b)&&(b+="Z");b=Date.parse(b);return isNaN(b)?null:Math.floor(b/1E3)},ua:function(b){if(!b)return null;var c=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(b);
if(!c)return B("Invalid duration string:",b),null;b=31536E3*Number(c[1]||null)+2592E3*Number(c[2]||null)+86400*Number(c[3]||null)+3600*Number(c[4]||null)+60*Number(c[5]||null)+Number(c[6]||null);return isFinite(b)?b:null},Yb:function(b){var c=/([0-9]+)-([0-9]+)/.exec(b);if(!c)return null;b=Number(c[1]);if(!isFinite(b))return null;c=Number(c[2]);return isFinite(c)?{start:b,end:c}:null},parseInt:function(b){b=Number(b);return 0===b%1?b:null},Xb:function(b){b=Number(b);return 0===b%1&&0<b?b:null},mb:function(b){b=
Number(b);return 0===b%1&&0<=b?b:null},parseFloat:function(b){b=Number(b);return isNaN(b)?null:b},Id:function(b){var c;b=(c=b.match(/^(\d+)\/(\d+)$/))?Number(c[1])/Number(c[2]):Number(b);return isNaN(b)?null:b},hd:function(b,c){var d=new DOMParser;try{var e=d.parseFromString(b,"text/xml")}catch(g){}if(e&&e.documentElement.tagName==c)var f=e.documentElement;return f&&0<f.getElementsByTagName("parsererror").length?null:f},gd:function(b,c){try{var d=lc(b);return T.hd(d,c)}catch(e){}}};var Ee=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime");
function Fe(b,c,d){var e=Ge(b),f=null;b=[];var g=[],h=new Set(e.map(function(b){return b.keyId}));h["delete"](null);if(1<h.size)throw new I(2,4,4010);d||(g=e.filter(function(b){return"urn:mpeg:dash:mp4protection:2011"==b.pd?(f=b.init||f,!1):!0}),g.length&&(b=He(f,c,g),0==b.length&&(b=[jd("",f)])));if(e.length&&(d||!g.length))for(b=[],c=r(Ee.values()),d=c.next();!d.done;d=c.next())d=d.value,"org.w3.clearkey"!=d&&b.push(jd(d,f));if(h=Array.from(h)[0]||null)for(c=r(b),d=c.next();!d.done;d=c.next())for(d=
r(d.value.initData),e=d.next();!e.done;e=d.next())e.value.keyId=h;return{Oc:h,hf:f,drmInfos:b,Uc:!0}}function Ie(b,c,d,e){var f=Fe(b,c,e);if(d.Uc){b=1==d.drmInfos.length&&!d.drmInfos[0].keySystem;c=0==f.drmInfos.length;if(0==d.drmInfos.length||b&&!c)d.drmInfos=f.drmInfos;d.Uc=!1}else if(0<f.drmInfos.length&&(d.drmInfos=d.drmInfos.filter(function(b){return f.drmInfos.some(function(c){return c.keySystem==b.keySystem})}),0==d.drmInfos.length))throw new I(2,4,4008);return f.Oc||d.Oc}
function Je(b){var c=0,d=(new DataView(b)).getUint32(c,!0);c+=4;if(d!==b.byteLength)return B("PlayReady Object with invalid length encountered."),[];c+=2;d=[];for(var e=new DataView(b);c<b.byteLength-1;){var f=e.getUint16(c,!0);c+=2;var g=e.getUint16(c,!0);c+=2;var h=new Uint8Array(b,c,g);d.push({type:f,value:h});c+=g}return d}function Ke(b){return(b=b.querySelector("DATA > LA_URL"))?b.textContent:""}
function He(b,c,d){var e=[];d=r(d);for(var f=d.next();!f.done;f=d.next()){f=f.value;var g=Ee.get(f.pd);if(g){var h;if(h=T.kc(f.node,"urn:microsoft:playready","pro")){h=rc(h.textContent);var k=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),l=h.length,m=k.length+16+l,n=new ArrayBuffer(m),q=new Uint8Array(n);n=new DataView(n);var v=0;n.setUint32(v,m);v+=4;n.setUint32(v,1886614376);v+=4;n.setUint32(v,0);v+=4;q.set(k,v);v+=k.length;n.setUint32(v,l);v+=4;q.set(h,v);h=[{initData:q,
initDataType:"cenc",keyId:f.keyId}]}else h=null;h=jd(g,f.init||b||h);if(g=Le.get(g))h.licenseServerUri=g(f);e.push(h)}else for(f=c(f.node)||[],f=r(f),g=f.next();!g.done;g=f.next())e.push(g.value)}return e}
var Le=(new Map).set("com.widevine.alpha",function(b){return(b=T.kc(b.node,"urn:microsoft","laurl"))?b.getAttribute("licenseUrl")||"":""}).set("com.microsoft.playready",function(b){b=T.kc(b.node,"urn:microsoft:playready","pro");if(!b)return"";b=rc(b.textContent);b=Je(b.buffer).filter(function(b){return 1===b.type})[0];if(!b)return"";b=Wb(b.value,!0);return(b=T.hd(b,"WRMHEADER"))?Ke(b):""});function Ge(b){var c=[];b=r(b);for(var d=b.next();!d.done;d=b.next())(d=Me(d.value))&&c.push(d);return c}
function Me(b){var c=b.getAttribute("schemeIdUri"),d=T.getAttributeNS(b,"urn:mpeg:cenc:2013","default_KID"),e=T.Tc(b,"urn:mpeg:cenc:2013","pssh").map(T.Kb);if(!c)return A("Missing required schemeIdUri attribute on","ContentProtection element",b),null;c=c.toLowerCase();if(d&&(d=d.replace(/-/g,"").toLowerCase(),d.includes(" ")))throw new I(2,4,4009);var f=[];try{f=e.map(function(b){return{initDataType:"cenc",initData:rc(b),keyId:null}})}catch(g){throw new I(2,4,4007);}return{node:b,pd:c,keyId:d,init:0<
f.length?f:null}};function Ne(b,c,d,e,f){var g={RepresentationID:c,Number:d,Bandwidth:e,Time:f};return b.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(c,d,e,f){if("$$"==c)return"$";var h=g[d];if(null==h)return B("URL template does not have an available substitution for identifier",'"'+d+'":',b),c;"RepresentationID"==d&&e&&(B("URL template should not contain a width specifier for identifier",'"RepresentationID":',b),e=void 0);"Time"==d&&(h=Math.round(h));switch(f){case void 0:case "d":case "i":case "u":c=
h.toString();break;case "o":c=h.toString(8);break;case "x":c=h.toString(16);break;case "X":c=h.toString(16).toUpperCase();break;default:c=h.toString()}e=window.parseInt(e,10)||1;return Array(Math.max(0,e-c.length)+1).join("0")+c})}
function Oe(b,c){var d=Pe(b,c,"timescale"),e=1;d&&(e=T.Xb(d)||1);d=Pe(b,c,"duration");(d=T.Xb(d||""))&&(d/=e);var f=Pe(b,c,"startNumber"),g=Number(Pe(b,c,"presentationTimeOffset"))||0,h=T.mb(f||"");if(null==f||null==h)h=1;var k=Qe(b,c,"SegmentTimeline");f=null;if(k){f=e;var l=b.M.duration||Infinity;k=T.L(k,"S");for(var m=[],n=0,q=0;q<k.length;++q){var v=k[q],x=T.F(v,"t",T.mb),E=T.F(v,"d",T.mb),K=T.F(v,"r",T.parseInt);null!=x&&(x-=g);if(!E){B('"S" element must have a duration:','ignoring the remaining "S" elements.',
v);break}x=null!=x?x:n;K=K||0;if(0>K)if(q+1<k.length){K=T.F(k[q+1],"t",T.mb);if(null==K){B('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',v);break}else if(x>=K){B('An "S" element cannot have a negative repeat','if its start time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',v);break}K=Math.ceil((K-x)/E)-1}else{if(Infinity==l){B('The last "S" element cannot have a negative repeat',
"if the Period has an infinite duration:",'ignoring the last "S" element.',v);break}else if(x/f>=l){B('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'igoring the last "S" element.',v);break}K=Math.ceil((l*f-x)/E)-1}0<m.length&&x!=n&&(Math.abs((x-n)/f)>=ld&&B("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",v),m[m.length-1].end=x/f);for(v=0;v<=K;++v)n=x+E,m.push({start:x/f,end:n/f,af:x}),x=n}f=m}return{timescale:e,
S:d,Sa:h,ga:g/e||0,Kc:g,G:f}}function Pe(b,c,d){return[c(b.u),c(b.X),c(b.fa)].filter(hd.Ba).map(function(b){return b.getAttribute(d)}).reduce(function(b,c){return b||c})}function Qe(b,c,d){return[c(b.u),c(b.X),c(b.fa)].filter(hd.Ba).map(function(b){return T.Jb(b,d)}).reduce(function(b,c){return b||c})}
function Re(b,c,d,e,f,g){for(var h=T.getAttributeNS(b,"http://www.w3.org/1999/xlink","href"),k=T.getAttributeNS(b,"http://www.w3.org/1999/xlink","actuate")||"onRequest",l=0;l<b.attributes.length;l++){var m=b.attributes[l];"http://www.w3.org/1999/xlink"==m.namespaceURI&&(b.removeAttributeNS(m.namespaceURI,m.localName),--l)}if(5<=g)return pb(new I(2,4,4028));if("onLoad"!=k)return pb(new I(2,4,4027));var n=id([e],[h]);return f.request(0,Eb(n,c)).Y(function(e){e=T.gd(e.data,b.tagName);if(!e)return pb(new I(2,
4,4001,h));for(;b.childNodes.length;)b.removeChild(b.childNodes[0]);for(;e.childNodes.length;){var k=e.childNodes[0];e.removeChild(k);b.appendChild(k)}for(k=0;k<e.attributes.length;k++){var l=e.attributes[k].nodeName,m=e.getAttribute(l);b.setAttribute(l,m)}return Se(b,c,d,n[0],f,g+1)})}
function Se(b,c,d,e,f,g){g=void 0===g?0:g;if(T.getAttributeNS(b,"http://www.w3.org/1999/xlink","href")){var h=Re(b,c,d,e,f,g);d&&(h=h.Y(void 0,function(){return Se(b,c,d,e,f,g)}));return h}h=[];for(var k=0;k<b.childNodes.length;k++){var l=b.childNodes[k];l instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==T.getAttributeNS(l,"http://www.w3.org/1999/xlink","href")?(b.removeChild(l),--k):"SegmentTimeline"!=l.tagName&&h.push(Se(l,c,d,e,f,g)))}return tb(h).Y(function(){return b})};function Te(b,c,d){this.c=b;this.b=c;this.a=d}z("shaka.media.InitSegmentReference",Te);Te.prototype.gc=function(){return this.c()};Te.prototype.createUris=Te.prototype.gc;Te.prototype.oc=function(){return this.b};Te.prototype.getStartByte=Te.prototype.oc;Te.prototype.mc=function(){return this.a};Te.prototype.getEndByte=Te.prototype.mc;function U(b,c,d,e,f,g){this.position=b;this.startTime=c;this.endTime=d;this.c=e;this.b=f;this.a=g}z("shaka.media.SegmentReference",U);U.prototype.U=function(){return this.position};
U.prototype.getPosition=U.prototype.U;U.prototype.Nb=function(){return this.startTime};U.prototype.getStartTime=U.prototype.Nb;U.prototype.Od=function(){return this.endTime};U.prototype.getEndTime=U.prototype.Od;U.prototype.gc=function(){return this.c()};U.prototype.createUris=U.prototype.gc;U.prototype.oc=function(){return this.b};U.prototype.getStartByte=U.prototype.oc;U.prototype.mc=function(){return this.a};U.prototype.getEndByte=U.prototype.mc;function Ue(b,c,d,e){var f,g=(new S).na("sidx",function(b){f=Ve(c,e,d,b)});b&&g.parse(b);if(f)return f;A('Invalid box type, expected "sidx".');throw new I(2,3,3004);}
function Ve(b,c,d,e){var f=[];e.reader.H(4);var g=e.reader.B();if(0==g)throw A("Invalid timescale."),new I(2,3,3005);if(0==e.version){var h=e.reader.B();var k=e.reader.B()}else h=e.reader.xb(),k=e.reader.xb();e.reader.H(2);var l=e.reader.kd();b=b+e.size+k;for(k=0;k<l;k++){var m=e.reader.B(),n=(m&2147483648)>>>31;m&=2147483647;var q=e.reader.B();e.reader.H(4);if(1==n)throw A("Heirarchical SIDXs are not supported."),new I(2,3,3006);f.push(new U(f.length,h/g-c,(h+q)/g-c,function(){return d},b,b+m-1));
h+=q;b+=m}e.parser.stop();return f};function V(b){this.a=b}z("shaka.media.SegmentIndex",V);V.prototype.destroy=function(){this.a=null;return Promise.resolve()};V.prototype.destroy=V.prototype.destroy;V.prototype.find=function(b){for(var c=this.a.length-1;0<=c;--c){var d=this.a[c];if(b>=d.startTime&&b<d.endTime)return d.position}return this.a.length&&b<this.a[0].startTime?this.a[0].position:null};V.prototype.find=V.prototype.find;
V.prototype.get=function(b){if(0==this.a.length)return null;b-=this.a[0].position;return 0>b||b>=this.a.length?null:this.a[b]};V.prototype.get=V.prototype.get;V.prototype.offset=function(b){for(var c=0;c<this.a.length;++c)this.a[c].startTime+=b,this.a[c].endTime+=b};V.prototype.offset=V.prototype.offset;
V.prototype.tc=function(b){for(var c=[],d=0,e=0;d<this.a.length&&e<b.length;){var f=this.a[d],g=b[e];f.startTime<g.startTime?(c.push(f),d++):(f.startTime>g.startTime?0==d?c.push(g):B("Refusing to rewrite original references on update!"):(.1<Math.abs(f.endTime-g.endTime)?c.push(new U(f.position,g.startTime,g.endTime,g.c,g.b,g.a)):c.push(f),d++),e++)}for(;d<this.a.length;)c.push(this.a[d++]);if(c.length)for(d=c[c.length-1].position+1;e<b.length;)f=b[e++],f=new U(d++,f.startTime,f.endTime,f.c,f.b,f.a),
c.push(f);else c=b;this.a=c};V.prototype.merge=V.prototype.tc;V.prototype.ic=function(b){for(var c=0;c<this.a.length;++c)if(this.a[c].endTime>b){this.a.splice(0,c);return}this.a=[]};V.prototype.evict=V.prototype.ic;function We(b,c){for(;b.a.length;)if(b.a[b.a.length-1].startTime>=c)b.a.pop();else break;for(;b.a.length;)if(0>=b.a[0].endTime)b.a.shift();else break;if(0!=b.a.length){var d=b.a[b.a.length-1];b.a[b.a.length-1]=new U(d.position,d.startTime,c,d.c,d.b,d.a)}};function Xe(b){this.b=b;this.a=new R(b,0);Ye||(Ye=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var Ye;Xe.prototype.oa=function(){return this.a.oa()};
function Ze(b){var c=$e(b);if(7<c.length)throw new I(2,3,3002);for(var d=0,e=0;e<c.length;e++)d=256*d+c[e];c=d;d=$e(b);a:{for(e=0;e<Ye.length;e++)if(uc(d,Ye[e])){e=!0;break a}e=!1}if(e)d=b.b.byteLength-b.a.U();else{if(8==d.length&&d[1]&224)throw new I(2,3,3001);e=d[0]&(1<<8-d.length)-1;for(var f=1;f<d.length;f++)e=256*e+d[f];d=e}d=b.a.U()+d<=b.b.byteLength?d:b.b.byteLength-b.a.U();e=new DataView(b.b.buffer,b.b.byteOffset+b.a.U(),d);b.a.H(d);return new af(c,e)}
function $e(b){var c=b.a.Ac(),d;for(d=1;8>=d&&!(c&1<<8-d);d++);if(8<d)throw new I(2,3,3002);var e=new Uint8Array(d);e[0]=c;for(c=1;c<d;c++)e[c]=b.a.Ac();return e}function af(b,c){this.id=b;this.a=c}function bf(b){if(8<b.a.byteLength)throw new I(2,3,3002);if(8==b.a.byteLength&&b.a.getUint8(0)&224)throw new I(2,3,3001);for(var c=0,d=0;d<b.a.byteLength;d++){var e=b.a.getUint8(d);c=256*c+e}return c};function cf(){}
cf.prototype.parse=function(b,c,d,e){var f;c=new Xe(new DataView(c));if(440786851!=Ze(c).id)throw A("Not an EBML element."),new I(2,3,3008);var g=Ze(c);if(408125543!=g.id)throw A("Not a Segment element."),new I(2,3,3009);c=g.a.byteOffset;g=new Xe(g.a);for(f=null;g.oa();){var h=Ze(g);if(357149030==h.id){f=h;break}}if(!f)throw A("Not an Info element."),new I(2,3,3010);g=new Xe(f.a);f=1E6;for(h=null;g.oa();){var k=Ze(g);if(2807729==k.id)f=bf(k);else if(17545==k.id)if(h=k,4==h.a.byteLength)h=h.a.getFloat32(0);
else if(8==h.a.byteLength)h=h.a.getFloat64(0);else throw new I(2,3,3003);}if(null==h)throw new I(2,3,3011);g=f/1E9;f=h*g;b=Ze(new Xe(new DataView(b)));if(475249515!=b.id)throw A("Not a Cues element."),new I(2,3,3007);return df(b,c,g,f,d,e)};
function df(b,c,d,e,f,g){function h(){return f}var k=[];b=new Xe(b.a);for(var l=null,m=null;b.oa();){var n=Ze(b);if(187==n.id){var q=ef(n);q&&(n=d*q.bf,q=c+q.Ee,null!=l&&k.push(new U(k.length,l-g,n-g,h,m,q-1)),l=n,m=q)}}null!=l&&k.push(new U(k.length,l-g,e-g,h,m,null));return k}
function ef(b){var c=new Xe(b.a);b=Ze(c);if(179!=b.id)throw B("Not a CueTime element."),new I(2,3,3013);b=bf(b);c=Ze(c);if(183!=c.id)throw B("Not a CueTrackPositions element."),new I(2,3,3012);c=new Xe(c.a);for(var d=0;c.oa();){var e=Ze(c);if(241==e.id){d=bf(e);break}}return{bf:b,Ee:d}};function ff(b,c){var d=Qe(b,c,"Initialization");if(!d)return null;var e=id(b.J.za,b.u.J),f=d.getAttribute("sourceURL");f&&(e=id(e,[f]));f=0;var g=null;if(d=T.F(d,"range",T.Yb))f=d.start,g=d.end;return new Te(function(){return e},f,g)}
function gf(b,c){var d=Number(Pe(b,hf,"presentationTimeOffset"))||0,e=Pe(b,hf,"timescale"),f=1;e&&(f=T.Xb(e)||1);d=d/f||0;e=ff(b,hf);var g=b.u.contentType;f=b.u.mimeType.split("/")[1];if("text"!=g&&"mp4"!=f&&"webm"!=f)throw A("SegmentBase specifies an unsupported container type.",b.u),new I(2,4,4006);if("webm"==f&&!e)throw A("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",b.u),new I(2,4,4005);
g=Qe(b,hf,"RepresentationIndex");var h=Pe(b,hf,"indexRange"),k=id(b.J.za,b.u.J);h=T.Yb(h||"");if(g){var l=g.getAttribute("sourceURL");l&&(k=id(k,[l]));h=T.F(g,"range",T.Yb,h)}if(!h)throw A("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",b.u),new I(2,4,4002);f=jf(b,c,e,k,h.start,h.end,f,d);return{createSegmentIndex:f.createSegmentIndex,findSegmentPosition:f.findSegmentPosition,getSegmentReference:f.getSegmentReference,
initSegmentReference:e,ga:d}}function jf(b,c,d,e,f,g,h,k){var l=b.presentationTimeline,m=!b.eb||!b.M.qc,n=b.M.start,q=b.M.duration,v=c,x=null;return{createSegmentIndex:function(){var b=[v(e,f,g),"webm"==h?v(d.c(),d.b,d.a):null];v=null;return Promise.all(b).then(function(b){var c=b[0];b=b[1]||null;c="mp4"==h?Ue(c,f,e,k):(new cf).parse(c,b,e,k);l.Tb(c,n);x=new V(c);m&&We(x,q)})},findSegmentPosition:function(b){return x.find(b)},getSegmentReference:function(b){return x.get(b)}}}
function hf(b){return b.zb};function kf(b,c){var d=ff(b,lf);var e=mf(b);var f=Oe(b,lf),g=f.Sa;0==g&&(B("SegmentList@startNumber must be > 0"),g=1);var h=0;f.S?h=f.S*(g-1):f.G&&0<f.G.length&&(h=f.G[0].start);e={S:f.S,startTime:h,Sa:g,ga:f.ga,G:f.G,Oa:e};if(!e.S&&!e.G&&1<e.Oa.length)throw B("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",b.u),new I(2,4,4002);if(!e.S&&!b.M.duration&&!e.G&&1==e.Oa.length)throw B("SegmentList does not contain sufficient segment information:",
"the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",b.u),new I(2,4,4002);if(e.G&&0==e.G.length)throw B("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",b.u),new I(2,4,4002);g=f=null;b.fa.id&&b.u.id&&(g=b.fa.id+","+b.u.id,f=c[g]);h=nf(b.M.duration,e.Sa,b.u.J,e);f?(f.tc(h),f.ic(b.presentationTimeline.Mb()-b.M.start)):(b.presentationTimeline.Tb(h,b.M.start),f=new V(h),g&&b.eb&&(c[g]=
f));b.eb&&b.M.qc||We(f,b.M.duration);return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:f.find.bind(f),getSegmentReference:f.get.bind(f),initSegmentReference:d,ga:e.ga}}function lf(b){return b.Ea}
function nf(b,c,d,e){var f=e.Oa.length;e.G&&e.G.length!=e.Oa.length&&(f=Math.min(e.G.length,e.Oa.length),B("The number of items in the segment timeline and the number of segment","URLs do not match, truncating",e.Oa.length,"to",f));for(var g=[],h=e.startTime,k=0;k<f;k++){var l=e.Oa[k],m=id(d,[l.he]),n=void 0;n=null!=e.S?h+e.S:e.G?e.G[k].end:h+b;g.push(new U(k+c,h,n,function(b){return b}.bind(null,m),l.start,l.end));h=n}return g}
function mf(b){return[b.u.Ea,b.X.Ea,b.fa.Ea].filter(hd.Ba).map(function(b){return T.L(b,"SegmentURL")}).reduce(function(b,d){return 0<b.length?b:d}).map(function(c){c.getAttribute("indexRange")&&!b.Yc&&(b.Yc=!0,B("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate."));var d=c.getAttribute("media");c=T.F(c,"mediaRange",T.Yb,{start:0,end:null});return{he:d,start:c.start,end:c.end}})};function of(b,c,d,e){var f=pf(b);var g=Oe(b,qf);var h=Pe(b,qf,"media"),k=Pe(b,qf,"index");g={S:g.S,timescale:g.timescale,Sa:g.Sa,ga:g.ga,Kc:g.Kc,G:g.G,sc:h,ub:k};h=g.ub?1:0;h+=g.G?1:0;h+=g.S?1:0;if(0==h)throw A("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",b.u),new I(2,4,4002);1!=h&&(B("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,",
"a SegmentTimeline or a segment duration.",b.u),g.ub?(C("Using the index URL template by default."),g.G=null):C("Using the SegmentTimeline by default."),g.S=null);if(!g.ub&&!g.sc)throw A("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",b.u),new I(2,4,4002);if(g.ub){d=b.u.mimeType.split("/")[1];if("mp4"!=d&&"webm"!=d)throw A("SegmentTemplate specifies an unsupported container type.",b.u),new I(2,4,4006);if("webm"==d&&!f)throw A("SegmentTemplate does not contain sufficient segment information:",
"the SegmentTemplate uses a WebM container,","but does not contain an initialization URL template.",b.u),new I(2,4,4005);e=Ne(g.ub,b.u.id,null,b.bandwidth||null,null);h=id(b.J.za,b.u.J);e=id(h,[e]);b=jf(b,c,f,e,0,null,d,g.ga)}else g.S?(e||(b.presentationTimeline.uc(g.S),b.presentationTimeline.vc(b.M.start)),b=rf(b,g)):(e=c=null,b.fa.id&&b.u.id&&(e=b.fa.id+","+b.u.id,c=d[e]),h=sf(b,g),k=!b.eb||!b.M.qc,c?(k&&We(new V(h),b.M.duration),c.tc(h),c.ic(b.presentationTimeline.Mb()-b.M.start)):(b.presentationTimeline.Tb(h,
b.M.start),c=new V(h),e&&b.eb&&(d[e]=c)),k&&We(c,b.M.duration),b={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:c.find.bind(c),getSegmentReference:c.get.bind(c)});return{createSegmentIndex:b.createSegmentIndex,findSegmentPosition:b.findSegmentPosition,getSegmentReference:b.getSegmentReference,initSegmentReference:f,ga:g.ga}}function qf(b){return b.Ab}
function rf(b,c){var d=b.M.duration,e=c.S,f=c.Sa,g=c.timescale,h=c.sc,k=b.bandwidth||null,l=b.u.id,m=b.u;return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(b){return 0>b||d&&b>=d?null:Math.floor(b/e)},getSegmentReference:function(c){var q=c*e,n=q+e;d&&(n=Math.min(n,d));return 0>n||d&&q>=d?null:new U(c,q,n,function(){var d=id(b.J.za,m.J),e=Ne(h,l,c+f,k,q*g);return id(d,[e])},0,null)}}}
function sf(b,c){for(var d=[],e=0;e<c.G.length;e++){var f=e+c.Sa;d.push(new U(f,c.G[e].start,c.G[e].end,function(b,c,d,e,f,n,q){e=id(e.za,f);b=Ne(b,c,n,d,q);return id(e,[b]).map(function(b){return b.toString()})}.bind(null,c.sc,b.u.id,b.bandwidth||null,b.J,b.u.J,f,c.G[e].af+c.Kc),0,null))}return d}function pf(b){var c=Pe(b,qf,"initialization");if(!c)return null;var d=b.u.id,e=b.bandwidth||null,f=b.u;return new Te(function(){var g=Ne(c,d,null,e,null),h=id(b.J.za,f.J);return id(h,[g])},0,null)};var W={nb:{},wb:{},ld:function(b,c){W.wb[b]=c}};z("shaka.media.ManifestParser.registerParserByExtension",W.ld);W.md=function(b,c){W.nb[b]=c};z("shaka.media.ManifestParser.registerParserByMime",W.md);
W.Be=function(){var b={};if(fc()){for(var c in W.nb)b[c]=!0;for(var d in W.wb)b[d]=!0}c={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};d=r(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"]);for(var e=d.next();!e.done;e=d.next())e=e.value,b[e]=fc()?!!W.nb[e]:gc(e);for(var f in c)b[f]=fc()?!!W.wb[f]:gc(c[f]);return b};
W.create=function(b,c,d,e){return t(function g(){var h,k;return y(g,function(g){switch(g.m){case 1:return g.T=2,u(g,W.Pd(b,c,d,e),4);case 4:return h=g.O,g["return"](new h);case 2:throw k=ya(g),k.severity=2,k;}})})};
W.Pd=function(b,c,d,e){return t(function g(){var h,k,l,m,n;return y(g,function(g){switch(g.m){case 1:h=W;if(e){if(k=h.nb[e.toLowerCase()])return g["return"](k);B("Could not determine manifest type using MIME type ",e)}if(l=h.getExtension(b)){if(m=h.wb[l])return g["return"](m);B("Could not determine manifest type for extension ",l)}else B("Could not find extension for ",b);if(e){g.m=2;break}return u(g,h.Wd(b,c,d),3);case 3:if(e=g.O){if(n=W.nb[e])return g["return"](n);B("Could not determine manifest type using MIME type",
e)}case 2:throw new I(2,4,4E3,b);}})})};W.Wd=function(b,c,d){return t(function f(){var g,h,k;return y(f,function(f){switch(f.m){case 1:return g=Eb([b],d),g.method="HEAD",u(f,c.request(0,g).promise,2);case 2:return h=f.O,k=h.headers["content-type"],f["return"](k?k.toLowerCase():"")}})})};W.getExtension=function(b){b=(new Ta(b)).la.split("/").pop().split(".");return 1==b.length?"":b.pop().toLowerCase()};W.isSupported=function(b,c){return fc()?c in W.nb||W.getExtension(b)in W.wb?!0:!1:!1};function Y(b,c,d){this.f=b;this.l=c;this.h=this.g=Infinity;this.a=1;this.b=this.c=null;this.j=0;this.s=!0;this.i=0;this.v=void 0===d?!0:d}z("shaka.media.PresentationTimeline",Y);Y.prototype.Z=function(){return this.g};Y.prototype.getDuration=Y.prototype.Z;Y.prototype.Ra=function(b){this.g=b};Y.prototype.setDuration=Y.prototype.Ra;Y.prototype.ae=function(){return this.f};Y.prototype.getPresentationStartTime=Y.prototype.ae;Y.prototype.qd=function(b){this.j=b};Y.prototype.setClockOffset=Y.prototype.qd;
Y.prototype.sd=function(b){this.s=b};Y.prototype.setStatic=Y.prototype.sd;Y.prototype.rd=function(b){this.h=b};Y.prototype.setSegmentAvailabilityDuration=Y.prototype.rd;Y.prototype.Qe=function(b){this.l=b};Y.prototype.setDelay=Y.prototype.Qe;Y.prototype.Nd=function(){return this.l};Y.prototype.getDelay=Y.prototype.Nd;
Y.prototype.Tb=function(b,c){if(0!=b.length){var d=b[b.length-1].endTime+c;this.vc(b[0].startTime+c);this.a=b.reduce(function(b,c){return Math.max(b,c.endTime-c.startTime)},this.a);this.b=Math.max(this.b,d);null!=this.f&&this.v&&(this.f=(Date.now()+this.j)/1E3-this.b-this.a);F("notifySegments:","maxSegmentDuration="+this.a)}};Y.prototype.notifySegments=Y.prototype.Tb;Y.prototype.vc=function(b){this.c=null==this.c?b:Math.min(this.c,b)};Y.prototype.notifyMinSegmentStartTime=Y.prototype.vc;
Y.prototype.uc=function(b){this.a=Math.max(this.a,b);F("notifyNewSegmentDuration:","maxSegmentDuration="+this.a)};Y.prototype.notifyMaxSegmentDuration=Y.prototype.uc;Y.prototype.offset=function(b){null!=this.c&&(this.c+=b);null!=this.b&&(this.b+=b)};Y.prototype.offset=Y.prototype.offset;Y.prototype.$=function(){return Infinity==this.g&&!this.s};Y.prototype.isLive=Y.prototype.$;Y.prototype.ib=function(){return Infinity!=this.g&&!this.s};Y.prototype.isInProgress=Y.prototype.ib;
Y.prototype.Mb=function(){return Infinity==this.h?this.i:Math.max(this.i,this.gb()-this.h)};Y.prototype.getSegmentAvailabilityStart=Y.prototype.Mb;Y.prototype.td=function(b){this.i=b};Y.prototype.setUserSeekStart=Y.prototype.td;Y.prototype.gb=function(){return this.$()||this.ib()?Math.min(Math.max(0,(Date.now()+this.j)/1E3-this.a-this.f),this.g):this.g};Y.prototype.getSegmentAvailabilityEnd=Y.prototype.gb;
Y.prototype.sb=function(b){var c=Math.max(this.c,this.i);return Infinity==this.h?c:Math.max(c,Math.min(this.gb()-this.h+b,this.sa()))};Y.prototype.getSafeSeekRangeStart=Y.prototype.sb;Y.prototype.fb=function(){return this.sb(0)};Y.prototype.getSeekRangeStart=Y.prototype.fb;Y.prototype.sa=function(){return Math.max(0,this.gb()-(this.$()||this.ib()?this.l:0))};Y.prototype.getSeekRangeEnd=Y.prototype.sa;Y.prototype.wd=function(){return null==this.f||null!=this.b?!1:!0};
Y.prototype.usingPresentationStartTime=Y.prototype.wd;function tf(b,c,d,e){b=Eb(b,e);if(0!=c||null!=d)b.headers.Range=d?"bytes="+c+"-"+d:"bytes="+c+"-";return b};function uf(){var b=this;this.a=this.b=null;this.f=[];this.c=null;this.j=[];this.h=1;this.l={};this.s=0;this.v=new La(5);this.i=new H(function(){vf(b)});this.g=new Ab}z("shaka.dash.DashParser",uf);p=uf.prototype;p.configure=function(b){this.b=b};p.start=function(b,c){var d=this;return t(function f(){var g;return y(f,function(f){switch(f.m){case 1:return d.f=[b],d.a=c,u(f,wf(d),2);case 2:g=f.O;d.a&&xf(d,g);if(!d.a)throw new I(2,7,7001);return f["return"](d.c)}})})};
p.stop=function(){this.b=this.a=null;this.f=[];this.c=null;this.j=[];this.l={};null!=this.i&&(this.i.stop(),this.i=null);return this.g.destroy()};p.update=function(){wf(this)["catch"](function(b){if(this.a)this.a.onError(b)}.bind(this))};p.onExpirationUpdated=function(){};
function wf(b){var c=Date.now(),d=b.a.networkingEngine.request(0,Eb(b.f,b.b.retryParameters));Bb(b.g,d);return d.promise.then(function(c){if(b.a)return c.uri&&!b.f.includes(c.uri)&&b.f.unshift(c.uri),yf(b,c.data,c.uri)}).then(function(){var d=(Date.now()-c)/1E3;Ma(b.v,1,d);return d})}function zf(b){this.za=b}
function yf(b,c,d){c=T.gd(c,"MPD");if(!c)throw new I(2,4,4001,d);c=Se(c,b.b.retryParameters,b.b.dash.xlinkFailGracefully,d,b.a.networkingEngine);Bb(b.g,c);return c.promise.then(function(c){return Af(b,c,d)})}
function Af(b,c,d){return t(function f(){var g,h,k,l,m,n,q,v,x,E,K,N,X,ja,Va,Ob,Gc,sa,kg,lg,bb,mg,ng,og,fj,pg,qg;return y(f,function(f){switch(f.m){case 1:l=hd;m=T;n=[d];q=m.L(c,"Location").map(m.Kb).filter(l.Ba);0<q.length&&(v=id(n,q),n=b.f=v);x=m.L(c,"BaseURL").map(m.Kb);E=id(n,x);K=b.b.dash.ignoreMinBufferTime;N=0;K||(N=m.F(c,"minBufferTime",m.ua));b.s=m.F(c,"minimumUpdatePeriod",m.ua,-1);X=m.F(c,"availabilityStartTime",m.xe);ja=m.F(c,"timeShiftBufferDepth",m.ua);Va=m.F(c,"suggestedPresentationDelay",
m.ua);Ob=m.F(c,"maxSegmentDuration",m.ua);Gc=c.getAttribute("type")||"static";b.c?sa=b.c.presentationTimeline:(kg=Math.max(b.b.dash.defaultPresentationDelay,1.5*N),lg=null!=Va?Va:kg,sa=new Y(X,lg,b.b.dash.autoCorrectDrift));b.c&&b.c.J?(bb=b.c.J,bb.za=E):bb=new zf(E);mg={eb:"static"!=Gc,presentationTimeline:sa,fa:null,M:null,X:null,u:null,bandwidth:0,Yc:!1,J:bb};for(var rg=mg,gj=[""],Pb=T.F(c,"mediaPresentationDuration",T.ua),Qb=[],Na=0,nb=T.L(c,"Period"),Aa=0;Aa<nb.length;Aa++){var Wa=nb[Aa];Na=T.F(Wa,
"start",T.ua,Na);var ob=T.F(Wa,"duration",T.ua),Ba=null;if(Aa!=nb.length-1){var Hc=T.F(nb[Aa+1],"start",T.ua);null!=Hc&&(Ba=Hc-Na)}else null!=Pb&&(Ba=Pb-Na);Hc=ld;Ba&&ob&&Math.abs(Ba-ob)>Hc&&B("There is a gap/overlap between Periods",Wa);null==Ba&&(Ba=ob);Wa=Bf(b,rg,gj,{start:Na,duration:Ba,node:Wa,qc:null==Ba||Aa==nb.length-1});Qb.push(Wa);ob=rg.fa.id;b.j.includes(ob)||(b.j.push(ob),b.c&&(b.a.filterNewPeriod(Wa),b.c.periods.push(Wa)));if(null==Ba){Aa!=nb.length-1&&B("Skipping Period",Aa+1,"and any subsequent Periods:",
"Period",Aa+1,"does not have a valid start time.",Qb[Aa+1]);Na=null;break}Na+=Ba}null==b.c&&b.a.filterAllPeriods(Qb);null!=Pb?(Na!=Pb&&B("@mediaPresentationDuration does not match the total duration of all","Periods."),g=Qb,h=Pb,k=!1):(g=Qb,h=Na,k=!0);ng=h;og=g;sa.sd("static"==Gc);"static"!=Gc&&k||sa.Ra(ng||Infinity);(fj=sa.$())&&!isNaN(b.b.availabilityWindowOverride)&&(ja=b.b.availabilityWindowOverride);null==ja&&(ja=Infinity);sa.rd(ja);sa.uc(Ob||1);if(b.c){f.m=0;break}b.c={J:bb,presentationTimeline:sa,
periods:og,offlineSessionIds:[],minBufferTime:N||0};if(!sa.wd()){f.m=0;break}pg=m.L(c,"UTCTiming");return u(f,Cf(b,E,pg),4);case 4:qg=f.O;if(!b.a)return f["return"]();sa.qd(qg);w(f)}})})}
function Bf(b,c,d,e){c.fa=Df(e.node,null,d);c.M=e;c.fa.id||(C("No Period ID given for Period with start time "+e.start+",  Assigning a default"),c.fa.id="__shaka_period_"+e.start);T.L(e.node,"EventStream").forEach(b.ye.bind(b,e.start,e.duration));d=T.L(e.node,"AdaptationSet").map(b.we.bind(b,c)).filter(hd.Ba);if(c.eb){c=[];for(var f=r(d),g=f.next();!g.done;g=f.next()){g=r(g.value.Fe);for(var h=g.next();!h.done;h=g.next())c.push(h.value)}if(c.length!=(new Set(c)).size)throw new I(2,4,4018);}var k=
d.filter(function(b){return!b.Jc});d.filter(function(b){return b.Jc}).forEach(function(b){var c=b.streams[0],d=b.Jc;k.forEach(function(b){b.id==d&&b.streams.forEach(function(b){b.trickModeVideo=c})})});c=Ef(k,"video");f=Ef(k,"audio");if(!c.length&&!f.length)throw new I(2,4,4004);f.length||(f=[null]);c.length||(c=[null]);d=[];for(g=0;g<f.length;g++)for(h=0;h<c.length;h++)Ff(b,f[g],c[h],d);b=Ef(k,"text");c=[];for(f=0;f<b.length;f++)c.push.apply(c,b[f].streams);return{startTime:e.start,textStreams:c,
variants:d}}function Ef(b,c){return b.filter(function(b){return b.contentType==c})}
function Ff(b,c,d,e){if(c||d)if(c&&d){var f=c.drmInfos;var g=d.drmInfos;if(f.length&&g.length?0<$c(f,g).length:1){g=$c(c.drmInfos,d.drmInfos);for(var h=0;h<c.streams.length;h++)for(var k=0;k<d.streams.length;k++)f=(d.streams[k].bandwidth||0)+(c.streams[h].bandwidth||0),f={id:b.h++,language:c.language,primary:c.rc||d.rc,audio:c.streams[h],video:d.streams[k],bandwidth:f,drmInfos:g,allowedByApplication:!0,allowedByKeySystem:!0},e.push(f)}}else for(g=c||d,h=0;h<g.streams.length;h++)f=g.streams[h].bandwidth||
0,f={id:b.h++,language:g.language||"und",primary:g.rc,audio:c?g.streams[h]:null,video:d?g.streams[h]:null,bandwidth:f,drmInfos:g.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},e.push(f)}
p.we=function(b,c){b.X=Df(c,b.fa,null);var d=!1,e=T.L(c,"Role"),f=e.map(function(b){return b.getAttribute("value")}).filter(hd.Ba),g=void 0,h="text"==b.X.contentType;h&&(g="subtitle");for(var k=0;k<e.length;k++){var l=e[k].getAttribute("schemeIdUri");if(null==l||"urn:mpeg:dash:role:2011"==l)switch(l=e[k].getAttribute("value"),l){case "main":d=!0;break;case "caption":case "subtitle":g=l}}var m=null,n=!1;T.L(c,"EssentialProperty").forEach(function(b){"http://dashif.org/guidelines/trickmode"==b.getAttribute("schemeIdUri")?
m=b.getAttribute("value"):n=!0});k=T.L(c,"Accessibility");var q=new Map;e={};k=r(k);for(l=k.next();!l.done;e={rb:e.rb},l=k.next()){var v=l.value;l=v.getAttribute("schemeIdUri");v=v.getAttribute("value");"urn:scte:dash:cc:cea-608:2015"==l||"urn:scte:dash:cc:cea-708:2015"==l?(e.rb=1,null!=v?v.split(";").forEach(function(b){return function(c){if(c.includes("=")){c=c.split("=");var d=c[0].startsWith("CC")?c[0]:"CC"+c[0];c=c[1].split(",")[0].split(":").pop()}else d="CC"+b.rb,b.rb+=2;q.set(d,P(c))}}(e)):
q.set("CC1","und")):"urn:mpeg:dash:role:2011"==l&&null!=v&&(f.push(v),"captions"==v&&(g="caption"))}if(n)return null;e=T.L(c,"ContentProtection");var x=Fe(e,this.b.dash.customScheme,this.b.dash.ignoreDrmInfo);e=P(c.getAttribute("lang")||"und");l=c.getAttribute("label");k=T.L(c,"Representation");f=k.map(this.ze.bind(this,b,x,g,e,l,d,f,q)).filter(function(b){return!!b});if(0==f.length){if(h)return null;throw new I(2,4,4003);}b.X.contentType&&"application"!=b.X.contentType||(b.X.contentType=Gf(f[0].mimeType,
f[0].codecs),f.forEach(function(c){c.type=b.X.contentType}));f.forEach(function(b){x.drmInfos.forEach(function(c){b.keyId&&c.keyIds.push(b.keyId)})});h=k.map(function(b){return b.getAttribute("id")}).filter(hd.Ba);return{id:b.X.id||"__fake__"+this.h++,contentType:b.X.contentType,language:e,rc:d,streams:f,drmInfos:x.drmInfos,Jc:m,Fe:h}};
p.ze=function(b,c,d,e,f,g,h,k,l){b.u=Df(l,b.X,null);if(!Hf(b.u))return B("Skipping Representation",b.u),null;b.bandwidth=T.F(l,"bandwidth",T.Xb)||0;var m=b.u.contentType;m="text"==m||"application"==m;try{var n=this.Ge.bind(this);if(b.u.zb)var q=gf(b,n);else if(b.u.Ea)q=kf(b,this.l);else if(b.u.Ab)q=of(b,n,this.l,!!this.c);else{var v=id(b.J.za,b.u.J),x=b.M.duration||0;q={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(b){return 0<=b&&b<x?1:null},getSegmentReference:function(b){return 1!=
b?null:new U(1,0,x,function(){return v},0,null)},initSegmentReference:null,ga:0}}}catch(E){if(m&&4002==E.code)return null;throw E;}l=T.L(l,"ContentProtection");l=Ie(l,this.b.dash.customScheme,c,this.b.dash.ignoreDrmInfo);return{id:this.h++,originalId:b.u.id,createSegmentIndex:q.createSegmentIndex,findSegmentPosition:q.findSegmentPosition,getSegmentReference:q.getSegmentReference,initSegmentReference:q.initSegmentReference,presentationTimeOffset:q.ga,mimeType:b.u.mimeType,codecs:b.u.codecs,frameRate:b.u.frameRate,
bandwidth:b.bandwidth,width:b.u.width,height:b.u.height,kind:d,encrypted:0<c.drmInfos.length,keyId:l,language:e,label:f,type:b.X.contentType,primary:g,trickModeVideo:null,emsgSchemeIdUris:b.u.emsgSchemeIdUris,roles:h,channelsCount:b.u.wc,closedCaptions:k}};
function vf(b){t(function d(){var e,f;return y(d,function(d){switch(d.m){case 1:return C("Updating manifest..."),e=0,d.T=2,u(d,wf(b),4);case 4:e=d.O;xa(d,3);break;case 2:f=ya(d),b.a&&(f.severity=1,b.a.onError(f));case 3:if(!b.a)return d["return"]();xf(b,e);w(d)}})})}function xf(b,c){0>b.s||b.i.V(Math.max(3,b.s-c,Oa(b.v)))}
function Df(b,c,d){c=c||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,wc:null};d=d||c.J;var e=T.mb,f=T.Id,g=T.L(b,"BaseURL").map(T.Kb),h=b.getAttribute("contentType")||c.contentType,k=b.getAttribute("mimeType")||c.mimeType,l=b.getAttribute("codecs")||c.codecs;f=T.F(b,"frameRate",f)||c.frameRate;var m=T.L(b,"InbandEventStream"),n=c.emsgSchemeIdUris.slice();m=r(m);for(var q=m.next();!q.done;q=m.next())q=q.value.getAttribute("schemeIdUri"),n.includes(q)||n.push(q);m=T.L(b,
"AudioChannelConfiguration");m=If(m)||c.wc;h||(h=Gf(k,l));return{J:id(d,g),zb:T.Jb(b,"SegmentBase")||c.zb,Ea:T.Jb(b,"SegmentList")||c.Ea,Ab:T.Jb(b,"SegmentTemplate")||c.Ab,width:T.F(b,"width",e)||c.width,height:T.F(b,"height",e)||c.height,contentType:h,mimeType:k,codecs:l,frameRate:f,emsgSchemeIdUris:n,id:b.getAttribute("id"),wc:m}}
function If(b){for(var c=0;c<b.length;++c){var d=b[c],e=d.getAttribute("schemeIdUri");if(e&&(d=d.getAttribute("value")))switch(e){case "urn:mpeg:dash:outputChannelPositionList:2012":return d.trim().split(/ +/).length;case "urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case "urn:dts:dash:audio_channel_configuration:2012":var f=parseInt(d,10);if(!f){B("Channel parsing failure! Ignoring scheme and value",e,d);continue}return f;case "tag:dolby.com,2014:dash:audio_channel_configuration:2011":case "urn:dolby:dash:audio_channel_configuration:2011":f=
parseInt(d,16);if(!f){B("Channel parsing failure! Ignoring scheme and value",e,d);continue}for(b=0;f;)f&1&&++b,f>>=1;return b;default:B("Unrecognized audio channel scheme:",e,d)}}return null}
function Hf(b){var c=b.zb?1:0;c+=b.Ea?1:0;c+=b.Ab?1:0;if(0==c){if("text"==b.contentType||"application"==b.contentType)return!0;B("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',b);return!1}1!=c&&(B("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",
b),b.zb?(C("Using SegmentBase by default."),b.Ea=null):C("Using SegmentList by default."),b.Ab=null);return!0}
function Jf(b,c,d,e){c=id(c,[d]);c=Eb(c,b.b.retryParameters);c.method=e;c=b.a.networkingEngine.request(4,c);Bb(b.g,c);return c.promise.then(function(b){if("HEAD"==e){if(!b.headers||!b.headers.date)return B("UTC timing response is missing","expected date header"),0;b=b.headers.date}else b=lc(b.data);b=Date.parse(b);return isNaN(b)?(B("Unable to parse date from UTC timing response"),0):b-Date.now()})}
function Cf(b,c,d){d=d.map(function(b){return{scheme:b.getAttribute("schemeIdUri"),value:b.getAttribute("value")}});var e=b.b.dash.clockSyncUri;!d.length&&e&&d.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:e});return hd.Gd(d,function(b){var d=b.scheme;b=b.value;switch(d){case "urn:mpeg:dash:utc:http-head:2014":case "urn:mpeg:dash:utc:http-head:2012":return Jf(this,c,b,"HEAD");case "urn:mpeg:dash:utc:http-xsdate:2014":case "urn:mpeg:dash:utc:http-iso:2014":case "urn:mpeg:dash:utc:http-xsdate:2012":case "urn:mpeg:dash:utc:http-iso:2012":return Jf(this,
c,b,"GET");case "urn:mpeg:dash:utc:direct:2014":case "urn:mpeg:dash:utc:direct:2012":return d=Date.parse(b),isNaN(d)?0:d-Date.now();case "urn:mpeg:dash:utc:http-ntp:2014":case "urn:mpeg:dash:utc:ntp:2014":case "urn:mpeg:dash:utc:sntp:2014":return Ra("NTP UTCTiming scheme is not supported"),Promise.reject();default:return Ra("Unrecognized scheme in UTCTiming element",d),Promise.reject()}}.bind(b))["catch"](function(){Ra("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!");
return 0})}p.ye=function(b,c,d){var e=T.mb,f=d.getAttribute("schemeIdUri")||"",g=d.getAttribute("value")||"",h=T.F(d,"timescale",e)||1;T.L(d,"Event").forEach(function(d){var k=T.F(d,"presentationTime",e)||0,m=T.F(d,"duration",e)||0;k=k/h+b;m=k+m/h;null!=c&&(k=Math.min(k,b+c),m=Math.min(m,b+c));d={schemeIdUri:f,value:g,startTime:k,endTime:m,id:d.getAttribute("id")||"",eventElement:d};this.a.onTimelineRegionAdded(d)}.bind(this))};
p.Ge=function(b,c,d){b=tf(b,c,d,this.b.retryParameters);b=this.a.networkingEngine.request(1,b);Bb(this.g,b);return b.promise.then(function(b){return b.data})};function Gf(b,c){return Jd(bc(b,c))?"text":b.split("/")[0]}W.ld("mpd",uf);W.md("application/dash+xml",uf);function Kf(b,c){this.a=b;this.b=c}Kf.prototype.toString=function(){return"v"+this.a+"."+this.b};function Lf(b,c){var d=new Kf(2,6),e=Mf,f=e.a,g=d.b-f.b;(0<(d.a-f.a||g)?e.c:e.b)(e.a,d,b,c)}function Nf(b,c,d,e){Ra([d,"has been deprecated and will be removed in",c,". We are currently at version",b,". Additional information:",e].join(" "))}function Of(b,c,d,e){Qa([d,"has been deprecated and has been removed in",c,". We are now at version",b,". Additional information:",e].join(""))}var Mf=null;function Pf(){this.a=new Map}function Qf(b,c,d){Rf(b,c).text=d}function Rf(b,c){b.a.has(c)||b.a.set(c,new Sf);return b.a.get(c)}function Sf(){this.text=this.variant=null};function Tf(b,c){this.a=b;this.b=new Set([b]);c=c||[];for(var d=r(c),e=d.next();!e.done;e=d.next())this.add(e.value)}Tf.prototype.add=function(b){if(Uf(this.a,b))return this.b.add(b),!0;B("Rejecting variant - not compatible with root.");return!1};
function Uf(b,c){var d;if(!(d=!!b.audio!=!!c.audio||!!b.video!=!!c.video||b.language!=c.language)&&(d=b.audio&&c.audio)){d=b.audio;var e=c.audio;d=!(d.channelsCount==e.channelsCount&&Vf(d,e)&&Wf(d.roles,e.roles))}!d&&(d=b.video&&c.video)&&(d=b.video,e=c.video,d=!(Vf(d,e)&&Wf(d.roles,e.roles)));return d?!1:!0}Tf.prototype.values=function(){return this.b.values()};
function Vf(b,c){if(b.mimeType!=c.mimeType)return!1;var d=b.codecs.split(",").map(function(b){return ec(b)[0]}),e=c.codecs.split(",").map(function(b){return ec(b)[0]});if(d.length!=e.length)return!1;d.sort();e.sort();for(var f=0;f<d.length;f++)if(d[f]!=e[f])return!1;return!0}function Wf(b,c){var d=new Set(b),e=new Set(c);d["delete"]("main");e["delete"]("main");if(d.size!=e.size)return!1;d=r(d);for(var f=d.next();!f.done;f=d.next())if(!e.has(f.value))return!1;return!0};function Xf(b){this.a=b;this.b=new Yf(b.language,"",b.audio&&b.audio.channelsCount?b.audio.channelsCount:0)}Xf.prototype.create=function(b){var c=this,d=b.filter(function(b){return Uf(c.a,b)});return d.length?new Tf(d[0],d):this.b.create(b)};function Yf(b,c,d){this.c=b;this.b=c;this.a=d}
Yf.prototype.create=function(b){var c=[];c=Zf(b,this.c);var d=b.filter(function(b){return b.primary});c=c.length?c:d.length?d:b;this.b&&(b=$f(c,this.b),b.length?c=b:B("No exact match for variant role could be found."));this.a&&(b=qe(c,this.a),b.length?c=b:B("No exact match for the channel count could be found."));b=new Tf(c[0]);c=r(c);for(d=c.next();!d.done;d=c.next())d=d.value,Uf(b.a,d)&&b.add(d);return b};
function Zf(b,c){var d=P(c),e=ee(d,b.map(function(b){return de(b)}));return e?b.filter(function(b){return e==de(b)}):[]}function $f(b,c){return b.filter(function(b){var d=b.audio;b=b.video;return d&&0<=d.roles.indexOf(c)||b&&0<=b.roles.indexOf(c)})};function ag(b,c){this.a=bg;this.b=(new Map).set(bg,c).set(cg,b)}var cg=0,bg=1;function dg(b,c){this.f=b;this.g=eg(b);this.b=b.a.currentTime;this.c=Date.now()/1E3;this.h=c;this.a=function(){}}dg.prototype.release=function(){this.f=null;this.a=function(){}};function fg(b,c){b.a=c}function gg(b){this.a=b}function eg(b){if(b.a.paused||0==b.a.playbackRate||null==b.a.buffered)var c=!1;else a:{c=b.a.buffered;b=b.a.currentTime;for(var d=0;d<c.length;d++){var e=c.start(d),f=c.end(d);if(!(b<e||b>f-.5)){c=!0;break a}}c=!1}return c};function hg(b,c,d,e,f){var g=this;this.a=b;this.v=c;this.s=d;this.j=f;this.f=new O;this.i=!1;this.l=b.readyState;this.c=!1;this.b=e;this.h=!1;this.f.w(b,"waiting",function(){return ig(g)});this.g=(new H(function(){ig(g)})).Ga(.25)}hg.prototype.release=function(){this.f&&(this.f.release(),this.f=null);null!=this.g&&(this.g.stop(),this.g=null);this.b&&(this.b.release(),this.b=null);this.a=this.v=this.j=null};hg.prototype.yc=function(){this.h=!0;ig(this)};
function ig(b){if(0!=b.a.readyState){if(b.a.seeking){if(!b.i)return}else b.i=!1;if(!b.a.paused){b.a.readyState!=b.l&&(b.c=!1,b.l=b.a.readyState);var c=b.s.smallGapLimit,d=b.a.currentTime,e=b.a.buffered;a:{if(e&&e.length&&!(1==e.length&&1E-6>e.end(0)-e.start(0))){var f=ic("Edge/")||ic("Trident/")||ic("Tizen")||ic("CrKey")?.5:.1;for(var g=0;g<e.length;g++)if(e.start(g)>d&&(0==g||e.end(g-1)-d<=f)){f=g;break a}}f=null}if(null==f){if(b.b){b=b.b;e=b.f;d=eg(e);e=e.a.currentTime;f=Date.now()/1E3;if(b.b!=
e||b.g!=d)b.c=f,b.b=e,b.g=d;e=f-b.c;e>=b.h&&d&&b.a(b.b,e)}}else if(0!=f||b.h)if(g=e.start(f),!(g>=b.v.sa())){var h=g-d;c=h<=c;var k=!1;if(!(.001>h)){if(!c&&!b.c){b.c=!0;var l=new L("largegap",{currentTime:d,gapSize:h});l.cancelable=!0;b.j(l);b.s.jumpLargeGaps&&!l.defaultPrevented?k=!0:C("Ignoring large gap at",d,"size",h)}if(c||k)0==f?C("Jumping forward",h,"seconds because of gap before start time of",g):C("Jumping forward",h,"seconds because of gap starting at",e.end(f-1),"and ending at",g),b.a.currentTime=
g}}}}};function jg(b){var c=this;this.c=b;this.a=new Set;this.b=(new H(function(){sg(c,!1)})).Ga(.25)}jg.prototype.release=function(){this.b.stop();for(var b=r(this.a),c=b.next();!c.done;c=b.next())c.value.release();this.a.clear()};function sg(b,c){for(var d=r(b.a),e=d.next();!e.done;e=d.next())e.value.g(b.c.currentTime,c)};function tg(b){var c=[];b=r(b);for(var d=b.next();!d.done;d=b.next()){d=r(d.value.variants);for(var e=d.next();!e.done;e=d.next())c.push(e.value)}return c}function ug(b,c){for(var d=null,e=r(b),f=e.next();!f.done;f=e.next())f=f.value,c>=f.startTime&&(d=f);return d};function vg(b){this.c=b;this.a=null;this.b=function(){}}vg.prototype.release=function(){this.a=this.c=null;this.b=function(){}};vg.prototype.g=function(b){var c=this.a,d=this.c.periods;b=ug(d,b)||d[0];c!=b&&this.b(b);this.a=b};function wg(b,c){b.b=c};function xg(b){var c=this;this.a=b;this.f=!1;this.c=this.a.Lb();this.b=new H(function(){c.a.$c(.25*c.c)})}xg.prototype.release=function(){this.b&&(this.b.stop(),this.b=null);this.a=null};xg.prototype.set=function(b){this.c=b;yg(this)};function yg(b){b.b.stop();var c=b.f?0:b.c;if(0<=c)try{b.a.Lb()!=c&&b.a.Fc(c);return}catch(d){}b.b.Ga(.25);0!=b.a.Lb()&&b.a.Fc(0)};function zg(b,c,d){this.a=b;this.f=c;this.g=d;this.h=!1;this.b=new O;this.c=new Ag(b);0<b.readyState?Bg(this,d):Cg(this,d)}zg.prototype.release=function(){this.b&&(this.b.release(),this.b=null);null!=this.c&&(this.c.release(),this.c=null);this.f=function(){};this.a=null};function Dg(b){return b.h?b.a.currentTime:b.g}function Cg(b,c){b.g=c;b.b.aa(b.a,"loadedmetadata");b.b.ea(b.a,"loadedmetadata",function(){Bg(b,c)})}
function Bg(b,c){.001>Math.abs(b.a.currentTime-c)?Eg(b):(b.b.ea(b.a,"seeking",function(){Eg(b)}),Fg(b.c,0==b.a.currentTime?c:b.a.currentTime))}function Eg(b){b.h=!0;b.b.w(b.a,"seeking",function(){return b.f()})}function Ag(b){var c=this;this.b=b;this.h=10;this.g=this.c=this.f=0;this.a=new H(function(){0>=c.f?(B(["Failed to move playhead from",c.c,"to",c.g].join(" ")),c.a.stop()):c.b.currentTime!=c.c?c.a.stop():(c.b.currentTime=c.g,c.f--)})}
Ag.prototype.release=function(){this.a&&(this.a.stop(),this.a=null);this.b=null};function Fg(b,c){b.c=b.b.currentTime;b.g=c;b.f=b.h;b.b.currentTime=c;b.a.Ga(.1)};function Gg(b){function c(){null==d.c?d.f=!0:(d.b.ea(d.a,"seeking",function(){d.f=!0}),d.a.currentTime=d.c)}var d=this;this.a=b;this.f=!1;this.c=null;this.b=new O;0==this.a.readyState?this.b.ea(this.a,"loadedmetadata",c):c()}Gg.prototype.release=function(){this.b&&(this.b.release(),this.b=null);this.a=null};Gg.prototype.l=function(b){this.c=this.f?this.c:b};Gg.prototype.h=function(){return(this.f?this.a.currentTime:this.c)||0};Gg.prototype.s=function(){};
function Hg(b,c,d,e,f,g){var h=this;this.b=b;this.a=c.presentationTimeline;this.C=c.minBufferTime||0;this.g=d;this.v=f;this.j=null;this.f=new hg(b,c.presentationTimeline,d,Ig(b,d),g);this.c=new zg(b,function(){a:{var b=h.f;b.i=!0;b.h=!1;b.c=!1;var c=Dg(h.c);b=Jg(h,c);if(.001<Math.abs(b-c)){var d=(new Date).getTime()/1E3;if(!h.j||h.j<d-1){h.j=d;c=h.c;0<c.a.readyState?Fg(c.c,b):Cg(c,b);b=void 0;break a}}F("Seek to "+c);h.v();b=void 0}return b},Kg(this,e));this.i=(new H(function(){if(0!=h.b.readyState&&
!h.b.paused){var b=h.b.currentTime,c=h.a.fb(),d=h.a.sa();3>d-c&&(c=d-3);b<c&&(c=Jg(h,b),C("Jumping forward "+(c-b)+" seconds to catch up with the seek range."),h.b.currentTime=c)}})).Ga(.25)}Hg.prototype.release=function(){this.c&&(this.c.release(),this.c=null);this.f&&(this.f.release(),this.f=null);this.i&&(this.i.stop(),this.i=null);this.b=this.c=this.a=this.g=null;this.v=function(){}};Hg.prototype.l=function(b){var c=this.c;0<c.a.readyState?Fg(c.c,b):Cg(c,b)};
Hg.prototype.h=function(){var b=Dg(this.c);return 0<this.b.readyState&&!this.b.paused?Lg(this,b):b};function Kg(b,c){null==c?c=Infinity>b.a.Z()?b.a.fb():b.a.sa():0>c&&(c=b.a.sa()+c);return Mg(b,Lg(b,c))}Hg.prototype.s=function(){this.f.yc()};function Mg(b,c){var d=b.a.Z();return c>=d?d-b.g.durationBackoff:c}
function Jg(b,c){var d=ed.bind(null,b.b.buffered),e=Math.max(b.C,b.g.rebufferingGoal),f=b.g.safeSeekOffset,g=b.a.fb(),h=b.a.sa(),k=b.a.Z();3>h-g&&(g=h-3);var l=b.a.sb(e),m=b.a.sb(f);e=b.a.sb(e+f);if(c>=k)return F("Playhead past duration."),Mg(b,c);if(c>h)return F("Playhead past end."),h;if(c<g){if(d(m))return F("Playhead before start & start is buffered"),m;F("Playhead before start & start is unbuffered");return e}if(c>=l||d(c))return F("Playhead in safe region or in buffered region."),c;F("Playhead outside safe region & in unbuffered region.");
return e}function Lg(b,c){var d=b.a.fb();if(c<d)return d;d=b.a.sa();return c>d?d:c}function Ig(b,c){if(!c.stallEnabled)return null;var d=c.stallSkip,e=new dg(new gg(b),c.stallThreshold);fg(e,function(c,e){D(["Stall detected at",c,"for",e,"seconds. Seeking forward",d,"seconds."].join(" "));b.currentTime+=d});return e};function Ng(){this.b=function(){};this.a=new Set}Ng.prototype.release=function(){this.b=function(){};this.a.clear()};function Og(b,c){b.b=c};function Pg(b){var c=this;this.h=b;this.f=new Map;this.a=function(){};this.b=function(){};this.c=function(){};this.i=[{Va:null,Ua:Qg,Na:function(b,e){return c.a(b,e)}},{Va:Rg,Ua:Qg,Na:function(b,e){return c.a(b,e)}},{Va:Sg,Ua:Qg,Na:function(b,e){return c.a(b,e)}},{Va:Qg,Ua:Rg,Na:function(b,e){return c.b(b,e)}},{Va:Qg,Ua:Sg,Na:function(b,e){return c.b(b,e)}},{Va:Rg,Ua:Sg,Na:function(b,e){return c.c(b,e)}},{Va:Sg,Ua:Rg,Na:function(b,e){return c.c(b,e)}}]}
Pg.prototype.release=function(){this.h=null;this.f.clear();this.a=function(){};this.b=function(){};this.c=function(){}};Pg.prototype.g=function(b,c){for(var d=r(this.h.a),e=d.next();!e.done;e=d.next()){e=e.value;var f=this.f.get(e),g=b<e.startTime?Rg:b>e.endTime?Sg:Qg;this.f.set(e,g);for(var h=r(this.i),k=h.next();!k.done;k=h.next())k=k.value,k.Va==f&&k.Ua==g&&k.Na(e,c)}};function Tg(b,c,d,e){b.a=c;b.b=d;b.c=e}var Rg=1,Qg=2,Sg=3;function Ug(b,c){this.a=c;this.c=b;this.g=null;this.j=1;this.v=Promise.resolve();this.h=[];this.i=new Map;this.b=new Map;this.s=!1;this.N=null;this.I=this.f=this.l=!1;this.C=0}Ug.prototype.destroy=function(){for(var b=r(this.b.values()),c=b.next();!c.done;c=b.next())Vg(c.value);this.b.clear();this.i.clear();this.g=this.h=this.v=this.c=this.a=null;this.f=!0;return Promise.resolve()};
Ug.prototype.configure=function(b){this.g=b;this.N=new jb({maxAttempts:Math.max(b.retryParameters.maxAttempts,2),baseDelay:b.retryParameters.baseDelay,backoffFactor:b.retryParameters.backoffFactor,fuzzFactor:b.retryParameters.fuzzFactor,timeout:0},!0)};
Ug.prototype.start=function(){var b=this;return t(function d(){var e,f,g;return y(d,function(d){switch(d.m){case 1:return e=b.a.Aa(),f=Wg(b,e),g=b.a.cd(b.c.periods[f]),g.variant||g.text?u(d,Xg(b,g.variant?g.variant.audio:null,g.variant?g.variant.video:null,g.text,e),2):(A("init: no Streams chosen"),d["return"](new I(2,5,5005)));case 2:if(b.f)return d["return"]();D("init: completed initial Stream setup");b.a&&b.a.ke&&(F("init: calling onInitialStreamsSetup()..."),b.a.ke());w(d)}})})};
function Yg(b){return Zg(b,"audio")}function $g(b){return Zg(b,"video")}function Zg(b,c){var d=b.b.get(c);return d?d.Da||d.stream:null}
function ah(b,c){return t(function e(){var f,g,h,k,l,m,n,q,v,x;return y(e,function(e){switch(e.m){case 1:return f=kd,u(e,Xd(b.a.A,f.Ja),2);case 2:return b.C++,b.I=!1,g=b.C,h=b.a.A,k=new Map,l=new Set,k.set(f.Ja,c),l.add(c),u(e,h.init(k,!1),3);case 3:return b.f?e["return"]():u(e,bh(b,l),4);case 4:if(b.f)return e["return"]();n=(m=b.a.A.g.isTextVisible())||b.g.alwaysStreamText;b.C!=g||b.b.has(f.Ja)||b.I||!n||(q=b.a.Aa(),v=Wg(b,q),x=ch(c,v,0),b.b.set(f.Ja,x),dh(b,x,0));w(e)}})})}
function eh(b,c){var d=b.b.get("video");if(d){var e=d.stream;if(e)if(D("setTrickPlay",c),c){var f=e.trickModeVideo;f&&!d.Da&&(D("Engaging trick mode stream",f),fh(b,f,!1,0,!1),d.Da=e)}else if(e=d.Da)D("Restoring non-trick-mode stream",e),d.Da=null,fh(b,e,!0,0,!1)}}function gh(b,c,d,e){c.video&&fh(b,c.video,d,e,!1);c.audio&&fh(b,c.audio,d,e,!1)}
function fh(b,c,d,e,f){var g=b.b.get(c.type);if(!g&&"text"==c.type&&b.g.ignoreTextStreamFailures)ah(b,c);else if(g){var h=hh(b,c),k=Array.from(b.b.values()).every(function(b){return b.ka==g.ka});d&&h!=g.ka&&k?(D("switch: switching to stream in another Period; clearing buffer and changing Periods"),b.b.forEach(function(c){ih(b,c)})):(g.Da&&(D("switch during trick play mode",c),c.trickModeVideo?(g.Da=c,c=c.trickModeVideo,D("switch found trick play stream",c)):(g.Da=null,D("switch found no special trick play stream"))),
(k=b.h[h])&&k.pb&&(k=b.i.get(c.id))&&k.pb&&(g.stream!=c||f?("text"==c.type&&Pd(b.a.A,bc(c.mimeType,c.codecs)),g.stream=c,g.Qb=!0,D("switch: switching to Stream "+jh(g)),c=kh(b,g,h),lh(b,g,h)&&(C("Aborting current segment request to switch."),g.vb.abort(),h=b.c.periods[h],c&&b.a.A.remove(g.type,c.startTime+h.startTime,c.endTime+h.startTime)),d&&(g.Ka?g.$b=!0:g.Ca?(g.Ia=!0,g.Hb=e,g.$b=!0):(Vg(g),mh(b,g,!0,e)["catch"](function(c){if(b.a)b.a.onError(c)})))):D("switch: Stream "+jh(g)+" already active")))}}
function kh(b,c,d){if(!c.vb)return null;var e=b.a.Aa(),f=Td(b.a.A,c.type);return nh(b,c,e,f,d)}
function lh(b,c,d){var e=kh(b,c,d);if(!e)return!1;var f=e?e.a?e.a-e.b:null:null;d=b.c.periods[d];var g=e.Nb()+d.startTime;d=b.a.Aa();if(d>g)return!1;null==f&&(f=(e.endTime-e.Nb())*c.stream.bandwidth/8);if(isNaN(f))return!1;(e=c.stream.initSegmentReference)&&(f+=(e.a?e.a-e.b:null)||0);e=b.a.getBandwidthEstimate();e=8*f/e;d=Td(b.a.A,c.type)-d;return e<d-Math.max(b.c.minBufferTime||0,b.g.rebufferingGoal)||c.vb.b.a>f?!0:!1}
function oh(b){function c(c){var f=b.a.A;"text"==c?(c=f.a,c=null==c.a||null==c.b?!1:d>=c.a&&d<c.b):(c=Sd(f,c),c=ed(c,d,e));return c}var d=b.a.Aa(),e=b.g.smallGapLimit,f=!1,g=Wg(b,d);if(Zb(b.b.values(),function(b){return b.ka==g}))for(var h=r(b.b.keys()),k=h.next();!k.done;k=h.next())k=k.value,c(k)||(ih(b,b.b.get(k)),f=!0);else Zb(b.b.keys(),c)||(D("(all): seeked: unbuffered seek: clearing all buffers"),b.b.forEach(function(c){ih(b,c)}),f=!0);f||D("(all): seeked: buffered seek: presentationTime="+
d)}function ih(b,c){var d=jh(c);c.Ka?D(d,"clear: already clearing the buffer"):c.Ia?D(d,"clear: already waiting"):c.Ca?(D(d,"clear: currently updating"),c.Ia=!0,c.Hb=0):null==Rd(b.a.A,c.type)?(D(d,"clear: nothing buffered"),null==c.wa&&dh(b,c,0)):(D(d,"clear: handling right now"),Vg(c),mh(b,c,!1,0)["catch"](function(c){if(b.a)b.a.onError(c)}))}
function Xg(b,c,d,e,f){return t(function h(){var k,l,m,n,q,v,x;return y(h,function(h){switch(h.m){case 1:return k=b.a.Aa(),l=Wg(b,k),m=kd,n=new Map,q=new Set,c&&(n.set(m.xd,c),q.add(c)),d&&(n.set(m.Lc,d),q.add(d)),e&&(n.set(m.Ja,e),q.add(e)),v=b.a.A,x=b.g.forceTransmuxTS,u(h,v.init(n,x),2);case 2:if(b.f)return h["return"]();ph(b);return u(h,bh(b,q),3);case 3:if(b.f)return h["return"]();n.forEach(function(c,d){if(!b.b.has(d)){var e=ch(c,l,f);b.b.set(d,e);dh(b,e,0)}});w(h)}})})}
function ch(b,c,d){return{stream:b,type:b.type,jb:null,ta:null,Da:null,Qb:!0,ka:c,endOfStream:!1,Ca:!1,wa:null,Ia:!1,Hb:0,$b:!1,Ka:!1,Bc:!1,tb:!1,od:d||0,vb:null}}
function qh(b,c){var d=b.h[c];if(d)return D("(all) Period "+c+" is being or has been set up"),d.promise;D("(all) setting up Period "+c);d={promise:new mb,pb:!1};b.h[c]=d;for(var e=new Set,f=r(b.c.periods[c].variants),g=f.next();!g.done;g=f.next())g=g.value,g.video&&e.add(g.video),g.video&&g.video.trickModeVideo&&e.add(g.video.trickModeVideo),g.audio&&e.add(g.audio);f=r(b.c.periods[c].textStreams);for(g=f.next();!g.done;g=f.next())e.add(g.value);b.v=b.v.then(function(){if(!this.f)return bh(this,e)}.bind(b)).then(function(){this.f||
(this.h[c].promise.resolve(),this.h[c].pb=!0,F("(all) setup Period "+c))}.bind(b))["catch"](function(b){this.f||(this.h[c].promise["catch"](function(){}),this.h[c].promise.reject(),delete this.h[c],B("(all) failed to setup Period "+c),this.a.onError(b))}.bind(b));return d.promise}
function bh(b,c){return t(function e(){var f,g,h,k,l,m,n;return y(e,function(e){switch(e.m){case 1:f=[];for(var q=r(c),x=q.next();!x.done;x=q.next())g=x.value,(h=b.i.get(g.id))?(D("(all) Stream "+g.id+" is being or has been set up"),f.push(h.promise)):(F("(all) setting up Stream "+g.id),b.i.set(g.id,{promise:new mb,pb:!1}),f.push(g.createSegmentIndex()));e.T=2;return u(e,Promise.all(f),4);case 4:if(b.f)return e["return"]();xa(e,3);break;case 2:k=ya(e);if(b.f)return e["return"]();e=r(c);for(x=e.next();!x.done;x=
e.next())l=x.value,b.i.get(l.id).promise["catch"](function(){}),b.i.get(l.id).promise.reject(),b.i["delete"](l.id);throw k;case 3:q=r(c);for(x=q.next();!x.done;x=q.next())m=x.value,n=b.i.get(m.id),n.pb||(n.promise.resolve(),n.pb=!0,F("(all) setup Stream "+m.id));w(e)}})})}function ph(b){var c=b.c.presentationTimeline.Z();Infinity>c?b.a.A.Ra(c):b.a.A.Ra(Math.pow(2,32))}
function rh(b,c){if(!b.f){var d=jh(c);if(!c.Ca&&null!=c.wa&&!c.Ka)if(c.wa=null,c.Ia)D(d,"skipping update and clearing the buffer"),mh(b,c,c.$b,c.Hb);else{try{var e=sh(b,c);null!=e&&(dh(b,c,e),c.tb=!1)}catch(f){th(b,f);return}e=Array.from(b.b.values());uh(b,c);b.s&&e.every(function(b){return b.endOfStream})&&(F(d,"calling endOfStream()..."),b.a.A.endOfStream().then(function(){if(!this.f){var b=this.a.A.Z();0!=b&&b<this.c.presentationTimeline.Z()&&this.c.presentationTimeline.Ra(b)}}.bind(b)))}}}
function sh(b,c){if(vh(c))return b.a.A.Zb(c.stream.originalId||""),null;var d=jh(c),e=b.a.Aa(),f=wh(b,c,e);G(d,"timeNeeded="+f);var g=hh(b,c.stream),h=Wg(b,f),k=Ud(b.a.A,c.type,e);G(d,"update_:","presentationTime="+e,"bufferedAhead="+k);var l=Math.max(b.c.minBufferTime||0,b.g.rebufferingGoal,b.g.bufferingGoal)*b.j;if(f>=b.c.presentationTimeline.Z())return D(d,"buffered to end of presentation"),c.endOfStream=!0,"video"==c.type&&(f=b.b.get("text"))&&"application/cea-608"==f.stream.mimeType&&(f.endOfStream=
!0),null;c.endOfStream=!1;c.ka=h;if(h!=g)return D(d,"need Period "+h,"presentationTime="+e,"timeNeeded="+f,"currentPeriodIndex="+g),null;if(k>=l)return G(d,"buffering goal met"),.5;d=Td(b.a.A,c.type);d=nh(b,c,e,d,g);if(!d)return 1;var m=Infinity;Array.from(b.b.values()).forEach(function(c){vh(c)||(c=wh(b,c,e),m=Math.min(m,c))});if(f>=m+b.c.presentationTimeline.a)return 1;c.od=0;xh(b,c,e,g,d);return null}
function wh(b,c,d){if(!c.jb||!c.ta)return Math.max(d,c.od);d=hh(b,c.jb);return b.c.periods[d].startTime+c.ta.endTime}
function nh(b,c,d,e,f){var g=jh(c);if(c.ta&&c.stream==c.jb)return e=c.ta.position+1,G(g,"next position known:","position="+e),yh(b,c,f,e);c.ta?(F(g,"next position unknown: another Stream buffered"),g=hh(b,c.jb),g=zh(b,c,b.c.periods[g].startTime+c.ta.endTime,f)):(F(g,"next position unknown: nothing buffered"),g=zh(b,c,e||d,f));if(null==g)return null;d=null;null==e&&(d=yh(b,c,f,Math.max(0,g-1)));return d||yh(b,c,f,g)}
function zh(b,c,d,e){var f=jh(c);b=b.c.periods[e];D(f,"looking up segment:","presentationTime="+d,"currentPeriod.startTime="+b.startTime);d=Math.max(0,d-b.startTime);c=c.stream.findSegmentPosition(d);null==c&&B(f,"cannot find segment:","currentPeriod.startTime="+b.startTime,"lookupTime="+d);return c}
function yh(b,c,d,e){var f=jh(c);d=b.c.periods[d];c=c.stream.getSegmentReference(e);if(!c)return F(f,"segment does not exist:","currentPeriod.startTime="+d.startTime,"position="+e),null;e=b.c.presentationTimeline;b=e.Mb();e=e.gb();return d.startTime+c.endTime<b||d.startTime+c.startTime>e?(G(f,"segment is not available:","currentPeriod.startTime="+d.startTime,"reference.startTime="+c.startTime,"reference.endTime="+c.endTime,"availabilityStart="+b,"availabilityEnd="+e),null):c}
function xh(b,c,d,e,f){var g=jh(c),h=b.c.periods[e];F(g,"fetchAndAppend_:","presentationTime="+d,"currentPeriod.startTime="+h.startTime,"reference.position="+f.position,"reference.startTime="+f.startTime,"reference.endTime="+f.endTime);var k=c.stream,l=b.c.presentationTimeline.Z(),m=b.c.periods[e+1];e=Ah(b,c,e,Math.max(0,h.startTime-.1),m?m.startTime+.01:l);c.Ca=!0;c.Qb=!1;G(g,"fetching segment #"+f.position);var n=e;Bh(b,c,f,function(e,l,m,E){b.f||b.l||!E||(n=n.then(function(){if(b.f||b.l||!E)return Promise.resolve();
G(g,"#"+f.position+" appending "+E.byteLength+" bytes");return Ch(b,c,d,h,k,f,E)}))}).then(function(){if(!this.f&&!this.l)return n}.bind(b)).then(function(){this.f||this.l||(c.Ca=!1,c.Bc=!1,c.jb=k,c.ta=f,c.Ia||this.a.yc(),dh(this,c,0),Dh(this,c,k),F(g,"finished fetch and append #"+f.position))}.bind(b))["catch"](function(b){this.f||this.l||(c.Ca=!1,"text"==c.type&&this.g.ignoreTextStreamFailures?(1001==b.code?B(g,"Text stream failed to download. Proceeding without it."):B(g,"Text stream failed to parse. Proceeding without it."),
this.b["delete"]("text")):7001==b.code?(c.Ca=!1,c.wa=null,dh(this,c,0)):3017==b.code?Eh(this,c,b):(A(g,"failed fetch and append: code="+b.code),c.tb=!0,b.severity=2,th(this,b)))}.bind(b))}
function Eh(b,c,d){var e=jh(c);if(Array.from(b.b.values()).some(function(b){return b!=c&&b.Bc}))D(e,"MediaSource threw QuotaExceededError:","waiting for another stream to recover...");else{var f=Math.round(100*b.j);if(20<f)b.j-=.2;else if(4<f)b.j-=.04;else{A(e,"MediaSource threw QuotaExceededError too many times");c.tb=!0;b.l=!0;b.a.onError(d);return}B(e,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-Math.round(100*b.j))+"%");c.Bc=!0}dh(b,c,4)}
function Ah(b,c,d,e,f){if(!c.Qb)return Promise.resolve();var g=jh(c);d=b.c.periods[d].startTime-c.stream.presentationTimeOffset;F(g,"setting timestamp offset to "+d);F(g,"setting append window start to "+e);F(g,"setting append window end to "+f);e=Yd(b.a.A,c.type,d,e,f);if(!c.stream.initSegmentReference)return e;F(g,"fetching init segment");b=Bh(b,c,c.stream.initSegmentReference).then(function(b){if(!this.f)return F(g,"appending init segment"),Vd(this.a.A,c.type,b,null,null,c.stream.closedCaptions&&
0<c.stream.closedCaptions.size)}.bind(b))["catch"](function(b){c.Qb=!0;return Promise.reject(b)});return Promise.all([e,b])}
function Ch(b,c,d,e,f,g,h){var k=jh(c),l=f.closedCaptions&&0<f.closedCaptions.size;null!=f.emsgSchemeIdUris&&0<f.emsgSchemeIdUris.length&&(new S).na("emsg",b.P.bind(b,e,g,f.emsgSchemeIdUris)).parse(h,!0);return Fh(b,c,d).then(function(){if(!this.f)return F(k,"appending media segment"),Vd(this.a.A,c.type,h,g.startTime+e.startTime,g.endTime+e.startTime,l)}.bind(b)).then(function(){if(!this.f)return G(k,"appended media segment"),Promise.resolve()}.bind(b))}
Ug.prototype.P=function(b,c,d,e){var f=e.reader.zc(),g=e.reader.zc(),h=e.reader.B(),k=e.reader.B(),l=e.reader.B(),m=e.reader.B();e=e.reader.Qa(e.reader.D.byteLength-e.reader.U());b=b.startTime+c.startTime+k/h;if(d.includes(f))if("urn:mpeg:dash:event:2012"==f)this.a.le();else this.a.onEvent(new L("emsg",{detail:{startTime:b,endTime:b+l/h,schemeIdUri:f,value:g,timescale:h,presentationTimeDelta:k,eventDuration:l,id:m,messageData:e}}))};
function Fh(b,c,d){var e=jh(c);G(e,"checking buffer length");var f=Math.max(b.g.bufferBehind,b.c.presentationTimeline.a),g=Rd(b.a.A,c.type);if(null==g)return G(e,"buffer behind okay because nothing buffered:","presentationTime="+d,"bufferBehind="+f),Promise.resolve();var h=d-g,k=h-f;if(0>=k)return G(e,"buffer behind okay:","presentationTime="+d,"bufferedBehind="+h,"bufferBehind="+f,"underflow="+-k),Promise.resolve();F(e,"buffer behind too large:","presentationTime="+d,"bufferedBehind="+h,"bufferBehind="+
f,"overflow="+k);return b.a.A.remove(c.type,g,g+k).then(function(){this.f||F(e,"evicted "+k+" seconds")}.bind(b))}
function Dh(b,c,d){if(!b.s){var e=jh(c);c=Array.from(b.b.values());if(1!=c.length||"text"!=c[0].type)b.s=c.every(function(b){return"text"==b.type?!0:!b.Ia&&!b.Ka&&b.ta});if(b.s){D(e,"startup complete");d=hh(b,d);b.h[d]||qh(b,d).then(function(){this.f||(F(e,"calling onCanSwitch()..."),this.a.bd())}.bind(b))["catch"](hd.Sb);for(d=0;d<b.c.periods.length;++d)qh(b,d)["catch"](hd.Sb);b.a.re&&(F(e,"calling onStartupComplete()..."),b.a.re())}}}
function uh(b,c){var d=jh(c),e=hh(b,c.stream);if(c.ka!=e){var f=c.ka,g=Array.from(b.b.values());g.every(function(b){return b.ka==f||vh(b)})?g.every(Gh)?(D(d,"all need Period "+f),qh(b,f).then(function(){if(!this.f)if(g.every(function(b){var c=Gh(b),d=hh(this,b.stream);return vh(b)?!0:c&&b.ka==f&&d!=f}.bind(this))){var b=this.c.periods[f];F(d,"calling onChooseStreams()...");var c=this.a.cd(b),e=new Map;c.variant&&c.variant.video&&e.set("video",c.variant.video);c.variant&&c.variant.audio&&e.set("audio",
c.variant.audio);c.text&&e.set("text",c.text);var m=r(this.b.keys());for(c=m.next();!c.done;c=m.next())if(c=c.value,!e.has(c)&&"text"!=c){A(d,"invalid Streams chosen: missing "+c+" Stream");this.a.onError(new I(2,5,5005));return}m=r(Array.from(e.keys()));for(c=m.next();!c.done;c=m.next())if(c=c.value,!this.b.has(c))if("text"==c)Xg(this,null,null,e.get("text"),b.startTime),e["delete"](c);else{A(d,"invalid Streams chosen: unusable "+c+" Stream");this.a.onError(new I(2,5,5005));return}b=r(Array.from(this.b.keys()));
for(c=b.next();!c.done;c=b.next())c=c.value,(m=e.get(c))?(fh(this,m,!1,0,!1),dh(this,this.b.get(c),0)):this.b["delete"](c);F(d,"calling onCanSwitch()...");this.a.bd()}else D(d,"ignoring transition to Period",f,"since another is happening")}.bind(b))["catch"](hd.Sb)):D(d,"all MediaStates need Period "+f+", but not all MediaStates are idle"):D(d,"not all MediaStates need Period "+f)}}function vh(b){return"text"==b.type&&"application/cea-608"==b.stream.mimeType}
function Gh(b){return!b.Ca&&null==b.wa&&!b.Ia&&!b.Ka}function Wg(b,c){var d=ug(b.c.periods,c+ld);return d?b.c.periods.indexOf(d):0}function hh(b,c){for(var d=b.c.periods,e=0;e<d.length;e++){for(var f=d[e],g=new Set,h=r(f.variants),k=h.next();!k.done;k=h.next())k=k.value,k.audio&&g.add(k.audio),k.video&&g.add(k.video),k.video&&k.video.trickModeVideo&&g.add(k.video.trickModeVideo);f=r(f.textStreams);for(h=f.next();!h.done;h=f.next())g.add(h.value);if(g.has(c))return e}return-1}
function Bh(b,c,d,e){var f=tf(d.c(),d.b,d.a,b.g.retryParameters);G("fetching: reference=",d);b=b.a.Rb.request(1,f,e);c.vb=b;return b.promise.then(function(b){c.vb=null;return b.data})}
function mh(b,c,d,e){return t(function g(){var h,k,l,m;return y(g,function(g){switch(g.m){case 1:return h=jh(c),c.Ia=!1,c.$b=!1,c.Hb=0,c.Ka=!0,D(h,"clearing buffer"),e?(l=b.a.Aa(),m=b.a.A.Z(),k=b.a.A.remove(c.type,l+e,m)):k=Xd(b.a.A,c.type).then(function(){if(!this.f&&d)return this.a.A.flush(c.type)}.bind(b)),u(g,k,2);case 2:if(b.f)return g["return"]();D(h,"cleared buffer");c.jb=null;c.ta=null;c.Ka=!1;c.endOfStream=!1;dh(b,c,0);w(g)}})})}
function dh(b,c,d){G(jh(c),"updating in "+d+" seconds");c.wa=(new ib(function(){return t(function f(){var d;return y(f,function(f){switch(f.m){case 1:return f.T=2,u(f,rh(b,c),4);case 4:xa(f,0);break;case 2:d=ya(f);if(b.a)b.a.onError(d);w(f)}})})})).V(d)}function Vg(b){null!=b.wa&&(b.wa.stop(),b.wa=null)}function th(b,c){lb(b.N).then(function(){this.f||(this.a.onError(c),c.handled||this.g.failureCallback(c))}.bind(b))}function jh(b){return"("+b.type+":"+b.stream.id+")"};function Hh(b,c,d,e,f,g){if(200<=d&&299>=d&&202!=d)return{uri:f||e,lf:e,data:c,headers:b,fromCache:!!b["x-shaka-from-cache"]};f=null;try{f=nc(c)}catch(h){}D("HTTP error text:",f);throw new I(401==d||403==d?2:1,1,1001,e,d,f,b,g);};function Ih(b,c,d,e){var f=new Ih.b;$b(c.headers).forEach(function(b,c){f.append(c,b)});var g=new Ih.a,h={Mc:!1,vd:!1};b=Ih.h(b,d,{body:c.body||void 0,headers:f,method:c.method,signal:g.signal,credentials:c.allowCrossSiteCredentials?"include":void 0},h,e);b=new J(b,function(){h.Mc=!0;g.abort();return Promise.resolve()});if(c=c.retryParameters.timeout){var k=new H(function(){h.vd=!0;g.abort()});k.V(c/1E3);b["finally"](function(){k.stop()})}return b}z("shaka.net.HttpFetchPlugin",Ih);
Ih.h=function(b,c,d,e,f){return t(function h(){var k,l,m,n,q,v,x,E,K,N,X,ja,Va,Ob;return y(h,function(h){switch(h.m){case 1:return k=Ih.g,l=Ih.c,v=q=0,x=Date.now(),h.T=2,u(h,k(b,d),4);case 4:return m=h.O,E=m.clone().body.getReader(),N=(K=m.headers.get("Content-Length"))?parseInt(K,10):0,X=function(b){function c(){return t(function bb(){var d,e,h,k,l,m;return y(bb,function(n){switch(n.m){case 1:return n.T=2,u(n,E.read(),4);case 4:d=n.O;xa(n,3);break;case 2:return e=ya(n),F("error reading from stream",
e.message),n["return"]();case 3:d.done||(q+=d.value.byteLength),h=Date.now(),k=q-v,l=h-x,m=N-q,f(l,k,m,d.value),v=q,x=h,d.done?b.close():(b.enqueue(d.value),c()),w(n)}})})}c()},new l({start:X}),u(h,m.arrayBuffer(),5);case 5:n=h.O;xa(h,3);break;case 2:ja=ya(h);if(e.Mc)throw new I(1,1,7001,b,c);if(e.vd)throw new I(1,1,1003,b,c);throw new I(1,1,1002,b,ja,c);case 3:return Va={},Ob=m.headers,Ob.forEach(function(b,c){Va[c.trim()]=b}),h["return"](Hh(Va,n,m.status,b,m.url,c))}})})};
Ih.isSupported=function(){if(window.ReadableStream)try{new ReadableStream({})}catch(b){return!1}else return!1;return!(!window.fetch||!window.AbortController)};Ih.isSupported=Ih.isSupported;Ih.g=window.fetch;Ih.a=window.AbortController;Ih.c=window.ReadableStream;Ih.b=window.Headers;Ih.isSupported()&&(Db("http",Ih,2),Db("https",Ih,2));function Jh(b,c,d,e){var f=new Jh.f,g=Date.now(),h=0,k=new Promise(function(k,m){f.open(c.method,b,!0);f.responseType="arraybuffer";f.timeout=c.retryParameters.timeout;f.withCredentials=c.allowCrossSiteCredentials;f.onabort=function(){m(new I(1,1,7001,b,d))};f.onload=function(c){c=c.target;var e=c.getAllResponseHeaders().trim().split("\r\n"),f={};e=r(e);for(var g=e.next();!g.done;g=e.next())g=g.value.split(": "),f[g[0].toLowerCase()]=g.slice(1).join(": ");try{var h=Hh(f,c.response,c.status,b,c.responseURL,
d);k(h)}catch(N){m(N)}};f.onerror=function(c){m(new I(1,1,1002,b,c,d))};f.ontimeout=function(){m(new I(1,1,1003,b,d))};f.onprogress=function(b){var c=Date.now();if(100<c-g||b.lengthComputable&&b.loaded==b.total)e(c-g,b.loaded-h,b.total-b.loaded),h=b.loaded,g=c};for(var l in c.headers)f.setRequestHeader(l.toLowerCase(),c.headers[l]);f.send(c.body)});return new J(k,function(){f.abort();return Promise.resolve()})}z("shaka.net.HttpXHRPlugin",Jh);Jh.f=window.XMLHttpRequest;Db("http",Jh,1);
Db("https",Jh,1);function Kh(b,c){var d=Lh(),e=this;this.g=c;this.c=b;this.i=d;this.h=null;this.f=[];this.b=this.a=null;this.j=!0;this.l=Promise.resolve().then(function(){return Mh(e)})}Kh.prototype.destroy=function(){var b=this;return t(function d(){var e;return y(d,function(d){switch(d.m){case 1:return b.j=!1,b.b&&b.b.abort(),Nh(b),u(d,b.l,2);case 2:b.a&&b.a.pa.Pa();for(var f=r(b.f),h=f.next();!h.done;h=f.next())e=h.value,e.pa.Pa();b.a=null;b.f=[];b.g=null;w(d)}})})};
function Oh(b,c){var d={kb:function(){},Ub:function(){},Pa:function(){},onError:function(){},Vb:function(){},kf:function(){}};b.f.push({create:c,pa:d});b.b&&b.b.abort();Nh(b);return d}
function Mh(b){return t(function d(){return y(d,function(d){switch(d.m){case 1:if(b.j){if(0==b.f.length||b.a&&!b.a.Ma)var e=!1;else{b.a&&(b.a.pa.Pa(),b.a=null);e=b.f.shift();var g=e.create(b.i);g?(e.pa.kb(),b.a={node:g.node,payload:g.payload,Ma:g.Ma,pa:e.pa}):e.pa.Vb();e=!0}e?e=Promise.resolve():b.a?e=Ph(b):(b.g.je(b.c),b.h=new mb,e=b.h);return u(d,e,1)}d.m=0}})})}
function Ph(b){return t(function d(){var e,f;return y(d,function(d){switch(d.m){case 1:return b.c=b.g.Yd(b.c,b.i,b.a.node,b.a.payload),d.T=2,b.b=b.g.Hd(b.c,b.i,b.a.payload),u(d,b.b.promise,4);case 4:b.b=null;b.c==b.a.node&&(b.a.pa.Ub(),b.a=null);xa(d,0);break;case 2:e=ya(d);if(7001==e.code)b.a.pa.Pa();else b.a.pa.onError(e);b.a=null;b.b=null;f=b;return u(d,b.g.handleError(b.i,e),5);case 5:f.c=d.O,w(d)}})})}function Nh(b){b.h&&(b.h.resolve(),b.h=null)};function Qh(b){this.a=null;for(var c=0;c<b.textTracks.length;++c){var d=b.textTracks[c];d.mode="disabled";"Shaka Player TextTrack"==d.label&&(this.a=d)}this.a||(this.a=b.addTextTrack("subtitles","Shaka Player TextTrack"));this.a.mode="hidden"}z("shaka.text.SimpleTextDisplayer",Qh);Qh.prototype.remove=function(b,c){if(!this.a)return!1;Rh(this.a,function(d){return d.startTime<c&&d.endTime>b});return!0};Qh.prototype.remove=Qh.prototype.remove;
Qh.prototype.append=function(b){for(var c=Sh,d=[],e=0;e<b.length;e++){var f=c(b[e]);f&&d.push(f)}d.slice().sort(function(b,c){return b.startTime!=c.startTime?b.startTime-c.startTime:b.endTime!=c.endTime?b.endTime-c.startTime:d.indexOf(c)-d.indexOf(b)}).forEach(function(b){this.a.addCue(b)}.bind(this))};Qh.prototype.append=Qh.prototype.append;Qh.prototype.destroy=function(){this.a&&Rh(this.a,function(){return!0});this.a=null;return Promise.resolve()};Qh.prototype.destroy=Qh.prototype.destroy;
Qh.prototype.isTextVisible=function(){return"showing"==this.a.mode};Qh.prototype.isTextVisible=Qh.prototype.isTextVisible;Qh.prototype.setTextVisibility=function(b){this.a.mode=b?"showing":"hidden"};Qh.prototype.setTextVisibility=Qh.prototype.setTextVisibility;
function Sh(b){if(b.startTime>=b.endTime)return B("Invalid cue times: "+b.startTime+" - "+b.endTime),null;var c=new VTTCue(b.startTime,b.endTime,b.payload);c.lineAlign=b.lineAlign;c.positionAlign=b.positionAlign;c.size=b.size;try{c.align=b.textAlign}catch(d){}"center"==b.textAlign&&"center"!=c.align&&(c.align="middle");"vertical-lr"==b.writingMode?c.vertical="lr":"vertical-rl"==b.writingMode&&(c.vertical="rl");1==b.lineInterpretation&&(c.snapToLines=!1);null!=b.line&&(c.line=b.line);null!=b.position&&
(c.position=b.position);return c}function Rh(b,c){var d=b.mode;b.mode="showing"==d?"showing":"hidden";for(var e=b.cues,f=e.length-1;0<=f;f--){var g=e[f];g&&c(g)&&b.removeCue(g)}b.mode=d};function Th(b,c,d,e,f){var g=f in e,h=!0,k;for(k in c){var l=f+"."+k,m=g?e[f]:d[k];g||k in d?void 0===c[k]?void 0===m||g?delete b[k]:b[k]=xb(m):m.constructor==Object&&c[k]&&c[k].constructor==Object?(b[k]||(b[k]=xb(m)),l=Th(b[k],c[k],m,e,l),h=h&&l):typeof c[k]!=typeof m||null==c[k]||c[k].constructor!=m.constructor?(A("Invalid config, wrong type for "+l),h=!1):("function"==typeof d[k]&&d[k].length!=c[k].length&&B("Invalid config, wrong number of arguments for "+l),b[k]=c[k]):(A("Invalid config, unrecognized key "+
l),h=!1)}return h}z("shaka.util.ConfigUtils.mergeConfigObjects",Th);function Uh(b,c){for(var d={},e=d,f=0,g=0;;){f=b.indexOf(".",f);if(0>f)break;if(0==f||"\\"!=b[f-1])g=b.substring(g,f).replace(/\\\./g,"."),e[g]={},e=e[g],g=f+1;f+=1}e[b.substring(g).replace(/\\\./g,".")]=c;return d}z("shaka.util.ConfigUtils.convertToConfigObject",Uh);function Vh(){}z("shaka.util.PlayerConfiguration",Vh);
function Wh(){var b=5E5,c=Infinity;navigator.connection&&(b=1E6*navigator.connection.downlink,navigator.connection.saveData&&(c=360));var d={retryParameters:kb(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:function(b){return b},fairPlayTransform:!0},e={retryParameters:kb(),availabilityWindowOverride:NaN,dash:{customScheme:function(b){if(b)return null},clockSyncUri:"",ignoreDrmInfo:!1,xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,
autoCorrectDrift:!0},hls:{ignoreTextStreamFailures:!1}},f={retryParameters:kb(),failureCallback:function(b){A("Unhandled streaming error",b)},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1};ic("Web0S")&&(f.stallEnabled=!1);var g={trackSelectionCallback:function(b){return b},progressCallback:function(b,
c){G("Offline operation on",b.originalManifestUri,"progress at",c)},usePersistentLicense:!0},h={drm:d,manifest:e,streaming:f,offline:g,abrFactory:Q,abr:{enabled:!0,defaultBandwidthEstimate:b,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:Infinity,minHeight:0,maxHeight:c,minPixels:0,maxPixels:Infinity,minBandwidth:0,maxBandwidth:Infinity}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,
restrictions:{minWidth:0,maxWidth:Infinity,minHeight:0,maxHeight:Infinity,minPixels:0,maxPixels:Infinity,minBandwidth:0,maxBandwidth:Infinity},playRangeStart:0,playRangeEnd:Infinity,textDisplayFactory:function(){return null}};g.trackSelectionCallback=function(b){return Xh(b,h.preferredAudioLanguage)};return h}
function Yh(b,c,d){var e={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return Th(b,c,d||Wh(),e,"")}Vh.mergeConfigObjects=Yh;
function Xh(b,c){var d=b.filter(function(b){return"variant"==b.type}),e=[],f=ee(c,d.map(function(b){return b.language}));f&&(e=d.filter(function(b){return P(b.language)==f}));0==e.length&&(e=d.filter(function(b){return b.primary}));0==e.length&&(1<(new Set(d.map(function(b){return b.language}))).size&&B("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),e=d);var g=e.filter(function(b){return b.height&&480>=b.height});g.length&&
(g.sort(function(b,c){return c.height-b.height}),e=g.filter(function(b){return b.height==g[0].height}));d=[];if(e.length){var h=Math.floor(e.length/2);e.sort(function(b,c){return b.bandwidth-c.bandwidth});d.push(e[h])}e=r(b);for(h=e.next();!h.done;h=e.next())h=h.value,"text"==h.type&&d.push(h);return d};function Zh(){this.a=null;this.b=[]}function $h(b,c){if(null==b.a)b.a={timestamp:Date.now()/1E3,state:c,duration:0};else{var d=Date.now()/1E3;b.a.duration=d-b.a.timestamp;b.a.state!=c&&(b.b.push(b.a),b.a={timestamp:d,state:c,duration:0})}}function ai(b,c){var d=0;b.a&&b.a.state==c&&(d+=b.a.duration);for(var e=r(b.b),f=e.next();!f.done;f=e.next())f=f.value,d+=f.state==c?f.duration:0;return d}
function bi(b){function c(b){return{timestamp:b.timestamp,state:b.state,duration:b.duration}}for(var d=[],e=r(b.b),f=e.next();!f.done;f=e.next())d.push(c(f.value));b.a&&d.push(c(b.a));return d};function ci(){this.b=this.c=null;this.a=[]};function di(){this.f=this.j=this.b=this.h=this.i=this.g=this.l=NaN;this.a=new Zh;this.c=new ci};function Z(b,c){var d=this;wb.call(this);this.h=ei;this.a=null;this.Ya=!1;this.i=new O;this.bc=this.j=this.Wa=this.c=this.l=this.f=this.Fb=this.W=this.Bb=this.ca=this.$a=this.s=this.I=this.g=this.N=null;this.Wc=1E9;this.Db=new Set;this.bb=!0;this.xa=null;this.Sc=!1;this.Pc=0;this.ja=null;this.ha=new Pf;this.b=fi(this);this.Eb={width:Infinity,height:Infinity};this.v=null;this.Cb=new Yf(this.b.preferredAudioLanguage,this.b.preferredVariantRole,this.b.preferredAudioChannelCount);this.ia=this.b.preferredTextLanguage;
this.Xa=this.b.preferredTextRole;c&&c(this);this.N=gi(this);this.i.w(window,"online",function(){d.Dc()});this.C={name:"detach"};this.P={name:"attach"};this.ya={name:"unload"};this.fc={name:"manifest-parser"};this.ec={name:"manifest"};this.Za={name:"media-source"};this.cc={name:"drm-engine"};this.ba={name:"load"};this.hc={name:"src-equals-drm-engine"};this.ab={name:"src-equals"};var e=new Map;e.set(this.P,function(b,c){return sb(hi(d,b,c))});e.set(this.C,function(b){b.o&&(d.i.aa(b.o,"error"),b.o=null);
d.a=null;b=Promise.resolve();return sb(b)});e.set(this.ya,function(b){return sb(ii(d,b))});e.set(this.Za,function(b){b=ji(d,b);return sb(b)});e.set(this.fc,function(b,c){var e=ki(d,b,c);return sb(e)});e.set(this.ec,function(b){return li(d,b)});e.set(this.cc,function(){var b=mi(d);return sb(b)});e.set(this.ba,function(b,c){return sb(ni(d,b,c))});e.set(this.hc,function(b){b=oi(d,b);return sb(b)});e.set(this.ab,function(b,c){return pi(d,b,c)});this.cb=new Kh(this.C,{Yd:function(b,c,e,k){var f=null;b==
d.C&&(f=e==d.C?d.C:d.P);b==d.P&&(f=e==d.C||c.o!=k.o?d.C:e==d.P?d.P:e==d.Za||e==d.ba?d.Za:e==d.ab?d.hc:null);b==d.Za&&(f=e==d.ba&&c.o==k.o?d.fc:d.ya);b==d.fc&&(f=qi(d.ba,d.ec,d.ya,e,c,k));b==d.ec&&(f=qi(d.ba,d.cc,d.ya,e,c,k));b==d.cc&&(f=qi(d.ba,d.ba,d.ya,e,c,k));b==d.hc&&(f=e==d.ab&&c.o==k.o?d.ab:d.ya);if(b==d.ba||b==d.ab)f=d.ya;b==d.ya&&(f=k.o&&c.o==k.o?d.P:d.C);return f},Hd:function(b,c,h){d.dispatchEvent(new L("onstatechange",{state:b.name}));return e.get(b)(c,h)},handleError:function(b,c){return t(function k(){return y(k,
function(e){switch(e.m){case 1:return B("The walker saw an error:"),c instanceof I?B("Error Code:",c.code):(B("Error Message:",c.message),B("Error Stack:",c.stack)),u(e,ii(d,b),2);case 2:return e["return"](b.o?d.P:d.C)}})})},je:function(b){d.dispatchEvent(new L("onstateidle",{state:b.name}))}});b&&this.qb(b,!0)}Ka(Z,wb);z("shaka.Player",Z);
Z.prototype.destroy=function(){var b=this;return t(function d(){var e;return y(d,function(d){switch(d.m){case 1:if(b.h==ri)return d["return"]();b.h=ri;e=Oh(b.cb,function(){return{node:b.C,payload:Lh(),Ma:!1}});return u(d,new Promise(function(b){e.kb=function(){C("Preparing to destroy walker...")};e.Ub=function(){b()};e.Pa=function(){b()};e.onError=function(){b()};e.Vb=function(){b()}}),2);case 2:return u(d,b.cb.destroy(),3);case 3:b.i&&(b.i.release(),b.i=null);b.bc=null;b.j=null;b.b=null;if(!b.N){d.m=
0;break}return u(d,b.N.destroy(),5);case 5:b.N=null,w(d)}})})};Z.prototype.destroy=Z.prototype.destroy;Z.version="2.5.5-yandex-patched-custom-build-partial-chunks_3-dirty";var si=["","5"];Mf=new function(b){this.a=b;this.c=Nf;this.b=Of}(new Kf(Number(si[0]),Number(si[1])));var ti=["output-restricted","internal-error"],ui={};Z.registerSupportPlugin=function(b,c){ui[b]=c};
Z.isBrowserSupported=function(){return window.Promise&&window.Uint8Array&&Array.prototype.forEach&&window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration?fc()?!0:gc("application/x-mpegurl"):!1};
Z.probeSupport=function(){return Yc().then(function(b){for(var c=W.Be(),d={},e=r('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),f=
e.next();!f.done;f=e.next()){f=f.value;d[f]=fc()?Jd(f)?!0:MediaSource.isTypeSupported(f)||nd(f):gc(f);var g=f.split(";")[0];d[g]=d[g]||d[f]}b={manifest:c,media:d,drm:b};for(var h in ui)b[h]=ui[h]();return b})};Z.prototype.qb=function(b,c){c=void 0===c?!0:c;if(this.h==ri)return Promise.reject(vi());var d=Lh();d.o=b;fc()||(c=!1);var e=c?this.Za:this.P,f=Oh(this.cb,function(){return{node:e,payload:d,Ma:!1}});f.kb=function(){return C("Starting attach...")};return wi(f)};Z.prototype.attach=Z.prototype.qb;
Z.prototype.detach=function(){var b=this;if(this.h==ri)return Promise.reject(vi());var c=Oh(this.cb,function(){return{node:b.C,payload:Lh(),Ma:!1}});c.kb=function(){return C("Starting detach...")};return wi(c)};Z.prototype.detach=Z.prototype.detach;
Z.prototype.Ye=function(b){var c=this;b=void 0===b?!0:b;if(this.h==ri)return Promise.reject(vi());fc()||(b=!1);var d=Lh(),e=Oh(this.cb,function(e){var f=e.o&&b?c.Za:e.o?c.P:c.C;d.o=e.o;return{node:f,payload:d,Ma:!1}});e.kb=function(){return C("Starting unload...")};return wi(e)};Z.prototype.unload=Z.prototype.Ye;
Z.prototype.load=function(b,c,d){if(this.h==ri)return Promise.reject(vi());this.dispatchEvent(new L("loading"));var e=Lh();e.uri=b;e.Hc=Date.now()/1E3;d&&"string"!=typeof d&&(Lf("Loading with a manifest parser factory","Please register a manifest parser and for the mime-type."),e.ra=function(){return new d});d&&"string"==typeof d&&(e.mimeType=d);void 0!==c&&(e.startTime=c);var f=xi(e)?this.ab:this.ba,g=Oh(this.cb,function(b){if(null==b.o)return null;e.o=b.o;return{node:f,payload:e,Ma:!0}});g.kb=function(){return C("Starting load of "+
b+"...")};return new Promise(function(b,c){g.Vb=function(){return c(new I(2,7,7002))};g.Ub=function(){return b()};g.Pa=function(){return c(vi())};g.onError=function(b){return c(b)}})};Z.prototype.load=Z.prototype.load;
function xi(b){if(b.ra)return!1;if(!fc())return!0;var c=b.mimeType;b=b.uri||"";c||(c={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",ts:"video/mp2t",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac"}[W.getExtension(b)]);return c?gc(c)?W.isSupported(b,c)?!!navigator.vendor&&navigator.vendor.includes("Apple"):!0:!1:!1}function hi(b,c,d){null==c.o&&(c.o=d.o,b.i.w(c.o,"error",function(){var c=yi(b);c&&b.Fa(c)}));b.a=c.o;return Promise.resolve()}
function ii(b,c){return t(function e(){return y(e,function(e){switch(e.m){case 1:b.h!=ri&&(b.h=ei);b.dispatchEvent(new L("unloading"));c.ra=null;c.mimeType=null;c.startTime=null;c.uri=null;c.o&&(b.i.aa(c.o,"loadeddata"),b.i.aa(c.o,"playing"),b.i.aa(c.o,"pause"),b.i.aa(c.o,"ended"),b.i.aa(c.o,"ratechange"));b.$a&&(b.$a.release(),b.$a=null);b.Bb&&(b.Bb.stop(),b.Bb=null);if(!b.l){e.m=2;break}return u(e,b.l.stop(),3);case 3:b.l=null;case 2:if(!b.j){e.m=4;break}return u(e,b.j.stop(),4);case 4:if(!b.f){e.m=
6;break}return u(e,b.f.destroy(),7);case 7:b.f=null;case 6:b.s&&(b.s.release(),b.s=null);if(!b.I){e.m=8;break}return u(e,b.I.destroy(),9);case 9:b.I=null;case 8:c.o&&c.o.src&&(c.o.removeAttribute("src"),c.o.load());if(!b.g){e.m=10;break}return u(e,b.g.destroy(),11);case 11:b.g=null;case 10:b.ha.a.clear(),b.Wa=null,b.W=null,b.Db.clear(),b.c=null,b.v=null,b.ac=null,b.bb=!0,zi(b),w(e)}})})}
function ji(b,c){return t(function e(){var f,g,h,k;return y(e,function(e){switch(e.m){case 1:return f=window.muxjs?new bd:new cd,g=b.b.textDisplayFactory,h=new g,b.ac=g,k=new Md(c.o,f,h),u(e,k.s,2);case 2:b.I=k,w(e)}})})}
function ki(b,c,d){return t(function f(){var g,h,k;return y(f,function(f){switch(f.m){case 1:c.ra=d.ra;c.mimeType=d.mimeType;c.uri=d.uri;g=c.uri;h=b.N;b.Wa=g;if(c.ra){b.l=c.ra();f.m=2;break}k=b;return u(f,W.create(g,h,b.b.manifest.retryParameters,c.mimeType),3);case 3:k.l=f.O;case 2:b.l.configure(b.b.manifest),w(f)}})})}
function li(b,c){var d=c.uri,e=b.N;b.Fb=new Ng;Og(b.Fb,function(c){Ai(b,"timelineregionadded",c)});var f={networkingEngine:e,filterNewPeriod:function(c){return b.jc(c)},filterAllPeriods:function(c){return Bi(b,c)},onTimelineRegionAdded:function(c){var d=b.Fb;a:{var e=r(d.a);for(var f=e.next();!f.done;f=e.next())if(f=f.value,f.schemeIdUri==c.schemeIdUri&&f.startTime==c.startTime&&f.endTime==c.endTime){e=f;break a}e=null}null==e&&(d.a.add(c),d.b(c))},onEvent:function(c){return b.dispatchEvent(c)},onError:function(c){return b.Fa(c)}};
return new J(Promise.resolve().then(function(){return t(function h(){var c;return y(h,function(e){switch(e.m){case 1:return c=b,u(e,b.l.start(d,f),2);case 2:c.c=e.O;b.dispatchEvent(new L("manifestparsed"));if(0==b.c.periods.length)throw new I(2,4,4014);Ci(b.c.periods);w(e)}})})}),function(){C("Aborting parser step...");return b.l.stop()})}
function mi(b){return t(function d(){return y(d,function(d){switch(d.m){case 1:return b.g=new wc({Rb:b.N,onError:function(d){b.Fa(d)},dd:function(d){Di(b,d)},onExpirationUpdated:function(d,e){Ei(b,d,e)},onEvent:function(d){b.dispatchEvent(d)}}),b.g.configure(b.b.drm),u(d,Bc(b.g,tg(b.c.periods),b.c.offlineSessionIds),2);case 2:Bi(b,b.c.periods),w(d)}})})}
function ni(b,c,d){return t(function f(){var g,h,k,l,m,n,q,v,x,E;return y(f,function(f){switch(f.m){case 1:return c.startTime=d.startTime,g=c.o,h=c.uri,b.Wa=h,b.v=new di,k=function(){return Fi(b)},l=function(){var c=b.a.playbackRate;0!=c&&b.ca.set(c)},b.i.w(g,"playing",k),b.i.w(g,"pause",k),b.i.w(g,"ended",k),b.i.w(g,"ratechange",l),m=b.b.abrFactory,b.j&&b.bc==m||(b.bc=m,b.j=new m,b.j.configure(b.b.abr)),Gi(b,b.c.periods),b.Cb=new Yf(b.b.preferredAudioLanguage,b.b.preferredVariantRole,b.b.preferredAudioChannelCount),
b.ia=b.b.preferredTextLanguage,Hi(b.c.presentationTimeline,b.b.playRangeStart,b.b.playRangeEnd),u(f,b.g.qb(g),2);case 2:return b.j.init(function(c,d,f){d=void 0===d?!1:d;f=void 0===f?0:f;D("switch_");a:{var g=r(b.c.periods);for(var h=g.next();!h.done;h=g.next())if(h=h.value,h.variants.includes(c)){g=h;break a}g=null}Ii(b,g,c,!0);b.f&&(gh(b.f,c,d,f),Ji(b))}),b.s=Ki(b,c.startTime),b.$a=Li(b),b.ca=new xg({Lb:function(){return c.o.playbackRate},Fc:function(b){c.o.playbackRate=b},$c:function(b){c.o.currentTime+=
b}}),n=Math.max(b.c.minBufferTime,b.b.streaming.rebufferingGoal),Mi(b,n),b.f=Ni(b),b.f.configure(b.b.streaming),Oi(b),b.h=Pi,b.dispatchEvent(new L("streaming")),u(f,b.f.start(),3);case 3:b.b.streaming.startAtSegmentBoundary&&(q=b.s.h(),v=Qi(b,q),b.s.l(v)),b.c.periods.forEach(b.jc.bind(b)),Ri(b),Ji(b),x=Si(b)||b.c.periods[0],E=x.variants.some(function(b){return b.primary}),b.b.preferredAudioLanguage||E||B("No preferred audio language set.  We will choose an arbitrary language initially"),Ti(b,x.variants),
b.i.ea(g,"loadeddata",function(){b.v.b=Date.now()/1E3-d.Hc}),w(f)}})})}
function oi(b,c){return t(function e(){var f,g;return y(e,function(e){switch(e.m){case 1:return f=kd,b.g=new wc({Rb:b.N,onError:function(c){b.Fa(c)},dd:function(c){Di(b,c)},onExpirationUpdated:function(c,e){Ei(b,c,e)},onEvent:function(c){b.dispatchEvent(c)}}),b.g.configure(b.b.drm),g={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,
presentationTimeOffset:0,mimeType:"video/mp4",codecs:"",encrypted:!0,keyId:null,language:"und",label:null,type:f.Lc,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},u(e,Bc(b.g,[g],[]),2);case 2:return u(e,b.g.qb(c.o),0)}})})}
function pi(b,c,d){function e(){return Fi(b)}c.uri=d.uri;c.startTime=d.startTime;b.Wa=c.uri;b.v=new di;b.s=new Gg(c.o);null!=c.startTime&&b.s.l(c.startTime);b.ca=new xg({Lb:function(){return c.o.playbackRate},Fc:function(b){c.o.playbackRate=b},$c:function(b){c.o.currentTime+=b}});Mi(b,b.b.streaming.rebufferingGoal);b.i.w(c.o,"playing",e);b.i.w(c.o,"pause",e);b.i.w(c.o,"ended",e);b.i.ea(c.o,"loadeddata",function(){b.v.b=Date.now()/1E3-d.Hc});b.a.audioTracks&&(b.i.w(b.a.audioTracks,"addtrack",function(){return Ri(b)}),
b.i.w(b.a.audioTracks,"removetrack",function(){return Ri(b)}));if(b.a.textTracks){var f=b.a.textTracks;b.i.w(f,"addtrack",function(){return Ri(b)});b.i.w(f,"removetrack",function(){return Ri(b)})}c.o.src=c.uri;b.h=Ui;b.dispatchEvent(new L("streaming"));var g=new mb;b.a.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA?g.resolve():b.a.error?g.reject(yi(b)):(b.i.ea(b.a,"loadeddata",function(){g.resolve()}),b.i.ea(b.a,"error",function(){g.reject(yi(b))}));return new J(g,function(){g.reject(new I(2,7,7001));
return Promise.resolve()})}function Ci(b){function c(b){return b.video&&b.audio||b.video&&b.video.codecs.includes(",")}b.some(function(b){return b.variants.some(c)})&&(D("Found variant with audio and video content, so filtering out audio-only content in all periods."),b.forEach(function(b){b.variants=b.variants.filter(c)}))}
function Oi(b){function c(b){var c="";b.video&&(c=ec(b.video.codecs)[0]);var d="";b.audio&&(d=ec(b.audio.codecs)[0]);return c+"-"+d}var d=b.c.periods.reduce(function(b,c){return b.concat(c.variants)},[]);d=qe(d,b.b.preferredAudioChannelCount);var e=new vb;d.forEach(function(b){var d=c(b);e.push(d,b)});var f=null,g=Infinity;e.forEach(function(b,c){var d=0,e=0;c.forEach(function(b){d+=b.bandwidth||0;++e});var h=d/e;D("codecs",b,"avg bandwidth",h);h<g&&(f=b,g=h)});b.c.periods.forEach(function(b){b.variants=
b.variants.filter(function(b){if(c(b)==f)return!0;D("Dropping Variant (better codec available)",b);return!1})})}function gi(b){return new M(function(c,d){b.j&&b.j.segmentDownloaded(c,d)})}function Ki(b,c){return new Hg(b.a,b.c,b.b.streaming,c,function(){b.$a&&sg(b.$a,!0);b.f&&oh(b.f)},function(c){return b.dispatchEvent(c)})}
function Li(b){var c=new vg(b.c);wg(c,function(){Ri(b)});var d=new Pg(b.Fb);Tg(d,function(c){Ai(b,"timelineregionenter",c)},function(c){Ai(b,"timelineregionexit",c)},function(c,d){d||(Ai(b,"timelineregionenter",c),Ai(b,"timelineregionexit",c))});var e=new jg(b.a);e.a.add(c);e.a.add(d);return e}
function Mi(b,c){b.W=new ag(c,Math.min(.5,c/2));b.W.a=cg;zi(b);b.Bb=(new H(function(){switch(b.h){case Ui:var c=b.a.ended?!0:dd(b.a.buffered)>=b.a.duration-.1;break;case Pi:a:if(b.a.ended||Qd(b.I))c=!0;else{if(b.c.presentationTimeline.$()){var e=b.c.presentationTimeline.gb();if(dd(b.a.buffered)>=e){c=!0;break a}}c=!1}break;default:c=!1}var f=fd(b.a.buffered,b.a.currentTime);e=b.W;var g=c,h=e.b.get(e.a);c=e.a;f=g||f>=h?bg:cg;e.a=f;c!=f&&zi(b)})).Ga(.25)}
function Ni(b){return new Ug(b.c,{Aa:function(){return b.s.h()},getBandwidthEstimate:function(){return b.j.getBandwidthEstimate()},A:b.I,Rb:b.N,cd:b.ie.bind(b),bd:b.Cd.bind(b),onError:b.Fa.bind(b),onEvent:function(c){return b.dispatchEvent(c)},le:b.me.bind(b),yc:b.qe.bind(b)})}Z.prototype.configure=function(b,c){2==arguments.length&&"string"==typeof b&&(b=Uh(b,c));var d=Yh(this.b,b,fi(this));Vi(this);return d};Z.prototype.configure=Z.prototype.configure;
function Vi(b){b.l&&b.l.configure(b.b.manifest);b.g&&b.g.configure(b.b.drm);if(b.f){b.f.configure(b.b.streaming);try{b.c.periods.forEach(b.jc.bind(b))}catch(g){b.Fa(g)}var c=Yg(b.f),d=$g(b.f),e=Si(b);c=te(c,d,e.variants);b.j&&c&&c.allowedByApplication&&c.allowedByKeySystem?Ti(b,e.variants):(D("Choosing new streams after changing configuration"),Wi(b,e))}if(b.I&&(e=b.b.textDisplayFactory,b.ac!=e)){c=new e;d=b.I;var f=d.g;d.g=c;f&&(c.setTextVisibility(f.isTextVisible()),f.destroy());d.a&&(d.a.c=c);
b.ac=e;b.f&&(e=b.f,(c=e.b.get("text"))&&fh(e,c.stream,!0,0,!0))}b.j&&(b.j.configure(b.b.abr),b.b.abr.enabled&&!b.bb?b.j.enable():b.j.disable(),Xi(b))}Z.prototype.getConfiguration=function(){var b=fi(this);Yh(b,this.b,fi(this));return b};Z.prototype.getConfiguration=Z.prototype.getConfiguration;Z.prototype.He=function(){for(var b in this.b)delete this.b[b];Yh(this.b,fi(this),fi(this));Vi(this)};Z.prototype.resetConfiguration=Z.prototype.He;Z.prototype.Rd=function(){return this.h};
Z.prototype.getLoadMode=Z.prototype.Rd;Z.prototype.Vd=function(){return this.a};Z.prototype.getMediaElement=Z.prototype.Vd;Z.prototype.Xd=function(){return this.N};Z.prototype.getNetworkingEngine=Z.prototype.Xd;Z.prototype.Kd=function(){return this.Wa};Z.prototype.getAssetUri=Z.prototype.Kd;Z.prototype.Ud=function(){Lf("getManifestUri",'Please use "getAssetUri" instead.');return this.Wa};Z.prototype.getManifestUri=Z.prototype.Ud;
Z.prototype.$=function(){return this.c?this.c.presentationTimeline.$():this.a&&this.a.src?Infinity==this.a.duration:!1};Z.prototype.isLive=Z.prototype.$;Z.prototype.ib=function(){return this.c?this.c.presentationTimeline.ib():!1};Z.prototype.isInProgress=Z.prototype.ib;
Z.prototype.fe=function(){if(this.c){if(!this.c.periods.length)return!1;var b=this.c.periods[0].variants;return b.length?!b[0].video:!1}return this.a&&this.a.src?this.a.videoTracks?0==this.a.videoTracks.length:0==this.a.videoHeight:!1};Z.prototype.isAudioOnly=Z.prototype.fe;Z.prototype.Ke=function(){if(this.c){var b=this.c.presentationTimeline;return{start:b.fb(),end:b.sa()}}return this.a&&this.a.src&&(b=this.a.seekable,b.length)?{start:b.start(0),end:b.end(b.length-1)}:{start:0,end:0}};
Z.prototype.seekRange=Z.prototype.Ke;Z.prototype.keySystem=function(){return this.g?this.g.keySystem():""};Z.prototype.keySystem=Z.prototype.keySystem;Z.prototype.drmInfo=function(){return this.g?this.g.a:null};Z.prototype.drmInfo=Z.prototype.drmInfo;Z.prototype.nc=function(){return this.g?this.g.nc():Infinity};Z.prototype.getExpiration=Z.prototype.nc;Z.prototype.Zc=function(){return this.W?this.W.a==cg:!1};Z.prototype.isBuffering=Z.prototype.Zc;
Z.prototype.Zd=function(){if(this.ca){var b=this.ca;b=b.f?0:b.c}else b=0;return b};Z.prototype.getPlaybackRate=Z.prototype.Zd;Z.prototype.Xe=function(b){0==b?Ra("A trick play rate of 0 is unsupported!"):(this.a.paused&&this.a.play(),this.ca.set(b),this.h==Pi&&eh(this.f,1<Math.abs(b)))};Z.prototype.trickPlay=Z.prototype.Xe;Z.prototype.Dd=function(){this.h==Ui&&this.ca.set(1);this.h==Pi&&(this.ca.set(1),eh(this.f,!1))};Z.prototype.cancelTrickPlay=Z.prototype.Dd;
Z.prototype.pc=function(){if(this.c&&this.s){for(var b=Yi(this),c=[],d=r(Zi(this)),e=d.next();!e.done;e=d.next()){e=e.value;var f=ke(e);f.active=e==b;c.push(f)}return c}return this.a&&this.a.audioTracks?Array.from(this.a.audioTracks).map(function(b){var c=oe(b);c.active=b.enabled;c.type="variant";c.originalAudioId=b.id;"main"==b.kind?(c.primary=!0,c.roles=["main"],c.audioRoles=["main"]):c.audioRoles=[];return c}):[]};Z.prototype.getVariantTracks=Z.prototype.pc;
Z.prototype.hb=function(){if(this.c&&this.s){for(var b=$i(this),c=[],d=r(aj(this)),e=d.next();!e.done;e=d.next()){e=e.value;var f=le(e);f.active=e==b;c.push(f)}return c}return this.a&&this.a.src&&this.a.textTracks?Array.from(this.a.textTracks).map(function(b){var c=oe(b);c.active="disabled"!=b.mode;c.type="text";c.originalTextId=b.id;"captions"==b.kind&&(c.mimeType="application/cea-608");return c}):[]};Z.prototype.getTextTracks=Z.prototype.hb;
Z.prototype.Ec=function(b){if(this.c&&this.f){var c=Si(this),d=c.textStreams.find(function(c){return c.id==b.id});d?(bj(this,c,d,!1),cj(this,d),this.ia=d.language):A("No stream with id",b.id)}else if(this.a&&this.a.src&&this.a.textTracks){c=Array.from(this.a.textTracks);c=r(c);for(d=c.next();!d.done;d=c.next())d=d.value,me(d)==b.id?d.mode=this.Ya?"showing":"hidden":d.mode="disabled";dj(this)}};Z.prototype.selectTextTrack=Z.prototype.Ec;
Z.prototype.Me=function(){Lf("selectEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack.");var b=this.hb().filter(function(b){return"application/cea-608"==b.mimeType});0<b.length?this.Ec(b[0]):B("Unable to find the text track embedded in the video.")};Z.prototype.selectEmbeddedTextTrack=Z.prototype.Me;
Z.prototype.cf=function(){Lf("usingEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text.");var b=this.hb().filter(function(b){return b.active})[0];return b?"application/cea-608"==b.mimeType:!1};Z.prototype.usingEmbeddedTextTrack=Z.prototype.cf;
Z.prototype.Oe=function(b,c,d){d=void 0===d?0:d;if(this.c&&this.f){var e=Si(this);this.b.abr.enabled&&Ra("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var f=e.variants.find(function(c){return c.id==b.id});f?pe(f)?(Ii(this,e,f,!1),ej(this,f,c,d),this.Cb=new Xf(f),Ti(this,e.variants)):A("Unable to switch to restricted track",b.id):A("No variant with id",b.id)}else if(this.a&&this.a.audioTracks){c=
Array.from(this.a.audioTracks);c=r(c);for(d=c.next();!d.done;d=c.next())d=d.value,me(d)==b.id&&(d.enabled=!0);hj(this)}};Z.prototype.selectVariantTrack=Z.prototype.Oe;Z.prototype.Md=function(){return ij(this.pc())};Z.prototype.getAudioLanguagesAndRoles=Z.prototype.Md;Z.prototype.de=function(){return ij(this.hb())};Z.prototype.getTextLanguagesAndRoles=Z.prototype.de;Z.prototype.Ld=function(){return Array.from(jj(this.pc()))};Z.prototype.getAudioLanguages=Z.prototype.Ld;Z.prototype.ce=function(){return Array.from(jj(this.hb()))};
Z.prototype.getTextLanguages=Z.prototype.ce;Z.prototype.Le=function(b,c){if(this.c&&this.s){var d=Si(this);this.Cb=new Yf(b,c||"",0);Wi(this,d)}else if(this.a&&this.a.audioTracks){d=Array.from(this.a.audioTracks);d=r(d);for(var e=d.next();!e.done;e=d.next())e=e.value,e.language==b&&(e.enabled=!0);hj(this)}};Z.prototype.selectAudioLanguage=Z.prototype.Le;
Z.prototype.Ne=function(b,c){if(this.c&&this.s){var d=Si(this);this.ia=b;this.Xa=c||"";var e=re(d.textStreams,this.ia,this.Xa)[0]||null;e&&(bj(this,d,e,!1),(this.b.streaming.alwaysStreamText||this.Pb())&&cj(this,e))}else(d=this.hb().filter(function(c){return c.language==b})[0])&&this.Ec(d)};Z.prototype.selectTextLanguage=Z.prototype.Ne;
Z.prototype.Pb=function(){var b=this.Ya;return this.c?this.I.g.isTextVisible():this.a&&this.a.src&&this.a.textTracks?Array.from(this.a.textTracks).some(function(b){return"showing"==b.mode}):b};Z.prototype.isTextTrackVisible=Z.prototype.Pb;
Z.prototype.Se=function(b){var c=this;return t(function e(){var f,g,h,k,l,m;return y(e,function(e){switch(e.m){case 1:f=c.Ya;g=b;if(f==g)return e["return"]();c.Ya=g;if(c.h!=Pi){if(c.a&&c.a.src&&c.a.textTracks){h=Array.from(c.a.textTracks);for(var n=r(h),v=n.next();!v.done;v=n.next())k=v.value,"disabled"!=k.mode&&(k.mode=b?"showing":"hidden")}e.m=2;break}c.I.g.setTextVisibility(b);if(c.b.streaming.alwaysStreamText){e.m=2;break}if(!b){n=c.f;n.I=!0;if(v=n.b.get("text"))Vg(v),n.b["delete"]("text");e.m=
2;break}l=Si(c);m=re(l.textStreams,c.ia,c.Xa);if(!(0<m.length)){e.m=2;break}return u(e,ah(c.f,m[0]),2);case 2:kj(c),w(e)}})})};Z.prototype.setTextTrackVisibility=Z.prototype.Se;
Z.prototype.$d=function(){if(!this.$())return B("getPlayheadTimeAsDate is for live streams!"),null;if(this.c)return new Date(1E3*(this.c.presentationTimeline.f+this.a.currentTime));if(this.a&&this.a.getStartDate){var b=this.a.getStartDate();return isNaN(b.getTime())?(B("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(b.getTime()+1E3*this.a.currentTime)}B("No way to get playhead time as Date!");return null};Z.prototype.getPlayheadTimeAsDate=Z.prototype.$d;
Z.prototype.be=function(){if(!this.$())return B("getPresentationStartTimeAsDate is for live streams!"),null;if(this.c)return new Date(1E3*this.c.presentationTimeline.f);if(this.a&&this.a.getStartDate){var b=this.a.getStartDate();return isNaN(b.getTime())?(B("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):b}B("No way to get presentation start time as Date!");return null};Z.prototype.getPresentationStartTimeAsDate=Z.prototype.be;
Z.prototype.lc=function(){var b={total:[],audio:[],video:[],text:[]};this.h==Ui&&(b.total=gd(this.a.buffered));this.h==Pi&&this.I.lc(b);return b};Z.prototype.getBufferedInfo=Z.prototype.lc;
Z.prototype.getStats=function(){if(this.h!=Pi&&this.h!=Ui)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,switchHistory:[],stateHistory:[]};Fi(this);var b=this.a;if(b.getVideoPlaybackQuality){b=b.getVideoPlaybackQuality();var c=this.v,d=Number(b.totalVideoFrames);c.i=Number(b.droppedVideoFrames);c.h=d}if(this.h==Pi){if(b=Yi(this))this.v.j=b.bandwidth;b&&b.video&&(c=this.v,d=b.video.height||
NaN,c.l=b.video.width||NaN,c.g=d);b=this.j.getBandwidthEstimate();this.v.f=b}var e=this.v;b=e.l;c=e.g;d=e.j;var f=e.h,g=e.i,h=e.f,k=e.b,l=ai(e.a,"playing"),m=ai(e.a,"paused"),n=ai(e.a,"buffering"),q=bi(e.a),v=[];e=r(e.c.a);for(var x=e.next();!x.done;x=e.next())x=x.value,v.push({timestamp:x.timestamp,id:x.id,type:x.type,fromAdaptation:x.fromAdaptation,bandwidth:x.bandwidth});return{width:b,height:c,streamBandwidth:d,decodedFrames:f,droppedFrames:g,estimatedBandwidth:h,loadLatency:k,playTime:l,pauseTime:m,
bufferingTime:n,stateHistory:q,switchHistory:v}};Z.prototype.getStats=Z.prototype.getStats;
Z.prototype.addTextTrack=function(b,c,d,e,f,g){var h=this;return t(function l(){var m,n,q,v,x,E,K,N,X;return y(l,function(l){switch(l.m){case 1:if(h.h==Ui)throw A("Cannot add text when loaded with src="),Error("State error!");if(h.h!=Pi)throw A("Must call load() and wait for it to resolve before adding text tracks."),Error("State error!");m=Si(h);n=kd;q=h.c.periods.indexOf(m);v=q+1;x=v>=h.c.periods.length?h.c.presentationTimeline.Z():h.c.periods[v].startTime;E=x-m.startTime;if(Infinity==E)throw new I(1,
4,4033);K=new U(1,0,E,function(){return[b]},0,null);N={id:h.Wc++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(b){return 1==b?K:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:e,codecs:f||"",kind:d,encrypted:!1,keyId:null,language:c,label:g||null,type:n.Ja,primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,closedCaptions:null};h.Db.add(N);m.textStreams.push(N);return u(l,
ah(h.f,N),2);case 2:return(X=Zg(h.f,"text"))&&Qf(h.ha,m,X),h.Db["delete"](N),D("Choosing new streams after adding a text stream"),Wi(h,m),Ri(h),l["return"](le(N))}})})};Z.prototype.addTextTrack=Z.prototype.addTextTrack;Z.prototype.Re=function(b,c){this.Eb.width=b;this.Eb.height=c};Z.prototype.setMaxHardwareResolution=Z.prototype.Re;
Z.prototype.Dc=function(){if(this.h==Pi){var b=this.f;if(b.f)A("Unable to retry after StreamingEngine is destroyed!"),b=!1;else if(b.l)A("Unable to retry after StreamingEngine encountered a fatal error!"),b=!1;else{for(var c=r(b.b.values()),d=c.next();!d.done;d=c.next()){d=d.value;var e=jh(d);d.tb&&(C(e,"Retrying after failure..."),d.tb=!1,dh(b,d,.1))}b=!0}}else b=!1;return b};Z.prototype.retryStreaming=Z.prototype.Dc;Z.prototype.Sd=function(){return this.c};Z.prototype.getManifest=Z.prototype.Sd;
Z.prototype.Td=function(){return this.l?this.l.constructor:null};Z.prototype.getManifestParserFactory=Z.prototype.Td;function Ii(b,c,d,e){Rf(b.ha,c).variant=d;b=b.v.c;b.c!=d&&(b.c=d,b.a.push({timestamp:Date.now()/1E3,id:d.id,type:"variant",fromAdaptation:e,bandwidth:d.bandwidth}))}function bj(b,c,d,e){Qf(b.ha,c,d);b=b.v.c;b.b!=d&&(b.b=d,b.a.push({timestamp:Date.now()/1E3,id:d.id,type:"text",fromAdaptation:e,bandwidth:null}))}
function fi(b){var c=Wh();c.streaming.failureCallback=function(c){var d=[1001,1002,1003];b.$()&&d.includes(c.code)&&(c.severity=1,B("Live streaming error.  Retrying automatically..."),b.Dc())};c.textDisplayFactory=function(){return new Qh(b.a)};return c}
function Gi(b,c){for(var d=0;d<c.length;d++){for(var e=c[d],f=new Map,g=r(e.variants),h=g.next();!h.done;h=g.next())if(h=h.value,h.video&&h.video.closedCaptions){h=h.video;for(var k=r(h.closedCaptions.keys()),l=k.next();!l.done;l=k.next())if(l=l.value,!f.has(l)){var m={id:b.Wc++,originalId:l,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"application/cea-608",
codecs:"",kind:"caption",encrypted:!1,keyId:null,language:h.closedCaptions.get(l),label:null,type:"text",primary:!1,trickModeVideo:null,emsgSchemeIdUris:null,roles:h.roles,channelsCount:null,closedCaptions:null};f.set(l,m)}}f=r(f.values());for(g=f.next();!g.done;g=f.next())e.textStreams.push(g.value)}}
function Bi(b,c){var d=b.f?Yg(b.f):null,e=b.f?$g(b.f):null;c.forEach(he.bind(null,b.g,d,e));d=zb(c,function(b){return b.variants.some(pe)});if(0==d)throw new I(2,4,4032);if(d<c.length)throw new I(2,4,4011);c.forEach(function(b){ge(b.variants,this.b.restrictions,this.Eb)&&this.f&&Si(this)==b&&Ri(this);lj(this,b.variants)}.bind(b))}p=Z.prototype;
p.jc=function(b){var c=this.f?Yg(this.f):null,d=this.f?$g(this.f):null;he(this.g,c,d,b);c=b.variants;if(!c.some(pe))throw new I(2,4,4011);lj(this,b.variants);ge(c,this.b.restrictions,this.Eb)&&this.f&&Si(this)==b&&Ri(this);if(b=this.g?this.g.a:null)for(c=r(c),d=c.next();!d.done;d=c.next()){d=r(d.value.drmInfos);for(var e=d.next();!e.done;e=d.next())if(e=e.value,e.keySystem==b.keySystem){e=r(e.initData||[]);for(var f=e.next();!f.done;f=e.next())f=f.value,Nc(this.g,f.initDataType,f.initData)}}};
function ej(b,c,d,e){d=void 0===d?!1:d;e=void 0===e?0:e;b.bb?(b.xa=c,b.Sc=d,b.Pc=e):(gh(b.f,c,d,e),hj(b))}function cj(b,c){b.bb?b.ja=c:(fh(b.f,c,!0,0,!1),dj(b))}function Qi(b,c){function d(b,c){if(!b)return null;var d=b.findSegmentPosition(c-g.startTime);return null==d?null:(d=b.getSegmentReference(d))?d.startTime+g.startTime:null}var e=Yg(b.f),f=$g(b.f),g=Si(b);e=d(e,c);f=d(f,c);return null!=f&&null!=e?Math.max(f,e):null!=f?f:null!=e?e:c}
function zi(b){var c=b.Zc();if(b.v&&b.W&&b.s){var d=b.ca;d.f=c;yg(d);Fi(b)}b.dispatchEvent(new L("buffering",{buffering:c}))}function Fi(b){if(b.v&&b.W){var c=b.v.a;b.W.a==cg?$h(c,"buffering"):b.a.paused?$h(c,"paused"):b.a.ended?$h(c,"ended"):$h(c,"playing")}}function Ti(b,c){try{lj(b,c)}catch(e){return b.Fa(e),null}var d=c.filter(function(b){return pe(b)});d=b.Cb.create(d);b.j.setVariants(Array.from(d.values()));return b.j.chooseVariant()}
function Wi(b,c){var d=Ti(b,c.variants);d&&(Ii(b,c,d,!0),ej(b,d,!0));(d=re(c.textStreams,b.ia,b.Xa)[0]||null)&&(b.b.streaming.alwaysStreamText||b.Pb())&&(bj(b,c,d,!0),cj(b,d));Ji(b)}
p.ie=function(b){D("onChooseStreams_",b);try{G("onChooseStreams_, choosing variant from ",b.variants);G("onChooseStreams_, choosing text from ",b.textStreams);this.bb=!0;this.j.disable();Xi(this);D("Choosing new streams after period changed");var c=Ti(this,b.variants),d=re(b.textStreams,this.ia,this.Xa)[0]||null;this.xa&&(b.variants.includes(this.xa)&&(c=this.xa),this.xa=null);this.ja&&(b.textStreams.includes(this.ja)&&(d=this.ja),this.ja=null);c&&Ii(this,b,c,!0);d&&bj(this,b,d,!0);var e=this.f,f=
e.b.get("video");if(f)var g=e.c.periods[f.ka];else{var h=e.b.get("audio");g=h?e.c.periods[h.ka]:null}var k=c?c.audio:null;if(!g&&d){var l;if(l=k){b=d;var m=P(this.b.preferredTextLanguage),n=P(k.language),q=P(b.language);l=ae(q,m)&&!ae(n,q)}l&&(this.Ya=!0);this.Ya&&this.I.g.setTextVisibility(!0);kj(this)}var v=this.b.streaming.alwaysStreamText||this.Pb()?{variant:c,text:d}:{variant:c,text:null};G("onChooseStreams_, chose variant ",v.variant);G("onChooseStreams_, chose text ",v.text);return v}catch(x){return this.Fa(x),
{variant:null,text:null}}};p.Cd=function(){D("canSwitch_");this.bb=!1;this.b.abr.enabled&&(this.j.enable(),Xi(this));this.xa&&(gh(this.f,this.xa,this.Sc,this.Pc),hj(this),this.xa=null);this.ja&&(fh(this.f,this.ja,!0,0,!1),dj(this),this.ja=null)};p.me=function(){this.l&&this.l.update&&this.l.update()};p.qe=function(){this.s&&this.s.s()};function Ji(b){mj(b,new L("adaptation"))}function Ri(b){mj(b,new L("trackschanged"))}function hj(b){mj(b,new L("variantchanged"))}
function dj(b){mj(b,new L("textchanged"))}function kj(b){mj(b,new L("texttrackvisibility"))}function Xi(b){mj(b,new L("abrstatuschanged",{jf:b.b.abr.enabled}))}p.Fa=function(b){if(this.h!=ri){var c=new L("error",{detail:b});this.dispatchEvent(c);c.defaultPrevented&&(b.handled=!0)}};function Ai(b,c,d){b.dispatchEvent(new L(c,{detail:{schemeIdUri:d.schemeIdUri,value:d.value,startTime:d.startTime,endTime:d.endTime,id:d.id,eventElement:d.eventElement}}))}
function yi(b){if(!b.a.error)return null;var c=b.a.error.code;if(1==c)return null;var d=b.a.error.msExtendedCode;d&&(0>d&&(d+=Math.pow(2,32)),d=d.toString(16));return new I(2,3,3016,c,d,b.a.error.message)}
function Di(b,c){if(b.f){var d=Si(b),e=!1,f=Object.keys(c);0==f.length&&B("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var g=1==f.length&&"00"==f[0];g&&B("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");f.length&&d.variants.forEach(function(b){ue(b).forEach(function(d){var f=
b.allowedByKeySystem;d.keyId&&(d=c[g?"00":d.keyId],b.allowedByKeySystem=!!d&&!ti.includes(d));f!=b.allowedByKeySystem&&(e=!0)})});f=Yg(b.f);var h=$g(b.f);(f=te(f,h,d.variants))&&!f.allowedByKeySystem&&(D("Choosing new streams after key status changed"),Wi(b,d));e&&(Ri(b),Ti(b,d.variants))}}function Ei(b,c,d){if(b.l&&b.l.onExpirationUpdated)b.l.onExpirationUpdated(c,d);b.dispatchEvent(new L("expirationupdated"))}
function Hi(b,c,d){0<c&&(b.$()?B("|playRangeStart| has been configured for live content. Ignoring the setting."):b.td(c));d<b.Z()&&(b.$()?B("|playRangeEnd| has been configured for live content. Ignoring the setting."):b.Ra(d))}
function lj(b,c){var d=b.g?ac(b.g.ba):{},e=Object.keys(d);e=e.length&&"00"==e[0];for(var f=!1,g=!1,h=[],k=[],l=r(c),m=l.next();!m.done;m=l.next()){m=m.value;var n=[];m.audio&&n.push(m.audio);m.video&&n.push(m.video);n=r(n);for(var q=n.next();!q.done;q=n.next())if(q=q.value,q.keyId){var v=d[e?"00":q.keyId];v?ti.includes(v)&&(k.includes(v)||k.push(v)):h.includes(q.keyId)||h.push(q.keyId)}m.allowedByApplication?m.allowedByKeySystem&&(f=!0):g=!0}if(!f)throw new I(2,4,4012,{hasAppRestrictions:g,missingKeys:h,
restrictedKeyStatuses:k});}function mj(b,c){t(function e(){return y(e,function(e){switch(e.m){case 1:return u(e,Promise.resolve(),2);case 2:b.h!=ri&&b.dispatchEvent(c),w(e)}})})}function jj(b){var c=new Set;b=r(b);for(var d=b.next();!d.done;d=b.next())d=d.value,d.language?c.add(P(d.language)):c.add("und");return c}
function ij(b){var c=new Map;b=r(b);for(var d=b.next();!d.done;d=b.next()){var e=d.value;d="und";var f=[];e.language&&(d=P(e.language));"variant"==e.type?f=e.audioRoles:f=e.roles;f&&f.length||(f=[""]);c.has(d)||c.set(d,new Set);e=r(f);for(f=e.next();!f.done;f=e.next())f=f.value,c.get(d).add(f)}var g=[];c.forEach(function(b,c){for(var d=r(b),e=d.next();!e.done;e=d.next())g.push({language:c,role:e.value})});return g}
function Zi(b){b=Si(b);return null==b?[]:b.variants.filter(function(b){return pe(b)})}function aj(b){var c=Si(b);return null==c?[]:c.textStreams.filter(function(c){return!b.Db.has(c)})}function Si(b){var c=b.s.h(),d=null;b=r(b.c.periods);for(var e=b.next();!e.done;e=b.next())e=e.value,e.startTime<=c&&(d=e);return d}function Yi(b){var c=Si(b);return Rf(b.ha,c).variant}
function $i(b){var c=Si(b);if(null==c)return null;if(!Rf(b.ha,c).text){var d=re(c.textStreams,b.ia,b.Xa);d.length&&Qf(b.ha,c,d[0])}return Rf(b.ha,c).text}function vi(){return new I(2,7,7E3)}function qi(b,c,d,e,f,g){return e==b&&f.o==g.o&&f.uri==g.uri&&f.mimeType==g.mimeType&&f.ra==g.ra?c:d}function Lh(){return{ra:null,o:null,mimeType:null,startTime:null,Hc:null,uri:null}}
function wi(b){return new Promise(function(c,d){b.Pa=function(){return d(vi())};b.Ub=function(){return c()};b.onError=function(b){return d(b)};b.Vb=function(){return d(vi())}})}var ri=0,ei=1,Pi=2,Ui=3;Z.LoadMode={DESTROYED:ri,NOT_LOADED:ei,MEDIA_SOURCE:Pi,SRC_EQUALS:Ui};z("shaka.polyfill.installAll",function(){for(var b=0;b<nj.length;++b)nj[b].Bd()});var nj=[];function oj(b,c){c=c||0;for(var d={priority:c,Bd:b},e=0;e<nj.length;e++)if(nj[e].priority<c){nj.splice(e,0,d);return}nj.push(d)}z("shaka.polyfill.register",oj);function pj(b,c,d){if("input"==b)switch(this.type){case "range":b="change"}HTMLInputElement.prototype.originalAddEventListener.call(this,b,c,d)}oj(function(){D("InputEvent.install");ic("Trident/")&&!HTMLInputElement.prototype.originalAddEventListener&&(C("Patching input event support on IE."),HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=pj)});oj(function(){navigator.languages||Object.defineProperty(navigator,"languages",{get:function(){return navigator.language?[navigator.language]:["en"]}})});oj(function(){D("mathRound.install")});function qj(){var b=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(c){for(var d=[],e=0;e<arguments.length;++e)d[e]=arguments[e];d=b.apply(this,d);d.abort=function(){};return d}}function rj(){var b=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(c,d){return b.call(this,c,d-.001)}}
function sj(){var b=MediaSource.prototype.endOfStream;MediaSource.prototype.endOfStream=function(c){for(var d=[],e=0;e<arguments.length;++e)d[e]=arguments[e];for(var h=e=0;h<this.sourceBuffers.length;++h){var k=this.sourceBuffers[h];k=k.buffered.end(k.buffered.length-1);e=Math.max(e,k)}if(!isNaN(this.duration)&&e<this.duration)for(this.Xc=!0,e=0;e<this.sourceBuffers.length;++e)this.sourceBuffers[e].Qc=!1;return b.apply(this,d)};var c=!1,d=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=
function(b){for(var e=[],g=0;g<arguments.length;++g)e[g]=arguments[g];e=d.apply(this,e);e.mediaSource_=this;e.addEventListener("updateend",tj,!1);c||(this.addEventListener("sourceclose",uj,!1),c=!0);return e}}function tj(b){var c=b.target,d=c.mediaSource_;if(d.Xc){b.preventDefault();b.stopPropagation();b.stopImmediatePropagation();c.Qc=!0;for(b=0;b<d.sourceBuffers.length;++b)if(0==d.sourceBuffers[b].Qc)return;d.Xc=!1}}
function uj(b){b=b.target;for(var c=0;c<b.sourceBuffers.length;++c)b.sourceBuffers[c].removeEventListener("updateend",tj,!1);b.removeEventListener("sourceclose",uj,!1)}function vj(){var b=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(c){return"mp2t"==c.split(/ *; */)[0].split("/")[1].toLowerCase()?!1:b(c)}}function wj(){var b=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(c){return"opus"!=ec(c)[0]&&b(c)}}
function xj(){var b=MediaSource.isTypeSupported,c=/^dv(?:h[e1]|a[v1])\./;MediaSource.isTypeSupported=function(d){for(var e=d.split(/ *; */),f=e[0],g={},h=1;h<e.length;++h){var k=e[h].split("="),l=k[0];k=k[1].replace(/"(.*)"/,"$1");g[l]=k}e=g.codecs;if(!e)return b(d);var m=!1,n=!1;d=e.split(",").filter(function(b){c.test(b)&&(n=!0);/^(hev|hvc)1\.2/.test(b)&&(m=!0);return!0});n&&(m=!1);g.codecs=d.join(",");m&&(g.eotf="smpte2084");for(var q in g)f+="; "+q+'="'+g[q]+'"';return cast.__platform__.canDisplayType(f)}}
oj(function(){D("MediaSource.install");if(window.MediaSource)if(window.cast&&cast.__platform__&&cast.__platform__.canDisplayType)C("Patching Chromecast MSE bugs."),xj();else if(navigator.vendor&&navigator.vendor.includes("Apple")){var b=navigator.appVersion;vj();if(b.includes("Version/8"))C("Blacklisting Safari 8 MSE."),window.MediaSource=null;else if(b.includes("Version/9"))C("Patching Safari 9 MSE bugs."),qj();else if(b.includes("Version/10"))C("Patching Safari 10 MSE bugs."),qj(),sj();else if(b.includes("Version/11")||
b.includes("Version/12"))C("Patching Safari 11/12 MSE bugs."),qj(),rj()}else ic("Tizen")?wj():C("Using native MSE as-is.");else C("No MSE implementation available.")});function yj(b,c){D("PatchedMediaKeysMs.requestMediaKeySystemAccess");try{var d=new zj(b,c);return Promise.resolve(d)}catch(e){return Promise.reject(e)}}
function zj(b,c){D("PatchedMediaKeysMs.MediaKeySystemAccess");this.keySystem=b;for(var d=!1,e=0;e<c.length;++e){var f=c[e],g={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:f.initDataTypes,sessionTypes:["temporary"],label:f.label},h=!1;if(f.audioCapabilities)for(var k=0;k<f.audioCapabilities.length;++k){var l=f.audioCapabilities[k];if(l.contentType){h=!0;var m=l.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,
m)&&(g.audioCapabilities.push(l),d=!0)}}if(f.videoCapabilities)for(k=0;k<f.videoCapabilities.length;++k)l=f.videoCapabilities[k],l.contentType&&(h=!0,m=l.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,m)&&(g.videoCapabilities.push(l),d=!0));h||(d=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));"required"==f.persistentState&&(d=!1);if(d){this.a=g;return}}d=Error("Unsupported keySystem");d.name="NotSupportedError";d.code=DOMException.NOT_SUPPORTED_ERR;throw d;}
zj.prototype.createMediaKeys=function(){D("PatchedMediaKeysMs.MediaKeySystemAccess.createMediaKeys");var b=new Aj(this.keySystem);return Promise.resolve(b)};zj.prototype.getConfiguration=function(){D("PatchedMediaKeysMs.MediaKeySystemAccess.getConfiguration");return this.a};function Bj(b){D("PatchedMediaKeysMs.setMediaKeys");var c=this.mediaKeys;c&&c!=b&&Cj(c,null);delete this.mediaKeys;return(this.mediaKeys=b)?Cj(b,this):Promise.resolve()}
function Aj(b){D("PatchedMediaKeysMs.MediaKeys");this.a=new MSMediaKeys(b);this.b=new O}Aj.prototype.createSession=function(b){D("PatchedMediaKeysMs.MediaKeys.createSession");b=b||"temporary";if("temporary"!=b)throw new TypeError("Session type "+b+" is unsupported on this platform.");return new Dj(this.a,b)};Aj.prototype.setServerCertificate=function(){D("PatchedMediaKeysMs.MediaKeys.setServerCertificate");return Promise.resolve(!1)};
function Cj(b,c){function d(){c.msSetMediaKeys(e.a);c.removeEventListener("loadedmetadata",d)}b.b.yb();if(!c)return Promise.resolve();b.b.w(c,"msneedkey",Ej);var e=b;try{return 1<=c.readyState?c.msSetMediaKeys(b.a):c.addEventListener("loadedmetadata",d),Promise.resolve()}catch(f){return Promise.reject(f)}}
function Dj(b){D("PatchedMediaKeysMs.MediaKeySession");wb.call(this);this.c=null;this.g=b;this.b=this.a=null;this.f=new O;this.sessionId="";this.expiration=NaN;this.closed=new mb;this.keyStatuses=new Fj}Ka(Dj,wb);p=Dj.prototype;
p.generateRequest=function(b,c){D("PatchedMediaKeysMs.MediaKeySession.generateRequest");this.a=new mb;try{this.c=this.g.createSession("video/mp4",new Uint8Array(c),null),this.f.w(this.c,"mskeymessage",this.pe.bind(this)),this.f.w(this.c,"mskeyadded",this.ne.bind(this)),this.f.w(this.c,"mskeyerror",this.oe.bind(this)),Gj(this,"status-pending")}catch(d){this.a.reject(d)}return this.a};p.load=function(){D("PatchedMediaKeysMs.MediaKeySession.load");return Promise.reject(Error("MediaKeySession.load not yet supported"))};
p.update=function(b){D("PatchedMediaKeysMs.MediaKeySession.update");this.b=new mb;try{this.c.update(new Uint8Array(b))}catch(c){this.b.reject(c)}return this.b};p.close=function(){D("PatchedMediaKeysMs.MediaKeySession.close");try{this.c.close(),this.closed.resolve(),this.f.yb()}catch(b){this.closed.reject(b)}return this.closed};p.remove=function(){D("PatchedMediaKeysMs.MediaKeySession.remove");return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};
function Ej(b){D("PatchedMediaKeysMs.onMsNeedKey_",b);if(b.initData){var c=document.createEvent("CustomEvent");c.initCustomEvent("encrypted",!1,!1,null);c.initDataType="cenc";c.initData=Hj(b.initData);this.dispatchEvent(c)}}
function Hj(b){if(!b)return b;var c=new De(b);if(1>=c.a.length)return b;for(var d=[],e=0;e<c.a.length;e++)d.push(b.subarray(c.a[e].start,c.a[e].end+1));b=[];c={};e=r(d);for(d=e.next();!d.done;c={Ob:c.Ob},d=e.next())c.Ob=d.value,b.some(function(b){return function(c){return uc(c,b.Ob)}}(c))||b.push(c.Ob);c=0;e=r(b);for(d=e.next();!d.done;d=e.next())c+=d.value.length;c=new Uint8Array(c);e=0;b=r(b);for(d=b.next();!d.done;d=b.next())d=d.value,c.set(d,e),e+=d.length;return c}
p.pe=function(b){D("PatchedMediaKeysMs.onMsKeyMessage_",b);this.a&&(this.a.resolve(),this.a=null);this.dispatchEvent(new L("message",{messageType:void 0==this.keyStatuses.a?"license-request":"license-renewal",message:b.message.buffer}))};p.ne=function(b){D("PatchedMediaKeysMs.onMsKeyAdded_",b);this.a?(D("Simulating completion for a PR persistent license."),Gj(this,"usable"),this.a.resolve(),this.a=null):this.b&&(Gj(this,"usable"),this.b.resolve(),this.b=null)};
p.oe=function(b){D("PatchedMediaKeysMs.onMsKeyError_",b);b=Error("EME PatchedMediaKeysMs key error");b.errorCode=this.c.error;if(null!=this.a)this.a.reject(b),this.a=null;else if(null!=this.b)this.b.reject(b),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:Gj(this,"output-not-allowed");break;default:Gj(this,"internal-error")}};
function Gj(b,c){var d=b.keyStatuses;d.size=void 0==c?0:1;d.a=c;b.dispatchEvent(new L("keystatuseschange"))}function Fj(){this.size=0;this.a=void 0}var Ij;p=Fj.prototype;p.forEach=function(b){this.a&&b(this.a,Ij)};p.get=function(b){if(this.has(b))return this.a};p.has=function(b){var c=Ij;return this.a&&uc(new Uint8Array(b),new Uint8Array(c))?!0:!1};p.entries=function(){};p.keys=function(){};p.values=function(){};
oj(function(){!window.HTMLVideoElement||!window.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(C("Using ms-prefixed EME v20140218"),Ij=(new Uint8Array([0])).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Bj,window.MediaKeys=Aj,window.MediaKeySystemAccess=zj,navigator.requestMediaKeySystemAccess=yj)});function Jj(){D("PatchedMediaKeysNop.requestMediaKeySystemAccess");return Promise.reject(Error("The key system specified is not supported."))}function Kj(b){D("PatchedMediaKeysNop.setMediaKeys");return null==b?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function Lj(){throw new TypeError("Illegal constructor.");}Lj.prototype.createSession=function(){};Lj.prototype.setServerCertificate=function(){};function Mj(){throw new TypeError("Illegal constructor.");}
Mj.prototype.getConfiguration=function(){};Mj.prototype.createMediaKeys=function(){};oj(function(){!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(C("EME not available."),navigator.requestMediaKeySystemAccess=Jj,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Kj,window.MediaKeys=Lj,window.MediaKeySystemAccess=Mj)},-10);var Nj="";function Oj(b){var c=Nj;return c?c+b.charAt(0).toUpperCase()+b.slice(1):b}function Pj(b,c){D("PatchedMediaKeysWebkit.requestMediaKeySystemAccess");try{var d=new Qj(b,c);return Promise.resolve(d)}catch(e){return Promise.reject(e)}}function Rj(b){D("PatchedMediaKeysWebkit.setMediaKeys");var c=this.mediaKeys;c&&c!=b&&Sj(c,null);delete this.mediaKeys;(this.mediaKeys=b)&&Sj(b,this);return Promise.resolve()}
function Qj(b,c){D("PatchedMediaKeysWebkit.MediaKeySystemAccess");this.a=this.keySystem=b;var d=!1;"org.w3.clearkey"==b&&(this.a="webkit-org.w3.clearkey",d=!1);var e=!1;var f=document.getElementsByTagName("video");f=f.length?f[0]:document.createElement("video");for(var g=0;g<c.length;++g){var h=c[g],k={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:h.initDataTypes,sessionTypes:["temporary"],label:h.label},l=!1;if(h.audioCapabilities)for(var m=
0;m<h.audioCapabilities.length;++m){var n=h.audioCapabilities[m];if(n.contentType){l=!0;var q=n.contentType.split(";")[0];f.canPlayType(q,this.a)&&(k.audioCapabilities.push(n),e=!0)}}if(h.videoCapabilities)for(m=0;m<h.videoCapabilities.length;++m)n=h.videoCapabilities[m],n.contentType&&(l=!0,f.canPlayType(n.contentType,this.a)&&(k.videoCapabilities.push(n),e=!0));l||(e=f.canPlayType("video/mp4",this.a)||f.canPlayType("video/webm",this.a));"required"==h.persistentState&&(d?(k.persistentState="required",
k.sessionTypes=["persistent-license"]):e=!1);if(e){this.b=k;return}}d="Unsupported keySystem";if("org.w3.clearkey"==b||"com.widevine.alpha"==b)d="None of the requested configurations were supported.";d=Error(d);d.name="NotSupportedError";d.code=DOMException.NOT_SUPPORTED_ERR;throw d;}Qj.prototype.createMediaKeys=function(){D("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var b=new Tj(this.a);return Promise.resolve(b)};
Qj.prototype.getConfiguration=function(){D("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration");return this.b};function Tj(b){D("PatchedMediaKeysWebkit.MediaKeys");this.g=b;this.b=null;this.a=new O;this.c=[];this.f={}}function Sj(b,c){b.b=c;b.a.yb();var d=Nj;c&&(b.a.w(c,d+"needkey",b.ve.bind(b)),b.a.w(c,d+"keymessage",b.ue.bind(b)),b.a.w(c,d+"keyadded",b.se.bind(b)),b.a.w(c,d+"keyerror",b.te.bind(b)))}p=Tj.prototype;
p.createSession=function(b){D("PatchedMediaKeysWebkit.MediaKeys.createSession");b=b||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+b+" is unsupported on this platform.");var c=this.b||document.createElement("video");c.src||(c.src="about:blank");b=new Uj(c,this.g,b);this.c.push(b);return b};p.setServerCertificate=function(){D("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate");return Promise.resolve(!1)};
p.ve=function(b){D("PatchedMediaKeysWebkit.onWebkitNeedKey_",b);var c=document.createEvent("CustomEvent");c.initCustomEvent("encrypted",!1,!1,null);c.initDataType="webm";c.initData=b.initData;this.b.dispatchEvent(c)};
p.ue=function(b){D("PatchedMediaKeysWebkit.onWebkitKeyMessage_",b);var c=Vj(this,b.sessionId);c?(b=new L("message",{messageType:void 0==c.keyStatuses.a?"licenserequest":"licenserenewal",message:b.message}),D("PatchedMediaKeysWebkit.MediaKeySession.generated"),c.b&&(c.b.resolve(),c.b=null),c.dispatchEvent(b)):A("Session not found",b.sessionId)};
p.se=function(b){D("PatchedMediaKeysWebkit.onWebkitKeyAdded_",b);if(b=Vj(this,b.sessionId))D("PatchedMediaKeysWebkit.MediaKeySession.ready"),Wj(b,"usable"),b.a&&b.a.resolve(),b.a=null};p.te=function(b){D("PatchedMediaKeysWebkit.onWebkitKeyError_",b);var c=Vj(this,b.sessionId);c&&c.handleError(b)};function Vj(b,c){var d=b.f[c];return d?(D("PatchedMediaKeysWebkit.MediaKeys.findSession_",d),d):(d=b.c.shift())?(d.sessionId=c,b.f[c]=d,D("PatchedMediaKeysWebkit.MediaKeys.findSession_",d),d):null}
function Uj(b,c,d){D("PatchedMediaKeysWebkit.MediaKeySession");wb.call(this);this.f=b;this.h=!1;this.a=this.b=null;this.c=c;this.g=d;this.sessionId="";this.expiration=NaN;this.closed=new mb;this.keyStatuses=new Xj}Ka(Uj,wb);p=Uj.prototype;
p.handleError=function(b){D("PatchedMediaKeysWebkit.MediaKeySession.handleError",b);var c=Error("EME v0.1b key error");c.errorCode=b.errorCode;c.errorCode.systemCode=b.systemCode;!b.sessionId&&this.b?(c.method="generateRequest",45==b.systemCode&&(c.message="Unsupported session type."),this.b.reject(c),this.b=null):b.sessionId&&this.a?(c.method="update",this.a.reject(c),this.a=null):(c=b.systemCode,b.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Wj(this,"output-restricted"):1==c?Wj(this,"expired"):
Wj(this,"internal-error"))};
function Yj(b,c,d){if(b.h)return Promise.reject(Error("The session is already initialized."));b.h=!0;try{if("persistent-license"==b.g)if(d)var e=new Uint8Array(oc("LOAD_SESSION|"+d));else{var f=oc("PERSISTENT|"),g=new Uint8Array(f.byteLength+c.byteLength);g.set(new Uint8Array(f),0);g.set(new Uint8Array(c),f.byteLength);e=g}else e=new Uint8Array(c)}catch(k){return Promise.reject(k)}b.b=new mb;var h=Oj("generateKeyRequest");try{b.f[h](b.c,e)}catch(k){if("InvalidStateError"!=k.name)return b.b=null,Promise.reject(k);
(new H(function(){try{b.f[h](b.c,e)}catch(l){b.b.reject(l),b.b=null}})).V(.01)}return b.b}
p.Gc=function(b,c){if(this.a)this.a.then(this.Gc.bind(this,b,c))["catch"](this.Gc.bind(this,b,c));else{this.a=b;if("webkit-org.w3.clearkey"==this.c){var d=lc(c);var e=JSON.parse(d);"oct"!=e.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null);d=rc(e.keys[0].k);e=rc(e.keys[0].kid)}else d=new Uint8Array(c),e=null;var f=Oj("addKey");try{this.f[f](this.c,d,e,this.sessionId)}catch(g){this.a.reject(g),this.a=null}}};
function Wj(b,c){var d=b.keyStatuses;d.size=void 0==c?0:1;d.a=c;b.dispatchEvent(new L("keystatuseschange"))}p.generateRequest=function(b,c){D("PatchedMediaKeysWebkit.MediaKeySession.generateRequest");return Yj(this,c,null)};p.load=function(b){D("PatchedMediaKeysWebkit.MediaKeySession.load");return"persistent-license"==this.g?Yj(this,null,b):Promise.reject(Error("Not a persistent session."))};p.update=function(b){D("PatchedMediaKeysWebkit.MediaKeySession.update",b);var c=new mb;this.Gc(c,b);return c};
p.close=function(){D("PatchedMediaKeysWebkit.MediaKeySession.close");if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var b=Oj("cancelKeyRequest");try{this.f[b](this.c,this.sessionId)}catch(c){}}this.closed.resolve();return this.closed};p.remove=function(){D("PatchedMediaKeysWebkit.MediaKeySession.remove");return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()};
function Xj(){this.size=0;this.a=void 0}var Zj;p=Xj.prototype;p.forEach=function(b){this.a&&b(this.a,Zj)};p.get=function(b){if(this.has(b))return this.a};p.has=function(b){var c=Zj;return this.a&&uc(new Uint8Array(b),new Uint8Array(c))?!0:!1};p.entries=function(){};p.keys=function(){};p.values=function(){};
oj(function(){if(!(!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)C("Using webkit-prefixed EME v0.1b"),Nj="webkit";else if(HTMLMediaElement.prototype.generateKeyRequest)C("Using nonprefixed EME v0.1b");else return;Zj=(new Uint8Array([0])).buffer;navigator.requestMediaKeySystemAccess=Pj;delete HTMLMediaElement.prototype.mediaKeys;HTMLMediaElement.prototype.mediaKeys=null;HTMLMediaElement.prototype.setMediaKeys=
Rj;window.MediaKeys=Tj;window.MediaKeySystemAccess=Qj}});oj(function(){D("VideoPlayPromise.install");if(window.HTMLMediaElement){var b=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var c=b.apply(this);c&&c["catch"](function(){});return c}}});function ak(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}oj(function(){if(window.HTMLVideoElement){var b=HTMLVideoElement.prototype;!b.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in b&&(b.getVideoPlaybackQuality=ak)}});function bk(b,c,d){return new window.TextTrackCue(b,c,d)}function ck(b,c,d){return new window.TextTrackCue(b+"-"+c+"-"+d,b,c,d)}
oj(function(){if(window.VTTCue)C("Using native VTTCue.");else if(window.TextTrackCue){var b=TextTrackCue.length;if(3==b)C("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=bk;else if(6==b)C("Using VTTCue polyfill from 6 argument TextTrackCue."),window.VTTCue=ck;else{try{var c=!!bk(1,2,"")}catch(d){c=!1}c&&(C("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=bk)}}else A("VTTCue not available.")});function dk(){}dk.prototype.parseInit=function(){};
dk.prototype.parseMedia=function(b,c){var d=lc(b),e=[],f=new DOMParser,g=null;try{g=f.parseFromString(d,"text/xml")}catch(Va){throw new I(2,2,2005);}if(g){if(g=g.getElementsByTagName("tt")[0]){var h=T.getAttributeNS(g,"http://www.w3.org/ns/ttml#parameter","frameRate");var k=T.getAttributeNS(g,"http://www.w3.org/ns/ttml#parameter","subFrameRate");var l=T.getAttributeNS(g,"http://www.w3.org/ns/ttml#parameter","frameRateMultiplier");var m=T.getAttributeNS(g,"http://www.w3.org/ns/ttml#parameter","tickRate");
d=g.getAttribute("xml:space")||"default";f=g.getAttribute("tts:extent")}else throw new I(2,2,2005);if("default"!=d&&"preserve"!=d)throw new I(2,2,2005);d="default"==d;h=new ek(h,k,l,m);k=fk(g.getElementsByTagName("metadata")[0]);l=fk(g.getElementsByTagName("styling")[0]);m=fk(g.getElementsByTagName("layout")[0]);for(var n=[],q=0;q<m.length;q++){var v=m[q],x=l,E=f;var K=new sd;var N=v.getAttribute("xml:id");if(N){K.id=N;N=null;E&&(N=gk.exec(E)||hk.exec(E));E=N?Number(N[1]):null;N=N?Number(N[2]):null;
var X,ja;if(X=ik(v,x,"extent"))X=(ja=gk.exec(X))||hk.exec(X),null!=X&&(K.width=null!=E?100*Number(X[1])/E:Number(X[1]),K.height=null!=N?100*Number(X[2])/N:Number(X[2]),K.widthUnits=ja||null!=E?Fd:0,K.heightUnits=ja||null!=N?Fd:0);if(v=ik(v,x,"origin"))X=(ja=gk.exec(v))||hk.exec(v),null!=X&&(K.viewportAnchorX=null!=N?100*Number(X[1])/N:Number(X[1]),K.viewportAnchorY=null!=E?100*Number(X[2])/E:Number(X[2]),K.viewportAnchorUnits=ja||null!=E?Fd:0)}else B("TtmlTextParser parser encountered a region with no id. Region will be ignored."),
K=null;K&&n.push(K)}f=fk(g.getElementsByTagName("body")[0]);for(g=0;g<f.length;g++)(q=jk(f[g],c.periodStart,h,k,l,m,n,d))&&e.push(q)}return e};
var gk=/^(\d{1,2}|100)% (\d{1,2}|100)%$/,kk=/^(\d+px|\d+em)$/,hk=/^(\d+)px (\d+)px$/,lk=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,mk=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,nk=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,ok=/^(\d*(?:\.\d*)?)f$/,pk=/^(\d*(?:\.\d*)?)t$/,qk=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,rk={left:xd,center:"center",right:"end",start:xd,end:"end"},sk={left:"line-left",center:"center",right:"line-right"};
function fk(b){var c=[];if(!b)return c;for(var d=b.childNodes,e=0;e<d.length;e++){var f="span"==d[e].nodeName&&"p"==b.nodeName;d[e].nodeType!=Node.ELEMENT_NODE||"br"==d[e].nodeName||f||(f=fk(d[e]),c=c.concat(f))}c.length||c.push(b);return c}function tk(b,c){for(var d=b.childNodes,e=0;e<d.length;e++)if("br"==d[e].nodeName&&0<e)d[e-1].textContent+="\n";else if(0<d[e].childNodes.length)tk(d[e],c);else if(c){var f=d[e].textContent.trim();f=f.replace(/\s+/g," ");d[e].textContent=f}}
function jk(b,c,d,e,f,g,h,k){if(!b.hasAttribute("begin")&&!b.hasAttribute("end")&&/^\s*$/.test(b.textContent))return null;tk(b,k);k=uk(b.getAttribute("begin"),d);var l=uk(b.getAttribute("end"),d);d=uk(b.getAttribute("dur"),d);var m=b.textContent;null==l&&null!=d&&(l=k+d);if(null==k||null==l)throw new I(2,2,2001);c=new qd(k+c,l+c,m);if((g=vk(b,"region",g,""))&&g.getAttribute("xml:id")){var n=g.getAttribute("xml:id");h=h.filter(function(b){return b.id==n});c.region=h[0]}e=vk(b,"smpte:backgroundImage",
e,"#");wk(c,b,g,e,f);return c}
function wk(b,c,d,e,f){"rtl"==xk(c,d,f,"direction")&&(b.direction="rtl");var g=xk(c,d,f,"writingMode");"tb"==g||"tblr"==g?b.writingMode="vertical-lr":"tbrl"==g?b.writingMode="vertical-rl":"rltb"==g||"rl"==g?b.direction="rtl":g&&(b.direction=rd);if(g=xk(c,d,f,"textAlign"))b.positionAlign=sk[g],b.lineAlign=rk[g],b.textAlign=Bd[g.toUpperCase()];if(g=xk(c,d,f,"displayAlign"))b.displayAlign=Cd[g.toUpperCase()];if(g=xk(c,d,f,"color"))b.color=g;if(g=xk(c,d,f,"backgroundColor"))b.backgroundColor=g;if(g=xk(c,
d,f,"fontFamily"))b.fontFamily=g;(g=xk(c,d,f,"fontWeight"))&&"bold"==g&&(b.fontWeight=700);(g=xk(c,d,f,"wrapOption"))&&"noWrap"==g&&(b.wrapLine=!1);(g=xk(c,d,f,"lineHeight"))&&g.match(kk)&&(b.lineHeight=g);(g=xk(c,d,f,"fontSize"))&&g.match(kk)&&(b.fontSize=g);if(g=xk(c,d,f,"fontStyle"))b.fontStyle=Ed[g.toUpperCase()];if(e){g=e.getAttribute("imagetype");var h=e.getAttribute("encoding");e=e.textContent.trim();"PNG"==g&&"Base64"==h&&e&&(b.backgroundImage="data:image/png;base64,"+e)}(d=ik(d,f,"textDecoration"))&&
yk(b,d);(c=zk(c,f,"textDecoration"))&&yk(b,c)}
function yk(b,c){for(var d=c.split(" "),e=0;e<d.length;e++)switch(d[e]){case "underline":b.textDecoration.includes("underline")||b.textDecoration.push("underline");break;case "noUnderline":b.textDecoration.includes("underline")&&yb(b.textDecoration,"underline");break;case "lineThrough":b.textDecoration.includes("lineThrough")||b.textDecoration.push("lineThrough");break;case "noLineThrough":b.textDecoration.includes("lineThrough")&&yb(b.textDecoration,"lineThrough");break;case "overline":b.textDecoration.includes("overline")||
b.textDecoration.push("overline");break;case "noOverline":b.textDecoration.includes("overline")&&yb(b.textDecoration,"overline")}}function xk(b,c,d,e){return(b=zk(b,d,e))?b:ik(c,d,e)}function ik(b,c,d){for(var e=fk(b),f=0;f<e.length;f++){var g=T.getAttributeNS(e[f],"http://www.w3.org/ns/ttml#styling",d);if(g)return g}return(b=vk(b,"style",c,""))?T.getAttributeNS(b,"http://www.w3.org/ns/ttml#styling",d):null}
function zk(b,c,d){return(b=vk(b,"style",c,""))?T.getAttributeNS(b,"http://www.w3.org/ns/ttml#styling",d):null}function vk(b,c,d,e){if(!b||1>d.length)return null;var f=null,g=b;for(b=null;g&&!(b=g.getAttribute(c))&&(g=g.parentNode,g instanceof Element););if(c=b)for(b=0;b<d.length;b++)if(e+d[b].getAttribute("xml:id")==c){f=d[b];break}return f}
function uk(b,c){var d=null;if(lk.test(b)){d=lk.exec(b);var e=Number(d[1]),f=Number(d[2]),g=Number(d[3]),h=Number(d[4]);h+=(Number(d[5])||0)/c.b;g+=h/c.frameRate;d=g+60*f+3600*e}else mk.test(b)?d=Ak(mk,b):nk.test(b)?d=Ak(nk,b):ok.test(b)?(d=ok.exec(b),d=Number(d[1])/c.frameRate):pk.test(b)?(d=pk.exec(b),d=Number(d[1])/c.a):qk.test(b)&&(d=Ak(qk,b));return d}
function Ak(b,c){var d=b.exec(c);return null==d||""==d[0]?null:(Number(d[4])||0)/1E3+(Number(d[3])||0)+60*(Number(d[2])||0)+3600*(Number(d[1])||0)}function ek(b,c,d,e){this.frameRate=Number(b)||30;this.b=Number(c)||1;this.a=Number(e);0==this.a&&(this.a=b?this.frameRate*this.b:1);d&&(b=/^(\d+) (\d+)$/g.exec(d))&&(this.frameRate*=Number(b[1])/Number(b[2]))}Id["application/ttml+xml"]=dk;function Bk(){this.a=new dk}Bk.prototype.parseInit=function(b){var c=!1;(new S).K("moov",Ae).K("trak",Ae).K("mdia",Ae).K("minf",Ae).K("stbl",Ae).na("stsd",Be).K("stpp",function(b){c=!0;b.parser.stop()}).parse(b);if(!c)throw new I(2,2,2007);};Bk.prototype.parseMedia=function(b,c){var d=!1,e=[];(new S).K("mdat",Ce(function(b){d=!0;e=e.concat(this.a.parseMedia(b,c))}.bind(this))).parse(b);if(!d)throw new I(2,2,2007);return e};Id['application/mp4; codecs="stpp"']=Bk;
Id['application/mp4; codecs="stpp.TTML.im1t"']=Bk;function Ck(b){this.b=b;this.a=0}function Dk(b){Ek(b,/[ \t]+/gm)}function Ek(b,c){c.lastIndex=b.a;var d=c.exec(b.b);d=null==d?null:{position:d.index,length:d[0].length,Ie:d};if(b.a==b.b.length||null==d||d.position!=b.a)return null;b.a+=d.length;return d.Ie}function Fk(b){return b.a==b.b.length?null:(b=Ek(b,/[^ \t\n]*/gm))?b[0]:null};function Gk(){}Gk.prototype.parseInit=function(){};
Gk.prototype.parseMedia=function(b,c){var d=lc(b);d=d.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n");d=d.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(d[0]))throw new I(2,2,2E3);var e=c.segmentStart;if(null==e&&(e=0,d[0].includes("X-TIMESTAMP-MAP"))){var f=d[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),g=d[0].match(/MPEGTS:(\d+)/m);if(f&&g){e=Hk(new Ck(f[1]));if(null==e)throw new I(2,2,2E3);e=c.periodStart+(Number(g[1])/9E4-e)}}g=[];var h=d[0].split("\n");for(f=1;f<h.length;f++)if(/^Region:/.test(h[f])){var k=
new Ck(h[f]),l=new sd;Fk(k);Dk(k);for(var m=Fk(k);m;){var n;a:{var q=l,v=m;if(n=/^id=(.*)$/.exec(v))q.id=n[1];else if(n=/^width=(\d{1,2}|100)%$/.exec(v))q.width=Number(n[1]);else if(n=/^lines=(\d+)$/.exec(v))q.height=Number(n[1]),q.heightUnits=2;else if(n=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(v))q.regionAnchorX=Number(n[1]),q.regionAnchorY=Number(n[2]);else if(n=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(v))q.viewportAnchorX=Number(n[1]),q.viewportAnchorY=Number(n[2]);else if(/^scroll=up$/.exec(v))q.scroll=
"up";else{n=!1;break a}n=!0}n||B("VTT parser encountered an invalid VTTRegion setting: ",m," The setting will be ignored.");Dk(k);m=Fk(k)}g.push(l)}f=[];for(k=1;k<d.length;k++){h=d[k].split("\n");n=h;q=e;h=g;if(1==n.length&&!n[0]||/^NOTE($|[ \t])/.test(n[0])||"STYLE"==n[0])h=null;else{l=null;n[0].includes("--\x3e")||(l=n[0],n.splice(0,1));m=new Ck(n[0]);v=Hk(m);var x=Ek(m,/[ \t]+--\x3e[ \t]+/g),E=Hk(m);if(null==v||null==x||null==E)throw new I(2,2,2001);n=new qd(v+q,E+q,n.slice(1).join("\n").trim());
Dk(m);for(q=Fk(m);q;)Ik(n,q,h)||B("VTT parser encountered an invalid VTT setting: ",q," The setting will be ignored."),Dk(m),q=Fk(m);null!=l&&(n.id=l);h=n}h&&f.push(h)}return f};
function Ik(b,c,d){var e;if(e=/^align:(start|middle|center|end|left|right)$/.exec(c))c=e[1],"middle"==c?b.textAlign=ud:b.textAlign=Bd[c.toUpperCase()];else if(e=/^vertical:(lr|rl)$/.exec(c))b.writingMode="lr"==e[1]?"vertical-lr":"vertical-rl";else if(e=/^size:([\d.]+)%$/.exec(c))b.size=Number(e[1]);else if(e=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(c))b.position=Number(e[1]),e[2]&&(c=e[2],b.positionAlign="line-left"==c||"start"==c?"line-left":"line-right"==c||"end"==
c?"line-right":"center");else if(e=/^region:(.*)$/.exec(c)){if(c=Jk(d,e[1]))b.region=c}else{a:{if(d=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(c))b.lineInterpretation=1,b.line=Number(d[1]),d[2]&&(b.lineAlign=Dd[d[2].toUpperCase()]);else if(d=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(c))b.lineInterpretation=wd,b.line=Number(d[1]),d[2]&&(b.lineAlign=Dd[d[2].toUpperCase()]);else{b=!1;break a}b=!0}return b}return!0}
function Jk(b,c){var d=b.filter(function(b){return b.id==c});return d.length?d[0]:(B("VTT parser could not find a region with id: ",c," The region will be ignored."),null)}function Hk(b){b=Ek(b,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g);if(null==b)return null;var c=Number(b[2]),d=Number(b[3]);return 59<c||59<d?null:Number(b[4])/1E3+d+60*c+3600*(Number(b[1])||0)}Id["text/vtt"]=Gk;Id['text/vtt; codecs="vtt"']=Gk;function Kk(){this.a=null}Kk.prototype.parseInit=function(b){var c=!1;(new S).K("moov",Ae).K("trak",Ae).K("mdia",Ae).na("mdhd",function(b){0==b.version?(b.reader.H(4),b.reader.H(4),this.a=b.reader.B(),b.reader.H(4)):(b.reader.H(8),b.reader.H(8),this.a=b.reader.B(),b.reader.H(8));b.reader.H(4)}.bind(this)).K("minf",Ae).K("stbl",Ae).na("stsd",Be).K("wvtt",function(){c=!0}).parse(b);if(!this.a)throw new I(2,2,2008);if(!c)throw new I(2,2,2008);};
Kk.prototype.parseMedia=function(b,c){var d=this;if(!this.a)throw A("No init segment for MP4+VTT!"),new I(2,2,2008);var e=0,f=[],g,h=[],k=!1,l=!1,m=!1,n=null;(new S).K("moof",Ae).K("traf",Ae).na("tfdt",function(b){k=!0;e=0==b.version?b.reader.B():b.reader.xb()}).na("tfhd",function(b){var c=b.flags;b=b.reader;b.H(4);c&1&&b.H(8);c&2&&b.H(4);n=c&8?b.B():null}).na("trun",function(b){l=!0;var c=b.version,d=b.flags;b=b.reader;var e=b.B();d&1&&b.H(4);d&4&&b.H(4);for(var g=[],h=0;h<e;h++){var k={duration:null,
sampleSize:null,Ic:null};d&256&&(k.duration=b.B());d&512&&(k.sampleSize=b.B());d&1024&&b.H(4);d&2048&&(k.Ic=0==c?b.B():b.jd());g.push(k)}f=g}).K("mdat",Ce(function(b){m=!0;g=b})).parse(b);if(!m&&!k&&!l)throw new I(2,2,2008);var q=e,v=new DataView(g.buffer,g.byteOffset,g.byteLength),x=new R(v,0);f.forEach(function(b){var f=b.duration||n,g=b.Ic?e+b.Ic:q;q=g+(f||0);var k=0;do{var l=x.B();k+=l;var m=x.B();m=ze(m);var v=null;"vttc"==m?8<l&&(v=x.Qa(l-8)):("vtte"!=m&&A("Unknown box "+m+"! Skipping!"),x.H(l-
8));f?v&&h.push(Lk(v,c.periodStart+g/d.a,c.periodStart+q/d.a)):A("WVTT sample duration unknown, and no default found!")}while(b.sampleSize&&k<b.sampleSize)});return h.filter(hd.Ba)};function Lk(b,c,d){var e,f,g;(new S).K("payl",Ce(function(b){e=lc(b)})).K("iden",Ce(function(b){f=lc(b)})).K("sttg",Ce(function(b){g=lc(b)})).parse(b);return e?Mk(e,f,g,c,d):null}
function Mk(b,c,d,e,f){b=new qd(e,f,b);c&&(b.id=c);if(d)for(c=new Ck(d),d=Fk(c);d;)Ik(b,d,[])||B("VTT parser encountered an invalid VTT setting: ",d," The setting will be ignored."),Dk(c),d=Fk(c);return b}Id['application/mp4; codecs="wvtt"']=Kk;z("shaka.util.Dom.createHTMLElement",function(b){return document.createElement(b)});z("shaka.util.Dom.createVideoElement",function(){var b=document.createElement("video");b.muted=!0;b.width=600;b.height=400;return b});z("shaka.util.Dom.asHTMLElement",function(b){return b});z("shaka.util.Dom.asHTMLMediaElement",function(b){return b});z("shaka.util.Dom.removeAllChildren",function(b){for(;b.firstChild;)b.removeChild(b.firstChild)});}).call(exportTo,innerGlobal,innerGlobal);if(typeof exports!="undefined")for(var k in exportTo.shaka)exports[k]=exportTo.shaka[k];else if(typeof define!="undefined"&&define.amd)define(function(){return exportTo.shaka});else innerGlobal.shaka=exportTo.shaka})();

//# sourceMappingURL=shaka-player.compiled.map