/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
(function(){var innerGlobal=typeof window!="undefined"?window:global;var exportTo={};(function(window,global,module){var l,aa="function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,d){b!=Array.prototype&&b!=Object.prototype&&(b[c]=d.value)},ba="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ca(){ca=function(){};ba.Symbol||(ba.Symbol=da)}var da=function(){var b=0;return function(c){return"jscomp_symbol_"+(c||"")+b++}}();
function ea(){ca();var b=ba.Symbol.iterator;b||(b=ba.Symbol.iterator=ba.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&aa(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return fa(this)}});ea=function(){}}function fa(b){var c=0;return ia(function(){return c<b.length?{done:!1,value:b[c++]}:{done:!0}})}function ia(b){ea();b={next:b};b[ba.Symbol.iterator]=function(){return this};return b}function q(b){ea();var c=b[Symbol.iterator];return c?c.call(b):fa(b)}
function ja(b,c){if(c){for(var d=ba,e=b.split("."),f=0;f<e.length-1;f++){var g=e[f];g in d||(d[g]={});d=d[g]}e=e[e.length-1];f=d[e];g=c(f);g!=f&&null!=g&&aa(d,e,{configurable:!0,writable:!0,value:g})}}
ja("Promise",function(b){function c(b){this.b=0;this.g=void 0;this.a=[];var c=this.c();try{b(c.resolve,c.reject)}catch(m){c.reject(m)}}function d(){this.a=null}function e(b){return b instanceof c?b:new c(function(c){c(b)})}if(b)return b;d.prototype.b=function(b){null==this.a&&(this.a=[],this.f());this.a.push(b)};d.prototype.f=function(){var b=this;this.c(function(){b.h()})};var f=ba.setTimeout;d.prototype.c=function(b){f(b,0)};d.prototype.h=function(){for(;this.a&&this.a.length;){var b=this.a;this.a=
[];for(var c=0;c<b.length;++c){var d=b[c];b[c]=null;try{d()}catch(n){this.g(n)}}}this.a=null};d.prototype.g=function(b){this.c(function(){throw b;})};c.prototype.c=function(){function b(b){return function(e){d||(d=!0,b.call(c,e))}}var c=this,d=!1;return{resolve:b(this.u),reject:b(this.f)}};c.prototype.u=function(b){if(b===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(b instanceof c)this.w(b);else{a:switch(typeof b){case "object":var d=null!=b;break a;case "function":d=!0;
break a;default:d=!1}d?this.o(b):this.h(b)}};c.prototype.o=function(b){var c=void 0;try{c=b.then}catch(m){this.f(m);return}"function"==typeof c?this.C(c,b):this.h(b)};c.prototype.f=function(b){this.i(2,b)};c.prototype.h=function(b){this.i(1,b)};c.prototype.i=function(b,c){if(0!=this.b)throw Error("Cannot settle("+b+", "+c+"): Promise already settled in state"+this.b);this.b=b;this.g=c;this.m()};c.prototype.m=function(){if(null!=this.a){for(var b=0;b<this.a.length;++b)g.b(this.a[b]);this.a=null}};
var g=new d;c.prototype.w=function(b){var c=this.c();b.Pb(c.resolve,c.reject)};c.prototype.C=function(b,c){var d=this.c();try{b.call(c,d.resolve,d.reject)}catch(n){d.reject(n)}};c.prototype.then=function(b,d){function e(b,c){return"function"==typeof b?function(c){try{f(b(c))}catch(C){g(C)}}:c}var f,g,h=new c(function(b,c){f=b;g=c});this.Pb(e(b,f),e(d,g));return h};c.prototype["catch"]=function(b){return this.then(void 0,b)};c.prototype.Pb=function(b,c){function d(){switch(e.b){case 1:b(e.g);break;
case 2:c(e.g);break;default:throw Error("Unexpected state: "+e.b);}}var e=this;null==this.a?g.b(d):this.a.push(d)};c.resolve=e;c.reject=function(b){return new c(function(c,d){d(b)})};c.race=function(b){return new c(function(c,d){for(var f=q(b),g=f.next();!g.done;g=f.next())e(g.value).Pb(c,d)})};c.all=function(b){var d=q(b),f=d.next();return f.done?e([]):new c(function(b,c){function g(c){return function(d){h[c]=d;k--;0==k&&b(h)}}var h=[],k=0;do h.push(void 0),k++,e(f.value).Pb(g(h.length-1),c),f=d.next();
while(!f.done)})};return c});ja("Promise.prototype.finally",function(b){return b?b:function(b){return this.then(function(c){return Promise.resolve(b()).then(function(){return c})},function(c){return Promise.resolve(b()).then(function(){throw c;})})}});function ka(b){function c(c){return b.next(c)}function d(c){return b["throw"](c)}return new Promise(function(e,f){function g(b){b.done?e(b.value):Promise.resolve(b.value).then(c,d).then(g,f)}g(b.next())})}function t(b){return ka(b())}
function la(b){for(var c,d=[];!(c=b.next()).done;)d.push(c.value);return d}var ma="function"==typeof Object.create?Object.create:function(b){function c(){}c.prototype=b;return new c},na;if("function"==typeof Object.setPrototypeOf)na=Object.setPrototypeOf;else{var oa;a:{var pa={Ld:!0},qa={};try{qa.__proto__=pa;oa=qa.Ld;break a}catch(b){}oa=!1}na=oa?function(b,c){b.__proto__=c;if(b.__proto__!==c)throw new TypeError(b+" is not extensible");return b}:null}var ra=na;
function sa(){this.c=!1;this.a=null;this.R=void 0;this.l=1;this.g=this.W=0;this.b=null}function ua(b){if(b.c)throw new TypeError("Generator is already running");b.c=!0}sa.prototype.f=function(b){this.R=b};function va(b,c){b.b={ed:c,ue:!0};b.l=b.W||b.g}sa.prototype["return"]=function(b){this.b={"return":b};this.l=this.g};function v(b,c,d){b.l=d;return{value:c}}function w(b){b.l=0}function ya(b,c){b.l=c;b.W=0}function za(b){b.W=0;var c=b.b.ed;b.b=null;return c}
function Aa(b){this.a=new sa;this.b=b}function Ba(b,c){ua(b.a);var d=b.a.a;if(d)return Ca(b,"return"in d?d["return"]:function(b){return{value:b,done:!0}},c,b.a["return"]);b.a["return"](c);return Da(b)}function Ca(b,c,d,e){try{var f=c.call(b.a.a,d);if(!(f instanceof Object))throw new TypeError("Iterator result "+f+" is not an object");if(!f.done)return b.a.c=!1,f;var g=f.value}catch(h){return b.a.a=null,va(b.a,h),Da(b)}b.a.a=null;e.call(b.a,g);return Da(b)}
function Da(b){for(;b.a.l;)try{var c=b.b(b.a);if(c)return b.a.c=!1,{value:c.value,done:!1}}catch(d){b.a.R=void 0,va(b.a,d)}b.a.c=!1;if(b.a.b){c=b.a.b;b.a.b=null;if(c.ue)throw c.ed;return{value:c["return"],done:!0}}return{value:void 0,done:!0}}
function Ea(b){this.next=function(c){ua(b.a);b.a.a?c=Ca(b,b.a.a.next,c,b.a.f):(b.a.f(c),c=Da(b));return c};this["throw"]=function(c){ua(b.a);b.a.a?c=Ca(b,b.a.a["throw"],c,b.a.f):(va(b.a,c),c=Da(b));return c};this["return"]=function(c){return Ba(b,c)};ea();this[Symbol.iterator]=function(){return this}}function y(b,c){Ea.prototype=b.prototype;return new Ea(new Aa(c))}function Fa(b,c){return Object.prototype.hasOwnProperty.call(b,c)}
ja("WeakMap",function(b){function c(b){this.a=(g+=Math.random()+1).toString();if(b){ca();ea();b=q(b);for(var c;!(c=b.next()).done;)c=c.value,this.set(c[0],c[1])}}function d(b){Fa(b,f)||aa(b,f,{value:{}})}function e(b){var c=Object[b];c&&(Object[b]=function(b){d(b);return c(b)})}if(function(){if(!b||!Object.seal)return!1;try{var c=Object.seal({}),d=Object.seal({}),e=new b([[c,2],[d,3]]);if(2!=e.get(c)||3!=e.get(d))return!1;e["delete"](c);e.set(d,4);return!e.has(c)&&4==e.get(d)}catch(n){return!1}}())return b;
var f="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var g=0;c.prototype.set=function(b,c){d(b);if(!Fa(b,f))throw Error("WeakMap key fail: "+b);b[f][this.a]=c;return this};c.prototype.get=function(b){return Fa(b,f)?b[f][this.a]:void 0};c.prototype.has=function(b){return Fa(b,f)&&Fa(b[f],this.a)};c.prototype["delete"]=function(b){return Fa(b,f)&&Fa(b[f],this.a)?delete b[f][this.a]:!1};return c});
ja("Map",function(b){function c(){var b={};return b.Aa=b.next=b.head=b}function d(b,c){var d=b.a;return ia(function(){if(d){for(;d.head!=b.a;)d=d.Aa;for(;d.next!=d.head;)return d=d.next,{done:!1,value:c(d)};d=null}return{done:!0,value:void 0}})}function e(b,c){var d=c&&typeof c;"object"==d||"function"==d?g.has(c)?d=g.get(c):(d=""+ ++h,g.set(c,d)):d="p_"+c;var e=b.b[d];if(e&&Fa(b.b,d))for(var f=0;f<e.length;f++){var k=e[f];if(c!==c&&k.key!==k.key||c===k.key)return{id:d,list:e,index:f,X:k}}return{id:d,
list:e,index:-1,X:void 0}}function f(b){this.b={};this.a=c();this.size=0;if(b){b=q(b);for(var d;!(d=b.next()).done;)d=d.value,this.set(d[0],d[1])}}if(function(){if(!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),d=new b(q([[c,"s"]]));if("s"!=d.get(c)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var e=d.entries(),f=e.next();if(f.done||f.value[0]!=c||"s"!=f.value[1])return!1;f=e.next();return f.done||4!=f.value[0].x||
"t"!=f.value[1]||!e.next().done?!1:!0}catch(r){return!1}}())return b;ca();ea();var g=new WeakMap;f.prototype.set=function(b,c){var d=e(this,b);d.list||(d.list=this.b[d.id]=[]);d.X?d.X.value=c:(d.X={next:this.a,Aa:this.a.Aa,head:this.a,key:b,value:c},d.list.push(d.X),this.a.Aa.next=d.X,this.a.Aa=d.X,this.size++);return this};f.prototype["delete"]=function(b){b=e(this,b);return b.X&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.b[b.id],b.X.Aa.next=b.X.next,b.X.next.Aa=b.X.Aa,b.X.head=
null,this.size--,!0):!1};f.prototype.clear=function(){this.b={};this.a=this.a.Aa=c();this.size=0};f.prototype.has=function(b){return!!e(this,b).X};f.prototype.get=function(b){return(b=e(this,b).X)&&b.value};f.prototype.entries=function(){return d(this,function(b){return[b.key,b.value]})};f.prototype.keys=function(){return d(this,function(b){return b.key})};f.prototype.values=function(){return d(this,function(b){return b.value})};f.prototype.forEach=function(b,c){for(var d=this.entries(),e;!(e=d.next()).done;)e=
e.value,b.call(c,e[1],e[0],this)};f.prototype[Symbol.iterator]=f.prototype.entries;var h=0;return f});
ja("Set",function(b){function c(b){this.a=new Map;if(b){b=q(b);for(var c;!(c=b.next()).done;)this.add(c.value)}this.size=this.a.size}if(function(){if(!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),e=new b(q([c]));if(!e.has(c)||1!=e.size||e.add(c)!=e||1!=e.size||e.add({x:4})!=e||2!=e.size)return!1;var f=e.entries(),g=f.next();if(g.done||g.value[0]!=c||g.value[1]!=c)return!1;g=f.next();return g.done||g.value[0]==c||4!=g.value[0].x||
g.value[1]!=g.value[0]?!1:f.next().done}catch(h){return!1}}())return b;ca();ea();c.prototype.add=function(b){this.a.set(b,b);this.size=this.a.size;return this};c.prototype["delete"]=function(b){b=this.a["delete"](b);this.size=this.a.size;return b};c.prototype.clear=function(){this.a.clear();this.size=0};c.prototype.has=function(b){return this.a.has(b)};c.prototype.entries=function(){return this.a.entries()};c.prototype.values=function(){return this.a.values()};c.prototype.keys=c.prototype.values;
c.prototype[Symbol.iterator]=c.prototype.values;c.prototype.forEach=function(b,c){var d=this;this.a.forEach(function(e){return b.call(c,e,e,d)})};return c});function Ga(b,c){ea();b instanceof String&&(b+="");var d=0,e={next:function(){if(d<b.length){var f=d++;return{value:c(f,b[f]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e}ja("Array.prototype.keys",function(b){return b?b:function(){return Ga(this,function(b){return b})}});
ja("Object.is",function(b){return b?b:function(b,d){return b===d?0!==b||1/b===1/d:b!==b&&d!==d}});ja("Array.prototype.includes",function(b){return b?b:function(b,d){var c=this;c instanceof String&&(c=String(c));var f=c.length,g=d||0;for(0>g&&(g=Math.max(g+f,0));g<f;g++){var h=c[g];if(h===b||Object.is(h,b))return!0}return!1}});
function Ha(b,c,d){if(null==b)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return b+""}ja("String.prototype.includes",function(b){return b?b:function(b,d){return-1!==Ha(this,b,"includes").indexOf(b,d||0)}});
ja("Array.from",function(b){return b?b:function(b,d,e){ea();d=null!=d?d:function(b){return b};var c=[],g=b[Symbol.iterator];if("function"==typeof g)for(b=g.call(b);!(g=b.next()).done;)c.push(d.call(e,g.value));else{g=b.length;for(var h=0;h<g;h++)c.push(d.call(e,b[h]))}return c}});ja("String.prototype.startsWith",function(b){return b?b:function(b,d){for(var c=Ha(this,b,"startsWith"),f=c.length,g=b.length,h=Math.max(0,Math.min(d|0,c.length)),k=0;k<g&&h<f;)if(c[h++]!=b[k++])return!1;return k>=g}});
ja("Array.prototype.find",function(b){return b?b:function(b,d){a:{var c=this;c instanceof String&&(c=String(c));for(var f=c.length,g=0;g<f;g++){var h=c[g];if(b.call(d,h,g,c)){c=h;break a}}c=void 0}return c}});var Ia="function"==typeof Object.assign?Object.assign:function(b,c){for(var d=1;d<arguments.length;d++){var e=arguments[d];if(e)for(var f in e)Fa(e,f)&&(b[f]=e[f])}return b};ja("Object.assign",function(b){return b||Ia});var Ja=this;Ja.a=!0;
function z(b,c){var d=b.split("."),e=Ja;d[0]in e||!e.execScript||e.execScript("var "+d[0]);for(var f;d.length&&(f=d.shift());)d.length||void 0===c?e[f]?e=e[f]:e=e[f]={}:e[f]=c}function La(b,c){function d(){}d.prototype=c.prototype;b.gf=c.prototype;b.prototype=new d;b.prototype.constructor=b;b.vf=function(b,d,g){return c.prototype[d].apply(b,Array.prototype.slice.call(arguments,2))}};/*

 Copyright 2016 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
function Ma(b){this.c=Math.exp(Math.log(.5)/b);this.b=this.a=0}function Na(b,c,d){var e=Math.pow(b.c,c);d=d*(1-e)+e*b.a;isNaN(d)||(b.a=d,b.b+=c)}function Oa(b){return b.a/(1-Math.pow(b.c,b.b))};function Qa(){this.b=new Ma(2);this.c=new Ma(5);this.a=0}Qa.prototype.getBandwidthEstimate=function(b){return 128E3>this.a?b:Math.min(Oa(this.b),Oa(this.c))};var A={gb:0,Ob:function(){},qa:function(){},error:function(){},j:function(){},info:function(){},debug:function(){},A:function(){},H:function(){}};window.console&&window.console.log.bind&&(A.qa=console.warn.bind(console),A.Ob=console.error.bind(console),1<=A.gb&&(A.error=console.error.bind(console)),2<=A.gb&&(A.j=console.warn.bind(console)),3<=A.gb&&(A.info=console.info.bind(console)),4<=A.gb&&(A.debug=console.log.bind(console)),5<=A.gb&&(A.A=console.debug.bind(console)),6<=A.gb&&(A.H=console.debug.bind(console)));/*
 @license
 Copyright 2008 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
var Ra=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;/*
 @license
 Copyright 2006 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
function Sa(b){var c;b instanceof Sa?(Ta(this,b.ta),this.ab=b.ab,this.ra=b.ra,Ua(this,b.xb),this.pa=b.pa,Va(this,b.a.clone()),this.Ra=b.Ra):b&&(c=String(b).match(Ra))?(Ta(this,c[1]||"",!0),this.ab=Wa(c[2]||""),this.ra=Wa(c[3]||"",!0),Ua(this,c[4]),this.pa=Wa(c[5]||"",!0),Va(this,c[6]||"",!0),this.Ra=Wa(c[7]||"")):this.a=new Za(null)}l=Sa.prototype;l.ta="";l.ab="";l.ra="";l.xb=null;l.pa="";l.Ra="";
l.toString=function(){var b=[],c=this.ta;c&&b.push($a(c,ab,!0),":");if(c=this.ra){b.push("//");var d=this.ab;d&&b.push($a(d,ab,!0),"@");b.push(encodeURIComponent(c).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));c=this.xb;null!=c&&b.push(":",String(c))}if(c=this.pa)this.ra&&"/"!=c.charAt(0)&&b.push("/"),b.push($a(c,"/"==c.charAt(0)?bb:cb,!0));(c=this.a.toString())&&b.push("?",c);(c=this.Ra)&&b.push("#",$a(c,db));return b.join("")};
l.resolve=function(b){var c=this.clone();"data"===c.ta&&(c=new Sa);var d=!!b.ta;d?Ta(c,b.ta):d=!!b.ab;d?c.ab=b.ab:d=!!b.ra;d?c.ra=b.ra:d=null!=b.xb;var e=b.pa;if(d)Ua(c,b.xb);else if(d=!!b.pa){if("/"!=e.charAt(0))if(this.ra&&!this.pa)e="/"+e;else{var f=c.pa.lastIndexOf("/");-1!=f&&(e=c.pa.substr(0,f+1)+e)}if(".."==e||"."==e)e="";else if(-1!=e.indexOf("./")||-1!=e.indexOf("/.")){f=0==e.lastIndexOf("/",0);e=e.split("/");for(var g=[],h=0;h<e.length;){var k=e[h++];"."==k?f&&h==e.length&&g.push(""):".."==
k?((1<g.length||1==g.length&&""!=g[0])&&g.pop(),f&&h==e.length&&g.push("")):(g.push(k),f=!0)}e=g.join("/")}}d?c.pa=e:d=""!==b.a.toString();d?Va(c,b.a.clone()):d=!!b.Ra;d&&(c.Ra=b.Ra);return c};l.clone=function(){return new Sa(this)};function Ta(b,c,d){b.ta=d?Wa(c,!0):c;b.ta&&(b.ta=b.ta.replace(/:$/,""))}function Ua(b,c){if(c){c=Number(c);if(isNaN(c)||0>c)throw Error("Bad port number "+c);b.xb=c}else b.xb=null}function Va(b,c,d){c instanceof Za?b.a=c:(d||(c=$a(c,eb)),b.a=new Za(c))}
function Wa(b,c){return b?c?decodeURI(b):decodeURIComponent(b):""}function $a(b,c,d){return"string"==typeof b?(b=encodeURI(b).replace(c,fb),d&&(b=b.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b):null}function fb(b){b=b.charCodeAt(0);return"%"+(b>>4&15).toString(16)+(b&15).toString(16)}var ab=/[#\/\?@]/g,cb=/[#\?:]/g,bb=/[#\?]/g,eb=/[#\?@]/g,db=/#/g;function Za(b){this.a=b||null}l=Za.prototype;l.fa=null;l.Rb=null;
l.add=function(b,c){if(!this.fa&&(this.fa={},this.Rb=0,this.a))for(var d=this.a.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null;if(0<=f){var h=d[e].substring(0,f);g=d[e].substring(f+1)}else h=d[e];h=decodeURIComponent(h.replace(/\+/g," "));g=g||"";this.add(h,decodeURIComponent(g.replace(/\+/g," ")))}this.a=null;(d=this.fa.hasOwnProperty(b)&&this.fa[b])||(this.fa[b]=d=[]);d.push(c);this.Rb++;return this};
l.toString=function(){if(this.a)return this.a;if(!this.fa)return"";var b=[],c;for(c in this.fa)for(var d=encodeURIComponent(c),e=this.fa[c],f=0;f<e.length;f++){var g=d;""!==e[f]&&(g+="="+encodeURIComponent(e[f]));b.push(g)}return this.a=b.join("&")};l.clone=function(){var b=new Za;b.a=this.a;if(this.fa){var c={},d;for(d in this.fa)c[d]=this.fa[d].concat();b.fa=c;b.Rb=this.Rb}return b};function gb(b){this.b=b;this.a=null}gb.prototype.U=function(b){var c=this;this.stop();var d=!0,e=null;this.a=function(){window.clearTimeout(e);d=!1};e=window.setTimeout(function(){d&&c.b()},1E3*b);return this};gb.prototype.stop=function(){this.a&&(this.a(),this.a=null)};function B(b){this.b=b;this.a=null}z("shaka.util.Timer",B);B.prototype.hf=function(){this.stop();this.b();return this};B.prototype.tickNow=B.prototype.hf;B.prototype.U=function(b){var c=this;this.stop();this.a=(new gb(function(){c.b()})).U(b);return this};B.prototype.tickAfter=B.prototype.U;B.prototype.Ba=function(b){var c=this;this.stop();this.a=(new gb(function(){c.a.U(b);c.b()})).U(b);return this};B.prototype.tickEvery=B.prototype.Ba;B.prototype.stop=function(){this.a&&(this.a.stop(),this.a=null)};
B.prototype.stop=B.prototype.stop;function hb(b,c){var d=ib();this.i=null==b.maxAttempts?d.maxAttempts:b.maxAttempts;this.f=null==b.baseDelay?d.baseDelay:b.baseDelay;this.h=null==b.fuzzFactor?d.fuzzFactor:b.fuzzFactor;this.g=null==b.backoffFactor?d.backoffFactor:b.backoffFactor;this.a=0;this.b=this.f;if(this.c=void 0===c?!1:c)this.a=1}
function jb(b){return t(function d(){var e,f;return y(d,function(d){switch(d.l){case 1:if(b.a>=b.i)if(b.c)b.a=1,b.b=b.f;else return d["return"](Promise.reject());e=b.a;b.a++;if(0==e)return d["return"]();f=b.b*(1+(2*Math.random()-1)*b.h);return v(d,new Promise(function(b){(new B(b)).U(f/1E3)}),2);case 2:b.b*=b.g,w(d)}})})}function ib(){return{maxAttempts:2,baseDelay:1E3,backoffFactor:2,fuzzFactor:.5,timeout:0}};function D(b,c,d,e){for(var f=[],g=3;g<arguments.length;++g)f[g-3]=arguments[g];this.severity=b;this.category=c;this.code=d;this.data=f;this.handled=!1}z("shaka.util.Error",D);D.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")};D.Severity={RECOVERABLE:1,CRITICAL:2};D.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9};
D.Code={UNSUPPORTED_SCHEME:1E3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2E3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3E3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,
MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4E3,
DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,
HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,HLS_INTERNAL_SKIP_STREAM:4035,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6E3,
REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,LOAD_INTERRUPTED:7E3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,
CAST_API_UNAVAILABLE:8E3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9E3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,
MISSING_STORAGE_CELL:9013};function E(){var b,c,d=new Promise(function(d,f){b=d;c=f});d.resolve=b;d.reject=c;return d}E.prototype.resolve=function(){};E.prototype.reject=function(){};function F(b,c){this.promise=b;this.pd=c;this.a=!1}z("shaka.util.AbortableOperation",F);function mb(b){return new F(Promise.reject(b),function(){return Promise.resolve()})}F.failed=mb;function nb(){var b=Promise.reject(new D(2,7,7001));b["catch"](function(){});return new F(b,function(){return Promise.resolve()})}F.aborted=nb;function ob(b){return new F(Promise.resolve(b),function(){return Promise.resolve()})}F.completed=ob;
function pb(b){return new F(b,function(){return b["catch"](function(){})})}F.notAbortable=pb;F.prototype.abort=function(){this.a=!0;return this.pd()};F.prototype.abort=F.prototype.abort;function qb(b){return new F(Promise.all(b.map(function(b){return b.promise})),function(){return Promise.all(b.map(function(b){return b.abort()}))})}F.all=qb;F.prototype["finally"]=function(b){this.promise.then(function(){return b(!0)},function(){return b(!1)});return this};F.prototype["finally"]=F.prototype["finally"];
F.prototype.aa=function(b,c){function d(d){return function(k){if(f.a&&d)g.reject(h);else{var m=d?b:c;m?e=rb(m,k,g):(d?g.resolve:g.reject)(k)}}}function e(){g.reject(h);return f.abort()}var f=this,g=new E,h=new D(2,7,7001);this.promise.then(d(!0),d(!1));return new F(g,function(){return e()})};F.prototype.chain=F.prototype.aa;
function rb(b,c,d){try{var e=b(c);if(e&&e.promise&&e.abort)return d.resolve(e.promise),function(){return e.abort()};d.resolve(e);return function(){return Promise.resolve(e).then(function(){},function(){})}}catch(f){return d.reject(f),function(){return Promise.resolve()}}};function H(b,c){c=void 0===c?{}:c;for(var d in c)this[d]=c[d];this.defaultPrevented=this.cancelable=this.bubbles=!1;this.timeStamp=window.performance&&window.performance.now?window.performance.now():Date.now();this.type=b;this.isTrusted=!1;this.target=this.currentTarget=null;this.a=!1}H.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)};H.prototype.stopImmediatePropagation=function(){this.a=!0};H.prototype.stopPropagation=function(){};function sb(){this.a={}}sb.prototype.push=function(b,c){this.a.hasOwnProperty(b)?this.a[b].push(c):this.a[b]=[c]};sb.prototype.get=function(b){return(b=this.a[b])?b.slice():null};sb.prototype.remove=function(b,c){var d=this.a[b];if(d)for(var e=0;e<d.length;++e)d[e]==c&&(d.splice(e,1),--e)};sb.prototype.forEach=function(b){for(var c in this.a)b(c,this.a[c])};function tb(){this.nc=new sb;this.kd=this}tb.prototype.addEventListener=function(b,c){this.nc.push(b,c)};tb.prototype.removeEventListener=function(b,c){this.nc.remove(b,c)};tb.prototype.dispatchEvent=function(b){for(var c=this.nc.get(b.type)||[],d=0;d<c.length;++d){b.target=this.kd;b.currentTarget=this.kd;var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(this,b)}catch(f){A.error("Uncaught exception in event handler",f,f?f.message:null,f?f.stack:null)}if(b.a)break}return b.defaultPrevented};function ub(b){function c(b){switch(typeof b){case "undefined":case "boolean":case "number":case "string":case "symbol":case "function":return b;default:if(!b||b.buffer&&b.buffer.constructor==ArrayBuffer)return b;if(d.has(b))return null;var e=b.constructor==Array;if(b.constructor!=Object&&!e)return null;d.add(b);var g=e?[]:{},h;for(h in b)g[h]=c(b[h]);e&&(g.length=b.length);return g}}var d=new Set;return c(b)};function vb(b,c){var d=b.indexOf(c);-1<d&&b.splice(d,1)}function wb(b,c){var d=0;b.forEach(function(b){d+=c(b)?1:0});return d};function xb(){this.a=[]}function yb(b,c){b.a.push(c["finally"](function(){vb(b.a,c)}))}xb.prototype.destroy=function(){var b=[];this.a.forEach(function(c){c.promise["catch"](function(){});b.push(c.abort())});this.a=[];return Promise.all(b)};function I(b){tb.call(this);this.f=!1;this.g=new xb;this.a=new Set;this.b=new Set;this.c=b||null}La(I,tb);z("shaka.net.NetworkingEngine",I);I.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4};I.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var zb={};function Ab(b,c,d){d=d||3;var e=zb[b];if(!e||d>=e.priority)zb[b]={priority:d,Oe:c}}I.registerScheme=Ab;I.unregisterScheme=function(b){delete zb[b]};I.prototype.Qe=function(b){this.a.add(b)};I.prototype.registerRequestFilter=I.prototype.Qe;
I.prototype.lf=function(b){this.a["delete"](b)};I.prototype.unregisterRequestFilter=I.prototype.lf;I.prototype.Qd=function(){this.a.clear()};I.prototype.clearAllRequestFilters=I.prototype.Qd;I.prototype.Re=function(b){this.b.add(b)};I.prototype.registerResponseFilter=I.prototype.Re;I.prototype.mf=function(b){this.b["delete"](b)};I.prototype.unregisterResponseFilter=I.prototype.mf;I.prototype.Rd=function(){this.b.clear()};I.prototype.clearAllResponseFilters=I.prototype.Rd;
I.defaultRetryParameters=function(){return ib()};function Bb(b,c){return{uris:b,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:c,licenseRequestType:null,sessionId:null}}I.makeRequest=Bb;I.prototype.destroy=function(){this.f=!0;this.a.clear();this.b.clear();return this.g.destroy()};I.prototype.destroy=I.prototype.destroy;
I.prototype.request=function(b,c){var d=this,e=new Cb;if(this.f){var f=Promise.reject(new D(2,7,7001));f["catch"](function(){});return new Db(f,function(){return Promise.resolve()},e)}c.method=c.method||"GET";c.headers=c.headers||{};c.retryParameters=c.retryParameters?ub(c.retryParameters):ib();c.uris=ub(c.uris);f=Eb(this,b,c);var g=f.aa(function(){return Fb(d,b,c,new hb(c.retryParameters,!1),0,null,e)}),h=g.aa(function(c){return Gb(d,b,c)}),k=Date.now(),m=0;f.promise.then(function(){m=Date.now()-
k},function(){});var n=0;g.promise.then(function(){n=Date.now()},function(){});f=h.aa(function(c){var e=Date.now()-n,f=c.response;f.timeMs+=m;f.timeMs+=e;c.se||!d.c||f.fromCache||1!=b||d.c(f.timeMs,f.data.byteLength);return f},function(b){b&&(b.severity=2);throw b;});f=new Db(f.promise,f.pd,e);yb(this.g,f);return f};I.prototype.request=I.prototype.request;
function Eb(b,c,d){var e=ob(void 0),f={};b=q(b.a);for(var g=b.next();!g.done;f={Pc:f.Pc},g=b.next())f.Pc=g.value,e=e.aa(function(b){return function(){return b.Pc(c,d)}}(f));return e.aa(void 0,function(b){if(b&&7001==b.code)throw b;throw new D(2,1,1006,b);})}
function Fb(b,c,d,e,f,g,h){var k=new Sa(d.uris[f]),m=k.ta,n=!1;m||(m=location.protocol,m=m.slice(0,-1),Ta(k,m),d.uris[f]=k.toString());m=m.toLowerCase();var p=(m=zb[m])?m.Oe:null;if(!p)return mb(new D(2,1,1E3,k));var r;return pb(jb(e)).aa(function(){if(b.f)return nb();r=Date.now();return p(d.uris[f],d,c,function(d,e,f){b.c&&1==c&&(b.c(d,e),n=!0,h.a=f)})}).aa(function(b){void 0==b.timeMs&&(b.timeMs=Date.now()-r);return{response:b,se:n}},function(k){if(k&&7001==k.code)throw k;if(b.f)return nb();if(k&&
1==k.severity)return b.dispatchEvent(new H("retry",{error:k instanceof D?k:null})),f=(f+1)%d.uris.length,Fb(b,c,d,e,f,k,h);throw k||g;})}function Gb(b,c,d){var e=ob(void 0);b=q(b.b);for(var f=b.next();!f.done;f=b.next())e=e.aa(f.value.bind(null,c,d.response));return e.aa(function(){return d},function(b){if(b&&7001==b.code)throw b;var c=2;b instanceof D&&(c=b.severity);throw new D(c,1,1007,b);})}function Cb(){this.a=0}I.NumBytesRemainingClass=Cb;function Db(b,c,d){F.call(this,b,c);this.b=d}
var Hb=Db;Hb.prototype=ma(F.prototype);Hb.prototype.constructor=Hb;if(ra)ra(Hb,F);else for(var Ib in F)if("prototype"!=Ib)if(Object.defineProperties){var Jb=Object.getOwnPropertyDescriptor(F,Ib);Jb&&Object.defineProperty(Hb,Ib,Jb)}else Hb[Ib]=F[Ib];Hb.gf=F.prototype;I.PendingRequest=Db;Db.all=qb;Db.notAbortable=pb;Db.completed=ob;Db.aborted=nb;Db.failed=mb;function Kb(){}z("shaka.util.IReleasable",Kb);Kb.prototype.release=function(){};function J(){this.a=new sb}z("shaka.util.EventManager",J);J.prototype.release=function(){this.Hb();this.a=null};J.prototype.release=J.prototype.release;J.prototype.B=function(b,c,d,e){this.a&&(b=new Lb(b,c,d,e),this.a.push(c,b))};J.prototype.listen=J.prototype.B;J.prototype.oa=function(b,c,d,e){function f(e){g.ja(b,c,f);d(e)}var g=this;this.B(b,c,f,e)};J.prototype.listenOnce=J.prototype.oa;
J.prototype.ja=function(b,c,d){if(this.a){var e=this.a.get(c)||[];e=q(e);for(var f=e.next();!f.done;f=e.next())f=f.value,f.target!=b||d!=f.listener&&d||(f.ja(),this.a.remove(c,f))}};J.prototype.unlisten=J.prototype.ja;J.prototype.Hb=function(){if(this.a){var b=this.a,c=[],d;for(d in b.a)c.push.apply(c,b.a[d]);b=q(c);for(c=b.next();!c.done;c=b.next())c.value.ja();this.a.a={}}};J.prototype.removeAll=J.prototype.Hb;
function Lb(b,c,d,e){this.target=b;this.type=c;this.listener=d;this.a=Mb(b,e);this.target.addEventListener(c,d,this.a)}Lb.prototype.ja=function(){this.target.removeEventListener(this.type,this.listener,this.a);this.listener=this.target=null;this.a=!1};Lb.prototype.unlisten=Lb.prototype.ja;function Mb(b,c){if(void 0==c)return!1;if("boolean"==typeof c)return c;var d=new Set(["passive","capture"]);Object.keys(c).filter(function(b){return!d.has(b)});return Qb(b)?c:c.capture||!1}
function Qb(b){var c=Rb;if(void 0==c){c=!1;try{var d={},e={get:function(){c=!0;return!1}};Object.defineProperty(d,"passive",e);Object.defineProperty(d,"capture",e);e=function(){};b.addEventListener("test",e,d);b.removeEventListener("test",e,d)}catch(f){c=!1}Rb=c}return c||!1}var Rb=void 0;function Sb(b){b=Tb(b);return(new Sa(b)).ra}z("shaka.util.FairPlayUtils.defaultGetContentId",Sb);function Ub(b,c,d){function e(b){(new DataView(f.buffer)).setUint32(g,b.byteLength,!0);g+=4;f.set(b,g);g+=b.byteLength}if(!d||!d.byteLength)throw new D(2,6,6015);c="string"==typeof c?new Uint8Array(Vb(c,!0)):new Uint8Array(c);b=Tb(b);b=Vb(b,!0);var f=new Uint8Array(12+b.byteLength+c.byteLength+d.byteLength),g=0;e(new Uint8Array(b));e(c);e(new Uint8Array(d));return f}
z("shaka.util.FairPlayUtils.initDataTransform",Ub);function Wb(b,c){for(var d=q(b),e=d.next();!e.done;e=d.next())if(!c(e.value))return!1;return!0};function Xb(b){var c=new Map;Object.keys(b).forEach(function(d){c.set(d,b[d])});return c}function Yb(b){var c={};b.forEach(function(b,e){c[e]=b});return c};function Zb(b,c){var d=b;c&&(d+='; codecs="'+c+'"');return d}function $b(b){var c=[b.mimeType];ac.forEach(function(d,e){var f=b[e];f&&c.push(d+'="'+f+'"')});return c.join(";")}function bc(b){b=b.split(".");var c=b[0];b.pop();return[c,b.join(".")]}var ac=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function cc(){return window.MediaSource&&MediaSource.isTypeSupported?!0:!1}function dc(b){return""!=ec().canPlayType(b)}function fc(){return navigator.userAgent.match(/Edge?\//)?!0:!1}function gc(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!hc("Tizen")}function ic(){if(!gc())return null;var b=navigator.userAgent.match(/Version\/(\d+)/);return b?parseInt(b[1],10):(b=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(b[1],10):null}
function hc(b){return(navigator.userAgent||"").includes(b)}function ec(){if(jc)return jc;kc||(kc=new B(function(){jc=null}));(jc=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(jc=document.createElement("video"));kc.U(1);return jc}var kc=null,jc=null;function lc(b){if(!b)return"";b=new Uint8Array(b);239==b[0]&&187==b[1]&&191==b[2]&&(b=b.subarray(3));b=mc(b);b=escape(b);try{return decodeURIComponent(b)}catch(c){throw new D(2,2,2004);}}z("shaka.util.StringUtils.fromUTF8",lc);
function nc(b,c,d){if(!b)return"";if(!d&&0!=b.byteLength%2)throw A.error("Data has an incorrect length, must be even."),new D(2,2,2004);if(b instanceof ArrayBuffer)var e=b;else d=new Uint8Array(b.byteLength),d.set(new Uint8Array(b)),e=d.buffer;b=Math.floor(b.byteLength/2);d=new Uint16Array(b);e=new DataView(e);for(var f=0;f<b;f++)d[f]=e.getUint16(2*f,c);return mc(d)}z("shaka.util.StringUtils.fromUTF16",nc);
function Tb(b){var c=new Uint8Array(b);if(239==c[0]&&187==c[1]&&191==c[2])return lc(c);if(254==c[0]&&255==c[1])return nc(c.subarray(2),!1);if(255==c[0]&&254==c[1])return nc(c.subarray(2),!0);var d=function(b,c){return b.byteLength<=c||32<=b[c]&&126>=b[c]}.bind(null,c);A.debug("Unable to find byte-order-mark, making an educated guess.");if(0==c[0]&&0==c[2])return nc(b,!1);if(0==c[1]&&0==c[3])return nc(b,!0);if(d(0)&&d(1)&&d(2)&&d(3))return lc(b);throw new D(2,2,2003);}
z("shaka.util.StringUtils.fromBytesAutoDetect",Tb);function oc(b){b=encodeURIComponent(b);b=unescape(b);for(var c=new Uint8Array(b.length),d=0;d<b.length;++d)c[d]=b.charCodeAt(d);return c.buffer}z("shaka.util.StringUtils.toUTF8",oc);function Vb(b,c){for(var d=new Uint8Array(2*b.length),e=new DataView(d.buffer),f=0;f<b.length;++f)e.setUint16(2*f,b.charCodeAt(f),c);return d.buffer}z("shaka.util.StringUtils.toUTF16",Vb);
function mc(b){if(!pc)for(var c=function(b){try{var c=new Uint8Array(b);return 0<String.fromCharCode.apply(null,c).length}catch(g){return!1}},d={size:65536};0<d.size;d={size:d.size},d.size/=2)if(c(d.size)){pc=function(b){return function(c){for(var d="",e=0;e<c.length;e+=b.size)d+=String.fromCharCode.apply(null,c.subarray(e,e+b.size));return d}}(d);break}return pc(b)}var pc=null;z("shaka.util.StringUtils.resetFromCharCode",function(){pc=null});var K={gc:function(b,c){var d=mc(b);c=void 0==c?!0:c;d=window.btoa(d).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")}};z("shaka.util.Uint8ArrayUtils.toBase64",K.gc);K.Ga=function(b){b=window.atob(b.replace(/-/g,"+").replace(/_/g,"/"));for(var c=new Uint8Array(b.length),d=0;d<b.length;++d)c[d]=b.charCodeAt(d);return c};z("shaka.util.Uint8ArrayUtils.fromBase64",K.Ga);
K.vc=function(b){for(var c=new Uint8Array(b.length/2),d=0;d<b.length;d+=2)c[d/2]=window.parseInt(b.substr(d,2),16);return c};z("shaka.util.Uint8ArrayUtils.fromHex",K.vc);K.hc=function(b){for(var c="",d=0;d<b.length;++d){var e=b[d].toString(16);1==e.length&&(e="0"+e);c+=e}return c};z("shaka.util.Uint8ArrayUtils.toHex",K.hc);K.Fa=function(b,c){if(!b&&!c)return!0;if(!b||!c||b.length!=c.length)return!1;for(var d=0;d<b.length;++d)if(b[d]!=c[d])return!1;return!0};z("shaka.util.Uint8ArrayUtils.equal",K.Fa);
K.concat=function(b){for(var c=[],d=0;d<arguments.length;++d)c[d]=arguments[d];for(var e=d=0;e<c.length;++e)d+=c[e].length;d=new Uint8Array(d);for(var f=e=0;f<c.length;++f)d.set(c[f],e),e+=c[f].length;return d};z("shaka.util.Uint8ArrayUtils.concat",K.concat);function qc(b,c){var d=this;c=void 0===c?1:c;this.C=b;this.u=new Set;this.h=this.m=null;this.$=!1;this.M=0;this.a=null;this.i=new J;this.b=new Map;this.w=[];this.o=new E;this.f=null;this.g=function(c){d.o.reject(c);b.onError(c)};this.na=new Map;this.ea=new Map;this.Z=new B(function(){return rc(d)});this.c=!1;this.la=new E;this.S=!1;this.K=[];this.ma=!1;this.ka=(new B(function(){sc(d)})).Ba(c);this.o["catch"](function(){})}l=qc.prototype;
l.destroy=function(){var b=this;return t(function d(){return y(d,function(d){switch(d.l){case 1:if(b.c)return v(d,b.la,0);b.c=!0;return v(d,tc(b),4);case 4:b.la.resolve(),d.l=0}})})};
function tc(b){return t(function d(){return y(d,function(d){switch(d.l){case 1:return b.i.release(),b.i=null,b.o.reject(),b.ka.stop(),b.ka=null,b.Z.stop(),b.Z=null,v(d,uc(b),2);case 2:if(!b.h){d.l=3;break}d.W=4;return v(d,b.h.setMediaKeys(null),6);case 6:ya(d,5);break;case 4:za(d);case 5:b.h=null;case 3:b.a=null,b.u.clear(),b.m=null,b.w=[],b.f=null,b.g=null,b.C=null,w(d)}})})}l.configure=function(b){this.f=b};function vc(b,c,d){b.w=d;b.S=0<d.length;return wc(b,c)}
function wc(b,c){var d=xc(b);if(d)for(var e=q(c),f=e.next();!f.done;f=e.next())f.value.drmInfos=[d];d=c.some(function(b){return 0<b.drmInfos.length});d||(f=Xb(b.f.servers),yc(c,f));e=q(c);for(f=e.next();!f.done;f=e.next()){f=q(f.value.drmInfos);for(var g=f.next();!g.done;g=f.next())zc(g.value,Xb(b.f.servers),Xb(b.f.advanced||{}))}f=Ac(b,c);if(!f.size)return b.$=!0,Promise.resolve();f=Bc(b,f);return d?f:f["catch"](function(){})}
l.Ab=function(b){var c=this;if(!this.m)return this.i.oa(b,"encrypted",function(){c.g(new D(2,6,6010))}),Promise.resolve();this.h=b;this.i.oa(this.h,"play",function(){for(var b=0;b<c.K.length;b++)Cc(c,c.K[b]);c.ma=!0;c.K=[]});"webkitCurrentPlaybackTargetIsWireless"in this.h&&this.i.B(this.h,"webkitcurrentplaybacktargetiswirelesschanged",function(){return uc(c)});b=this.h.setMediaKeys(this.m);b=b["catch"](function(b){return Promise.reject(new D(2,6,6003,b.message))});var d=Dc(this);return Promise.all([b,
d]).then(function(){if(c.c)return Promise.reject();Ec(c);c.a.initData.length||c.w.length||c.i.B(c.h,"encrypted",function(b){return Fc(c,b.initDataType,new Uint8Array(b.initData))})})["catch"](function(b){if(!c.c)return Promise.reject(b)})};
function Dc(b){return t(function d(){var e,f;return y(d,function(d){switch(d.l){case 1:if(!(b.m&&b.a&&b.a.serverCertificate&&b.a.serverCertificate.length)){d.l=0;break}d.W=3;return v(d,b.m.setServerCertificate(b.a.serverCertificate),5);case 5:(e=d.R)||A.j("Server certificates are not supported by the key system.  The server certificate has been ignored.");ya(d,0);break;case 3:return f=za(d),d["return"](Promise.reject(new D(2,6,6004,f.message)))}})})}
function Ec(b){var c=b.a?b.a.initData:[];c.forEach(function(c){return Fc(b,c.initDataType,c.initData)});b.w.forEach(function(c){return Jc(b,c)});c.length||b.w.length||b.o.resolve()}function Fc(b,c,d){var e=b.b.values();e=q(e);for(var f=e.next();!f.done;f=e.next())if(K.Fa(d,f.value.initData)&&!hc("Tizen 2")){A.debug("Ignoring duplicate init data.");return}Kc(b,c,d)}function Lc(b){return b?b.keySystem:""}
l.yc=function(){var b=Infinity,c=this.b.keys();c=q(c);for(var d=c.next();!d.done;d=c.next())d=d.value,isNaN(d.expiration)||(b=Math.min(b,d.expiration));return b};
function Ac(b,c){for(var d=new Set,e=q(c),f=e.next();!f.done;f=e.next()){var g=q(f.value.drmInfos);for(f=g.next();!f.done;f=g.next())d.add(f.value)}e=q(d);for(f=e.next();!f.done;f=e.next())zc(f.value,Xb(b.f.servers),Xb(b.f.advanced||{}));g=b.S?"required":"optional";var h=b.S?["persistent-license"]:["temporary"];e=new Map;d=q(d);for(f=d.next();!f.done;f=d.next())f=f.value,e.set(f.keySystem,{audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:g,sessionTypes:h,
label:f.keySystem,drmInfos:[]});d=q(c);for(f=d.next();!f.done;f=d.next()){f=f.value;g=f.audio;h=f.video;var k=g?Zb(g.mimeType,g.codecs):"",m=h?Zb(h.mimeType,h.codecs):"",n=q(f.drmInfos);for(f=n.next();!f.done;f=n.next()){f=f.value;var p=e.get(f.keySystem);p.drmInfos.push(f);f.distinctiveIdentifierRequired&&(p.distinctiveIdentifier="required");f.persistentStateRequired&&(p.persistentState="required");g&&p.audioCapabilities.push({robustness:f.audioRobustness||"",contentType:k});h&&p.videoCapabilities.push({robustness:f.videoRobustness||
"",contentType:m})}}return e}
function Bc(b,c){if(1==c.size&&c.has(""))return Promise.reject(new D(2,6,6E3));for(var d=q(c.values()),e=d.next();!e.done;e=d.next())e=e.value,0==e.audioCapabilities.length&&delete e.audioCapabilities,0==e.videoCapabilities.length&&delete e.videoCapabilities;var f=d=new E;[!0,!1].forEach(function(b){var d=this;c.forEach(function(c,e){c.drmInfos.some(function(b){return!!b.licenseServerUri})==b&&(f=f["catch"](function(){if(!this.c)return navigator.requestMediaKeySystemAccess(e,[c])}.bind(d)))})}.bind(b));
f=f["catch"](function(){return Promise.reject(new D(2,6,6001))});f=f.then(function(b){if(this.c)return Promise.reject();this.u.clear();var d=b.getConfiguration(),e=d.videoCapabilities||[],f=q(d.audioCapabilities||[]);for(d=f.next();!d.done;d=f.next())this.u.add(d.value.contentType.toLowerCase());e=q(e);for(d=e.next();!d.done;d=e.next())this.u.add(d.value.contentType.toLowerCase());e=b.keySystem;d=c.get(b.keySystem);f=[];var g=[],p=[],r=[];Mc(d.drmInfos,f,g,p,r);1<g.length&&A.j("Multiple unique server certificates found! Only the first will be used.");
1<f.length&&A.j("Multiple unique license server URIs found! Only the first will be used.");this.a={keySystem:e,licenseServerUri:f[0],distinctiveIdentifierRequired:"required"==d.distinctiveIdentifier,persistentStateRequired:"required"==d.persistentState,audioRobustness:(d.audioCapabilities?d.audioCapabilities[0].robustness:"")||"",videoRobustness:(d.videoCapabilities?d.videoCapabilities[0].robustness:"")||"",serverCertificate:g[0],initData:p,keyIds:r};return this.a.licenseServerUri?b.createMediaKeys():
Promise.reject(new D(2,6,6012,this.a.keySystem))}.bind(b)).then(function(b){if(this.c)return Promise.reject();A.info("Created MediaKeys object for key system",this.a.keySystem);this.m=b;this.$=!0}.bind(b))["catch"](function(b){if(!this.c)return this.a=null,this.u.clear(),b instanceof D?Promise.reject(b):Promise.reject(new D(2,6,6002,b.message))}.bind(b));d.reject();return f}
function xc(b){b=Xb(b.f.clearKeys);if(0==b.size)return null;var c=[],d=[];b.forEach(function(b,e){var f=K.vc(e),g=K.vc(b);f={kty:"oct",kid:K.gc(f,!1),k:K.gc(g,!1)};c.push(f);d.push(f.kid)});b=JSON.stringify({keys:c});var e=JSON.stringify({kids:d});e=[{initData:new Uint8Array(oc(e)),initDataType:"keyids"}];return{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+window.btoa(b),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",
serverCertificate:null,initData:e,keyIds:[]}}
function Jc(b,c){try{A.A("Attempting to load an offline session",c);var d=b.m.createSession("persistent-license")}catch(g){var e=new D(2,6,6005,g.message);b.g(e);return Promise.reject(e)}b.i.B(d,"message",b.ud.bind(b));b.i.B(d,"keystatuseschange",b.td.bind(b));var f={initData:null,loaded:!1,Jc:Infinity,Ma:null};b.b.set(d,f);return d.load(c).then(function(b){if(this.c)return Promise.reject();A.H("Loaded offline session",c,b);if(b)return f.loaded=!0,Nc(this)&&this.o.resolve(),d;this.b["delete"](d);
this.g(new D(2,6,6013))}.bind(b),function(b){this.c||(this.b["delete"](d),this.g(new D(2,6,6005,b.message)))}.bind(b))}
function Kc(b,c,d){try{if(b.S){A.A("Creating new persistent session");var e=b.m.createSession("persistent-license")}else A.A("Creating new temporary session"),e=b.m.createSession()}catch(f){b.g(new D(2,6,6005,f.message));return}b.i.B(e,"message",b.ud.bind(b));b.i.B(e,"keystatuseschange",b.td.bind(b));b.b.set(e,{initData:d,loaded:!1,Jc:Infinity,Ma:null});try{d=b.f.initDataTransform(d,b.a)}catch(f){c=f;f instanceof D||(c=new D(2,6,6016,f));b.g(c);return}e.generateRequest(c,d)["catch"](function(c){if(!b.c){b.b["delete"](e);
if(c.errorCode&&c.errorCode.systemCode){var d=c.errorCode.systemCode;0>d&&(d+=Math.pow(2,32));d="0x"+d.toString(16)}b.g(new D(2,6,6006,c.message,c,d))}})}function Oc(b,c){if(Lc(c).startsWith("com.apple.fps")){var d=c.serverCertificate,e=Sb(b);b=Ub(b,e,d)}return b}l.ud=function(b){this.h&&this.f.delayLicenseRequestUntilPlayed&&this.h.paused&&!this.ma?this.K.push(b):Cc(this,b)};
function Cc(b,c){var d=c.target;A.A("Sending license request for session",d.sessionId,"of type",c.messageType);var e=b.b.get(d),f=b.a.licenseServerUri,g=b.f.advanced[b.a.keySystem];"individualization-request"==c.messageType&&g&&g.individualizationServer&&(f=g.individualizationServer);f=Bb([f],b.f.retryParameters);f.body=c.message;f.method="POST";f.licenseRequestType=c.messageType;f.sessionId=d.sessionId;"com.microsoft.playready"!=b.a.keySystem&&"com.chromecast.playready"!=b.a.keySystem||Pc(f);b.a.keySystem.startsWith("com.apple.fps")&&
b.f.fairPlayTransform&&Qc(f);var h=Date.now();b.C.Zb.request(2,f).promise.then(function(b){if(this.c)return Promise.reject();this.a.keySystem.startsWith("com.apple.fps")&&this.f.fairPlayTransform&&Rc(b);this.M+=(Date.now()-h)/1E3;A.A("Updating session",d.sessionId);return d.update(b.data).then(function(){var b=this;this.C.onEvent(new H("drmsessionupdate"));e&&(e.Ma&&e.Ma.resolve(),(new B(function(){e.loaded=!0;Nc(b)&&b.o.resolve()})).U(Sc))}.bind(this))}.bind(b),function(b){this.c||(b=new D(2,6,6007,
b),this.g(b),e&&e.Ma&&e.Ma.reject(b))}.bind(b))["catch"](function(b){this.c||(b=new D(2,6,6008,b.message),this.g(b),e&&e.Ma&&e.Ma.reject(b))}.bind(b))}
function Pc(b){var c=nc(b.body,!0,!0);if(c.includes("PlayReadyKeyMessage")){A.debug("Unwrapping PlayReady request.");c=(new DOMParser).parseFromString(c,"application/xml");for(var d=c.getElementsByTagName("HttpHeader"),e=0;e<d.length;++e)b.headers[d[e].getElementsByTagName("name")[0].textContent]=d[e].getElementsByTagName("value")[0].textContent;b.body=K.Ga(c.getElementsByTagName("Challenge")[0].textContent).buffer}else A.debug("PlayReady request is already unwrapped."),b.headers["Content-Type"]=
"text/xml; charset=utf-8"}function Qc(b){var c=new Uint8Array(b.body);c="spc="+K.gc(c);b.headers["Content-Type"]="application/x-www-form-urlencoded";b.body=oc(c)}function Rc(b){try{var c=lc(b.data)}catch(d){return}c=c.trim();"<ckc>"===c.substr(0,5)&&"</ckc>"===c.substr(-6)&&(c=c.slice(5,-6));try{c=JSON.parse(c).ckc}catch(d){}b.data=K.Ga(c).buffer}
l.td=function(b){b=b.target;A.H("Key status changed for session",b.sessionId);var c=this.b.get(b),d=!1;b.keyStatuses.forEach(function(b,e){if("string"==typeof e){var f=e;e=b;b=f}if("com.microsoft.playready"==this.a.keySystem&&16==e.byteLength&&(hc("Trident/")||fc())){f=new DataView(e);var g=f.getUint32(0,!0),m=f.getUint16(4,!0),n=f.getUint16(6,!0);f.setUint32(0,g,!1);f.setUint16(4,m,!1);f.setUint16(6,n,!1)}"com.microsoft.playready"==this.a.keySystem&&"status-pending"==b&&(b="usable");"status-pending"!=
b&&(c.loaded=!0);"expired"==b&&(d=!0);f=K.hc(new Uint8Array(e));this.na.set(f,b)}.bind(this));var e=b.expiration-Date.now();(0>e||d&&1E3>e)&&c&&!c.Ma&&(A.debug("Session has expired",b.sessionId),this.b["delete"](b),b.close()["catch"](function(){}));Nc(this)&&(this.o.resolve(),this.Z.U(Tc))};function rc(b){var c=b.na,d=b.ea;d.clear();c.forEach(function(b,c){return d.set(c,b)});c=Array.from(d.values());c.length&&c.every(function(b){return"expired"==b})&&b.g(new D(2,6,6014));b.C.sd(Yb(d))}
function Uc(){function b(b){return t(function h(){var c,f,n;return y(h,function(h){switch(h.l){case 1:return h.W=2,v(h,navigator.requestMediaKeySystemAccess(b,d),4);case 4:return c=h.R,n=(f=c.getConfiguration().sessionTypes)?f.includes("persistent-license"):!1,hc("Tizen 3")&&(n=!1),e.set(b,{persistentState:n}),v(h,c.createMediaKeys(),5);case 5:ya(h,0);break;case 2:za(h),e.set(b,null),w(h)}})})}var c=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],d=[{videoCapabilities:c,
persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:c}],e=new Map;c="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").map(function(c){return b(c)});return Promise.all(c).then(function(){return Yb(e)})}
function Vc(b,c){var d=c.audio,e=c.video;if(d&&d.encrypted&&!fc()&&!b.u.has(Zb(d.mimeType,d.codecs).toLowerCase())||e&&e.encrypted&&!fc()&&!b.u.has(Zb(e.mimeType,e.codecs).toLowerCase()))return!1;var f=Lc(b.a);return 0==c.drmInfos.length||c.drmInfos.some(function(b){return b.keySystem==f})}
function Wc(b,c){if(!b.length)return c;if(!c.length)return b;for(var d=[],e=0;e<b.length;e++)for(var f=0;f<c.length;f++)if(b[e].keySystem==c[f].keySystem){var g=b[e];f=c[f];var h=[];h=h.concat(g.initData||[]);h=h.concat(f.initData||[]);var k=[];k=k.concat(g.keyIds);k=k.concat(f.keyIds);d.push({keySystem:g.keySystem,licenseServerUri:g.licenseServerUri||f.licenseServerUri,distinctiveIdentifierRequired:g.distinctiveIdentifierRequired||f.distinctiveIdentifierRequired,persistentStateRequired:g.persistentStateRequired||
f.persistentStateRequired,videoRobustness:g.videoRobustness||f.videoRobustness,audioRobustness:g.audioRobustness||f.audioRobustness,serverCertificate:g.serverCertificate||f.serverCertificate,initData:h,keyIds:k});break}return d}
function Xc(b){return t(function d(){var e;return y(d,function(d){switch(d.l){case 1:return e=new Promise(function(b,d){(new B(d)).U(Yc)}),d.W=2,v(d,Promise.race([Promise.all([b.close(),b.closed]),e]),4);case 4:ya(d,0);break;case 2:za(d),A.j("Timeout waiting for session close"),w(d)}})})}
function uc(b){return t(function d(){var e;return y(d,function(d){switch(d.l){case 1:return e=Array.from(b.b.keys()),b.b.clear(),v(d,Promise.all(e.map(function(b){return t(function k(){return y(k,function(d){switch(d.l){case 1:return A.A("Closing session",b.sessionId),d.W=2,v(d,Xc(b),4);case 4:ya(d,0);break;case 2:za(d),w(d)}})})})),0)}})})}function sc(b){b.b.forEach(function(c,d){var e=c.Jc,f=d.expiration;isNaN(f)&&(f=Infinity);f!=e&&(b.C.onExpirationUpdated(d.sessionId,f),c.Jc=f)})}
function Nc(b){b=b.b.values();return Wb(b,function(b){return b.loaded})}function yc(b,c){var d=[];c.forEach(function(b,c){d.push({keySystem:c,licenseServerUri:b,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})});for(var e=q(b),f=e.next();!f.done;f=e.next())f.value.drmInfos=d}
function Mc(b,c,d,e,f){b.forEach(function(b){c.includes(b.licenseServerUri)||c.push(b.licenseServerUri);b.serverCertificate&&(d.some(function(c){return K.Fa(c,b.serverCertificate)})||d.push(b.serverCertificate));b.initData&&b.initData.forEach(function(b){e.some(function(c){return c.keyId&&c.keyId==b.keyId?!0:c.initDataType==b.initDataType&&K.Fa(c.initData,b.initData)})||e.push(b)});if(b.keyIds)for(var g=0;g<b.keyIds.length;++g)f.includes(b.keyIds[g])||f.push(b.keyIds[g])})}
function zc(b,c,d){if(b.keySystem&&("org.w3.clearkey"!=b.keySystem||!b.licenseServerUri)){c.size&&(c=c.get(b.keySystem)||"",b.licenseServerUri=c);b.keyIds||(b.keyIds=[]);if(d=d.get(b.keySystem))b.distinctiveIdentifierRequired||(b.distinctiveIdentifierRequired=d.distinctiveIdentifierRequired),b.persistentStateRequired||(b.persistentStateRequired=d.persistentStateRequired),b.videoRobustness||(b.videoRobustness=d.videoRobustness),b.audioRobustness||(b.audioRobustness=d.audioRobustness),b.serverCertificate||
(b.serverCertificate=d.serverCertificate);window.cast&&window.cast.__platform__&&"com.microsoft.playready"==b.keySystem&&(b.keySystem="com.chromecast.playready")}}var Yc=1,Sc=5,Tc=.5;function Zc(){this.a=new muxjs.mp4.CaptionParser;this.g=[];this.f={}}Zc.prototype.init=function(b){var c=muxjs.mp4.probe;b=new Uint8Array(b);this.g=c.videoTrackIds(b);this.f=c.timescale(b);this.a.init()};Zc.prototype.b=function(b,c){var d=new Uint8Array(b);(d=this.a.parse(d,this.g,this.f))&&d.captions&&c(d.captions);this.a.clearParsedCaptions()};Zc.prototype.c=function(){this.a.resetCaptionStream()};function $c(){}$c.prototype.init=function(){};$c.prototype.b=function(){};$c.prototype.c=function(){};function ad(b){return!b||1==b.length&&1E-6>b.end(0)-b.start(0)?null:b.length?b.end(b.length-1):null}function bd(b,c,d){d=void 0===d?0:d;return!b||!b.length||1==b.length&&1E-6>b.end(0)-b.start(0)||c>b.end(b.length-1)?!1:c+d>=b.start(0)}function cd(b,c){if(!b||!b.length||1==b.length&&1E-6>b.end(0)-b.start(0))return 0;for(var d=0,e=b.length-1;0<=e&&b.end(e)>c;--e)d+=b.end(e)-Math.max(b.start(e),c);return d}
function dd(b){if(!b)return[];for(var c=[],d=0;d<b.length;d++)c.push({start:b.start(d),end:b.end(d)});return c};var ed={Sd:function(b,c){return b.reduce(function(b,c,f){return c["catch"](b.bind(null,f))}.bind(null,c),Promise.reject())},cd:function(b,c){return b.concat(c)},$b:function(){},Ha:function(b){return null!=b}};function M(b,c){if(0==c.length)return b;var d=c.map(function(b){return new Sa(b)});return b.map(function(b){return new Sa(b)}).map(function(b){return d.map(b.resolve.bind(b))}).reduce(ed.cd,[]).map(function(b){return b.toString()})}function fd(b,c){return{keySystem:b,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:c||[],keyIds:[]}}
var gd={ad:"video",Kd:"audio",Pa:"text",tf:"image",rf:"application"},hd=1/15;function id(){this.a=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0});this.b=null;this.g=[];this.c=[];this.f=!1;this.a.on("data",this.i.bind(this));this.a.on("done",this.h.bind(this))}id.prototype.destroy=function(){this.a.dispose();this.a=null;return Promise.resolve()};function jd(b,c){return window.muxjs&&"mp2t"==b.toLowerCase().split(";")[0].split("/")[1]?c?MediaSource.isTypeSupported(kd(c,b)):MediaSource.isTypeSupported(kd("audio",b))||MediaSource.isTypeSupported(kd("video",b)):!1}
function kd(b,c){var d=c.replace(/mp2t/i,"mp4");"audio"==b&&(d=d.replace("video","audio"));var e=/avc1\.(66|77|100)\.(\d+)/.exec(d);if(e){var f="avc1.",g=e[1],h=Number(e[2]);f=("66"==g?f+"4200":"77"==g?f+"4d00":f+"6400")+(h>>4).toString(16);f+=(h&15).toString(16);d=d.replace(e[0],f)}return d}function ld(b,c){b.f=!0;b.b=new E;b.g=[];b.c=[];var d=new Uint8Array(c);b.a.push(d);b.a.flush();b.f&&b.b.reject(new D(2,3,3018));return b.b}
id.prototype.i=function(b){this.c=b.captions;var c=new Uint8Array(b.data.byteLength+b.initSegment.byteLength);c.set(b.initSegment,0);c.set(b.data,b.initSegment.byteLength);this.g.push(c)};id.prototype.h=function(){var b={data:K.concat.apply(null,this.g),captions:this.c};this.b.resolve(b);this.f=!1};function N(b,c,d){this.startTime=b;this.direction=md;this.endTime=c;this.payload=d;this.region=new nd;this.position=null;this.positionAlign=od;this.size=0;this.textAlign=pd;this.writingMode=qd;this.lineInterpretation=rd;this.line=null;this.lineHeight="";this.lineAlign=sd;this.displayAlign=td;this.fontSize=this.backgroundImage=this.backgroundColor=this.color="";this.fontWeight=ud;this.fontStyle=vd;this.fontFamily="";this.textDecoration=[];this.wrapLine=!0;this.id="";this.nestedCues=[];this.spacer=
!1}z("shaka.text.Cue",N);N.prototype.clone=function(){var b=new N(0,0,""),c;for(c in this)b[c]=this[c],b[c]&&b[c].constructor==Array&&(b[c]=b[c].slice());return b};var od="auto";N.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:od};var pd="center",wd={LEFT:"left",RIGHT:"right",CENTER:pd,START:"start",END:"end"};N.textAlign=wd;var td="after",xd={BEFORE:"before",CENTER:"center",AFTER:td};N.displayAlign=xd;var md="ltr";N.direction={HORIZONTAL_LEFT_TO_RIGHT:md,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};
var qd="horizontal-tb";N.writingMode={HORIZONTAL_TOP_TO_BOTTOM:qd,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var rd=0;N.lineInterpretation={LINE_NUMBER:rd,PERCENTAGE:1};var sd="start",yd={CENTER:"center",START:sd,END:"end"};N.lineAlign=yd;var ud=400;N.fontWeight={NORMAL:ud,BOLD:700};var vd="normal",zd={NORMAL:vd,ITALIC:"italic",OBLIQUE:"oblique"};N.fontStyle=zd;N.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"};
function nd(){this.id="";this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0;this.height=this.width=100;this.viewportAnchorUnits=this.widthUnits=this.heightUnits=Ad;this.scroll=Bd}z("shaka.text.CueRegion",nd);var Ad=1;nd.units={PX:0,PERCENTAGE:Ad,LINES:2};var Bd="";nd.scrollMode={NONE:Bd,UP:"up"};function Cd(b){this.g=null;this.c=b;this.f=this.o=0;this.h=Infinity;this.b=this.a=null;this.m="";this.i=new Map}var Dd={};z("shaka.text.TextEngine.registerParser",function(b,c){Dd[b]=c});z("shaka.text.TextEngine.unregisterParser",function(b){delete Dd[b]});function Ed(b){return Dd[b]||window.muxjs&&"application/cea-608"==b?!0:!1}Cd.prototype.destroy=function(){this.c=this.g=null;this.i.clear();return Promise.resolve()};
Cd.prototype.Ac=function(b){var c={periodStart:0,segmentStart:null,segmentEnd:0};try{return this.g.parseMedia(new Uint8Array(b),c)[0].startTime}catch(d){throw new D(2,2,2009,d);}};
function Fd(b,c,d,e){return Promise.resolve().then(function(){if(this.g&&this.c)if(null==d||null==e)this.g.parseInit(new Uint8Array(c));else{var b={periodStart:this.o,segmentStart:d,segmentEnd:e};b=this.g.parseMedia(new Uint8Array(c),b).filter(function(b){return b.startTime>=this.f&&b.startTime<this.h}.bind(this));this.c.append(b);null==this.a&&(this.a=Math.max(d,this.f));this.b=Math.min(e,this.h)}}.bind(b))}
Cd.prototype.remove=function(b,c){return Promise.resolve().then(function(){!this.c||!this.c.remove(b,c)||null==this.a||c<=this.a||b>=this.b||(b<=this.a&&c>=this.b?this.a=this.b=null:b<=this.a&&c<this.b?this.a=c:b>this.a&&c>=this.b&&(this.b=b))}.bind(this))};function Gd(b,c,d){b.m=c;if(c=b.i.get(c))for(var e=q(c.keys()),f=e.next();!f.done;f=e.next())(f=c.get(f.value).filter(function(b){return b.endTime<=d}))&&b.c.append(f)}
function Hd(b,c,d,e,f){var g=d+" "+e,h=new Map;c=q(c);for(var k=c.next();!k.done;k=c.next()){var m=k.value;k=m.stream;h.has(k)||h.set(k,new Map);h.get(k).has(g)||h.get(k).set(g,[]);m.startTime+=f;m.endTime+=f;m.startTime>=b.f&&m.startTime<b.h&&(m=new N(m.startTime,m.endTime,m.text),h.get(k).get(g).push(m),k==b.m&&b.c.append([m]))}f=q(h.keys());for(g=f.next();!g.done;g=f.next())for(g=g.value,b.i.has(g)||b.i.set(g,new Map),c=q(h.get(g).keys()),k=c.next();!k.done;k=c.next())k=k.value,m=h.get(g).get(k),
b.i.get(g).set(k,m);b.a=null==b.a?Math.max(d,b.f):Math.min(b.a,Math.max(d,b.f));b.b=Math.max(b.b,Math.min(e,b.h))};function Id(b,c,d){this.f=b;this.g=d;this.b={};this.a=null;this.c={};this.i=new J;this.w=!1;this.m={};this.o=c;b=this.u=new E;c=new MediaSource;this.i.oa(c,"sourceopen",b.resolve);this.f.src=Jd(c);this.h=c}var Jd=window.URL.createObjectURL;function Kd(b){var c=Zb(b.mimeType,b.codecs),d=$b(b);return Ed(c)||MediaSource.isTypeSupported(d)||jd(c,b.type)}l=Id.prototype;
l.destroy=function(){var b=this;this.w=!0;var c=[],d;for(d in this.c){var e=this.c[d],f=e[0];this.c[d]=e.slice(0,1);f&&c.push(f.p["catch"](ed.$b));for(f=1;f<e.length;++f)e[f].p.reject()}this.a&&c.push(this.a.destroy());this.g&&c.push(this.g.destroy());for(var g in this.m)c.push(this.m[g].destroy());return Promise.all(c).then(function(){b.i&&(b.i.release(),b.i=null);b.f&&(b.f.removeAttribute("src"),b.f.load(),b.f=null);b.h=null;b.a=null;b.g=null;b.b={};b.m={};b.o=null;b.c={}})};
l.init=function(b,c){var d=this;return t(function f(){var g;return y(f,function(f){switch(f.l){case 1:return g=gd,v(f,d.u,2);case 2:b.forEach(function(b,f){var h=Zb(b.mimeType,b.codecs);f==g.Pa?Ld(d,h):(!c&&MediaSource.isTypeSupported(h)||!jd(h,f)||(d.m[f]=new id,h=kd(f,h)),h=d.h.addSourceBuffer(h),d.i.B(h,"error",d.ff.bind(d,f)),d.i.B(h,"updateend",d.ub.bind(d,f)),d.b[f]=h,d.c[f]=[])}),w(f)}})})};function Ld(b,c){b.a||(b.a=new Cd(b.g));"application/cea-608"!=c&&(b.a.g=new Dd[c])}
function Md(b){return b.h?"ended"==b.h.readyState:!0}function Nd(b,c){if("text"==c)var d=b.a.a;else d=Od(b,c),d=!d||1==d.length&&1E-6>d.end(0)-d.start(0)?null:1==d.length&&0>d.start(0)?0:d.length?d.start(0):null;return d}function Pd(b,c){return"text"==c?b.a.b:ad(Od(b,c))}function Qd(b,c,d){if("text"==c)return b=b.a,null==b.b||b.b<d?0:b.b-Math.max(d,b.a);b=Od(b,c);return cd(b,d)}
l.wc=function(b){b.total=dd(this.f.buffered);b.audio=dd(Od(this,"audio"));b.video=dd(Od(this,"video"));b.text=[];if(this.a){var c=this.a.a,d=this.a.b;null!=c&&null!=d&&b.text.push({start:c,end:d})}};function Od(b,c){try{return b.b[c].buffered}catch(d){return c in b.b&&A.error("failed to get buffered range for "+c,d),null}}
function Rd(b,c,d,e,f,g){if("text"==c)return Fd(b.a,d,e,f);if(b.m[c])return ld(b.m[c],d).then(function(b){this.a||Ld(this,"text/vtt");b.captions&&b.captions.length&&Hd(this.a,b.captions,e,f,this.b.video.timestampOffset);return Sd(this,c,this.Hd.bind(this,c,b.data.buffer))}.bind(b));g&&window.muxjs&&(b.a||Ld(b,"text/vtt"),null==e&&null==f?b.o.init(d):b.o.b(d,function(c){c.length&&Hd(b.a,c,e,f,b.b.video.timestampOffset)}));return Sd(b,c,b.Hd.bind(b,c,d))}
function Td(b,c){var d=Pd(b,"video")||0;Gd(b.a,c,d)}l.remove=function(b,c,d){return"text"==b?this.a.remove(c,d):Sd(this,b,this.Ad.bind(this,b,c,d))};function Ud(b,c){if("text"==c){if(!b.a)return Promise.resolve();b.o.c();return b.a.remove(0,Infinity)}return Sd(b,c,b.Ad.bind(b,c,0,b.h.duration))}l.flush=function(b){return"text"==b?Promise.resolve():Sd(this,b,this.Wd.bind(this,b))};
function Vd(b,c,d,e,f){return"text"==c?(b.a.o=d,b=b.a,b.f=e,b.h=f,Promise.resolve()):Promise.all([Sd(b,c,b.Md.bind(b,c)),Sd(b,c,b.ef.bind(b,c,d)),Sd(b,c,b.af.bind(b,c,e,f))])}l.endOfStream=function(b){return Wd(this,function(){Md(this)||(b?this.h.endOfStream(b):this.h.endOfStream())}.bind(this))};l.Za=function(b){return Wd(this,function(){this.h.duration=b}.bind(this))};l.ba=function(){return this.h.duration};l.Hd=function(b,c){this.b[b].appendBuffer(c)};
l.Ad=function(b,c,d){d<=c?this.ub(b):this.b[b].remove(c,d)};l.Md=function(b){var c=this.b[b].appendWindowStart,d=this.b[b].appendWindowEnd;this.b[b].abort();this.b[b].appendWindowStart=c;this.b[b].appendWindowEnd=d;this.ub(b)};l.Wd=function(b){this.f.currentTime-=.001;this.ub(b)};l.ef=function(b,c){0>c&&(c+=.001);this.b[b].timestampOffset=c;this.ub(b)};l.af=function(b,c,d){this.b[b].appendWindowStart=0;this.b[b].appendWindowEnd=d;this.b[b].appendWindowStart=c;this.ub(b)};
l.ff=function(b){this.c[b][0].p.reject(new D(2,3,3014,this.f.error?this.f.error.code:0))};l.ub=function(b){var c=this.c[b][0];c&&(c.p.resolve(),Xd(this,b))};function Sd(b,c,d){if(b.w)return Promise.reject();d={start:d,p:new E};b.c[c].push(d);if(1==b.c[c].length)try{d.start()}catch(e){"QuotaExceededError"==e.name?d.p.reject(new D(2,3,3017,c)):d.p.reject(new D(2,3,3015,e)),Xd(b,c)}return d.p}
function Wd(b,c){if(b.w)return Promise.reject();var d=[],e;for(e in b.b){var f=new E,g={start:function(b){b.resolve()}.bind(null,f),p:f};b.c[e].push(g);d.push(f);1==b.c[e].length&&g.start()}return Promise.all(d).then(function(){try{c()}catch(m){var b=Promise.reject(new D(2,3,3015,m))}for(var d in this.b)Xd(this,d);return b}.bind(b),function(b){throw b;}.bind(b))}function Xd(b,c){b.c[c].shift();var d=b.c[c][0];if(d)try{d.start()}catch(e){d.p.reject(new D(2,3,3015,e)),Xd(b,c)}};function Yd(b,c){b=O(b);c=O(c);return b.split("-")[0]==c.split("-")[0]}function Zd(b,c){b=O(b);c=O(c);var d=b.split("-"),e=c.split("-");return d[0]==e[0]&&1==d.length&&2==e.length}function O(b){b=b.split("-");b=q(b);var c=b.next().value;c=void 0===c?"":c;var d=b.next().value;d=void 0===d?"":d;b=la(b);c=c.toLowerCase();c=$d.get(c)||c;d=d.toUpperCase();return[d?c+"-"+d:c].concat(b instanceof Array?b:la(q(b))).join("-")}
function ae(b){return b.language?O(b.language):b.audio&&b.audio.language?O(b.audio.language):b.video&&b.video.language?O(b.video.language):"und"}
function be(b,c){for(var d=O(b),e=new Set,f=q(c),g=f.next();!g.done;g=f.next())e.add(O(g.value));f=q(e);for(g=f.next();!g.done;g=f.next())if(g=g.value,g==d)return g;f=q(e);for(g=f.next();!g.done;g=f.next())if(g=g.value,Zd(g,d))return g;f=q(e);for(g=f.next();!g.done;g=f.next()){var h=g=g.value,k=d;h=O(h);k=O(k);h=h.split("-");k=k.split("-");if(2==h.length&&2==k.length&&h[0]==k[0])return g}e=q(e);for(g=e.next();!g.done;g=e.next())if(f=g.value,Zd(d,f))return f;return null}
var $d=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze",
"cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice",
"is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao",
"mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san",
"sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie",
"vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function ce(b,c){function d(b){var c="";b.video&&(c=bc(b.video.codecs)[0]);var d="";b.audio&&(d=bc(b.audio.codecs)[0]);return c+"-"+d}var e=b.periods.reduce(function(b,c){return b.concat(c.variants)},[]);e=de(e,c);var f=new sb;e=q(e);for(var g=e.next();!g.done;g=e.next()){g=g.value;var h=d(g);f.push(h,g)}var k=null,m=Infinity;f.forEach(function(b,c){for(var d=0,e=0,f=q(c),g=f.next();!g.done;g=f.next())d+=g.value.bandwidth||0,++e;d/=e;A.debug("codecs",b,"avg bandwidth",d);d<m&&(k=b,m=d)});f=q(b.periods);
for(e=f.next();!e.done;e=f.next())e=e.value,e.variants=e.variants.filter(function(b){if(d(b)==k)return!0;A.debug("Dropping Variant (better codec available)",b);return!1})}
function ee(b,c,d){function e(b,c,d){return b>=c&&b<=d}var f=b.video;return f&&f.width&&f.height&&(!e(f.width,c.minWidth,Math.min(c.maxWidth,d.width))||!e(f.height,c.minHeight,Math.min(c.maxHeight,d.height))||!e(f.width*f.height,c.minPixels,c.maxPixels))||b&&b.video&&b.video.frameRate&&!e(b.video.frameRate,c.minFrameRate,c.maxFrameRate)||!e(b.bandwidth,c.minBandwidth,c.maxBandwidth)?!1:!0}
function fe(b,c,d){var e=!1;b.forEach(function(b){var f=b.allowedByApplication;b.allowedByApplication=ee(b,c,d);f!=b.allowedByApplication&&(e=!0)});return e}
function ge(b,c,d,e){e.variants=e.variants.filter(function(e){if(b&&b.$&&!Vc(b,e))return A.debug("Dropping variant - not compatible with key system",e),!1;var f=e.audio;e=e.video;return f&&!Kd(f)?(A.debug("Dropping variant - audio not compatible with platform",he(f)),!1):e&&!Kd(e)?(A.debug("Dropping variant - video not compatible with platform",he(e)),!1):f&&c&&!ie(f,c)?(A.debug("Droping variant - not compatible with active audio","active audio",he(c),"variant.audio",he(f)),!1):e&&d&&!ie(e,d)?(A.debug("Droping variant - not compatible with active video",
"active video",he(d),"variant.video",he(e)),!1):!0});e.textStreams=e.textStreams.filter(function(b){var c=Ed(Zb(b.mimeType,b.codecs));c||A.debug("Dropping text stream. Is not supported by the platform.",b);return c})}function ie(b,c){return b.mimeType!=c.mimeType||b.codecs.split(".")[0]!=c.codecs.split(".")[0]?!1:!0}
function je(b){var c=b.audio,d=b.video,e=c?c.codecs:null,f=d?d.codecs:null,g=[];f&&g.push(f);e&&g.push(e);var h=[];d&&h.push(d.mimeType);c&&h.push(c.mimeType);h=h[0]||null;var k=[];c&&k.push(c.kind);d&&k.push(d.kind);k=k[0]||null;var m=new Set;c&&c.roles.forEach(function(b){return m.add(b)});d&&d.roles.forEach(function(b){return m.add(b)});b={id:b.id,active:!1,type:"variant",bandwidth:b.bandwidth,language:b.language,label:null,kind:k,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:h,
codecs:g.join(", "),audioCodec:e,videoCodec:f,primary:b.primary,roles:Array.from(m),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null};d&&(b.videoId=d.id,b.originalVideoId=d.originalId,b.width=d.width||null,b.height=d.height||null,b.frameRate=d.frameRate||null,b.pixelAspectRatio=d.pixelAspectRatio||null,b.videoBandwidth=d.bandwidth||null);c&&(b.audioId=c.id,b.originalAudioId=
c.originalId,b.channelsCount=c.channelsCount,b.audioSamplingRate=c.audioSamplingRate,b.audioBandwidth=c.bandwidth||null,b.label=c.label,b.audioRoles=c.roles);return b}
function ke(b){return{id:b.id,active:!1,type:"text",bandwidth:0,language:b.language,label:b.label,kind:b.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:b.mimeType,codecs:b.codecs||null,audioCodec:null,videoCodec:null,primary:b.primary,roles:b.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:b.originalId}}
function le(b){b.__shaka_id||(b.__shaka_id=me++);return b.__shaka_id}var me=0;function ne(b){var c=oe(b);c.active=b.enabled;c.type="variant";c.originalAudioId=b.id;"main"==b.kind&&(c.primary=!0);b.kind&&(c.roles=[b.kind],c.audioRoles=[b.kind]);return c}
function oe(b){return{id:le(b),active:!1,type:"",bandwidth:0,language:O(b.language),label:b.label,kind:b.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}}
function pe(b){return b.allowedByApplication&&b.allowedByKeySystem}function de(b,c){var d=b.filter(function(b){return b.audio&&b.audio.channelsCount}),e=new Map;d=q(d);for(var f=d.next();!f.done;f=d.next()){f=f.value;var g=f.audio.channelsCount;e.has(g)||e.set(g,[]);e.get(g).push(f)}d=Array.from(e.keys());if(0==d.length)return b;f=d.filter(function(b){return b<=c});return f.length?e.get(Math.max.apply(null,f)):e.get(Math.min.apply(null,d))}
function qe(b,c,d){var e=b,f=b.filter(function(b){return b.primary});f.length&&(e=f);var g=e.length?e[0].language:"";e=e.filter(function(b){return b.language==g});if(c){var h=be(O(c),b.map(function(b){return b.language}));h&&(e=b.filter(function(b){return O(b.language)==h}))}if(d){b=re(e,d);if(b.length)return b;A.j("No exact match for the text role could be found.")}else if(b=e.filter(function(b){return 0==b.roles.length}),b.length)return b;b=e.map(function(b){return b.roles}).reduce(ed.cd,[]);return b.length?
re(e,b[0]):e}function re(b,c){return b.filter(function(b){return b.roles.includes(c)})}function se(b,c,d){for(var e=0;e<d.length;e++)if(d[e].audio==b&&d[e].video==c)return d[e];return null}function te(b){var c=[];b.audio&&c.push(b.audio);b.video&&c.push(b.video);return c}
function he(b){return"audio"==b.type?"type=audio codecs="+b.codecs+" bandwidth="+b.bandwidth+" channelsCount="+b.channelsCount+" audioSamplingRate="+b.audioSamplingRate:"video"==b.type?"type=video codecs="+b.codecs+" bandwidth="+b.bandwidth+" frameRate="+b.frameRate+" width="+b.width+" height="+b.height:"unexpected stream type"};function P(){this.h=null;this.c=!1;this.b=new Qa;this.g=[];this.i=!1;this.a=this.f=null}z("shaka.abr.SimpleAbrManager",P);P.prototype.stop=function(){this.h=null;this.c=!1;this.g=[];this.f=null};P.prototype.stop=P.prototype.stop;P.prototype.init=function(b){this.h=b};P.prototype.init=P.prototype.init;
P.prototype.chooseVariant=function(){var b=ue(this.a.restrictions,this.g),c=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);this.g.length&&!b.length&&(A.j("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),b=ue(null,this.g),b=[b[0]]);for(var d=b[0]||null,e=0;e<b.length;++e){var f=b[e],g=f.bandwidth/this.a.bandwidthDowngradeTarget,h=(b[e+1]||{bandwidth:Infinity}).bandwidth/this.a.bandwidthUpgradeTarget;A.H("Bandwidth ranges:",(f.bandwidth/1E6).toFixed(3),
(g/1E6).toFixed(3),(h/1E6).toFixed(3));c>=g&&c<=h&&(d=f)}this.f=Date.now();return d};P.prototype.chooseVariant=P.prototype.chooseVariant;P.prototype.enable=function(){this.c=!0};P.prototype.enable=P.prototype.enable;P.prototype.disable=function(){this.c=!1};P.prototype.disable=P.prototype.disable;
P.prototype.segmentDownloaded=function(b,c){A.H("Segment downloaded:","deltaTimeMs="+b,"numBytes="+c,"lastTimeChosenMs="+this.f,"enabled="+this.c);var d=this.b;if(!(16E3>c)){var e=8E3*c/b,f=b/1E3;d.a+=c;Na(d.b,f,e);Na(d.c,f,e)}if(null!=this.f&&this.c)a:{A.H("Suggesting Streams...");if(!this.i){if(!(128E3<=this.b.a)){A.H("Still waiting for a good estimate...");break a}this.i=!0}else if(Date.now()-this.f<1E3*this.a.switchInterval){A.H("Still within switch interval...");break a}d=this.chooseVariant();
e=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);A.debug("Calling switch_(), bandwidth="+Math.round(e/1E3)+" kbps");this.h(d)}};P.prototype.segmentDownloaded=P.prototype.segmentDownloaded;P.prototype.getBandwidthEstimate=function(){return this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate)};P.prototype.getBandwidthEstimate=P.prototype.getBandwidthEstimate;P.prototype.setVariants=function(b){this.g=b};P.prototype.setVariants=P.prototype.setVariants;
P.prototype.configure=function(b){this.a=b};P.prototype.configure=P.prototype.configure;function ue(b,c){b&&(c=c.filter(function(c){return ee(c,b,{width:Infinity,height:Infinity})}));return c.sort(function(b,c){return b.bandwidth-c.bandwidth})};function Q(b,c){this.G=b;this.b=c==ve;this.a=0}z("shaka.util.DataViewReader",Q);var ve=1;Q.Endianness={sf:0,uf:ve};Q.prototype.ua=function(){return this.a<this.G.byteLength};Q.prototype.hasMoreData=Q.prototype.ua;Q.prototype.ca=function(){return this.a};Q.prototype.getPosition=Q.prototype.ca;Q.prototype.ce=function(){return this.G.byteLength};Q.prototype.getLength=Q.prototype.ce;Q.prototype.Mc=function(){try{var b=this.G.getUint8(this.a);this.a+=1;return b}catch(c){we()}};Q.prototype.readUint8=Q.prototype.Mc;
Q.prototype.yd=function(){try{var b=this.G.getUint16(this.a,this.b);this.a+=2;return b}catch(c){we()}};Q.prototype.readUint16=Q.prototype.yd;Q.prototype.F=function(){try{var b=this.G.getUint32(this.a,this.b);this.a+=4;return b}catch(c){we()}};Q.prototype.readUint32=Q.prototype.F;Q.prototype.xd=function(){try{var b=this.G.getInt32(this.a,this.b);this.a+=4;return b}catch(c){we()}};Q.prototype.readInt32=Q.prototype.xd;
Q.prototype.Gb=function(){try{if(this.b){var b=this.G.getUint32(this.a,!0);var c=this.G.getUint32(this.a+4,!0)}else c=this.G.getUint32(this.a,!1),b=this.G.getUint32(this.a+4,!1)}catch(d){we()}if(2097151<c)throw new D(2,3,3001);this.a+=8;return c*Math.pow(2,32)+b};Q.prototype.readUint64=Q.prototype.Gb;Q.prototype.Ya=function(b){this.a+b>this.G.byteLength&&we();var c=new Uint8Array(this.G.buffer,this.G.byteOffset+this.a,b);this.a+=b;return c};Q.prototype.readBytes=Q.prototype.Ya;
Q.prototype.P=function(b){this.a+b>this.G.byteLength&&we();this.a+=b};Q.prototype.skip=Q.prototype.P;Q.prototype.Xe=function(b){this.a<b&&we();this.a-=b};Q.prototype.rewind=Q.prototype.Xe;Q.prototype.seek=function(b){(0>b||b>this.G.byteLength)&&we();this.a=b};Q.prototype.seek=Q.prototype.seek;Q.prototype.Lc=function(){for(var b=this.a;this.ua()&&0!=this.G.getUint8(this.a);)this.a+=1;b=new Uint8Array(this.G.buffer,this.G.byteOffset+b,this.a-b);this.a+=1;return lc(b)};
Q.prototype.readTerminatedString=Q.prototype.Lc;function we(){throw new D(2,3,3E3);};function R(){this.c=[];this.b=[];this.a=!1}z("shaka.util.Mp4Parser",R);R.prototype.L=function(b,c){var d=xe(b);this.c[d]=0;this.b[d]=c;return this};R.prototype.box=R.prototype.L;R.prototype.sa=function(b,c){var d=xe(b);this.c[d]=1;this.b[d]=c;return this};R.prototype.fullBox=R.prototype.sa;R.prototype.stop=function(){this.a=!0};R.prototype.stop=R.prototype.stop;
R.prototype.parse=function(b,c){var d=new Uint8Array(b);d=new Q(new DataView(d.buffer,d.byteOffset,d.byteLength),0);for(this.a=!1;d.ua()&&!this.a;)this.dc(0,d,c)};R.prototype.parse=R.prototype.parse;
R.prototype.dc=function(b,c,d){var e=c.ca(),f=c.F(),g=c.F();A.H("Parsing MP4 box",ye(g));switch(f){case 0:f=c.G.byteLength-e;break;case 1:f=c.Gb()}var h=this.b[g];if(h){var k=null,m=null;1==this.c[g]&&(m=c.F(),k=m>>>24,m&=16777215);g=e+f;d&&g>c.G.byteLength&&(g=c.G.byteLength);g-=c.ca();c=0<g?c.Ya(g):new Uint8Array(0);c=new Q(new DataView(c.buffer,c.byteOffset,c.byteLength),0);h({parser:this,partialOkay:d||!1,version:k,flags:m,reader:c,size:f,start:e+b})}else c.P(Math.min(e+f-c.ca(),c.G.byteLength-
c.ca()))};R.prototype.parseNext=R.prototype.dc;function ze(b){for(var c=null!=b.flags?12:8;b.reader.ua()&&!b.parser.a;)b.parser.dc(b.start+c,b.reader,b.partialOkay)}R.children=ze;function Ae(b){for(var c=null!=b.flags?12:8,d=b.reader.F();0<d&&!b.parser.a;--d)b.parser.dc(b.start+c,b.reader,b.partialOkay)}R.sampleDescription=Ae;function Be(b){return function(c){b(c.reader.Ya(c.reader.G.byteLength-c.reader.ca()))}}R.allData=Be;
function xe(b){for(var c=0,d=0;d<b.length;d++)c=c<<8|b.charCodeAt(d);return c}function ye(b){return String.fromCharCode(b>>24&255,b>>16&255,b>>8&255,b&255)}R.typeToString=ye;function Ce(b){var c=this;this.b=[];this.a=[];this.data=[];(new R).L("moov",ze).sa("pssh",function(b){if(1<b.version)A.j("Unrecognized PSSH version found!");else{var d=b.reader.G;d=new Uint8Array(d.buffer,d.byteOffset-12,b.size);c.data.push(d);c.b.push(K.hc(b.reader.Ya(16)));if(0<b.version){d=b.reader.F();for(var f=0;f<d;++f){var g=K.hc(b.reader.Ya(16));c.a.push(g)}}}}).parse(b);0==this.data.length&&A.j("No pssh box found!")}
function De(b){if(!b)return b;var c=new Ce(b);if(1>=c.data.length)return b;b=[];var d={};c=q(c.data);for(var e=c.next();!e.done;d={Wb:d.Wb},e=c.next())d.Wb=e.value,b.some(function(b){return function(c){return K.Fa(c,b.Wb)}}(d))||b.push(d.Wb);return K.concat.apply(K,b instanceof Array?b:la(q(b)))};var S={Sb:function(b,c){var d=S.O(b,c);return 1!=d.length?null:d[0]},uc:function(b,c,d){b=S.gd(b,c,d);return 1!=b.length?null:b[0]},O:function(b,c){return Array.prototype.filter.call(b.childNodes,function(b){return b instanceof Element&&b.tagName==c})},gd:function(b,c,d){return Array.prototype.filter.call(b.childNodes,function(b){return b instanceof Element&&b.localName==d&&b.namespaceURI==c})},getAttributeNS:function(b,c,d){return b.hasAttributeNS(c,d)?b.getAttributeNS(c,d):null},Tb:function(b){return Array.prototype.every.call(b.childNodes,
function(b){return b.nodeType==Node.TEXT_NODE||b.nodeType==Node.CDATA_SECTION_NODE})?b.textContent.trim():null},D:function(b,c,d,e){e=void 0===e?null:e;var f=null;b=b.getAttribute(c);null!=b&&(f=d(b));return null==f?e:f},Le:function(b){if(!b)return null;/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(b)&&(b+="Z");b=Date.parse(b);return isNaN(b)?null:Math.floor(b/1E3)},za:function(b){if(!b)return null;var c=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(b);
if(!c)return A.j("Invalid duration string:",b),null;b=31536E3*Number(c[1]||null)+2592E3*Number(c[2]||null)+86400*Number(c[3]||null)+3600*Number(c[4]||null)+60*Number(c[5]||null)+Number(c[6]||null);return isFinite(b)?b:null},fc:function(b){var c=/([0-9]+)-([0-9]+)/.exec(b);if(!c)return null;b=Number(c[1]);if(!isFinite(b))return null;c=Number(c[2]);return isFinite(c)?{start:b,end:c}:null},parseInt:function(b){b=Number(b);return 0===b%1?b:null},ec:function(b){b=Number(b);return 0===b%1&&0<b?b:null},
vb:function(b){b=Number(b);return 0===b%1&&0<=b?b:null},parseFloat:function(b){b=Number(b);return isNaN(b)?null:b},Ud:function(b){var c;b=(c=b.match(/^(\d+)\/(\d+)$/))?Number(c[1])/Number(c[2]):Number(b);return isNaN(b)?null:b},wd:function(b,c){var d=new DOMParser;try{var e=d.parseFromString(b,"text/xml")}catch(g){}if(e&&e.documentElement.tagName==c)var f=e.documentElement;return f&&0<f.getElementsByTagName("parsererror").length?null:f},vd:function(b,c){try{var d=lc(b);return S.wd(d,c)}catch(e){}}};var Ee=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime");
function Fe(b,c,d){var e=Ge(b),f=null;b=[];var g=[],h=new Set(e.map(function(b){return b.keyId}));h["delete"](null);if(1<h.size)throw new D(2,4,4010);d||(g=e.filter(function(b){return"urn:mpeg:dash:mp4protection:2011"==b.Bd?(f=b.init||f,!1):!0}),g.length&&(b=He(f,c,g),0==b.length&&(b=[fd("",f)])));if(e.length&&(d||!g.length))for(b=[],c=q(Ee.values()),d=c.next();!d.done;d=c.next())d=d.value,"org.w3.clearkey"!=d&&b.push(fd(d,f));if(h=Array.from(h)[0]||null)for(c=q(b),d=c.next();!d.done;d=c.next())for(d=
q(d.value.initData),e=d.next();!e.done;e=d.next())e.value.keyId=h;return{dd:h,wf:f,drmInfos:b,hd:!0}}function Ie(b,c,d,e){var f=Fe(b,c,e);if(d.hd){b=1==d.drmInfos.length&&!d.drmInfos[0].keySystem;c=0==f.drmInfos.length;if(0==d.drmInfos.length||b&&!c)d.drmInfos=f.drmInfos;d.hd=!1}else if(0<f.drmInfos.length&&(d.drmInfos=d.drmInfos.filter(function(b){return f.drmInfos.some(function(c){return c.keySystem==b.keySystem})}),0==d.drmInfos.length))throw new D(2,4,4008);return f.dd||d.dd}
function Je(b){var c=0,d=(new DataView(b)).getUint32(c,!0);c+=4;if(d!==b.byteLength)return A.j("PlayReady Object with invalid length encountered."),[];c+=2;d=[];for(var e=new DataView(b);c<b.byteLength-1;){var f=e.getUint16(c,!0);c+=2;var g=e.getUint16(c,!0);c+=2;var h=new Uint8Array(b,c,g);d.push({type:f,value:h});c+=g}return d}
function Ke(b){b=q(b.getElementsByTagName("DATA"));for(var c=b.next();!c.done;c=b.next()){c=q(c.value.childNodes);for(var d=c.next();!d.done;d=c.next())if(d=d.value,d instanceof Element&&"LA_URL"==d.tagName)return d.textContent}return""}
function He(b,c,d){var e=[];d=q(d);for(var f=d.next();!f.done;f=d.next()){f=f.value;var g=Ee.get(f.Bd);if(g){var h;if(h=S.uc(f.node,"urn:microsoft:playready","pro")){h=K.Ga(h.textContent);var k=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),m=h.length,n=k.length+16+m,p=new ArrayBuffer(n),r=new Uint8Array(p);p=new DataView(p);var u=0;p.setUint32(u,n);u+=4;p.setUint32(u,1886614376);u+=4;p.setUint32(u,0);u+=4;r.set(k,u);u+=k.length;p.setUint32(u,m);u+=4;r.set(h,u);h=[{initData:r,
initDataType:"cenc",keyId:f.keyId}]}else h=null;h=fd(g,f.init||b||h);if(g=Le.get(g))h.licenseServerUri=g(f);e.push(h)}else for(f=c(f.node)||[],f=q(f),g=f.next();!g.done;g=f.next())e.push(g.value)}return e}
var Le=(new Map).set("com.widevine.alpha",function(b){return(b=S.uc(b.node,"urn:microsoft","laurl"))?b.getAttribute("licenseUrl")||"":""}).set("com.microsoft.playready",function(b){b=S.uc(b.node,"urn:microsoft:playready","pro");if(!b)return"";b=K.Ga(b.textContent);b=Je(b.buffer).filter(function(b){return 1===b.type})[0];if(!b)return"";b=nc(b.value,!0);return(b=S.wd(b,"WRMHEADER"))?Ke(b):""});function Ge(b){var c=[];b=q(b);for(var d=b.next();!d.done;d=b.next())(d=Me(d.value))&&c.push(d);return c}
function Me(b){var c=b.getAttribute("schemeIdUri"),d=S.getAttributeNS(b,"urn:mpeg:cenc:2013","default_KID"),e=S.gd(b,"urn:mpeg:cenc:2013","pssh").map(S.Tb);if(!c)return A.error("Missing required schemeIdUri attribute on","ContentProtection element",b),null;c=c.toLowerCase();if(d&&(d=d.replace(/-/g,"").toLowerCase(),d.includes(" ")))throw new D(2,4,4009);var f=[];try{f=e.map(function(b){return{initDataType:"cenc",initData:K.Ga(b),keyId:null}})}catch(g){throw new D(2,4,4007);}return{node:b,Bd:c,keyId:d,
init:0<f.length?f:null}};function Ne(b,c,d,e,f){var g={RepresentationID:c,Number:d,Bandwidth:e,Time:f};return b.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(c,d,e,f){if("$$"==c)return"$";var h=g[d];if(null==h)return A.j("URL template does not have an available substitution for identifier",'"'+d+'":',b),c;"RepresentationID"==d&&e&&(A.j("URL template should not contain a width specifier for identifier",'"RepresentationID":',b),e=void 0);"Time"==d&&(h=Math.round(h));switch(f){case void 0:case "d":case "i":case "u":c=
h.toString();break;case "o":c=h.toString(8);break;case "x":c=h.toString(16);break;case "X":c=h.toString(16).toUpperCase();break;default:c=h.toString()}e=window.parseInt(e,10)||1;return Array(Math.max(0,e-c.length)+1).join("0")+c})}
function Oe(b,c){var d=Pe(b,c,"timescale"),e=1;d&&(e=S.ec(d)||1);d=Pe(b,c,"duration");(d=S.ec(d||""))&&(d/=e);var f=Pe(b,c,"startNumber"),g=Number(Pe(b,c,"presentationTimeOffset"))||0,h=S.vb(f||"");if(null==f||null==h)h=1;var k=Qe(b,c,"SegmentTimeline");f=null;if(k){f=e;var m=b.T.duration||Infinity;k=S.O(k,"S");for(var n=[],p=-g,r=0;r<k.length;++r){var u=k[r],x=S.D(u,"t",S.vb),G=S.D(u,"d",S.vb),C=S.D(u,"r",S.parseInt);null!=x&&(x-=g);if(!G){A.j('"S" element must have a duration:','ignoring the remaining "S" elements.',
u);break}x=null!=x?x:p;C=C||0;if(0>C)if(r+1<k.length){C=S.D(k[r+1],"t",S.vb);if(null==C){A.j('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',u);break}else if(x>=C){A.j('An "S" element cannot have a negative repeat','if its start time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',u);break}C=Math.ceil((C-x)/G)-1}else{if(Infinity==m){A.j('The last "S" element cannot have a negative repeat',
"if the Period has an infinite duration:",'ignoring the last "S" element.',u);break}else if(x/f>=m){A.j('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'igoring the last "S" element.',u);break}C=Math.ceil((m*f-x)/G)-1}0<n.length&&x!=p&&(Math.abs((x-p)/f)>=hd&&A.j("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",u),n[n.length-1].end=x/f);for(u=0;u<=C;++u)p=x+G,n.push({start:x/f,end:p/f,nf:x}),x=p}f=n}return{timescale:e,
Y:d,$a:h,ia:g/e||0,$c:g,J:f}}function Pe(b,c,d){return[c(b.v),c(b.V),c(b.ha)].filter(ed.Ha).map(function(b){return b.getAttribute(d)}).reduce(function(b,c){return b||c})}function Qe(b,c,d){return[c(b.v),c(b.V),c(b.ha)].filter(ed.Ha).map(function(b){return S.Sb(b,d)}).reduce(function(b,c){return b||c})}
function Re(b,c,d,e,f,g){for(var h=S.getAttributeNS(b,"http://www.w3.org/1999/xlink","href"),k=S.getAttributeNS(b,"http://www.w3.org/1999/xlink","actuate")||"onRequest",m=0;m<b.attributes.length;m++){var n=b.attributes[m];"http://www.w3.org/1999/xlink"==n.namespaceURI&&(b.removeAttributeNS(n.namespaceURI,n.localName),--m)}if(5<=g)return mb(new D(2,4,4028));if("onLoad"!=k)return mb(new D(2,4,4027));var p=M([e],[h]);return f.request(0,Bb(p,c)).aa(function(e){e=S.vd(e.data,b.tagName);if(!e)return mb(new D(2,
4,4001,h));for(;b.childNodes.length;)b.removeChild(b.childNodes[0]);for(;e.childNodes.length;){var k=e.childNodes[0];e.removeChild(k);b.appendChild(k)}for(k=0;k<e.attributes.length;k++){var m=e.attributes[k].nodeName,n=e.getAttribute(m);b.setAttribute(m,n)}return Se(b,c,d,p[0],f,g+1)})}
function Se(b,c,d,e,f,g){g=void 0===g?0:g;if(S.getAttributeNS(b,"http://www.w3.org/1999/xlink","href")){var h=Re(b,c,d,e,f,g);d&&(h=h.aa(void 0,function(){return Se(b,c,d,e,f,g)}));return h}h=[];for(var k=0;k<b.childNodes.length;k++){var m=b.childNodes[k];m instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==S.getAttributeNS(m,"http://www.w3.org/1999/xlink","href")?(b.removeChild(m),--k):"SegmentTimeline"!=m.tagName&&h.push(Se(m,c,d,e,f,g)))}return qb(h).aa(function(){return b})};function Te(b,c,d){this.c=b;this.b=c;this.a=d}z("shaka.media.InitSegmentReference",Te);Te.prototype.pc=function(){return this.c()};Te.prototype.createUris=Te.prototype.pc;Te.prototype.zc=function(){return this.b};Te.prototype.getStartByte=Te.prototype.zc;Te.prototype.xc=function(){return this.a};Te.prototype.getEndByte=Te.prototype.xc;function T(b,c,d,e,f,g){this.position=b;this.startTime=c;this.endTime=d;this.c=e;this.b=f;this.a=g}z("shaka.media.SegmentReference",T);T.prototype.ca=function(){return this.position};
T.prototype.getPosition=T.prototype.ca;T.prototype.Ac=function(){return this.startTime};T.prototype.getStartTime=T.prototype.Ac;T.prototype.ae=function(){return this.endTime};T.prototype.getEndTime=T.prototype.ae;T.prototype.pc=function(){return this.c()};T.prototype.createUris=T.prototype.pc;T.prototype.zc=function(){return this.b};T.prototype.getStartByte=T.prototype.zc;T.prototype.xc=function(){return this.a};T.prototype.getEndByte=T.prototype.xc;function Ue(b,c,d,e){var f,g=(new R).sa("sidx",function(b){f=Ve(c,e,d,b)});b&&g.parse(b);if(f)return f;A.error('Invalid box type, expected "sidx".');throw new D(2,3,3004);}
function Ve(b,c,d,e){var f=[];e.reader.P(4);var g=e.reader.F();if(0==g)throw A.error("Invalid timescale."),new D(2,3,3005);if(0==e.version){var h=e.reader.F();var k=e.reader.F()}else h=e.reader.Gb(),k=e.reader.Gb();e.reader.P(2);var m=e.reader.yd();b=b+e.size+k;for(k=0;k<m;k++){var n=e.reader.F(),p=(n&2147483648)>>>31;n&=2147483647;var r=e.reader.F();e.reader.P(4);if(1==p)throw A.error("Heirarchical SIDXs are not supported."),new D(2,3,3006);f.push(new T(f.length,h/g-c,(h+r)/g-c,function(){return d},
b,b+n-1));h+=r;b+=n}e.parser.stop();return f};function V(b){this.a=b}z("shaka.media.SegmentIndex",V);V.prototype.destroy=function(){this.a=null;return Promise.resolve()};V.prototype.destroy=V.prototype.destroy;V.prototype.find=function(b){for(var c=this.a.length-1;0<=c;--c){var d=this.a[c];if(b>=d.startTime&&b<d.endTime)return d.position}return this.a.length&&b<this.a[0].startTime?this.a[0].position:null};V.prototype.find=V.prototype.find;
V.prototype.get=function(b){if(0==this.a.length)return null;b-=this.a[0].position;return 0>b||b>=this.a.length?null:this.a[b]};V.prototype.get=V.prototype.get;V.prototype.offset=function(b){for(var c=0;c<this.a.length;++c)this.a[c].startTime+=b,this.a[c].endTime+=b};V.prototype.offset=V.prototype.offset;
V.prototype.Fc=function(b){for(var c=[],d=0,e=0;d<this.a.length&&e<b.length;){var f=this.a[d],g=b[e];f.startTime<g.startTime?(c.push(f),d++):(f.startTime>g.startTime?0==d?c.push(g):A.j("Refusing to rewrite original references on update!"):(.1<Math.abs(f.endTime-g.endTime)?c.push(new T(f.position,g.startTime,g.endTime,g.c,g.b,g.a)):c.push(f),d++),e++)}for(;d<this.a.length;)c.push(this.a[d++]);if(c.length)for(d=c[c.length-1].position+1;e<b.length;)f=b[e++],f=new T(d++,f.startTime,f.endTime,f.c,f.b,
f.a),c.push(f);else c=b;this.a=c};V.prototype.merge=V.prototype.Fc;V.prototype.sc=function(b){for(var c=0;c<this.a.length;++c)if(this.a[c].endTime>b){this.a.splice(0,c);return}this.a=[]};V.prototype.evict=V.prototype.sc;function We(b,c){for(;b.a.length;)if(b.a[b.a.length-1].startTime>=c)b.a.pop();else break;for(;b.a.length;)if(0>=b.a[0].endTime)b.a.shift();else break;if(0!=b.a.length){var d=b.a[b.a.length-1];b.a[b.a.length-1]=new T(d.position,d.startTime,c,d.c,d.b,d.a)}};function Xe(b){this.b=b;this.a=new Q(b,0);Ye||(Ye=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var Ye;Xe.prototype.ua=function(){return this.a.ua()};
function Ze(b){var c=$e(b);if(7<c.length)throw new D(2,3,3002);for(var d=0,e=0;e<c.length;e++)d=256*d+c[e];c=d;d=$e(b);a:{e=K.Fa;for(var f=0;f<Ye.length;f++)if(e(d,Ye[f])){e=!0;break a}e=!1}if(e)d=b.b.byteLength-b.a.ca();else{if(8==d.length&&d[1]&224)throw new D(2,3,3001);e=d[0]&(1<<8-d.length)-1;for(f=1;f<d.length;f++)e=256*e+d[f];d=e}d=b.a.ca()+d<=b.b.byteLength?d:b.b.byteLength-b.a.ca();e=new DataView(b.b.buffer,b.b.byteOffset+b.a.ca(),d);b.a.P(d);return new af(c,e)}
function $e(b){var c=b.a.Mc(),d;for(d=1;8>=d&&!(c&1<<8-d);d++);if(8<d)throw new D(2,3,3002);var e=new Uint8Array(d);e[0]=c;for(c=1;c<d;c++)e[c]=b.a.Mc();return e}function af(b,c){this.id=b;this.a=c}function bf(b){if(8<b.a.byteLength)throw new D(2,3,3002);if(8==b.a.byteLength&&b.a.getUint8(0)&224)throw new D(2,3,3001);for(var c=0,d=0;d<b.a.byteLength;d++){var e=b.a.getUint8(d);c=256*c+e}return c};function cf(){}
cf.prototype.parse=function(b,c,d,e){var f;c=new Xe(new DataView(c));if(440786851!=Ze(c).id)throw A.error("Not an EBML element."),new D(2,3,3008);var g=Ze(c);if(408125543!=g.id)throw A.error("Not a Segment element."),new D(2,3,3009);c=g.a.byteOffset;g=new Xe(g.a);for(f=null;g.ua();){var h=Ze(g);if(357149030==h.id){f=h;break}}if(!f)throw A.error("Not an Info element."),new D(2,3,3010);g=new Xe(f.a);f=1E6;for(h=null;g.ua();){var k=Ze(g);if(2807729==k.id)f=bf(k);else if(17545==k.id)if(h=k,4==h.a.byteLength)h=
h.a.getFloat32(0);else if(8==h.a.byteLength)h=h.a.getFloat64(0);else throw new D(2,3,3003);}if(null==h)throw new D(2,3,3011);g=f/1E9;f=h*g;b=Ze(new Xe(new DataView(b)));if(475249515!=b.id)throw A.error("Not a Cues element."),new D(2,3,3007);return df(b,c,g,f,d,e)};
function df(b,c,d,e,f,g){function h(){return f}var k=[];b=new Xe(b.a);for(var m=null,n=null;b.ua();){var p=Ze(b);if(187==p.id){var r=ef(p);r&&(p=d*r.pf,r=c+r.Se,null!=m&&k.push(new T(k.length,m-g,p-g,h,n,r-1)),m=p,n=r)}}null!=m&&k.push(new T(k.length,m-g,e-g,h,n,null));return k}
function ef(b){var c=new Xe(b.a);b=Ze(c);if(179!=b.id)throw A.j("Not a CueTime element."),new D(2,3,3013);b=bf(b);c=Ze(c);if(183!=c.id)throw A.j("Not a CueTrackPositions element."),new D(2,3,3012);c=new Xe(c.a);for(var d=0;c.ua();){var e=Ze(c);if(241==e.id){d=bf(e);break}}return{pf:b,Se:d}};function ff(b,c){var d=Qe(b,c,"Initialization");if(!d)return null;var e=M(b.N.Ea,b.v.N),f=d.getAttribute("sourceURL");f&&(e=M(e,[f]));f=0;var g=null;if(d=S.D(d,"range",S.fc))f=d.start,g=d.end;return new Te(function(){return e},f,g)}
function gf(b,c){var d=Number(Pe(b,hf,"presentationTimeOffset"))||0,e=Pe(b,hf,"timescale"),f=1;e&&(f=S.ec(e)||1);d=d/f||0;e=ff(b,hf);var g=b.v.contentType;f=b.v.mimeType.split("/")[1];if("text"!=g&&"mp4"!=f&&"webm"!=f)throw A.error("SegmentBase specifies an unsupported container type.",b.v),new D(2,4,4006);if("webm"==f&&!e)throw A.error("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",b.v),new D(2,
4,4005);g=Qe(b,hf,"RepresentationIndex");var h=Pe(b,hf,"indexRange"),k=M(b.N.Ea,b.v.N);h=S.fc(h||"");if(g){var m=g.getAttribute("sourceURL");m&&(k=M(k,[m]));h=S.D(g,"range",S.fc,h)}if(!h)throw A.error("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",b.v),new D(2,4,4002);f=jf(b,c,e,k,h.start,h.end,f,d);return{createSegmentIndex:f.createSegmentIndex,findSegmentPosition:f.findSegmentPosition,getSegmentReference:f.getSegmentReference,
initSegmentReference:e,ia:d}}function jf(b,c,d,e,f,g,h,k){var m=b.presentationTimeline,n=!b.mb||!b.T.Cc,p=b.T.start,r=b.T.duration,u=c,x=null;return{createSegmentIndex:function(){var b=[u(e,f,g),"webm"==h?u(d.c(),d.b,d.a):null];u=null;return Promise.all(b).then(function(b){var c=b[0];b=b[1]||null;c="mp4"==h?Ue(c,f,e,k):(new cf).parse(c,b,e,k);m.ac(c,p);x=new V(c);n&&We(x,r)})},findSegmentPosition:function(b){return x.find(b)},getSegmentReference:function(b){return x.get(b)}}}
function hf(b){return b.Ib};function kf(b,c){var d=ff(b,lf);var e=mf(b);var f=Oe(b,lf),g=f.$a;0==g&&(A.j("SegmentList@startNumber must be > 0"),g=1);var h=0;f.Y?h=f.Y*(g-1):f.J&&0<f.J.length&&(h=f.J[0].start);e={Y:f.Y,startTime:h,$a:g,ia:f.ia,J:f.J,Va:e};if(!e.Y&&!e.J&&1<e.Va.length)throw A.j("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",b.v),new D(2,4,4002);if(!e.Y&&!b.T.duration&&!e.J&&1==e.Va.length)throw A.j("SegmentList does not contain sufficient segment information:",
"the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",b.v),new D(2,4,4002);if(e.J&&0==e.J.length)throw A.j("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",b.v),new D(2,4,4002);g=f=null;b.ha.id&&b.v.id&&(g=b.ha.id+","+b.v.id,f=c[g]);h=nf(b.T.duration,e.$a,b.v.N,e);f?(f.Fc(h),f.sc(b.presentationTimeline.Vb()-b.T.start)):(b.presentationTimeline.ac(h,b.T.start),f=new V(h),g&&b.mb&&(c[g]=
f));b.mb&&b.T.Cc||We(f,b.T.duration);return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:f.find.bind(f),getSegmentReference:f.get.bind(f),initSegmentReference:d,ia:e.ia}}function lf(b){return b.Ka}
function nf(b,c,d,e){var f=e.Va.length;e.J&&e.J.length!=e.Va.length&&(f=Math.min(e.J.length,e.Va.length),A.j("The number of items in the segment timeline and the number of segment","URLs do not match, truncating",e.Va.length,"to",f));for(var g=[],h=e.startTime,k=0;k<f;k++){var m=e.Va[k],n=M(d,[m.ve]),p=void 0;p=null!=e.Y?h+e.Y:e.J?e.J[k].end:h+b;g.push(new T(k+c,h,p,function(b){return b}.bind(null,n),m.start,m.end));h=p}return g}
function mf(b){return[b.v.Ka,b.V.Ka,b.ha.Ka].filter(ed.Ha).map(function(b){return S.O(b,"SegmentURL")}).reduce(function(b,d){return 0<b.length?b:d}).map(function(c){c.getAttribute("indexRange")&&!b.md&&(b.md=!0,A.j("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate."));var d=c.getAttribute("media");c=S.D(c,"mediaRange",S.fc,{start:0,end:null});return{ve:d,start:c.start,end:c.end}})};function of(b,c,d,e){var f=pf(b);var g=Oe(b,qf);var h=Pe(b,qf,"media"),k=Pe(b,qf,"index");g={Y:g.Y,timescale:g.timescale,$a:g.$a,ia:g.ia,$c:g.$c,J:g.J,Ec:h,Eb:k};h=g.Eb?1:0;h+=g.J?1:0;h+=g.Y?1:0;if(0==h)throw A.error("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",b.v),new D(2,4,4002);1!=h&&(A.j("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,",
"a SegmentTimeline or a segment duration.",b.v),g.Eb?(A.info("Using the index URL template by default."),g.J=null):A.info("Using the SegmentTimeline by default."),g.Y=null);if(!g.Eb&&!g.Ec)throw A.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",b.v),new D(2,4,4002);if(g.Eb){d=b.v.mimeType.split("/")[1];if("mp4"!=d&&"webm"!=d)throw A.error("SegmentTemplate specifies an unsupported container type.",b.v),new D(2,4,4006);
if("webm"==d&&!f)throw A.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate uses a WebM container,","but does not contain an initialization URL template.",b.v),new D(2,4,4005);e=Ne(g.Eb,b.v.id,null,b.bandwidth||null,null);h=M(b.N.Ea,b.v.N);e=M(h,[e]);b=jf(b,c,f,e,0,null,d,g.ia)}else g.Y?(e||(b.presentationTimeline.Gc(g.Y),b.presentationTimeline.Hc(b.T.start)),b=rf(b,g)):(e=c=null,b.ha.id&&b.v.id&&(e=b.ha.id+","+b.v.id,c=d[e]),h=sf(b,g),k=!b.mb||!b.T.Cc,c?
(k&&We(new V(h),b.T.duration),c.Fc(h),c.sc(b.presentationTimeline.Vb()-b.T.start)):(b.presentationTimeline.ac(h,b.T.start),c=new V(h),e&&b.mb&&(d[e]=c)),k&&We(c,b.T.duration),b={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:c.find.bind(c),getSegmentReference:c.get.bind(c)});return{createSegmentIndex:b.createSegmentIndex,findSegmentPosition:b.findSegmentPosition,getSegmentReference:b.getSegmentReference,initSegmentReference:f,ia:g.ia}}function qf(b){return b.Jb}
function rf(b,c){var d=b.T.duration,e=c.Y,f=c.$a,g=c.timescale,h=c.Ec,k=b.bandwidth||null,m=b.v.id,n=b.v;return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(b){return 0>b||d&&b>=d?null:Math.floor(b/e)},getSegmentReference:function(c){var p=c*e,u=p+e;d&&(u=Math.min(u,d));return 0>u||d&&p>=d?null:new T(c,p,u,function(){var d=M(b.N.Ea,n.N),e=Ne(h,m,c+f,k,p*g);return M(d,[e])},0,null)}}}
function sf(b,c){for(var d=[],e=0;e<c.J.length;e++){var f=e+c.$a;d.push(new T(f,c.J[e].start,c.J[e].end,function(b,c,d,e,f,p,r){e=M(e.Ea,f);b=Ne(b,c,p,d,r);return M(e,[b]).map(function(b){return b.toString()})}.bind(null,c.Ec,b.v.id,b.bandwidth||null,b.N,b.v.N,f,c.J[e].nf+c.$c),0,null))}return d}function pf(b){var c=Pe(b,qf,"initialization");if(!c)return null;var d=b.v.id,e=b.bandwidth||null,f=b.v;return new Te(function(){var g=Ne(c,d,null,e,null),h=M(b.N.Ea,f.N);return M(h,[g])},0,null)};var W={wb:{},Fb:{},zd:function(b,c){W.Fb[b]=c}};z("shaka.media.ManifestParser.registerParserByExtension",W.zd);W.Oc=function(b,c){W.wb[b]=c};z("shaka.media.ManifestParser.registerParserByMime",W.Oc);
W.Pe=function(){var b={};if(cc()){for(var c in W.wb)b[c]=!0;for(var d in W.Fb)b[d]=!0}c={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};d=q(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"]);for(var e=d.next();!e.done;e=d.next())e=e.value,b[e]=cc()?!!W.wb[e]:dc(e);for(var f in c)b[f]=cc()?!!W.Fb[f]:dc(c[f]);return b};
W.create=function(b,c,d,e){return t(function g(){var h,k;return y(g,function(g){switch(g.l){case 1:return g.W=2,v(g,W.be(b,c,d,e),4);case 4:return h=g.R,g["return"](new h);case 2:throw k=za(g),k.severity=2,k;}})})};
W.be=function(b,c,d,e){return t(function g(){var h,k,m,n,p;return y(g,function(g){switch(g.l){case 1:h=W;if(e){if(k=h.wb[e.toLowerCase()])return g["return"](k);A.j("Could not determine manifest type using MIME type ",e)}if(m=h.getExtension(b)){if(n=h.Fb[m])return g["return"](n);A.j("Could not determine manifest type for extension ",m)}else A.j("Could not find extension for ",b);if(e){g.l=2;break}return v(g,h.je(b,c,d),3);case 3:if(e=g.R){if(p=W.wb[e])return g["return"](p);A.j("Could not determine manifest type using MIME type",
e)}case 2:throw new D(2,4,4E3,b);}})})};W.je=function(b,c,d){return t(function f(){var g,h,k;return y(f,function(f){switch(f.l){case 1:return g=Bb([b],d),g.method="HEAD",v(f,c.request(0,g).promise,2);case 2:return h=f.R,k=h.headers["content-type"],f["return"](k?k.toLowerCase().split(";").shift():"")}})})};W.getExtension=function(b){b=(new Sa(b)).pa.split("/").pop().split(".");return 1==b.length?"":b.pop().toLowerCase()};
W.isSupported=function(b,c){return cc()?c in W.wb||W.getExtension(b)in W.Fb?!0:!1:!1};function X(b,c,d){this.f=b;this.o=c;this.h=this.g=Infinity;this.a=1;this.b=this.c=null;this.m=0;this.u=!0;this.i=0;this.w=void 0===d?!0:d}z("shaka.media.PresentationTimeline",X);X.prototype.ba=function(){return this.g};X.prototype.getDuration=X.prototype.ba;X.prototype.he=function(){return this.a};X.prototype.getMaxSegmentDuration=X.prototype.he;X.prototype.Za=function(b){this.g=b};X.prototype.setDuration=X.prototype.Za;X.prototype.oe=function(){return this.f};
X.prototype.getPresentationStartTime=X.prototype.oe;X.prototype.Dd=function(b){this.m=b};X.prototype.setClockOffset=X.prototype.Dd;X.prototype.Fd=function(b){this.u=b};X.prototype.setStatic=X.prototype.Fd;X.prototype.Ed=function(b){this.h=b};X.prototype.setSegmentAvailabilityDuration=X.prototype.Ed;X.prototype.bf=function(b){this.o=b};X.prototype.setDelay=X.prototype.bf;X.prototype.$d=function(){return this.o};X.prototype.getDelay=X.prototype.$d;
X.prototype.ac=function(b,c){if(0!=b.length){var d=b[b.length-1].endTime+c;this.Hc(b[0].startTime+c);this.a=b.reduce(function(b,c){return Math.max(b,c.endTime-c.startTime)},this.a);this.b=Math.max(this.b,d);null!=this.f&&this.w&&(this.f=(Date.now()+this.m)/1E3-this.b-this.a);A.A("notifySegments:","maxSegmentDuration="+this.a)}};X.prototype.notifySegments=X.prototype.ac;X.prototype.Hc=function(b){this.c=null==this.c?b:Math.min(this.c,b)};X.prototype.notifyMinSegmentStartTime=X.prototype.Hc;
X.prototype.Gc=function(b){this.a=Math.max(this.a,b);A.A("notifyNewSegmentDuration:","maxSegmentDuration="+this.a)};X.prototype.notifyMaxSegmentDuration=X.prototype.Gc;X.prototype.offset=function(b){null!=this.c&&(this.c+=b);null!=this.b&&(this.b+=b)};X.prototype.offset=X.prototype.offset;X.prototype.da=function(){return Infinity==this.g&&!this.u};X.prototype.isLive=X.prototype.da;X.prototype.rb=function(){return Infinity!=this.g&&!this.u};X.prototype.isInProgress=X.prototype.rb;
X.prototype.Vb=function(){return Infinity==this.h?this.i:Math.max(this.i,this.ob()-this.h)};X.prototype.getSegmentAvailabilityStart=X.prototype.Vb;X.prototype.Gd=function(b){this.i=b};X.prototype.setUserSeekStart=X.prototype.Gd;X.prototype.ob=function(){return this.da()||this.rb()?Math.min(Math.max(0,(Date.now()+this.m)/1E3-this.a-this.f),this.g):this.g};X.prototype.getSegmentAvailabilityEnd=X.prototype.ob;
X.prototype.Cb=function(b){var c=Math.max(this.c,this.i);return Infinity==this.h?c:Math.max(c,Math.min(this.ob()-this.h+b,this.xa()))};X.prototype.getSafeSeekRangeStart=X.prototype.Cb;X.prototype.nb=function(){return this.Cb(0)};X.prototype.getSeekRangeStart=X.prototype.nb;X.prototype.xa=function(){return Math.max(0,this.ob()-(this.da()||this.rb()?this.o:0))};X.prototype.getSeekRangeEnd=X.prototype.xa;X.prototype.Jd=function(){return null==this.f||null!=this.b&&this.w?!1:!0};
X.prototype.usingPresentationStartTime=X.prototype.Jd;function tf(b,c,d,e){b=Bb(b,e);if(0!=c||null!=d)b.headers.Range=d?"bytes="+c+"-"+d:"bytes="+c+"-";return b};function uf(){var b=this;this.b=this.a=null;this.f=[];this.c=null;this.m=[];this.h=1;this.o={};this.u=0;this.w=new Ma(5);this.i=new B(function(){vf(b)});this.g=new xb}z("shaka.dash.DashParser",uf);l=uf.prototype;l.configure=function(b){this.a=b};l.start=function(b,c){var d=this;return t(function f(){var g;return y(f,function(f){switch(f.l){case 1:return d.f=[b],d.b=c,v(f,wf(d),2);case 2:g=f.R;d.b&&xf(d,g);if(!d.b)throw new D(2,7,7001);return f["return"](d.c)}})})};
l.stop=function(){this.a=this.b=null;this.f=[];this.c=null;this.m=[];this.o={};null!=this.i&&(this.i.stop(),this.i=null);return this.g.destroy()};l.update=function(){wf(this)["catch"](function(b){if(this.b)this.b.onError(b)}.bind(this))};l.onExpirationUpdated=function(){};
function wf(b){var c=Date.now(),d=b.b.networkingEngine.request(0,Bb(b.f,b.a.retryParameters));yb(b.g,d);return d.promise.then(function(c){if(b.b)return c.uri&&!b.f.includes(c.uri)&&b.f.unshift(c.uri),yf(b,c.data,c.uri)}).then(function(){var d=(Date.now()-c)/1E3;Na(b.w,1,d);return d})}function zf(b){this.Ea=b}
function yf(b,c,d){c=S.vd(c,"MPD");if(!c)throw new D(2,4,4001,d);c=Se(c,b.a.retryParameters,b.a.dash.xlinkFailGracefully,d,b.b.networkingEngine);yb(b.g,c);return c.promise.then(function(c){return Af(b,c,d)})}
function Af(b,c,d){return t(function f(){var g,h,k,m,n,p,r,u,x,G,C,L,U,ha,Xa,Ya,gg,Gc,ta,hg,Hc,Nb,ig,jg,kg,Bj,lg,mg;return y(f,function(f){switch(f.l){case 1:m=ed;n=S;p=[d];r=n.O(c,"Location").map(n.Tb).filter(m.Ha);0<r.length&&(u=M(p,r),p=b.f=u);x=n.O(c,"BaseURL").map(n.Tb);G=M(p,x);C=b.a.dash.ignoreMinBufferTime;L=0;C||(L=n.D(c,"minBufferTime",n.za));b.u=n.D(c,"minimumUpdatePeriod",n.za,-1);U=n.D(c,"availabilityStartTime",n.Le);ha=n.D(c,"timeShiftBufferDepth",n.za);Xa=n.D(c,"maxSegmentDuration",
n.za);Ya=c.getAttribute("type")||"static";gg=b.a.dash.ignoreSuggestedPresentationDelay;Gc=null;gg||(Gc=n.D(c,"suggestedPresentationDelay",n.za));b.c?ta=b.c.presentationTimeline:(hg=Math.max(b.a.dash.defaultPresentationDelay,1.5*L),Hc=null!=Gc?Gc:hg,ta=new X(U,Hc,b.a.dash.autoCorrectDrift));b.c&&b.c.N?(Nb=b.c.N,Nb.Ea=G):Nb=new zf(G);ig={mb:"static"!=Ya,presentationTimeline:ta,ha:null,T:null,V:null,v:null,bandwidth:0,md:!1,N:Nb};for(var ng=ig,Cj=[""],Ob=S.D(c,"mediaPresentationDuration",S.za),Pb=[],
Ka=0,kb=S.O(c,"Period"),wa=0;wa<kb.length;wa++){var Pa=kb[wa];Ka=S.D(Pa,"start",S.za,Ka);var lb=S.D(Pa,"duration",S.za),xa=null;if(wa!=kb.length-1){var Ic=S.D(kb[wa+1],"start",S.za);null!=Ic&&(xa=Ic-Ka)}else null!=Ob&&(xa=Ob-Ka);Ic=hd;xa&&lb&&Math.abs(xa-lb)>Ic&&A.j("There is a gap/overlap between Periods",Pa);null==xa&&(xa=lb);Pa=Bf(b,ng,Cj,{start:Ka,duration:xa,node:Pa,Cc:null==xa||wa==kb.length-1});Pb.push(Pa);lb=ng.ha.id;b.m.includes(lb)||(b.m.push(lb),b.c&&(b.b.filterNewPeriod(Pa),b.c.periods.push(Pa)));
if(null==xa){wa!=kb.length-1&&A.j("Skipping Period",wa+1,"and any subsequent Periods:","Period",wa+1,"does not have a valid start time.",Pb[wa+1]);Ka=null;break}Ka+=xa}null==b.c&&b.b.filterAllPeriods(Pb);null!=Ob?(Ka!=Ob&&A.j("@mediaPresentationDuration does not match the total duration of all","Periods."),g=Pb,h=Ob,k=!1):(g=Pb,h=Ka,k=!0);jg=h;kg=g;ta.Fd("static"==Ya);"static"!=Ya&&k||ta.Za(jg||Infinity);(Bj=ta.da())&&!isNaN(b.a.availabilityWindowOverride)&&(ha=b.a.availabilityWindowOverride);null==
ha&&(ha=Infinity);ta.Ed(ha);ta.Gc(Xa||1);if(b.c){f.l=0;break}b.c={N:Nb,presentationTimeline:ta,periods:kg,offlineSessionIds:[],minBufferTime:L||0};if(!ta.Jd()){f.l=0;break}lg=n.O(c,"UTCTiming");return v(f,Cf(b,G,lg),4);case 4:mg=f.R;if(!b.b)return f["return"]();ta.Dd(mg);w(f)}})})}
function Bf(b,c,d,e){c.ha=Df(e.node,null,d);c.T=e;c.ha.id||(A.info("No Period ID given for Period with start time "+e.start+",  Assigning a default"),c.ha.id="__shaka_period_"+e.start);S.O(e.node,"EventStream").forEach(b.Me.bind(b,e.start,e.duration));d=S.O(e.node,"AdaptationSet").map(b.Ke.bind(b,c)).filter(ed.Ha);if(c.mb){c=[];for(var f=q(d),g=f.next();!g.done;g=f.next()){g=q(g.value.Te);for(var h=g.next();!h.done;h=g.next())c.push(h.value)}if(c.length!=(new Set(c)).size)throw new D(2,4,4018);}var k=
d.filter(function(b){return!b.Zc});d.filter(function(b){return b.Zc}).forEach(function(b){var c=b.streams[0],d=b.Zc;k.forEach(function(b){b.id==d&&b.streams.forEach(function(b){b.trickModeVideo=c})})});c=Ef(k,"video");f=Ef(k,"audio");if(!c.length&&!f.length)throw new D(2,4,4004);d=b.a.disableAudio;if(!f.length||d)f=[null];d=b.a.disableVideo;if(!c.length||d)c=[null];d=[];for(g=0;g<f.length;g++)for(h=0;h<c.length;h++)Ff(b,f[g],c[h],d);c=[];if(!b.a.disableText)for(b=Ef(k,"text"),f=0;f<b.length;f++)c.push.apply(c,
b[f].streams);return{startTime:e.start,textStreams:c,variants:d}}function Ef(b,c){return b.filter(function(b){return b.contentType==c})}
function Ff(b,c,d,e){if(c||d)if(c&&d){var f=c.drmInfos;var g=d.drmInfos;if(f.length&&g.length?0<Wc(f,g).length:1){g=Wc(c.drmInfos,d.drmInfos);for(var h=0;h<c.streams.length;h++)for(var k=0;k<d.streams.length;k++)f=(d.streams[k].bandwidth||0)+(c.streams[h].bandwidth||0),f={id:b.h++,language:c.language,primary:c.Dc||d.Dc,audio:c.streams[h],video:d.streams[k],bandwidth:f,drmInfos:g,allowedByApplication:!0,allowedByKeySystem:!0},e.push(f)}}else for(g=c||d,h=0;h<g.streams.length;h++)f=g.streams[h].bandwidth||
0,f={id:b.h++,language:g.language||"und",primary:g.Dc,audio:c?g.streams[h]:null,video:d?g.streams[h]:null,bandwidth:f,drmInfos:g.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},e.push(f)}
l.Ke=function(b,c){b.V=Df(c,b.ha,null);if("image"==b.V.contentType)return A.j("Skipping Image AdaptationSet",b.V),null;var d=!1,e=S.O(c,"Role"),f=e.map(function(b){return b.getAttribute("value")}).filter(ed.Ha),g=void 0,h="text"==b.V.contentType;h&&(g="subtitle");for(var k=0;k<e.length;k++){var m=e[k].getAttribute("schemeIdUri");if(null==m||"urn:mpeg:dash:role:2011"==m)switch(m=e[k].getAttribute("value"),m){case "main":d=!0;break;case "caption":case "subtitle":g=m}}var n=null,p=!1;S.O(c,"EssentialProperty").forEach(function(b){"http://dashif.org/guidelines/trickmode"==
b.getAttribute("schemeIdUri")?n=b.getAttribute("value"):p=!0});k=S.O(c,"Accessibility");var r=new Map;e={};k=q(k);for(m=k.next();!m.done;e={Bb:e.Bb},m=k.next()){var u=m.value;m=u.getAttribute("schemeIdUri");u=u.getAttribute("value");"urn:scte:dash:cc:cea-608:2015"==m||"urn:scte:dash:cc:cea-708:2015"==m?(e.Bb=1,null!=u?u.split(";").forEach(function(b){return function(c){if(c.includes("=")){c=c.split("=");var d=c[0].startsWith("CC")?c[0]:"CC"+c[0];c=c[1].split(",")[0].split(":").pop()}else d="CC"+b.Bb,
b.Bb+=2;r.set(d,O(c))}}(e)):r.set("CC1","und")):"urn:mpeg:dash:role:2011"==m&&null!=u&&(f.push(u),"captions"==u&&(g="caption"))}if(p)return null;e=S.O(c,"ContentProtection");var x=Fe(e,this.a.dash.customScheme,this.a.dash.ignoreDrmInfo);e=O(c.getAttribute("lang")||"und");k=c.getAttribute("label");(m=S.O(c,"Label"))&&m.length&&(m=m[0],m.textContent&&(k=m.textContent));m=S.O(c,"Representation");f=m.map(this.Ne.bind(this,b,x,g,e,k,d,f,r)).filter(function(b){return!!b});if(0==f.length){if(this.a.dash.ignoreEmptyAdaptationSet||
h)return null;throw new D(2,4,4003);}b.V.contentType&&"application"!=b.V.contentType||(b.V.contentType=Gf(f[0].mimeType,f[0].codecs),f.forEach(function(c){c.type=b.V.contentType}));f.forEach(function(b){x.drmInfos.forEach(function(c){b.keyId&&c.keyIds.push(b.keyId)})});h=m.map(function(b){return b.getAttribute("id")}).filter(ed.Ha);return{id:b.V.id||"__fake__"+this.h++,contentType:b.V.contentType,language:e,Dc:d,streams:f,drmInfos:x.drmInfos,Zc:n,Te:h}};
l.Ne=function(b,c,d,e,f,g,h,k,m){b.v=Df(m,b.V,null);if(!Hf(b.v))return A.j("Skipping Representation",b.v),null;b.bandwidth=S.D(m,"bandwidth",S.ec)||0;var n=b.v.contentType;n="text"==n||"application"==n;try{var p=this.Ue.bind(this);if(b.v.Ib)var r=gf(b,p);else if(b.v.Ka)r=kf(b,this.o);else if(b.v.Jb)r=of(b,p,this.o,!!this.c);else{var u=M(b.N.Ea,b.v.N),x=b.T.duration||0;r={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(b){return 0<=b&&b<x?1:null},getSegmentReference:function(b){return 1!=
b?null:new T(1,0,x,function(){return u},0,null)},initSegmentReference:null,ia:0}}}catch(G){if(n&&4002==G.code)return null;throw G;}m=S.O(m,"ContentProtection");m=Ie(m,this.a.dash.customScheme,c,this.a.dash.ignoreDrmInfo);return{id:this.h++,originalId:b.v.id,createSegmentIndex:r.createSegmentIndex,findSegmentPosition:r.findSegmentPosition,getSegmentReference:r.getSegmentReference,initSegmentReference:r.initSegmentReference,presentationTimeOffset:r.ia,mimeType:b.v.mimeType,codecs:b.v.codecs,frameRate:b.v.frameRate,
pixelAspectRatio:b.v.pixelAspectRatio,bandwidth:b.bandwidth,width:b.v.width,height:b.v.height,kind:d,encrypted:0<c.drmInfos.length,keyId:m,language:e,label:f,type:b.V.contentType,primary:g,trickModeVideo:null,emsgSchemeIdUris:b.v.emsgSchemeIdUris,roles:h,channelsCount:b.v.Ic,audioSamplingRate:b.v.audioSamplingRate,closedCaptions:k}};
function vf(b){t(function d(){var e,f;return y(d,function(d){switch(d.l){case 1:return A.info("Updating manifest..."),e=0,d.W=2,v(d,wf(b),4);case 4:e=d.R;ya(d,3);break;case 2:f=za(d),b.b&&(f.severity=1,b.b.onError(f));case 3:if(!b.b)return d["return"]();xf(b,e);w(d)}})})}function xf(b,c){0>b.u||b.i.U(Math.max(3,b.u-c,Oa(b.w)))}
function Df(b,c,d){c=c||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,Ic:null,audioSamplingRate:null};d=d||c.N;var e=S.vb,f=S.Ud,g=S.O(b,"BaseURL").map(S.Tb),h=b.getAttribute("contentType")||c.contentType,k=b.getAttribute("mimeType")||c.mimeType,m=b.getAttribute("codecs")||c.codecs;f=S.D(b,"frameRate",f)||c.frameRate;var n=b.getAttribute("sar")||c.pixelAspectRatio,p=S.O(b,"InbandEventStream"),r=c.emsgSchemeIdUris.slice();p=q(p);for(var u=p.next();!u.done;u=p.next())u=
u.value.getAttribute("schemeIdUri"),r.includes(u)||r.push(u);p=S.O(b,"AudioChannelConfiguration");p=If(p)||c.Ic;u=S.D(b,"audioSamplingRate",e)||c.audioSamplingRate;h||(h=Gf(k,m));return{N:M(d,g),Ib:S.Sb(b,"SegmentBase")||c.Ib,Ka:S.Sb(b,"SegmentList")||c.Ka,Jb:S.Sb(b,"SegmentTemplate")||c.Jb,width:S.D(b,"width",e)||c.width,height:S.D(b,"height",e)||c.height,contentType:h,mimeType:k,codecs:m,frameRate:f,pixelAspectRatio:n,emsgSchemeIdUris:r,id:b.getAttribute("id"),Ic:p,audioSamplingRate:u}}
function If(b){for(var c=0;c<b.length;++c){var d=b[c],e=d.getAttribute("schemeIdUri");if(e&&(d=d.getAttribute("value")))switch(e){case "urn:mpeg:dash:outputChannelPositionList:2012":return d.trim().split(/ +/).length;case "urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case "urn:dts:dash:audio_channel_configuration:2012":var f=parseInt(d,10);if(!f){A.j("Channel parsing failure! Ignoring scheme and value",e,d);continue}return f;case "tag:dolby.com,2014:dash:audio_channel_configuration:2011":case "urn:dolby:dash:audio_channel_configuration:2011":f=
parseInt(d,16);if(!f){A.j("Channel parsing failure! Ignoring scheme and value",e,d);continue}for(b=0;f;)f&1&&++b,f>>=1;return b;default:A.j("Unrecognized audio channel scheme:",e,d)}}return null}
function Hf(b){var c=b.Ib?1:0;c+=b.Ka?1:0;c+=b.Jb?1:0;if(0==c){if("text"==b.contentType||"application"==b.contentType)return!0;A.j("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',b);return!1}1!=c&&(A.j("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",
b),b.Ib?(A.info("Using SegmentBase by default."),b.Ka=null):A.info("Using SegmentList by default."),b.Jb=null);return!0}
function Jf(b,c,d,e){c=M(c,[d]);c=Bb(c,b.a.retryParameters);c.method=e;c=b.b.networkingEngine.request(4,c);yb(b.g,c);return c.promise.then(function(b){if("HEAD"==e){if(!b.headers||!b.headers.date)return A.j("UTC timing response is missing","expected date header"),0;b=b.headers.date}else b=lc(b.data);b=Date.parse(b);return isNaN(b)?(A.j("Unable to parse date from UTC timing response"),0):b-Date.now()})}
function Cf(b,c,d){d=d.map(function(b){return{scheme:b.getAttribute("schemeIdUri"),value:b.getAttribute("value")}});var e=b.a.dash.clockSyncUri;!d.length&&e&&d.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:e});return ed.Sd(d,function(b){var d=b.scheme;b=b.value;switch(d){case "urn:mpeg:dash:utc:http-head:2014":case "urn:mpeg:dash:utc:http-head:2012":return Jf(this,c,b,"HEAD");case "urn:mpeg:dash:utc:http-xsdate:2014":case "urn:mpeg:dash:utc:http-iso:2014":case "urn:mpeg:dash:utc:http-xsdate:2012":case "urn:mpeg:dash:utc:http-iso:2012":return Jf(this,
c,b,"GET");case "urn:mpeg:dash:utc:direct:2014":case "urn:mpeg:dash:utc:direct:2012":return d=Date.parse(b),isNaN(d)?0:d-Date.now();case "urn:mpeg:dash:utc:http-ntp:2014":case "urn:mpeg:dash:utc:ntp:2014":case "urn:mpeg:dash:utc:sntp:2014":return A.qa("NTP UTCTiming scheme is not supported"),Promise.reject();default:return A.qa("Unrecognized scheme in UTCTiming element",d),Promise.reject()}}.bind(b))["catch"](function(){A.qa("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!");
return 0})}l.Me=function(b,c,d){var e=S.vb,f=d.getAttribute("schemeIdUri")||"",g=d.getAttribute("value")||"",h=S.D(d,"timescale",e)||1;S.O(d,"Event").forEach(function(d){var k=S.D(d,"presentationTime",e)||0,n=S.D(d,"duration",e)||0;k=k/h+b;n=k+n/h;null!=c&&(k=Math.min(k,b+c),n=Math.min(n,b+c));d={schemeIdUri:f,value:g,startTime:k,endTime:n,id:d.getAttribute("id")||"",eventElement:d};this.b.onTimelineRegionAdded(d)}.bind(this))};
l.Ue=function(b,c,d){b=tf(b,c,d,this.a.retryParameters);b=this.b.networkingEngine.request(1,b);yb(this.g,b);return b.promise.then(function(b){return b.data})};function Gf(b,c){return Ed(Zb(b,c))?"text":b.split("/")[0]}W.zd("mpd",uf);W.Oc("application/dash+xml",uf);W.Oc("video/vnd.mpeg.dash.mpd",uf);function Kf(b,c){this.a=b;this.b=c}Kf.prototype.toString=function(){return"v"+this.a+"."+this.b};function Lf(b,c){var d=new Kf(2,6),e=Mf,f=e.a,g=d.b-f.b;(0<(d.a-f.a||g)?e.c:e.b)(e.a,d,b,c)}function Nf(b,c,d,e){A.qa([d,"has been deprecated and will be removed in",c,". We are currently at version",b,". Additional information:",e].join(" "))}function Of(b,c,d,e){A.Ob([d,"has been deprecated and has been removed in",c,". We are now at version",b,". Additional information:",e].join(""))}var Mf=null;function Pf(){this.a=new Map}function Qf(b,c,d){Rf(b,c).text=d}function Rf(b,c){b.a.has(c)||b.a.set(c,new Sf);return b.a.get(c)}function Sf(){this.text=this.variant=null};function Tf(b,c){this.a=b;this.b=new Set([b]);c=c||[];for(var d=q(c),e=d.next();!e.done;e=d.next())this.add(e.value)}Tf.prototype.add=function(b){if(Uf(this.a,b))return this.b.add(b),!0;A.j("Rejecting variant - not compatible with root.");return!1};
function Uf(b,c){var d;if(!(d=!!b.audio!=!!c.audio||!!b.video!=!!c.video||b.language!=c.language)&&(d=b.audio&&c.audio)){d=b.audio;var e=c.audio;d=!(d.channelsCount==e.channelsCount&&Vf(d,e)&&Wf(d.roles,e.roles))}!d&&(d=b.video&&c.video)&&(d=b.video,e=c.video,d=!(Vf(d,e)&&Wf(d.roles,e.roles)));return d?!1:!0}Tf.prototype.values=function(){return this.b.values()};
function Vf(b,c){if(b.mimeType!=c.mimeType)return!1;var d=b.codecs.split(",").map(function(b){return bc(b)[0]}),e=c.codecs.split(",").map(function(b){return bc(b)[0]});if(d.length!=e.length)return!1;d.sort();e.sort();for(var f=0;f<d.length;f++)if(d[f]!=e[f])return!1;return!0}function Wf(b,c){var d=new Set(b),e=new Set(c);d["delete"]("main");e["delete"]("main");if(d.size!=e.size)return!1;d=q(d);for(var f=d.next();!f.done;f=d.next())if(!e.has(f.value))return!1;return!0};function Xf(b){this.a=b;this.b=new Yf(b.language,"",b.audio&&b.audio.channelsCount?b.audio.channelsCount:0,"")}Xf.prototype.create=function(b){var c=this,d=b.filter(function(b){return Uf(c.a,b)});return d.length?new Tf(d[0],d):this.b.create(b)};function Yf(b,c,d,e,f){this.f=b;this.c=c;this.a=d;this.b=void 0===e?"":e;this.g=void 0===f?"":f}
Yf.prototype.create=function(b){var c=[];c=Zf(b,this.f);var d=b.filter(function(b){return b.primary});c=c.length?c:d.length?d:b;this.c&&(b=$f(c,this.c,this.g),b.length?c=b:A.j("No exact match for variant role could be found."));this.a&&(b=de(c,this.a),b.length?c=b:A.j("No exact match for the channel count could be found."));this.b&&(b=ag(c,this.b),b.length?c=b:A.j("No exact match for variant label could be found."));b=new Tf(c[0]);c=q(c);for(d=c.next();!d.done;d=c.next())d=d.value,Uf(b.a,d)&&b.add(d);
return b};function Zf(b,c){var d=O(c),e=be(d,b.map(function(b){return ae(b)}));return e?b.filter(function(b){return e==ae(b)}):[]}function $f(b,c,d){return b.filter(function(b){if(d){var e=b[d];return e&&e.roles.includes(c)}e=b.audio;b=b.video;return e&&0<=e.roles.indexOf(c)||b&&0<=b.roles.indexOf(c)})}function ag(b,c){return b.filter(function(b){return b.audio?b.audio.label.toLowerCase()==c.toLowerCase():!1})};function bg(){this.a=cg;this.b=(new Map).set(cg,2).set(dg,1)}function eg(b,c,d){b.b.set(cg,d).set(dg,c)}var dg=0,cg=1;function fg(b,c){this.g=b;this.h=og(b);this.a=b.a.currentTime;this.f=Date.now()/1E3;this.b=!1;this.i=c;this.c=function(){}}fg.prototype.release=function(){this.g=null;this.c=function(){}};function pg(b,c){b.c=c}function qg(b){this.a=b}function og(b){if(b.a.paused||0==b.a.playbackRate||0==b.a.buffered.length)var c=!1;else a:{c=b.a.buffered;b=b.a.currentTime;for(var d=0;d<c.length;d++){var e=c.start(d),f=c.end(d);if(!(b<e-.1||b>f-.5)){c=!0;break a}}c=!1}return c};function rg(b,c,d,e,f){var g=this;this.a=b;this.w=c;this.u=d;this.m=f;this.f=new J;this.i=!1;this.o=b.readyState;this.c=!1;this.b=e;this.h=!1;this.f.B(b,"waiting",function(){return sg(g)});this.g=(new B(function(){sg(g)})).Ba(.25)}rg.prototype.release=function(){this.f&&(this.f.release(),this.f=null);null!=this.g&&(this.g.stop(),this.g=null);this.b&&(this.b.release(),this.b=null);this.a=this.w=this.m=null};rg.prototype.Kc=function(){this.h=!0;sg(this)};
function sg(b){if(0!=b.a.readyState){if(b.a.seeking){if(!b.i)return}else b.i=!1;if(!b.a.paused){b.a.readyState!=b.o&&(b.c=!1,b.o=b.a.readyState);var c;if(!(c=!b.b)){c=b.b;var d=c.g,e=og(d),f=d.a.currentTime,g=Date.now()/1E3;if(c.a!=f||c.h!=e)c.f=g,c.a=f,c.h=e,c.b=!1;f=g-c.f;if(e=f>=c.i&&e&&!c.b)c.c(c.a,f),c.b=!0,c.a=d.a.currentTime;c=!e}if(c){var h=b.u.smallGapLimit;c=b.a.currentTime;d=b.a.buffered;a:{if(d&&d.length&&!(1==d.length&&1E-6>d.end(0)-d.start(0)))for(e=fc()||hc("Trident/")||hc("Tizen")||
hc("CrKey")?.5:.1,f=0;f<d.length;f++)if(d.start(f)>c&&(0==f||d.end(f-1)-c<=e)){e=f;break a}e=null}if(!(null==e||0==e&&!b.h||(f=d.start(e),f>=b.w.xa()))){g=f-c;h=g<=h;var k=!1;if(!(.001>g)){if(!h&&!b.c){b.c=!0;var m=new H("largegap",{currentTime:c,gapSize:g});m.cancelable=!0;b.m(m);b.u.jumpLargeGaps&&!m.defaultPrevented?k=!0:A.info("Ignoring large gap at",c,"size",g)}if(h||k)0==e?A.info("Jumping forward",g,"seconds because of gap before start time of",f):A.info("Jumping forward",g,"seconds because of gap starting at",
d.end(e-1),"and ending at",f),b.a.currentTime=f}}}}}};function tg(b){var c=this;this.c=b;this.a=new Set;this.b=(new B(function(){ug(c,!1)})).Ba(.25)}tg.prototype.release=function(){this.b.stop();for(var b=q(this.a),c=b.next();!c.done;c=b.next())c.value.release();this.a.clear()};function ug(b,c){for(var d=q(b.a),e=d.next();!e.done;e=d.next())e.value.g(b.c.currentTime,c)};function vg(b){var c=[];b=q(b);for(var d=b.next();!d.done;d=b.next()){d=q(d.value.variants);for(var e=d.next();!e.done;e=d.next())c.push(e.value)}return c}function wg(b,c){for(var d=null,e=q(b),f=e.next();!f.done;f=e.next())f=f.value,c>=f.startTime&&(d=f);return d};function xg(b){this.c=b;this.a=null;this.b=function(){}}xg.prototype.release=function(){this.a=this.c=null;this.b=function(){}};xg.prototype.g=function(b){var c=this.a,d=this.c.periods;b=wg(d,b)||d[0];c!=b&&this.b(b);this.a=b};function yg(b,c){b.b=c};function zg(b){var c=this;this.a=b;this.f=!1;this.c=this.a.Ub();this.b=new B(function(){c.a.od(.25*c.c)})}zg.prototype.release=function(){this.b&&(this.b.stop(),this.b=null);this.a=null};zg.prototype.set=function(b){this.c=b;Ag(this)};function Ag(b){b.b.stop();var c=b.f?0:b.c;if(0<=c)try{b.a.Ub()!=c&&b.a.Vc(c);return}catch(d){}b.b.Ba(.25);0!=b.a.Ub()&&b.a.Vc(0)};/*

 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function Bg(b,c,d,e){c==HTMLMediaElement.HAVE_NOTHING||b.readyState>=c?e():(c=Cg.get(c),d.oa(b,c,e))}var Cg=new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]]);function Dg(b,c,d){var e=this;this.a=b;this.g=c;this.f=d;this.h=!1;this.b=new J;this.c=new Eg(b);Bg(this.a,HTMLMediaElement.HAVE_METADATA,this.b,function(){Fg(e,e.f)})}Dg.prototype.release=function(){this.b&&(this.b.release(),this.b=null);null!=this.c&&(this.c.release(),this.c=null);this.g=function(){};this.a=null};function Gg(b){return b.h?b.a.currentTime:b.f}function Hg(b,c){0<b.a.readyState?Ig(b.c,c):Bg(b.a,HTMLMediaElement.HAVE_METADATA,b.b,function(){Fg(b,b.f)})}
function Fg(b,c){.001>Math.abs(b.a.currentTime-c)?Jg(b):(b.b.oa(b.a,"seeking",function(){Jg(b)}),Ig(b.c,0==b.a.currentTime?c:b.a.currentTime))}function Jg(b){b.h=!0;b.b.B(b.a,"seeking",function(){return b.g()})}function Eg(b){var c=this;this.b=b;this.h=10;this.g=this.c=this.f=0;this.a=new B(function(){0>=c.f?(A.j(["Failed to move playhead from",c.c,"to",c.g].join(" ")),c.a.stop()):c.b.currentTime!=c.c?c.a.stop():(c.b.currentTime=c.g,c.f--)})}
Eg.prototype.release=function(){this.a&&(this.a.stop(),this.a=null);this.b=null};function Ig(b,c){b.c=b.b.currentTime;b.g=c;b.f=b.h;b.b.currentTime=c;b.a.Ba(.1)};function Kg(b){function c(){null==d.c?d.f=!0:(d.b.oa(d.a,"seeking",function(){d.f=!0}),d.a.currentTime=Math.max(0,d.a.currentTime+d.c))}var d=this;this.a=b;this.f=!1;this.c=null;this.b=new J;Bg(this.a,HTMLMediaElement.HAVE_CURRENT_DATA,this.b,function(){c()})}Kg.prototype.release=function(){this.b&&(this.b.release(),this.b=null);this.a=null};Kg.prototype.o=function(b){this.c=this.f?this.c:b};Kg.prototype.g=function(){return(this.f?this.a.currentTime:this.c)||0};Kg.prototype.u=function(){};
function Lg(b,c,d,e,f,g){var h=this;this.c=b;this.a=c.presentationTimeline;this.C=c.minBufferTime||0;this.h=d;this.w=f;this.m=null;this.f=new rg(b,c.presentationTimeline,d,Mg(b,d),g);this.b=new Dg(b,function(){a:{var b=h.f;b.i=!0;b.h=!1;b.c=!1;b=Gg(h.b);var c=Ng(h,b);if(.001<Math.abs(c-b)){var d=Date.now()/1E3;if(!h.m||h.m<d-1){h.m=d;Hg(h.b,c);b=void 0;break a}}A.A("Seek to "+b);h.w();b=void 0}return b},Og(this,e));this.i=(new B(function(){if(0!=h.c.readyState&&!h.c.paused){var b=Gg(h.b),c=h.a.nb(),
d=h.a.xa();3>d-c&&(c=d-3);b<c&&(c=Ng(h,b),A.info("Jumping forward "+(c-b)+" seconds to catch up with the seek range."),h.c.currentTime=c)}})).Ba(.25)}Lg.prototype.release=function(){this.b&&(this.b.release(),this.b=null);this.f&&(this.f.release(),this.f=null);this.i&&(this.i.stop(),this.i=null);this.c=this.b=this.a=this.h=null;this.w=function(){}};Lg.prototype.o=function(b){Hg(this.b,b)};Lg.prototype.g=function(){var b=Gg(this.b);return 0<this.c.readyState&&!this.c.paused?Pg(this,b):b};
function Og(b,c){null==c?c=Infinity>b.a.ba()?b.a.nb():b.a.xa():0>c&&(c=b.a.xa()+c);return Qg(b,Pg(b,c))}Lg.prototype.u=function(){this.f.Kc()};function Qg(b,c){var d=b.a.ba();return c>=d?d-b.h.durationBackoff:c}
function Ng(b,c){var d=bd.bind(null,b.c.buffered),e=Math.max(b.C,b.h.rebufferingGoal),f=b.h.safeSeekOffset,g=b.a.nb(),h=b.a.xa(),k=b.a.ba();3>h-g&&(g=h-3);var m=b.a.Cb(e),n=b.a.Cb(f);e=b.a.Cb(e+f);if(c>=k)return A.A("Playhead past duration."),Qg(b,c);if(c>h)return A.A("Playhead past end."),h;if(c<g){if(d(n))return A.A("Playhead before start & start is buffered"),n;A.A("Playhead before start & start is unbuffered");return e}if(c>=m||d(c))return A.A("Playhead in safe region or in buffered region."),
c;A.A("Playhead outside safe region & in unbuffered region.");return e}function Pg(b,c){var d=b.a.nb();if(c<d)return d;d=b.a.xa();return c>d?d:c}function Mg(b,c){if(!c.stallEnabled)return null;var d=c.stallSkip,e=new fg(new qg(b),c.stallThreshold);pg(e,function(c,e){A.debug("Stall detected at "+c+" for "+e+" seconds.");d?(A.debug("Seeking forward "+d+" seconds to break stall."),b.currentTime+=d):(A.debug("Pausing and unpausing to break stall."),b.pause(),b.play())});return e};function Rg(b){var c=this;this.b=function(){};this.a=new Set;this.f=b;this.c=(new B(function(){for(var b=c.f(),e=q(c.a),f=e.next();!f.done;f=e.next())f=f.value,f.endTime<b.start&&c.a["delete"](f)})).Ba(2)}Rg.prototype.release=function(){this.b=function(){};this.a.clear();this.c.stop()};function Sg(b,c){b.b=c};function Tg(b){var c=this;this.h=b;this.f=new Map;this.a=function(){};this.b=function(){};this.c=function(){};this.i=[{cb:null,bb:Ug,Ua:function(b,e){return c.a(b,e)}},{cb:Vg,bb:Ug,Ua:function(b,e){return c.a(b,e)}},{cb:Wg,bb:Ug,Ua:function(b,e){return c.a(b,e)}},{cb:Ug,bb:Vg,Ua:function(b,e){return c.b(b,e)}},{cb:Ug,bb:Wg,Ua:function(b,e){return c.b(b,e)}},{cb:Vg,bb:Wg,Ua:function(b,e){return c.c(b,e)}},{cb:Wg,bb:Vg,Ua:function(b,e){return c.c(b,e)}}]}
Tg.prototype.release=function(){this.h=null;this.f.clear();this.a=function(){};this.b=function(){};this.c=function(){}};Tg.prototype.g=function(b,c){for(var d=q(this.h.a),e=d.next();!e.done;e=d.next()){e=e.value;var f=this.f.get(e),g=b<e.startTime?Vg:b>e.endTime?Wg:Ug;this.f.set(e,g);for(var h=q(this.i),k=h.next();!k.done;k=h.next())k=k.value,k.cb==f&&k.bb==g&&k.Ua(e,c)}};function Xg(b,c,d,e){b.a=c;b.b=d;b.c=e}var Vg=1,Ug=2,Wg=3;function Yg(b,c){this.a=c;this.c=b;this.g=null;this.m=1;this.w=Promise.resolve();this.h=[];this.i=new Map;this.b=new Map;this.u=!1;this.M=null;this.K=this.f=this.o=!1;this.C=0}Yg.prototype.destroy=function(){var b=this;return t(function d(){var e,f;return y(d,function(d){switch(d.l){case 1:e=[];for(var g=q(b.b.values()),k=g.next();!k.done;k=g.next())f=k.value,Zg(f),e.push($g(f));return v(d,Promise.all(e),2);case 2:b.b.clear(),b.i.clear(),b.a=null,b.c=null,b.w=null,b.h=null,b.g=null,b.f=!0,w(d)}})})};
Yg.prototype.configure=function(b){this.g=b;this.M=new hb({maxAttempts:Math.max(b.retryParameters.maxAttempts,2),baseDelay:b.retryParameters.baseDelay,backoffFactor:b.retryParameters.backoffFactor,fuzzFactor:b.retryParameters.fuzzFactor,timeout:0},!0)};
Yg.prototype.start=function(){var b=this;return t(function d(){var e,f,g;return y(d,function(d){switch(d.l){case 1:return e=b.a.Sa(),f=ah(b,e),g=b.a.rd(b.c.periods[f]),g.variant||g.text?v(d,bh(b,g.variant?g.variant.audio:null,g.variant?g.variant.video:null,g.text,e),2):(A.error("init: no Streams chosen"),d["return"](new D(2,5,5005)));case 2:if(b.f)return d["return"]();A.debug("init: completed initial Stream setup");b.a&&b.a.ye&&(A.A("init: calling onInitialStreamsSetup()..."),b.a.ye());w(d)}})})};
function ch(b){return dh(b,"audio")}function eh(b){return dh(b,"video")}function dh(b,c){var d=b.b.get(c);return d?d.Ja||d.stream:null}
function fh(b,c){return t(function e(){var f,g,h,k,m,n,p,r,u,x;return y(e,function(e){switch(e.l){case 1:return f=gd,v(e,Ud(b.a.I,f.Pa),2);case 2:return b.C++,b.K=!1,g=b.C,h=b.a.I,k=new Map,m=new Set,k.set(f.Pa,c),m.add(c),v(e,h.init(k,!1),3);case 3:return b.f?e["return"]():v(e,gh(b,m),4);case 4:if(b.f)return e["return"]();p=(n=b.a.I.g.isTextVisible())||b.g.alwaysStreamText;b.C!=g||b.b.has(f.Pa)||b.K||!p||(r=b.a.Sa(),u=ah(b,r),x=hh(c,u,0),b.b.set(f.Pa,x),ih(b,x,0));w(e)}})})}
function jh(b){b.K=!0;var c=b.b.get("text");c&&(Zg(c),$g(c)["catch"](function(){}),b.b["delete"]("text"))}function kh(b,c){var d=b.b.get("video");if(d){var e=d.stream;if(e)if(A.debug("setTrickPlay",c),c){var f=e.trickModeVideo;f&&!d.Ja&&(A.debug("Engaging trick mode stream",f),lh(b,f,!1,0,!1),d.Ja=e)}else if(e=d.Ja)A.debug("Restoring non-trick-mode stream",e),d.Ja=null,lh(b,e,!0,0,!1)}}
function mh(b,c,d,e){var f=!1;if(c.video){var g=lh(b,c.video,d,e,!1);f=f||g}c.audio&&(b=lh(b,c.audio,d,e,!1),f=f||b);return f}
function lh(b,c,d,e,f){var g=b.b.get(c.type);if(!g&&"text"==c.type&&b.g.ignoreTextStreamFailures)return fh(b,c),!0;if(!g)return!1;var h=nh(b,c),k=Array.from(b.b.values()).every(function(b){return b.ga==g.ga});if(d&&h!=g.ga&&k)return A.debug("switch: switching to stream in another Period; clearing buffer and changing Periods"),b.b.forEach(function(c){oh(b,c)}),!0;g.Ja&&(A.debug("switch during trick play mode",c),c.trickModeVideo?(g.Ja=c,c=c.trickModeVideo,A.debug("switch found trick play stream",c)):
(g.Ja=null,A.debug("switch found no special trick play stream")));k=b.h[h];if(!k||!k.yb)return!1;k=b.i.get(c.id);if(!k||!k.yb)return!1;if(g.stream==c&&!f)return A.debug("switch: Stream "+Y(g)+" already active"),!1;"text"==c.type&&Ld(b.a.I,Zb(c.mimeType,c.codecs));g.stream=c;g.Yb=!0;A.debug("switch: switching to Stream "+Y(g));ph(b,g,h)&&(A.info("Aborting current segment request to switch."),g.Xa.abort());d&&(g.Qa?g.ic=!0:g.Ia?(g.Na=!0,g.Qb=e,g.ic=!0):(Zg(g),qh(b,g,!0,e)["catch"](function(c){if(b.a)b.a.onError(c)})));
return!0}function ph(b,c,d){if(!c.Xa)return!1;var e=b.a.Sa(),f=Pd(b.a.I,c.type),g=rh(b,c,e,f,d);d=g?g.a?g.a-g.b:null:null;g&&!d&&(d=(g.endTime-g.Ac())*c.stream.bandwidth/8);if(isNaN(d))return!1;(g=c.stream.initSegmentReference)&&(d+=(g.a?g.a-g.b:null)||0);g=b.a.getBandwidthEstimate();return 8*d/g<f-e-Math.max(b.c.minBufferTime||0,b.g.rebufferingGoal)||c.Xa.b.a>d?!0:!1}
function sh(b){function c(c){var f=b.a.I;"text"==c?(c=f.a,c=null==c.a||null==c.b?!1:d>=c.a&&d<c.b):(c=Od(f,c),c=bd(c,d,e));return c}var d=b.a.Sa(),e=b.g.smallGapLimit,f=!1,g=ah(b,d);if(Wb(b.b.values(),function(b){return b.ga==g}))for(var h=q(b.b.keys()),k=h.next();!k.done;k=h.next())k=k.value,c(k)||(oh(b,b.b.get(k)),f=!0);else Wb(b.b.keys(),c)||(A.debug("(all): seeked: unbuffered seek: clearing all buffers"),b.b.forEach(function(c){oh(b,c)}),f=!0);f||A.debug("(all): seeked: buffered seek: presentationTime="+
d)}function oh(b,c){var d=Y(c);c.Qa?A.debug(d,"clear: already clearing the buffer"):c.Na?A.debug(d,"clear: already waiting"):c.Ia?(A.debug(d,"clear: currently updating"),c.Na=!0,c.Qb=0):null==Nd(b.a.I,c.type)?(A.debug(d,"clear: nothing buffered"),null==c.Ca&&ih(b,c,0)):(A.debug(d,"clear: handling right now"),Zg(c),qh(b,c,!1,0)["catch"](function(c){if(b.a)b.a.onError(c)}))}
function bh(b,c,d,e,f){return t(function h(){var k,m,n,p,r,u,x;return y(h,function(h){switch(h.l){case 1:return k=b.a.Sa(),m=ah(b,k),n=gd,p=new Map,r=new Set,c&&(p.set(n.Kd,c),r.add(c)),d&&(p.set(n.ad,d),r.add(d)),e&&(p.set(n.Pa,e),r.add(e)),u=b.a.I,x=b.g.forceTransmuxTS,v(h,u.init(p,x),2);case 2:if(b.f)return h["return"]();th(b);return v(h,gh(b,r),3);case 3:if(b.f)return h["return"]();p.forEach(function(c,d){if(!b.b.has(d)){var e=hh(c,m,f);b.b.set(d,e);ih(b,e,0)}});w(h)}})})}
function hh(b,c,d){return{stream:b,type:b.type,sb:null,ya:null,Ja:null,Yb:!0,ga:c,endOfStream:!1,Ia:!1,Ca:null,Na:!1,Qb:0,ic:!1,Qa:!1,Nc:!1,Db:!1,Qc:d||0,Xa:null}}
function uh(b,c){var d=b.h[c];if(d)return A.debug("(all) Period "+c+" is being or has been set up"),d.promise;A.debug("(all) setting up Period "+c);d={promise:new E,yb:!1};b.h[c]=d;for(var e=new Set,f=q(b.c.periods[c].variants),g=f.next();!g.done;g=f.next())g=g.value,g.video&&e.add(g.video),g.video&&g.video.trickModeVideo&&e.add(g.video.trickModeVideo),g.audio&&e.add(g.audio);f=q(b.c.periods[c].textStreams);for(g=f.next();!g.done;g=f.next())e.add(g.value);b.w=b.w.then(function(){if(!this.f)return gh(this,
e)}.bind(b)).then(function(){this.f||(this.h[c].promise.resolve(),this.h[c].yb=!0,A.A("(all) setup Period "+c))}.bind(b))["catch"](function(b){this.f||(this.h[c].promise["catch"](function(){}),this.h[c].promise.reject(),delete this.h[c],A.j("(all) failed to setup Period "+c),this.a.onError(b))}.bind(b));return d.promise}
function gh(b,c){return t(function e(){var f,g,h,k,m,n,p;return y(e,function(e){switch(e.l){case 1:f=[];for(var r=q(c),x=r.next();!x.done;x=r.next())g=x.value,(h=b.i.get(g.id))?(A.debug("(all) Stream "+g.id+" is being or has been set up"),f.push(h.promise)):(A.A("(all) setting up Stream "+g.id),b.i.set(g.id,{promise:new E,yb:!1}),f.push(g.createSegmentIndex()));e.W=2;return v(e,Promise.all(f),4);case 4:if(b.f)return e["return"]();ya(e,3);break;case 2:k=za(e);if(b.f)return e["return"]();e=q(c);for(x=
e.next();!x.done;x=e.next())m=x.value,b.i.get(m.id).promise["catch"](function(){}),b.i.get(m.id).promise.reject(),b.i["delete"](m.id);throw k;case 3:r=q(c);for(x=r.next();!x.done;x=r.next())n=x.value,p=b.i.get(n.id),p.yb||(p.promise.resolve(),p.yb=!0,A.A("(all) setup Stream "+n.id));w(e)}})})}function th(b){var c=b.c.presentationTimeline.ba();Infinity>c?b.a.I.Za(c):b.a.I.Za(Math.pow(2,32))}
function vh(b,c){if(!b.f){var d=Y(c);if(!c.Ia&&null!=c.Ca&&!c.Qa)if(c.Ca=null,c.Na)A.debug(d,"skipping update and clearing the buffer"),qh(b,c,c.ic,c.Qb);else{try{var e=wh(b,c);null!=e&&(ih(b,c,e),c.Db=!1)}catch(f){xh(b,f);return}e=Array.from(b.b.values());yh(b,c);b.u&&e.every(function(b){return b.endOfStream})&&(A.A(d,"calling endOfStream()..."),b.a.I.endOfStream().then(function(){if(!this.f){var b=this.a.I.ba();0!=b&&b<this.c.presentationTimeline.ba()&&this.c.presentationTimeline.Za(b)}}.bind(b)))}}}
function wh(b,c){if(zh(c))return Td(b.a.I,c.stream.originalId||""),null;var d=Y(c),e=b.a.Sa(),f=Ah(b,c,e);A.H(d,"timeNeeded="+f);var g=nh(b,c.stream),h=ah(b,f),k=Qd(b.a.I,c.type,e);A.H(d,"update_:","presentationTime="+e,"bufferedAhead="+k);var m=Math.max(b.c.minBufferTime||0,b.g.rebufferingGoal,b.g.bufferingGoal)*b.m;if(f>=b.c.presentationTimeline.ba())return A.debug(d,"buffered to end of presentation"),c.endOfStream=!0,"video"==c.type&&(f=b.b.get("text"))&&"application/cea-608"==f.stream.mimeType&&
(f.endOfStream=!0),null;c.endOfStream=!1;c.ga=h;if(h!=g)return A.debug(d,"need Period "+h,"presentationTime="+e,"timeNeeded="+f,"currentPeriodIndex="+g),null;if(k>=m)return A.H(d,"buffering goal met"),.5;d=Pd(b.a.I,c.type);d=rh(b,c,e,d,g);if(!d)return 1;var n=Infinity;Array.from(b.b.values()).forEach(function(c){zh(c)||(c=Ah(b,c,e),n=Math.min(n,c))});if(f>=n+b.c.presentationTimeline.a)return 1;c.Qc=0;Bh(b,c,e,g,d);return null}
function Ah(b,c,d){if(!c.sb||!c.ya)return Math.max(d,c.Qc);d=nh(b,c.sb);return b.c.periods[d].startTime+c.ya.endTime}
function rh(b,c,d,e,f){var g=Y(c);if(c.ya&&c.stream==c.sb)return e=c.ya.position+1,A.H(g,"next position known:","position="+e),Ch(b,c,f,e);c.ya?(A.A(g,"next position unknown: another Stream buffered"),g=nh(b,c.sb),g=Dh(b,c,b.c.periods[g].startTime+c.ya.endTime,f)):(A.A(g,"next position unknown: nothing buffered"),g=Dh(b,c,e||d,f));if(null==g)return null;d=null;null==e&&(d=Ch(b,c,f,Math.max(0,g-1)));return d||Ch(b,c,f,g)}
function Dh(b,c,d,e){var f=Y(c);b=b.c.periods[e];A.debug(f,"looking up segment:","presentationTime="+d,"currentPeriod.startTime="+b.startTime);d=Math.max(0,d-b.startTime);c=c.stream.findSegmentPosition(d);null==c&&A.j(f,"cannot find segment:","currentPeriod.startTime="+b.startTime,"lookupTime="+d);return c}
function Ch(b,c,d,e){var f=Y(c);d=b.c.periods[d];c=c.stream.getSegmentReference(e);if(!c)return A.A(f,"segment does not exist:","currentPeriod.startTime="+d.startTime,"position="+e),null;e=b.c.presentationTimeline;b=e.Vb();e=e.ob();return d.startTime+c.endTime<b||d.startTime+c.startTime>e?(A.H(f,"segment is not available:","currentPeriod.startTime="+d.startTime,"reference.startTime="+c.startTime,"reference.endTime="+c.endTime,"availabilityStart="+b,"availabilityEnd="+e),null):c}
function Bh(b,c,d,e,f){var g=Y(c),h=b.c.periods[e];A.A(g,"fetchAndAppend_:","presentationTime="+d,"currentPeriod.startTime="+h.startTime,"reference.position="+f.position,"reference.startTime="+f.startTime,"reference.endTime="+f.endTime);var k=c.stream,m=b.c.presentationTimeline.ba(),n=b.c.periods[e+1];e=Eh(b,c,e,Math.max(0,h.startTime-.1),n?n.startTime+.01:m);c.Ia=!0;c.Yb=!1;A.H(g,"fetching segment");m=Fh(b,c,f);Promise.all([e,m]).then(function(b){if(!this.f&&!this.o)return Gh(this,c,d,h,k,f,b[1])}.bind(b)).then(function(){this.f||
this.o||(c.Ia=!1,c.Nc=!1,c.Na||this.a.Kc(),ih(this,c,0),Hh(this,c,k),A.A(g,"finished fetch and append"))}.bind(b))["catch"](function(b){this.f||this.o||(c.Ia=!1,"text"==c.type&&this.g.ignoreTextStreamFailures?(1001==b.code?A.j(g,"Text stream failed to download. Proceeding without it."):A.j(g,"Text stream failed to parse. Proceeding without it."),this.b["delete"]("text")):7001==b.code?(c.Ia=!1,c.Ca=null,ih(this,c,0)):3017==b.code?Ih(this,c,b):(A.error(g,"failed fetch and append: code="+b.code),c.Db=
!0,b.severity=2,xh(this,b)))}.bind(b))}
function Ih(b,c,d){var e=Y(c);if(Array.from(b.b.values()).some(function(b){return b!=c&&b.Nc}))A.debug(e,"MediaSource threw QuotaExceededError:","waiting for another stream to recover...");else{var f=Math.round(100*b.m);if(20<f)b.m-=.2;else if(4<f)b.m-=.04;else{A.error(e,"MediaSource threw QuotaExceededError too many times");c.Db=!0;b.o=!0;b.a.onError(d);return}A.j(e,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-Math.round(100*b.m))+"%");c.Nc=!0}ih(b,c,4)}
function Eh(b,c,d,e,f){if(!c.Yb)return Promise.resolve();var g=Y(c);d=b.c.periods[d].startTime-c.stream.presentationTimeOffset;A.A(g,"setting timestamp offset to "+d);A.A(g,"setting append window start to "+e);A.A(g,"setting append window end to "+f);e=Vd(b.a.I,c.type,d,e,f);if(!c.stream.initSegmentReference)return e;A.A(g,"fetching init segment");b=Fh(b,c,c.stream.initSegmentReference).then(function(b){if(!this.f)return A.A(g,"appending init segment"),Rd(this.a.I,c.type,b,null,null,c.stream.closedCaptions&&
0<c.stream.closedCaptions.size)}.bind(b))["catch"](function(b){c.Yb=!0;return Promise.reject(b)});return Promise.all([e,b])}
function Gh(b,c,d,e,f,g,h){var k=Y(c),m=f.closedCaptions&&0<f.closedCaptions.size;null!=f.emsgSchemeIdUris&&0<f.emsgSchemeIdUris.length&&(new R).sa("emsg",b.S.bind(b,e,g,f.emsgSchemeIdUris)).parse(h);return Jh(b,c,d).then(function(){if(!this.f)return A.A(k,"appending media segment"),Rd(this.a.I,c.type,h,g.startTime+e.startTime,g.endTime+e.startTime,m)}.bind(b)).then(function(){if(!this.f)return A.H(k,"appended media segment"),c.sb=f,c.ya=g,Promise.resolve()}.bind(b))}
Yg.prototype.S=function(b,c,d,e){var f=e.reader.Lc(),g=e.reader.Lc(),h=e.reader.F(),k=e.reader.F(),m=e.reader.F(),n=e.reader.F();e=e.reader.Ya(e.reader.G.byteLength-e.reader.ca());b=b.startTime+c.startTime+k/h;if(d.includes(f))if("urn:mpeg:dash:event:2012"==f)this.a.ze();else this.a.onEvent(new H("emsg",{detail:{startTime:b,endTime:b+m/h,schemeIdUri:f,value:g,timescale:h,presentationTimeDelta:k,eventDuration:m,id:n,messageData:e}}))};
function Jh(b,c,d){var e=Y(c);A.H(e,"checking buffer length");var f=Math.max(b.g.bufferBehind,b.c.presentationTimeline.a),g=Nd(b.a.I,c.type);if(null==g)return A.H(e,"buffer behind okay because nothing buffered:","presentationTime="+d,"bufferBehind="+f),Promise.resolve();var h=d-g,k=h-f;if(0>=k)return A.H(e,"buffer behind okay:","presentationTime="+d,"bufferedBehind="+h,"bufferBehind="+f,"underflow="+-k),Promise.resolve();A.A(e,"buffer behind too large:","presentationTime="+d,"bufferedBehind="+h,"bufferBehind="+
f,"overflow="+k);return b.a.I.remove(c.type,g,g+k).then(function(){this.f||A.A(e,"evicted "+k+" seconds")}.bind(b))}
function Hh(b,c,d){if(!b.u){var e=Y(c);c=Array.from(b.b.values());if(1!=c.length||"text"!=c[0].type)b.u=c.every(function(b){return"text"==b.type?!0:!b.Na&&!b.Qa&&b.ya});if(b.u){A.debug(e,"startup complete");d=nh(b,d);b.h[d]||uh(b,d).then(function(){this.f||(A.A(e,"calling onCanSwitch()..."),this.a.qd())}.bind(b))["catch"](ed.$b);for(d=0;d<b.c.periods.length;++d)uh(b,d)["catch"](ed.$b);b.a.Fe&&(A.A(e,"calling onStartupComplete()..."),b.a.Fe())}}}
function yh(b,c){var d=Y(c),e=nh(b,c.stream);if(c.ga!=e){var f=c.ga,g=Array.from(b.b.values());g.every(function(b){return b.ga==f||zh(b)})?g.every(Kh)?(A.debug(d,"all need Period "+f),uh(b,f).then(function(){if(!this.f)if(g.every(function(b){var c=Kh(b),d=nh(this,b.stream);return zh(b)?!0:c&&b.ga==f&&d!=f}.bind(this))){var b=this.c.periods[f];A.A(d,"calling onChooseStreams()...");var c=this.a.rd(b),e=new Map;c.variant&&c.variant.video&&e.set("video",c.variant.video);c.variant&&c.variant.audio&&e.set("audio",
c.variant.audio);c.text&&e.set("text",c.text);c=q(this.b.keys());for(var n=c.next();!n.done;n=c.next())if(n=n.value,!e.has(n)&&"text"!=n){A.error(d,"invalid Streams chosen: missing "+n+" Stream");this.a.onError(new D(2,5,5005));return}c=q(Array.from(e.keys()));for(n=c.next();!n.done;n=c.next())if(n=n.value,!this.b.has(n))if("text"==n)bh(this,null,null,e.get("text"),b.startTime),e["delete"](n);else{A.error(d,"invalid Streams chosen: unusable "+n+" Stream");this.a.onError(new D(2,5,5005));return}c=
q(Array.from(this.b.keys()));for(n=c.next();!n.done;n=c.next()){n=n.value;var p=this.b.get(n),r=e.get(n);if(r){var u=zh(p);u&&(p.ga=f,p.Qc=b.startTime);lh(this,r,!1,0,!1);u&&zh(p)||ih(this,this.b.get(n),0)}else this.b["delete"](n)}A.A(d,"calling onCanSwitch()...");this.a.qd()}else A.debug(d,"ignoring transition to Period",f,"since another is happening")}.bind(b))["catch"](ed.$b)):A.debug(d,"all MediaStates need Period "+f+", but not all MediaStates are idle"):A.debug(d,"not all MediaStates need Period "+
f)}}function zh(b){return b&&"text"==b.type&&"application/cea-608"==b.stream.mimeType}function Kh(b){return!b.Ia&&null==b.Ca&&!b.Na&&!b.Qa}function ah(b,c){var d=wg(b.c.periods,c+hd);return d?b.c.periods.indexOf(d):0}
function nh(b,c){for(var d=b.c.periods,e=0;e<d.length;e++){for(var f=d[e],g=new Set,h=q(f.variants),k=h.next();!k.done;k=h.next())k=k.value,k.audio&&g.add(k.audio),k.video&&g.add(k.video),k.video&&k.video.trickModeVideo&&g.add(k.video.trickModeVideo);f=q(f.textStreams);for(h=f.next();!h.done;h=f.next())g.add(h.value);if(g.has(c))return e}return-1}
function Fh(b,c,d){var e=tf(d.c(),d.b,d.a,b.g.retryParameters);A.H("fetching: reference=",d);b=b.a.Zb.request(1,e);c.Xa=b;return b.promise.then(function(b){c.Xa=null;return b.data})}
function qh(b,c,d,e){return t(function g(){var h,k,m,n;return y(g,function(g){switch(g.l){case 1:return h=Y(c),c.Na=!1,c.ic=!1,c.Qb=0,c.Qa=!0,c.sb=null,c.ya=null,A.debug(h,"clearing buffer"),e?(m=b.a.Sa(),n=b.a.I.ba(),k=b.a.I.remove(c.type,m+e,n)):k=Ud(b.a.I,c.type).then(function(){if(!this.f&&d)return this.a.I.flush(c.type)}.bind(b)),v(g,k,2);case 2:if(b.f)return g["return"]();A.debug(h,"cleared buffer");c.Qa=!1;c.endOfStream=!1;ih(b,c,0);w(g)}})})}
function ih(b,c,d){A.H(Y(c),"updating in "+d+" seconds");c.Ca=(new gb(function(){return t(function f(){var d;return y(f,function(f){switch(f.l){case 1:return f.W=2,v(f,vh(b,c),4);case 4:ya(f,0);break;case 2:d=za(f);if(b.a)b.a.onError(d);w(f)}})})})).U(d)}function Zg(b){null!=b.Ca&&(b.Ca.stop(),b.Ca=null)}function $g(b){return t(function d(){return y(d,function(d){switch(d.l){case 1:if(b.Xa)return v(d,b.Xa.abort(),0);d.l=0}})})}
function xh(b,c){jb(b.M).then(function(){this.f||(this.a.onError(c),c.handled||this.g.failureCallback(c))}.bind(b))}function Y(b){return"("+b.type+":"+b.stream.id+")"};function Lh(b,c,d,e,f,g){if(200<=d&&299>=d&&202!=d)return{uri:f||e,zf:e,data:c,headers:b,fromCache:!!b["x-shaka-from-cache"]};f=null;try{f=Tb(c)}catch(h){}A.debug("HTTP error text:",f);throw new D(401==d||403==d?2:1,1,1001,e,d,f,b,g);};function Mh(b,c,d,e){var f=new Mh.b;Xb(c.headers).forEach(function(b,c){f.append(c,b)});var g=new Mh.a,h={bd:!1,Id:!1};b=Mh.h(b,d,{body:c.body||void 0,headers:f,method:c.method,signal:g.signal,credentials:c.allowCrossSiteCredentials?"include":void 0},h,e);b=new F(b,function(){h.bd=!0;g.abort();return Promise.resolve()});if(c=c.retryParameters.timeout){var k=new B(function(){h.Id=!0;g.abort()});k.U(c/1E3);b["finally"](function(){k.stop()})}return b}z("shaka.net.HttpFetchPlugin",Mh);
Mh.h=function(b,c,d,e,f){return t(function h(){var k,m,n,p,r,u,x,G,C,L,U,ha,Xa,Ya;return y(h,function(h){switch(h.l){case 1:return k=Mh.g,m=Mh.c,u=r=0,x=Date.now(),h.W=2,v(h,k(b,d),4);case 4:return n=h.R,G=n.clone().body.getReader(),L=(C=n.headers.get("Content-Length"))?parseInt(C,10):0,U=function(b){function c(){return t(function Hc(){var d,e,h;return y(Hc,function(k){switch(k.l){case 1:return k.W=2,v(k,G.read(),4);case 4:d=k.R;ya(k,3);break;case 2:return e=za(k),A.A("error reading from stream",
e.message),k["return"]();case 3:d.done||(r+=d.value.byteLength);h=Date.now();if(100<h-x||d.done)f(h-x,r-u,L-r),u=r,x=h;d.done?b.close():(b.enqueue(d.value),c());w(k)}})})}c()},new m({start:U}),v(h,n.arrayBuffer(),5);case 5:p=h.R;ya(h,3);break;case 2:ha=za(h);if(e.bd)throw new D(1,1,7001,b,c);if(e.Id)throw new D(1,1,1003,b,c);throw new D(1,1,1002,b,ha,c);case 3:return Xa={},Ya=n.headers,Ya.forEach(function(b,c){Xa[c.trim()]=b}),h["return"](Lh(Xa,p,n.status,b,n.url,c))}})})};
Mh.isSupported=function(){if(window.ReadableStream)try{new ReadableStream({})}catch(b){return!1}else return!1;return!(!window.fetch||!window.AbortController)};Mh.isSupported=Mh.isSupported;Mh.g=window.fetch;Mh.a=window.AbortController;Mh.c=window.ReadableStream;Mh.b=window.Headers;Mh.isSupported()&&(Ab("http",Mh,2),Ab("https",Mh,2));function Nh(b,c,d,e){var f=new Nh.f,g=Date.now(),h=0,k=new Promise(function(k,n){f.open(c.method,b,!0);f.responseType="arraybuffer";f.timeout=c.retryParameters.timeout;f.withCredentials=c.allowCrossSiteCredentials;f.onabort=function(){n(new D(1,1,7001,b,d))};f.onload=function(c){c=c.target;var e=c.getAllResponseHeaders().trim().split("\r\n"),f={};e=q(e);for(var g=e.next();!g.done;g=e.next())g=g.value.split(": "),f[g[0].toLowerCase()]=g.slice(1).join(": ");try{var h=Lh(f,c.response,c.status,b,c.responseURL,
d);k(h)}catch(L){n(L)}};f.onerror=function(c){n(new D(1,1,1002,b,c,d))};f.ontimeout=function(){n(new D(1,1,1003,b,d))};f.onprogress=function(b){var c=Date.now();if(100<c-g||b.lengthComputable&&b.loaded==b.total)e(c-g,b.loaded-h,b.total-b.loaded),h=b.loaded,g=c};for(var m in c.headers)f.setRequestHeader(m.toLowerCase(),c.headers[m]);f.send(c.body)});return new F(k,function(){f.abort();return Promise.resolve()})}z("shaka.net.HttpXHRPlugin",Nh);Nh.f=window.XMLHttpRequest;Ab("http",Nh,1);
Ab("https",Nh,1);function Oh(b,c){var d=Ph(),e=this;this.h=c;this.c=b;this.f=d;this.i=null;this.g=[];this.b=this.a=null;this.m=!0;this.o=Promise.resolve().then(function(){return Qh(e)})}Oh.prototype.destroy=function(){var b=this;return t(function d(){var e;return y(d,function(d){switch(d.l){case 1:return b.m=!1,b.b&&b.b.abort(),Rh(b),v(d,b.o,2);case 2:b.a&&b.a.va.Wa();for(var f=q(b.g),h=f.next();!h.done;h=f.next())e=h.value,e.va.Wa();b.a=null;b.g=[];b.h=null;w(d)}})})};
function Sh(b,c){var d={tb:function(){},bc:function(){},Wa:function(){},onError:function(){},cc:function(){},yf:function(){}};b.g.push({create:c,va:d});b.b&&b.b.abort();Rh(b);return d}
function Qh(b){return t(function d(){return y(d,function(d){switch(d.l){case 1:if(b.m){if(0==b.g.length||b.a&&!b.a.Ta)var e=!1;else{b.a&&(b.a.va.Wa(),b.a=null);e=b.g.shift();var g=e.create(b.f);g?(e.va.tb(),b.a={node:g.node,payload:g.payload,Ta:g.Ta,va:e.va}):e.va.cc();e=!0}e?e=Promise.resolve():b.a?e=Th(b):(b.h.xe(b.c),b.i=new E,e=b.i);return v(d,e,1)}d.l=0}})})}
function Th(b){return t(function d(){var e,f;return y(d,function(d){switch(d.l){case 1:return b.c=b.h.le(b.c,b.f,b.a.node,b.a.payload),d.W=2,b.b=b.h.Td(b.c,b.f,b.a.payload),v(d,b.b.promise,4);case 4:b.b=null;b.c==b.a.node&&(b.a.va.bc(),b.a=null);ya(d,0);break;case 2:e=za(d);if(7001==e.code)b.a.va.Wa();else b.a.va.onError(e);b.a=null;b.b=null;f=b;return v(d,b.h.handleError(b.f,e),5);case 5:f.c=d.R,w(d)}})})}function Rh(b){b.i&&(b.i.resolve(),b.i=null)};function Uh(b){this.a=null;for(var c=0;c<b.textTracks.length;++c){var d=b.textTracks[c];d.mode="disabled";"Shaka Player TextTrack"==d.label&&(this.a=d)}this.a||(this.a=b.addTextTrack("subtitles","Shaka Player TextTrack"));this.a.mode="hidden"}z("shaka.text.SimpleTextDisplayer",Uh);Uh.prototype.remove=function(b,c){if(!this.a)return!1;Vh(this.a,function(d){return d.startTime<c&&d.endTime>b});return!0};Uh.prototype.remove=Uh.prototype.remove;
Uh.prototype.append=function(b){var c=Wh,d=b.map(function(b){if(b.nestedCues.length){var c=b.nestedCues.map(function(b){return b.spacer?"\n":b.payload+" "}).join("").replace(/ $/m,"");b=b.clone();b.nestedCues=[];b.payload=c}return b}),e=[];b=this.a.cues?Array.from(this.a.cues):[];var f={};d=q(d);for(var g=d.next();!g.done;f={qb:f.qb},g=d.next())f.qb=g.value,b.some(function(b){return function(c){return c.startTime==b.qb.startTime&&c.endTime==b.qb.endTime&&c.text==b.qb.payload?!0:!1}}(f))||(g=c(f.qb))&&
e.push(g);e.slice().sort(function(b,c){return b.startTime!=c.startTime?b.startTime-c.startTime:b.endTime!=c.endTime?b.endTime-c.startTime:"line"in VTTCue.prototype?e.indexOf(c)-e.indexOf(b):e.indexOf(b)-e.indexOf(c)}).forEach(function(b){this.a.addCue(b)}.bind(this))};Uh.prototype.append=Uh.prototype.append;Uh.prototype.destroy=function(){this.a&&Vh(this.a,function(){return!0});this.a=null;return Promise.resolve()};Uh.prototype.destroy=Uh.prototype.destroy;
Uh.prototype.isTextVisible=function(){return"showing"==this.a.mode};Uh.prototype.isTextVisible=Uh.prototype.isTextVisible;Uh.prototype.setTextVisibility=function(b){this.a.mode=b?"showing":"hidden"};Uh.prototype.setTextVisibility=Uh.prototype.setTextVisibility;
function Wh(b){if(b.startTime>=b.endTime)return A.j("Invalid cue times: "+b.startTime+" - "+b.endTime),null;var c=new VTTCue(b.startTime,b.endTime,b.payload);c.lineAlign=b.lineAlign;c.positionAlign=b.positionAlign;b.size&&(c.size=b.size);try{c.align=b.textAlign}catch(d){}"center"==b.textAlign&&"center"!=c.align&&(c.align="middle");"vertical-lr"==b.writingMode?c.vertical="lr":"vertical-rl"==b.writingMode&&(c.vertical="rl");1==b.lineInterpretation&&(c.snapToLines=!1);null!=b.line&&(c.line=b.line);null!=
b.position&&(c.position=b.position);return c}function Vh(b,c){var d=b.mode;b.mode="showing"==d?"showing":"hidden";for(var e=b.cues,f=e.length-1;0<=f;f--){var g=e[f];g&&c(g)&&b.removeCue(g)}b.mode=d};function Xh(b,c,d,e,f){var g=f in e,h=!0,k;for(k in c){var m=f+"."+k,n=g?e[f]:d[k];g||k in d?void 0===c[k]?void 0===n||g?delete b[k]:b[k]=ub(n):n.constructor==Object&&c[k]&&c[k].constructor==Object?(b[k]||(b[k]=ub(n)),m=Xh(b[k],c[k],n,e,m),h=h&&m):typeof c[k]!=typeof n||null==c[k]||"function"!=typeof c[k]&&c[k].constructor!=n.constructor?(A.Ob("Invalid config, wrong type for "+m),h=!1):("function"==typeof d[k]&&d[k].length!=c[k].length&&A.qa("Unexpected number of arguments for "+m),b[k]=c[k]):(A.Ob("Invalid config, unrecognized key "+
m),h=!1)}return h}z("shaka.util.ConfigUtils.mergeConfigObjects",Xh);function Yh(b,c){for(var d={},e=d,f=0,g=0;;){f=b.indexOf(".",f);if(0>f)break;if(0==f||"\\"!=b[f-1])g=b.substring(g,f).replace(/\\\./g,"."),e[g]={},e=e[g],g=f+1;f+=1}e[b.substring(g).replace(/\\\./g,".")]=c;return d}z("shaka.util.ConfigUtils.convertToConfigObject",Yh);function Zh(){}z("shaka.util.PlayerConfiguration",Zh);
function $h(){var b=5E5,c=Infinity;navigator.connection&&(navigator.connection.downlink&&(b=1E6*navigator.connection.downlink),navigator.connection.saveData&&(c=360));var d={retryParameters:ib(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:Oc,fairPlayTransform:!0,updateExpirationTime:1},e={retryParameters:ib(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,dash:{customScheme:function(b){if(b)return null},clockSyncUri:"",ignoreDrmInfo:!1,
xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,autoCorrectDrift:!0,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1},hls:{ignoreTextStreamFailures:!1,useFullSegmentsForStartTime:!1}},f={retryParameters:ib(),failureCallback:function(b){A.error("Unhandled streaming error",b);return[b]},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,
forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0};if(hc("Web0S")||hc("Tizen")||hc("CrKey"))f.stallSkip=0;var g={trackSelectionCallback:function(b){return t(function n(){return y(n,function(c){switch(c.l){case 1:return c["return"](b)}})})},progressCallback:function(b,c){return[b,c]},usePersistentLicense:!0},h={drm:d,manifest:e,streaming:f,offline:g,abrFactory:P,abr:{enabled:!0,defaultBandwidthEstimate:b,switchInterval:8,bandwidthUpgradeTarget:.85,
bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:Infinity,minHeight:0,maxHeight:c,minPixels:0,maxPixels:Infinity,minFrameRate:0,maxFrameRate:Infinity,minBandwidth:0,maxBandwidth:Infinity}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:Infinity,minHeight:0,maxHeight:Infinity,minPixels:0,maxPixels:Infinity,minFrameRate:0,maxFrameRate:Infinity,minBandwidth:0,maxBandwidth:Infinity},
playRangeStart:0,playRangeEnd:Infinity,textDisplayFactory:function(){return null}};g.trackSelectionCallback=function(b){return t(function n(){return y(n,function(c){switch(c.l){case 1:return c["return"](ai(b,h.preferredAudioLanguage))}})})};return h}
function bi(b,c,d){var e={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return Xh(b,c,d||$h(),e,"")}Zh.mergeConfigObjects=bi;
function ai(b,c){var d=b.filter(function(b){return"variant"==b.type}),e=[],f=be(c,d.map(function(b){return b.language}));f&&(e=d.filter(function(b){return O(b.language)==f}));0==e.length&&(e=d.filter(function(b){return b.primary}));0==e.length&&(1<(new Set(d.map(function(b){return b.language}))).size&&A.j("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),e=d);var g=e.filter(function(b){return b.height&&480>=b.height});g.length&&
(g.sort(function(b,c){return c.height-b.height}),e=g.filter(function(b){return b.height==g[0].height}));d=[];if(e.length){var h=Math.floor(e.length/2);e.sort(function(b,c){return b.bandwidth-c.bandwidth});d.push(e[h])}e=q(b);for(h=e.next();!h.done;h=e.next())h=h.value,"text"==h.type&&d.push(h);return d};function ci(){this.a=null;this.b=[]}function di(b,c){if(null==b.a)b.a={timestamp:Date.now()/1E3,state:c,duration:0};else{var d=Date.now()/1E3;b.a.duration=d-b.a.timestamp;b.a.state!=c&&(b.b.push(b.a),b.a={timestamp:d,state:c,duration:0})}}function ei(b,c){var d=0;b.a&&b.a.state==c&&(d+=b.a.duration);for(var e=q(b.b),f=e.next();!f.done;f=e.next())f=f.value,d+=f.state==c?f.duration:0;return d}
function fi(b){function c(b){return{timestamp:b.timestamp,state:b.state,duration:b.duration}}for(var d=[],e=q(b.b),f=e.next();!f.done;f=e.next())d.push(c(f.value));b.a&&d.push(c(b.a));return d};function gi(){this.b=this.c=null;this.a=[]};function hi(){this.f=this.u=this.h=this.b=this.i=this.m=this.o=this.g=this.w=NaN;this.a=new ci;this.c=new gi};function Z(b,c){var d=this;tb.call(this);this.i=ii;this.a=null;this.hb=!1;this.g=new J;this.kc=this.m=this.eb=this.c=this.u=this.f=this.Nb=this.C=this.Kb=this.M=this.jb=this.o=this.K=this.h=this.Z=null;this.ld=1E9;this.Lb=new Set;this.lb=!0;this.na=null;this.jd=!1;this.fd=0;this.ma=null;this.ka=new Pf;this.b=ji(this);this.Mb={width:Infinity,height:Infinity};this.w=null;this.zb=new Yf(this.b.preferredAudioLanguage,this.b.preferredVariantRole,this.b.preferredAudioChannelCount);this.la=this.b.preferredTextLanguage;
this.fb=this.b.preferredTextRole;this.lc=[];c&&c(this);this.Z=ki(this);this.g.B(window,"online",function(){d.Rc()});this.S={name:"detach"};this.$={name:"attach"};this.Da={name:"unload"};this.qc={name:"manifest-parser"};this.oc={name:"manifest"};this.ib={name:"media-source"};this.jc={name:"drm-engine"};this.ea={name:"load"};this.rc={name:"src-equals-drm-engine"};this.kb={name:"src-equals"};var e=new Map;e.set(this.$,function(b,c){return pb(li(d,b,c))});e.set(this.S,function(b){b.s&&(d.g.ja(b.s,"error"),
b.s=null);d.a=null;b=Promise.resolve();return pb(b)});e.set(this.Da,function(b){return pb(mi(d,b))});e.set(this.ib,function(b){b=ni(d,b);return pb(b)});e.set(this.qc,function(b,c){var e=oi(d,b,c);return pb(e)});e.set(this.oc,function(b){return pi(d,b)});e.set(this.jc,function(){var b=qi(d);return pb(b)});e.set(this.ea,function(b,c){return pb(ri(d,b,c))});e.set(this.rc,function(b){b=si(d,b);return pb(b)});e.set(this.kb,function(b,c){return ti(d,b,c)});this.Oa=new Oh(this.S,{le:function(b,c,e,k){var f=
null;b==d.S&&(f=e==d.S?d.S:d.$);b==d.$&&(f=e==d.S||c.s!=k.s?d.S:e==d.$?d.$:e==d.ib||e==d.ea?d.ib:e==d.kb?d.rc:null);b==d.ib&&(f=e==d.ea&&c.s==k.s?d.qc:d.Da);b==d.qc&&(f=ui(d.ea,d.oc,d.Da,e,c,k));b==d.oc&&(f=ui(d.ea,d.jc,d.Da,e,c,k));b==d.jc&&(f=ui(d.ea,d.ea,d.Da,e,c,k));b==d.rc&&(f=e==d.kb&&c.s==k.s?d.kb:d.Da);if(b==d.ea||b==d.kb)f=d.Da;b==d.Da&&(f=k.s&&c.s==k.s?d.$:d.S);return f},Td:function(b,c,h){d.dispatchEvent(new H("onstatechange",{state:b.name}));return e.get(b)(c,h)},handleError:function(b,
c){return t(function k(){return y(k,function(e){switch(e.l){case 1:return A.j("The walker saw an error:"),c instanceof D?A.j("Error Code:",c.code):(A.j("Error Message:",c.message),A.j("Error Stack:",c.stack)),v(e,mi(d,b),2);case 2:return e["return"](b.s?d.$:d.S)}})})},xe:function(b){d.dispatchEvent(new H("onstateidle",{state:b.name}))}});b&&this.Ab(b,!0)}La(Z,tb);z("shaka.Player",Z);
Z.prototype.destroy=function(){var b=this;return t(function d(){var e;return y(d,function(d){switch(d.l){case 1:if(b.i==vi)return d["return"]();b.i=vi;e=Sh(b.Oa,function(){return{node:b.S,payload:Ph(),Ta:!1}});return v(d,new Promise(function(d){e.tb=function(){A.info("Preparing to destroy walker...")};e.bc=function(){d();b.dispatchEvent(new H("loaded"))};e.Wa=function(){d()};e.onError=function(){d()};e.cc=function(){d()}}),2);case 2:return v(d,b.Oa.destroy(),3);case 3:b.g&&(b.g.release(),b.g=null);
b.kc=null;b.m=null;b.b=null;if(!b.Z){d.l=0;break}return v(d,b.Z.destroy(),5);case 5:b.Z=null,w(d)}})})};Z.prototype.destroy=Z.prototype.destroy;Z.version="v2.5.17-3-g49d7dabe";var wi=["2","5"];Mf=new function(b){this.a=b;this.c=Nf;this.b=Of}(new Kf(Number(wi[0]),Number(wi[1])));var xi=["output-restricted","internal-error"],yi={};Z.registerSupportPlugin=function(b,c){yi[b]=c};
Z.isBrowserSupported=function(){if(!(window.Promise&&window.Uint8Array&&Array.prototype.forEach))return!1;var b=ic();return b&&12>b||!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration)?!1:cc()?!0:dc("application/x-mpegurl")};
Z.probeSupport=function(){return Uc().then(function(b){for(var c=W.Pe(),d={},e=q('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),f=
e.next();!f.done;f=e.next()){f=f.value;d[f]=cc()?Ed(f)?!0:MediaSource.isTypeSupported(f)||jd(f):dc(f);var g=f.split(";")[0];d[g]=d[g]||d[f]}b={manifest:c,media:d,drm:b};for(var h in yi)b[h]=yi[h]();return b})};Z.prototype.Ab=function(b,c){c=void 0===c?!0:c;if(this.i==vi)return Promise.reject(zi());var d=Ph();d.s=b;cc()||(c=!1);var e=c?this.ib:this.$,f=Sh(this.Oa,function(){return{node:e,payload:d,Ta:!1}});f.tb=function(){return A.info("Starting attach...")};return Ai(f)};Z.prototype.attach=Z.prototype.Ab;
Z.prototype.detach=function(){var b=this;if(this.i==vi)return Promise.reject(zi());var c=Sh(this.Oa,function(){return{node:b.S,payload:Ph(),Ta:!1}});c.tb=function(){return A.info("Starting detach...")};return Ai(c)};Z.prototype.detach=Z.prototype.detach;
Z.prototype.kf=function(b){var c=this;b=void 0===b?!0:b;if(this.i==vi)return Promise.reject(zi());cc()||(b=!1);var d=Ph(),e=Sh(this.Oa,function(e){var f=e.s&&b?c.ib:e.s?c.$:c.S;d.s=e.s;return{node:f,payload:d,Ta:!1}});e.tb=function(){return A.info("Starting unload...")};return Ai(e)};Z.prototype.unload=Z.prototype.kf;
Z.prototype.load=function(b,c,d){if(this.i==vi)return Promise.reject(zi());this.dispatchEvent(new H("loading"));var e=Ph();e.uri=b;e.Xc=Date.now()/1E3;d&&"string"!=typeof d&&(Lf("Loading with a manifest parser factory","Please register a manifest parser and for the mime-type."),e.wa=function(){return new d});d&&"string"==typeof d&&(e.mimeType=d);void 0!==c&&(e.startTime=c);var f=Bi(this,e)?this.kb:this.ea,g=Sh(this.Oa,function(b){if(null==b.s)return null;e.s=b.s;return{node:f,payload:e,Ta:!0}});g.tb=
function(){return A.info("Starting load of "+b+"...")};return new Promise(function(b,c){g.cc=function(){return c(new D(2,7,7002))};g.bc=function(){return b()};g.Wa=function(){return c(zi())};g.onError=function(b){return c(b)}})};Z.prototype.load=Z.prototype.load;
function Bi(b,c){if(c.wa)return!1;if(!cc())return!0;var d=c.mimeType,e=c.uri||"";d||(d={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"}[W.getExtension(e)]);return d?""==(c.s||ec()).canPlayType(d)?!1:W.isSupported(e,d)?gc()&&b.b.streaming.useNativeHlsOnSafari:!0:!1}
function li(b,c,d){null==c.s&&(c.s=d.s,b.g.B(c.s,"error",function(){var c=Ci(b);c&&b.La(c)}));b.a=c.s;return Promise.resolve()}
function mi(b,c){return t(function e(){var f;return y(e,function(e){switch(e.l){case 1:return b.i!=vi&&(b.i=ii),f=b.lc.map(function(b){return b()}),b.lc=[],v(e,Promise.all(f),2);case 2:b.dispatchEvent(new H("unloading"));c.wa=null;c.mimeType=null;c.startTime=null;c.uri=null;c.s&&(b.g.ja(c.s,"loadedmetadata"),b.g.ja(c.s,"playing"),b.g.ja(c.s,"pause"),b.g.ja(c.s,"ended"),b.g.ja(c.s,"ratechange"));b.jb&&(b.jb.release(),b.jb=null);b.Kb&&(b.Kb.stop(),b.Kb=null);if(!b.u){e.l=3;break}return v(e,b.u.stop(),
4);case 4:b.u=null;case 3:if(!b.m){e.l=5;break}return v(e,b.m.stop(),5);case 5:if(!b.f){e.l=7;break}return v(e,b.f.destroy(),8);case 8:b.f=null;case 7:b.M&&(b.M.release(),b.M=null);b.o&&(b.o.release(),b.o=null);if(!b.K){e.l=9;break}return v(e,b.K.destroy(),10);case 10:b.K=null;case 9:if(!c.s||!c.s.src){e.l=11;break}return v(e,new Promise(function(b){return(new B(b)).U(.1)}),12);case 12:c.s.removeAttribute("src"),c.s.load();case 11:if(!b.h){e.l=13;break}return v(e,b.h.destroy(),14);case 14:b.h=null;
case 13:b.ka.a.clear(),b.eb=null,b.C=null,b.Lb.clear(),b.c=null,b.w=null,b.mc=null,b.lb=!0,Di(b),w(e)}})})}function ni(b,c){return t(function e(){var f,g,h,k;return y(e,function(e){switch(e.l){case 1:return f=window.muxjs?new Zc:new $c,g=b.b.textDisplayFactory,h=new g,b.mc=g,k=new Id(c.s,f,h),v(e,k.u,2);case 2:b.K=k,w(e)}})})}
function oi(b,c,d){return t(function f(){var g,h,k,m;return y(f,function(f){switch(f.l){case 1:c.wa=d.wa;c.mimeType=d.mimeType;c.uri=d.uri;g=c.uri;h=b.Z;b.eb=g;if(c.wa){b.u=c.wa();f.l=2;break}k=b;return v(f,W.create(g,h,b.b.manifest.retryParameters,c.mimeType),3);case 3:k.u=f.R;case 2:m=ub(b.b.manifest),d.s&&"AUDIO"===d.s.nodeName&&(m.disableVideo=!0),b.u.configure(m),w(f)}})})}
function pi(b,c){var d=c.uri,e=b.Z;b.Nb=new Rg(function(){return b.Cd()});Sg(b.Nb,function(c){Ei(b,"timelineregionadded",c)});var f={networkingEngine:e,filterNewPeriod:function(c){return b.tc(c)},filterAllPeriods:function(c){return Fi(b,c)},onTimelineRegionAdded:function(c){var d=b.Nb;a:{var e=q(d.a);for(var f=e.next();!f.done;f=e.next())if(f=f.value,f.schemeIdUri==c.schemeIdUri&&f.id==c.id&&f.startTime==c.startTime&&f.endTime==c.endTime){e=f;break a}e=null}null==e&&(d.a.add(c),d.b(c))},onEvent:function(c){return b.dispatchEvent(c)},
onError:function(c){return b.La(c)}};return new F(Promise.resolve().then(function(){return t(function h(){var c;return y(h,function(e){switch(e.l){case 1:return c=b,v(e,b.u.start(d,f),2);case 2:c.c=e.R;b.dispatchEvent(new H("manifestparsed"));if(0==b.c.periods.length)throw new D(2,4,4014);Gi(b.c.periods);w(e)}})})}),function(){A.info("Aborting parser step...");return b.u.stop()})}
function qi(b){return t(function d(){return y(d,function(d){switch(d.l){case 1:return b.h=Hi(b,{Zb:b.Z,onError:function(d){b.La(d)},sd:function(d){Ii(b,d)},onExpirationUpdated:function(d,e){Ji(b,d,e)},onEvent:function(d){b.dispatchEvent(d)}}),b.h.configure(b.b.drm),v(d,vc(b.h,vg(b.c.periods),b.c.offlineSessionIds),2);case 2:Fi(b,b.c.periods),w(d)}})})}
function ri(b,c,d){return t(function f(){var g,h,k,m,n,p,r,u,x,G;return y(f,function(f){switch(f.l){case 1:return c.startTime=d.startTime,g=c.s,h=c.uri,b.eb=h,b.M=new zg({Ub:function(){return c.s.playbackRate},Vc:function(b){c.s.playbackRate=b},od:function(b){c.s.currentTime+=b}}),b.w=new hi,k=function(){return Ki(b)},m=function(){return Li(b)},b.g.B(g,"playing",k),b.g.B(g,"pause",k),b.g.B(g,"ended",k),b.g.B(g,"ratechange",m),n=b.b.abrFactory,b.m&&b.kc==n||(b.kc=n,b.m=new n,b.m.configure(b.b.abr)),
Mi(b,b.c.periods),b.zb=new Yf(b.b.preferredAudioLanguage,b.b.preferredVariantRole,b.b.preferredAudioChannelCount),b.la=b.b.preferredTextLanguage,Ni(b.c.presentationTimeline,b.b.playRangeStart,b.b.playRangeEnd),v(f,b.h.Ab(g),2);case 2:return b.m.init(function(c,d,f){d=void 0===d?!1:d;f=void 0===f?0:f;A.debug("switch_");a:{var g=q(b.c.periods);for(var h=g.next();!h.done;h=g.next())if(h=h.value,h.variants.includes(c)){g=h;break a}g=null}Oi(b,g,c,!0);b.f&&mh(b.f,c,d,f)&&Pi(b)}),b.o=Qi(b,c.startTime),
b.jb=Ri(b),p=Math.max(b.c.minBufferTime,b.b.streaming.rebufferingGoal),Si(b,p),b.f=Ti(b),b.f.configure(b.b.streaming),ce(b.c,b.b.preferredAudioChannelCount),b.i=Ui,b.dispatchEvent(new H("streaming")),v(f,b.f.start(),3);case 3:b.b.streaming.startAtSegmentBoundary&&(r=b.o.g(),u=Vi(b,r),b.o.o(u)),b.c.periods.forEach(b.tc.bind(b)),Wi(b),Pi(b),x=Xi(b)||b.c.periods[0],G=x.variants.some(function(b){return b.primary}),b.b.preferredAudioLanguage||G||A.j("No preferred audio language set.  We will choose an arbitrary language initially"),
Yi(b,x.variants),b.g.oa(g,"loadedmetadata",function(){b.w.b=Date.now()/1E3-d.Xc}),w(f)}})})}
function si(b,c){return t(function e(){var f,g;return y(e,function(e){switch(e.l){case 1:return f=gd,b.h=Hi(b,{Zb:b.Z,onError:function(c){b.La(c)},sd:function(c){Ii(b,c)},onExpirationUpdated:function(c,e){Ji(b,c,e)},onEvent:function(c){b.dispatchEvent(c)}}),b.h.configure(b.b.drm),g={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,
presentationTimeOffset:0,mimeType:"video/mp4",codecs:"",encrypted:!0,keyId:null,language:"und",label:null,type:f.ad,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},v(e,vc(b.h,[g],[]),2);case 2:return v(e,b.h.Ab(c.s),0)}})})}
function ti(b,c,d){function e(){return Ki(b)}c.uri=d.uri;c.startTime=d.startTime;b.eb=c.uri;b.w=new hi;b.o=new Kg(c.s);null!=c.startTime&&b.o.o(c.startTime);b.M=new zg({Ub:function(){return c.s.playbackRate},Vc:function(b){c.s.playbackRate=b},od:function(b){c.s.currentTime+=b}});Si(b,b.b.streaming.rebufferingGoal);b.g.B(c.s,"playing",e);b.g.B(c.s,"pause",e);b.g.B(c.s,"ended",e);b.g.B(c.s,"ratechange",function(){return Li(b)});"none"!=b.a.preload&&b.g.oa(c.s,"loadedmetadata",function(){b.w.b=Date.now()/
1E3-d.Xc});b.a.audioTracks&&(b.g.B(b.a.audioTracks,"addtrack",function(){return Wi(b)}),b.g.B(b.a.audioTracks,"removetrack",function(){return Wi(b)}),b.g.B(b.a.audioTracks,"change",function(){return Wi(b)}));if(b.a.textTracks){var f=b.a.textTracks;b.g.B(f,"addtrack",function(){return Wi(b)});b.g.B(f,"removetrack",function(){return Wi(b)});b.g.B(f,"change",function(){return Wi(b)})}c.s.src=c.uri;(hc("Tizen")||hc("Web0S"))&&c.s.load();b.i=Zi;b.dispatchEvent(new H("streaming"));var g=new E;Bg(b.a,HTMLMediaElement.HAVE_METADATA,
b.g,function(){g.resolve()});var h=!1;b.lc.push(function(){h=!0});Bg(b.a,HTMLMediaElement.HAVE_CURRENT_DATA,b.g,function(){return t(function m(){var c;return y(m,function(d){switch(d.l){case 1:if(h)return d["return"]();$i(b);c=aj(b);if(c.find(function(b){return"disabled"!=b.mode})){d.l=2;break}return v(d,new Promise(function(c){b.g.oa(b.a.textTracks,"change",c);(new B(c)).U(1)}),2);case 2:if(h)return d["return"]();bj(b);w(d)}})})});b.a.error?g.reject(Ci(b)):"none"==b.a.preload&&(A.qa('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),
g.resolve());b.g.oa(b.a,"error",function(){g.reject(Ci(b))});return new F(g,function(){g.reject(new D(2,7,7001));return Promise.resolve()})}function $i(b){var c=b.b.preferredAudioLanguage;if(""!=c){b.Sc(c);var d=b.b.preferredVariantRole;""!=d&&b.Sc(c,d)}}function bj(b){var c=b.b.preferredTextLanguage;if(""!=c){b.Tc(c);var d=b.b.preferredTextRole;""!=d&&b.Tc(c,d)}}
function Gi(b){function c(b){return b.video&&b.audio||b.video&&b.video.codecs.includes(",")}b.some(function(b){return b.variants.some(c)})&&(A.debug("Found variant with audio and video content, so filtering out audio-only content in all periods."),b.forEach(function(b){b.variants=b.variants.filter(c)}))}function Hi(b,c){return new qc(c,b.b.drm.updateExpirationTime)}function ki(b){return new I(function(c,d){b.m&&b.m.segmentDownloaded(c,d)})}
function Qi(b,c){return new Lg(b.a,b.c,b.b.streaming,c,function(){b.jb&&ug(b.jb,!0);b.f&&sh(b.f);b.C&&cj(b)},function(c){return b.dispatchEvent(c)})}function Ri(b){var c=new xg(b.c);yg(c,function(){Wi(b)});var d=new Tg(b.Nb);Xg(d,function(c){Ei(b,"timelineregionenter",c)},function(c){Ei(b,"timelineregionexit",c)},function(c,d){d||(Ei(b,"timelineregionenter",c),Ei(b,"timelineregionexit",c))});var e=new tg(b.a);e.a.add(c);e.a.add(d);return e}
function Si(b,c){b.C=new bg;b.C.a=dg;eg(b.C,c,Math.min(.5,c/2));Di(b);b.Kb=(new B(function(){cj(b)})).Ba(.25)}function cj(b){switch(b.i){case Zi:var c=b.a.ended?!0:ad(b.a.buffered)>=b.a.duration-1;break;case Ui:a:if(b.a.ended||Md(b.K))c=!0;else{if(b.c.presentationTimeline.da()){var d=b.c.presentationTimeline.ob();if(ad(b.a.buffered)>=d){c=!0;break a}}c=!1}break;default:c=!1}var e=cd(b.a.buffered,b.a.currentTime);d=b.C;var f=c,g=d.b.get(d.a);c=d.a;e=f||e>=g?cg:dg;d.a=e;c!=e&&Di(b)}
function Ti(b){return new Yg(b.c,{Sa:function(){return b.o.g()},getBandwidthEstimate:function(){return b.m.getBandwidthEstimate()},I:b.K,Zb:b.Z,rd:b.we.bind(b),qd:b.Od.bind(b),onError:b.La.bind(b),onEvent:function(c){return b.dispatchEvent(c)},ze:b.Ae.bind(b),Kc:b.Ee.bind(b)})}Z.prototype.configure=function(b,c){2==arguments.length&&"string"==typeof b&&(b=Yh(b,c));var d=bi(this.b,b,ji(this));dj(this);return d};Z.prototype.configure=Z.prototype.configure;
function dj(b){if(b.u){var c=ub(b.b.manifest);b.a&&"AUDIO"===b.a.nodeName&&(c.disableVideo=!0);b.u.configure(c)}b.h&&b.h.configure(b.b.drm);if(b.f){b.f.configure(b.b.streaming);try{b.c.periods.forEach(b.tc.bind(b))}catch(g){b.La(g)}var d=ch(b.f),e=eh(b.f);c=Xi(b);d=se(d,e,c.variants);b.m&&d&&d.allowedByApplication&&d.allowedByKeySystem?Yi(b,c.variants):(A.debug("Choosing new streams after changing configuration"),ej(b,c))}if(b.K&&(c=b.b.textDisplayFactory,b.mc!=c)){d=new c;e=b.K;var f=e.g;e.g=d;f&&
(d.setTextVisibility(f.isTextVisible()),f.destroy());e.a&&(e.a.c=d);b.mc=c;b.f&&(c=b.f,(d=c.b.get("text"))&&lh(c,d.stream,!0,0,!0))}b.m&&(b.m.configure(b.b.abr),b.b.abr.enabled&&!b.lb?b.m.enable():b.m.disable(),fj(b));b.C&&(c=b.b.streaming.rebufferingGoal,b.c&&(c=Math.max(c,b.c.minBufferTime)),eg(b.C,c,Math.min(.5,c/2)))}Z.prototype.getConfiguration=function(){var b=ji(this);bi(b,this.b,ji(this));return b};Z.prototype.getConfiguration=Z.prototype.getConfiguration;
Z.prototype.Ve=function(){for(var b in this.b)delete this.b[b];bi(this.b,ji(this),ji(this));dj(this)};Z.prototype.resetConfiguration=Z.prototype.Ve;Z.prototype.de=function(){return this.i};Z.prototype.getLoadMode=Z.prototype.de;Z.prototype.ie=function(){return this.a};Z.prototype.getMediaElement=Z.prototype.ie;Z.prototype.ke=function(){return this.Z};Z.prototype.getNetworkingEngine=Z.prototype.ke;Z.prototype.Xd=function(){return this.eb};Z.prototype.getAssetUri=Z.prototype.Xd;
Z.prototype.ge=function(){Lf("getManifestUri",'Please use "getAssetUri" instead.');return this.eb};Z.prototype.getManifestUri=Z.prototype.ge;Z.prototype.da=function(){return this.c?this.c.presentationTimeline.da():this.a&&this.a.src?Infinity==this.a.duration:!1};Z.prototype.isLive=Z.prototype.da;Z.prototype.rb=function(){return this.c?this.c.presentationTimeline.rb():!1};Z.prototype.isInProgress=Z.prototype.rb;
Z.prototype.te=function(){if(this.c){if(!this.c.periods.length)return!1;var b=this.c.periods[0].variants;return b.length?!b[0].video:!1}return this.a&&this.a.src?this.a.videoTracks?0==this.a.videoTracks.length:0==this.a.videoHeight:!1};Z.prototype.isAudioOnly=Z.prototype.te;Z.prototype.Cd=function(){if(this.c){var b=this.c.presentationTimeline;return{start:b.nb(),end:b.xa()}}return this.a&&this.a.src&&(b=this.a.seekable,b.length)?{start:b.start(0),end:b.end(b.length-1)}:{start:0,end:0}};
Z.prototype.seekRange=Z.prototype.Cd;Z.prototype.keySystem=function(){return Lc(this.drmInfo())};Z.prototype.keySystem=Z.prototype.keySystem;Z.prototype.drmInfo=function(){return this.h?this.h.a:null};Z.prototype.drmInfo=Z.prototype.drmInfo;Z.prototype.yc=function(){return this.h?this.h.yc():Infinity};Z.prototype.getExpiration=Z.prototype.yc;Z.prototype.nd=function(){return this.C?this.C.a==dg:!1};Z.prototype.isBuffering=Z.prototype.nd;
Z.prototype.me=function(){if(this.M){var b=this.M;b=b.f?0:b.c}else b=0;return b};Z.prototype.getPlaybackRate=Z.prototype.me;Z.prototype.jf=function(b){0==b?A.qa("A trick play rate of 0 is unsupported!"):(this.a.paused&&this.a.play(),this.M&&this.M.set(b),this.i==Ui&&kh(this.f,1<Math.abs(b)))};Z.prototype.trickPlay=Z.prototype.jf;Z.prototype.Pd=function(){this.i==Zi&&this.M.set(1);this.i==Ui&&(this.M.set(1),kh(this.f,!1))};Z.prototype.cancelTrickPlay=Z.prototype.Pd;
Z.prototype.Bc=function(){if(this.c&&this.o){for(var b=gj(this),c=[],d=q(hj(this)),e=d.next();!e.done;e=d.next()){e=e.value;var f=je(e);f.active=e==b;c.push(f)}return c}return this.a&&this.a.audioTracks?Array.from(this.a.audioTracks).map(function(b){return ne(b)}):[]};Z.prototype.getVariantTracks=Z.prototype.Bc;
Z.prototype.pb=function(){if(this.c&&this.o){for(var b=ij(this),c=[],d=q(jj(this)),e=d.next();!e.done;e=d.next()){e=e.value;var f=ke(e);f.active=e==b;c.push(f)}return c}return this.a&&this.a.src&&this.a.textTracks?aj(this).map(function(b){var c=oe(b);c.active="disabled"!=b.mode;c.type="text";c.originalTextId=b.id;"captions"==b.kind&&(c.mimeType="application/cea-608");b.kind&&(c.roles=[b.kind]);return c}):[]};Z.prototype.getTextTracks=Z.prototype.pb;
Z.prototype.Uc=function(b){if(this.c&&this.f){var c=Xi(this),d=c.textStreams.find(function(c){return c.id==b.id});d?(kj(this,c,d,!1),lj(this,d),this.la=d.language):A.error("No stream with id",b.id)}else if(this.a&&this.a.src&&this.a.textTracks){c=aj(this);c=q(c);for(d=c.next();!d.done;d=c.next())d=d.value,le(d)==b.id?d.mode=this.hb?"showing":"hidden":d.mode="disabled";mj(this)}};Z.prototype.selectTextTrack=Z.prototype.Uc;
Z.prototype.Ye=function(){Lf("selectEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack.");var b=this.pb().filter(function(b){return"application/cea-608"==b.mimeType});0<b.length?this.Uc(b[0]):A.j("Unable to find the text track embedded in the video.")};Z.prototype.selectEmbeddedTextTrack=Z.prototype.Ye;
Z.prototype.qf=function(){Lf("usingEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text.");var b=this.pb().filter(function(b){return b.active})[0];return b?"application/cea-608"==b.mimeType:!1};Z.prototype.usingEmbeddedTextTrack=Z.prototype.qf;
Z.prototype.Ze=function(b,c,d){d=void 0===d?0:d;if(this.c&&this.f){var e=Xi(this);this.b.abr.enabled&&A.qa("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var f=e.variants.find(function(c){return c.id==b.id});f?pe(f)?(Oi(this,e,f,!1),nj(this,f,c,d),this.zb=new Xf(f),Yi(this,e.variants)):A.error("Unable to switch to restricted track",b.id):A.error("No variant with id",b.id)}else if(this.a&&
this.a.audioTracks){c=Array.from(this.a.audioTracks);c=q(c);for(d=c.next();!d.done;d=c.next())d=d.value,le(d)==b.id&&(d.enabled=!0);oj(this)}};Z.prototype.selectVariantTrack=Z.prototype.Ze;Z.prototype.Zd=function(){return pj(this.Bc())};Z.prototype.getAudioLanguagesAndRoles=Z.prototype.Zd;Z.prototype.re=function(){return pj(this.pb())};Z.prototype.getTextLanguagesAndRoles=Z.prototype.re;Z.prototype.Yd=function(){return Array.from(qj(this.Bc()))};Z.prototype.getAudioLanguages=Z.prototype.Yd;
Z.prototype.qe=function(){return Array.from(qj(this.pb()))};Z.prototype.getTextLanguages=Z.prototype.qe;Z.prototype.Sc=function(b,c){if(this.c&&this.o){var d=Xi(this);this.zb=new Yf(b,c||"",0,"","audio");rj(this,d)}else if(this.a&&this.a.audioTracks){var e=Array.from(this.a.audioTracks);d=O(b);e=q(e);for(var f=e.next();!f.done;f=e.next()){f=f.value;var g=ne(f);O(g.language)!=d||c&&!g.roles.includes(c)||(f.enabled=!0)}oj(this)}};Z.prototype.selectAudioLanguage=Z.prototype.Sc;
Z.prototype.Tc=function(b,c){if(this.c&&this.o){var d=Xi(this);this.la=b;this.fb=c||"";var e=qe(d.textStreams,this.la,this.fb)[0]||null;e&&(kj(this,d,e,!1),(this.b.streaming.alwaysStreamText||this.Xb())&&lj(this,e))}else{var f=O(b);(d=this.pb().filter(function(b){return O(b.language)==f&&(!c||b.roles.includes(c))})[0])&&this.Uc(d)}};Z.prototype.selectTextLanguage=Z.prototype.Tc;
Z.prototype.$e=function(b){if(this.c&&this.o){for(var c=Xi(this),d=null,e=q(hj(this)),f=e.next();!f.done;f=e.next())if(f=f.value,f.audio.label==b){d=f;break}null==d?A.j("No variants were found with label: "+b+". Ignoring the request to switch."):(this.zb=new Yf(d.language,"",0,b),rj(this,c))}};Z.prototype.selectVariantsByLabel=Z.prototype.$e;
Z.prototype.Xb=function(){var b=this.hb;return this.K?this.K.g.isTextVisible():this.a&&this.a.src&&this.a.textTracks?aj(this).some(function(b){return"showing"==b.mode}):b};Z.prototype.isTextTrackVisible=Z.prototype.Xb;function aj(b){return Array.from(b.a.textTracks).filter(function(b){return"metadata"!=b.kind&&"Shaka Player TextTrack"!=b.label})}
Z.prototype.df=function(b){var c=this;return t(function e(){var f,g,h,k,m,n;return y(e,function(e){switch(e.l){case 1:f=c.hb;g=!!b;if(f==g)return e["return"]();c.hb=g;if(c.i!=Ui){if(c.a&&c.a.src&&c.a.textTracks){h=aj(c);for(var p=q(h),u=p.next();!u.done;u=p.next())k=u.value,"disabled"!=k.mode&&(k.mode=g?"showing":"hidden")}e.l=2;break}c.K.g.setTextVisibility(g);if(c.b.streaming.alwaysStreamText){e.l=2;break}if(!g){jh(c.f);e.l=2;break}if(dh(c.f,"text")){e.l=2;break}m=Xi(c);n=qe(m.textStreams,c.la,
c.fb);if(!(0<n.length)){e.l=2;break}return v(e,fh(c.f,n[0]),2);case 2:sj(c),w(e)}})})};Z.prototype.setTextTrackVisibility=Z.prototype.df;
Z.prototype.ne=function(){if(!this.da())return A.j("getPlayheadTimeAsDate is for live streams!"),null;var b=this.Oa.f,c=0;if(this.o)c=this.o.g();else if(b){if(null==b.startTime)return new Date;c=b.startTime}if(this.c)return new Date(1E3*(this.c.presentationTimeline.f+this.a.currentTime));if(this.a&&this.a.getStartDate)return b=this.a.getStartDate(),isNaN(b.getTime())?(A.j("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(b.getTime()+1E3*c);A.j("No way to get playhead time as Date!");
return null};Z.prototype.getPlayheadTimeAsDate=Z.prototype.ne;Z.prototype.pe=function(){if(!this.da())return A.j("getPresentationStartTimeAsDate is for live streams!"),null;if(this.c)return new Date(1E3*this.c.presentationTimeline.f);if(this.a&&this.a.getStartDate){var b=this.a.getStartDate();return isNaN(b.getTime())?(A.j("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):b}A.j("No way to get presentation start time as Date!");return null};
Z.prototype.getPresentationStartTimeAsDate=Z.prototype.pe;Z.prototype.wc=function(){var b={total:[],audio:[],video:[],text:[]};this.i==Zi&&(b.total=dd(this.a.buffered));this.i==Ui&&this.K.wc(b);return b};Z.prototype.getBufferedInfo=Z.prototype.wc;
Z.prototype.getStats=function(){if(this.i!=Ui&&this.i!=Zi)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,switchHistory:[],stateHistory:[]};Ki(this);var b=this.a;if(b.getVideoPlaybackQuality){b=b.getVideoPlaybackQuality();var c=this.w,d=Number(b.totalVideoFrames);c.o=Number(b.droppedVideoFrames);c.m=d;this.w.i=Number(b.corruptedVideoFrames)}this.h?
(b=this.h,b=b.M?b.M:NaN):b=NaN;this.w.h=b;if(this.i==Ui){if(b=gj(this))this.w.u=b.bandwidth;b&&b.video&&(c=this.w,d=b.video.height||NaN,c.w=b.video.width||NaN,c.g=d);b=this.m.getBandwidthEstimate();this.w.f=b}var e=this.w;b=e.w;c=e.g;d=e.u;var f=e.m,g=e.o,h=e.i,k=e.f,m=e.b,n=ei(e.a,"playing"),p=ei(e.a,"paused"),r=ei(e.a,"buffering"),u=e.h,x=fi(e.a),G=[];e=q(e.c.a);for(var C=e.next();!C.done;C=e.next())C=C.value,G.push({timestamp:C.timestamp,id:C.id,type:C.type,fromAdaptation:C.fromAdaptation,bandwidth:C.bandwidth});
return{width:b,height:c,streamBandwidth:d,decodedFrames:f,droppedFrames:g,corruptedFrames:h,estimatedBandwidth:k,loadLatency:m,playTime:n,pauseTime:p,bufferingTime:r,licenseTime:u,stateHistory:x,switchHistory:G}};Z.prototype.getStats=Z.prototype.getStats;
Z.prototype.addTextTrack=function(b,c,d,e,f,g){var h=this;return t(function m(){var n,p,r,u,x,G,C,L,U;return y(m,function(m){switch(m.l){case 1:if(h.i==Zi)throw A.error("Cannot add text when loaded with src="),Error("State error!");if(h.i!=Ui)throw A.error("Must call load() and wait for it to resolve before adding text tracks."),Error("State error!");n=Xi(h);p=gd;r=h.c.periods.indexOf(n);u=r+1;x=u>=h.c.periods.length?h.c.presentationTimeline.ba():h.c.periods[u].startTime;G=x-n.startTime;if(Infinity==
G)throw new D(1,4,4033);C=new T(1,0,G,function(){return[b]},0,null);L={id:h.ld++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(b){return 1==b?C:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:e,codecs:f||"",kind:d,encrypted:!1,keyId:null,language:c,label:g||null,type:p.Pa,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,
audioSamplingRate:null,closedCaptions:null};h.Lb.add(L);n.textStreams.push(L);return v(m,fh(h.f,L),2);case 2:return(U=dh(h.f,"text"))&&Qf(h.ka,n,U),h.Lb["delete"](L),A.debug("Choosing new streams after adding a text stream"),ej(h,n),Wi(h),m["return"](ke(L))}})})};Z.prototype.addTextTrack=Z.prototype.addTextTrack;Z.prototype.cf=function(b,c){this.Mb.width=b;this.Mb.height=c};Z.prototype.setMaxHardwareResolution=Z.prototype.cf;
Z.prototype.Rc=function(){if(this.i==Ui){var b=this.f;if(b.f)A.error("Unable to retry after StreamingEngine is destroyed!"),b=!1;else if(b.o)A.error("Unable to retry after StreamingEngine encountered a fatal error!"),b=!1;else{for(var c=q(b.b.values()),d=c.next();!d.done;d=c.next()){d=d.value;var e=Y(d);d.Db&&(A.info(e,"Retrying after failure..."),d.Db=!1,ih(b,d,.1))}b=!0}}else b=!1;return b};Z.prototype.retryStreaming=Z.prototype.Rc;Z.prototype.ee=function(){return this.c};
Z.prototype.getManifest=Z.prototype.ee;Z.prototype.fe=function(){return this.u?this.u.constructor:null};Z.prototype.getManifestParserFactory=Z.prototype.fe;function Oi(b,c,d,e){Rf(b.ka,c).variant=d;b=b.w.c;b.c!=d&&(b.c=d,b.a.push({timestamp:Date.now()/1E3,id:d.id,type:"variant",fromAdaptation:e,bandwidth:d.bandwidth}))}function kj(b,c,d,e){Qf(b.ka,c,d);b=b.w.c;b.b!=d&&(b.b=d,b.a.push({timestamp:Date.now()/1E3,id:d.id,type:"text",fromAdaptation:e,bandwidth:null}))}
function ji(b){var c=$h();c.streaming.failureCallback=function(c){var d=[1001,1002,1003];b.da()&&d.includes(c.code)&&(c.severity=1,A.j("Live streaming error.  Retrying automatically..."),b.Rc())};c.textDisplayFactory=function(){return new Uh(b.a)};return c}
function Mi(b,c){for(var d=0;d<c.length;d++){for(var e=c[d],f=new Map,g=q(e.variants),h=g.next();!h.done;h=g.next())if(h=h.value,h.video&&h.video.closedCaptions){h=h.video;for(var k=q(h.closedCaptions.keys()),m=k.next();!m.done;m=k.next())if(m=m.value,!f.has(m)){var n={id:b.ld++,originalId:m,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"application/cea-608",
codecs:"",kind:"caption",encrypted:!1,keyId:null,language:h.closedCaptions.get(m),label:null,type:"text",primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:h.roles,channelsCount:null,audioSamplingRate:null,closedCaptions:null};f.set(m,n)}}f=q(f.values());for(g=f.next();!g.done;g=f.next())e.textStreams.push(g.value)}}
function Fi(b,c){var d=b.f?ch(b.f):null,e=b.f?eh(b.f):null;c.forEach(ge.bind(null,b.h,d,e));d=wb(c,function(b){return b.variants.some(pe)});if(0==d)throw new D(2,4,4032);if(d<c.length)throw new D(2,4,4011);c.forEach(function(b){fe(b.variants,this.b.restrictions,this.Mb)&&this.f&&Xi(this)==b&&Wi(this);tj(this,b.variants)}.bind(b))}l=Z.prototype;
l.tc=function(b){var c=this.f?ch(this.f):null,d=this.f?eh(this.f):null;ge(this.h,c,d,b);c=b.variants;if(!c.some(pe))throw new D(2,4,4011);tj(this,b.variants);fe(c,this.b.restrictions,this.Mb)&&this.f&&Xi(this)==b&&Wi(this);if(b=this.h?this.h.a:null)for(c=q(c),d=c.next();!d.done;d=c.next()){d=q(d.value.drmInfos);for(var e=d.next();!e.done;e=d.next())if(e=e.value,e.keySystem==b.keySystem){e=q(e.initData||[]);for(var f=e.next();!f.done;f=e.next())f=f.value,Fc(this.h,f.initDataType,f.initData)}}};
function nj(b,c,d,e){d=void 0===d?!1:d;e=void 0===e?0:e;if(b.lb)return b.na=c,b.jd=d,b.fd=e,!0;(c=mh(b.f,c,d,e))&&oj(b);return c}function lj(b,c){if(b.lb)return b.ma=c,!0;var d=lh(b.f,c,!0,0,!1);d&&mj(b);return d}function Vi(b,c){function d(b,c){if(!b)return null;var d=b.findSegmentPosition(c-g.startTime);return null==d?null:(d=b.getSegmentReference(d))?d.startTime+g.startTime:null}var e=ch(b.f),f=eh(b.f),g=Xi(b);e=d(e,c);f=d(f,c);return null!=f&&null!=e?Math.max(f,e):null!=f?f:null!=e?e:c}
function Di(b){var c=b.nd();if(b.w&&b.C&&b.o){var d=b.M;d.f=c;Ag(d);Ki(b)}b.dispatchEvent(new H("buffering",{buffering:c}))}function Li(b){var c=b.a.playbackRate;0!=c&&b.M.set(c)}function Ki(b){if(b.w&&b.C){var c=b.w.a;b.C.a==dg?di(c,"buffering"):b.a.paused?di(c,"paused"):b.a.ended?di(c,"ended"):di(c,"playing")}}function Yi(b,c){try{tj(b,c)}catch(e){return b.La(e),null}var d=c.filter(function(b){return pe(b)});d=b.zb.create(d);b.m.setVariants(Array.from(d.values()));return b.m.chooseVariant()}
function ej(b,c){var d=rj(b,c,!1),e=qe(c.textStreams,b.la,b.fb)[0]||null,f=!1;e&&(b.b.streaming.alwaysStreamText||b.Xb())&&(kj(b,c,e,!0),f=lj(b,e));(d||f)&&Pi(b)}function rj(b,c,d){d=void 0===d?!0:d;var e=Yi(b,c.variants),f=!1;e&&(Oi(b,c,e,!0),f=nj(b,e,!0));d&&f&&Pi(b);return f}
l.we=function(b){A.debug("onChooseStreams_",b);try{A.H("onChooseStreams_, choosing variant from ",b.variants);A.H("onChooseStreams_, choosing text from ",b.textStreams);this.lb=!0;this.m.disable();fj(this);A.debug("Choosing new streams after period changed");var c=Yi(this,b.variants),d=qe(b.textStreams,this.la,this.fb)[0]||null;this.na&&(b.variants.includes(this.na)&&(c=this.na),this.na=null);this.ma&&(b.textStreams.includes(this.ma)&&(d=this.ma),this.ma=null);c&&Oi(this,b,c,!0);d&&kj(this,b,d,!0);
var e=this.f,f=e.b.get("video");if(f)var g=e.c.periods[f.ga];else{var h=e.b.get("audio");g=h?e.c.periods[h.ga]:null}var k=c?c.audio:null;if(!g&&d){var m;if(m=k){b=d;var n=O(this.b.preferredTextLanguage),p=O(k.language),r=O(b.language);m=Yd(r,n)&&!Yd(p,r)}m&&(this.hb=!0);this.hb&&this.K.g.setTextVisibility(!0);sj(this)}var u=this.b.streaming.alwaysStreamText||this.Xb()?{variant:c,text:d}:{variant:c,text:null};A.H("onChooseStreams_, chose variant ",u.variant);A.H("onChooseStreams_, chose text ",u.text);
return u}catch(x){return this.La(x),{variant:null,text:null}}};l.Od=function(){A.debug("canSwitch_");this.lb=!1;this.b.abr.enabled&&(this.m.enable(),fj(this));this.na&&(mh(this.f,this.na,this.jd,this.fd),oj(this),this.na=null);this.ma&&(lh(this.f,this.ma,!0,0,!1),mj(this),this.ma=null)};l.Ae=function(){this.u&&this.u.update&&this.u.update()};l.Ee=function(){this.o&&this.o.u()};function Pi(b){uj(b,new H("adaptation"))}function Wi(b){uj(b,new H("trackschanged"))}
function oj(b){uj(b,new H("variantchanged"))}function mj(b){uj(b,new H("textchanged"))}function sj(b){uj(b,new H("texttrackvisibility"))}function fj(b){uj(b,new H("abrstatuschanged",{xf:b.b.abr.enabled}))}l.La=function(b){if(this.i!=vi){var c=new H("error",{detail:b});this.dispatchEvent(c);c.defaultPrevented&&(b.handled=!0)}};function Ei(b,c,d){b.dispatchEvent(new H(c,{detail:{schemeIdUri:d.schemeIdUri,value:d.value,startTime:d.startTime,endTime:d.endTime,id:d.id,eventElement:d.eventElement}}))}
function Ci(b){if(!b.a.error)return null;var c=b.a.error.code;if(1==c)return null;var d=b.a.error.msExtendedCode;d&&(0>d&&(d+=Math.pow(2,32)),d=d.toString(16));return new D(2,3,3016,c,d,b.a.error.message)}
function Ii(b,c){if(b.f){var d=Xi(b),e=!1,f=Object.keys(c);0==f.length&&A.j("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var g=1==f.length&&"00"==f[0];g&&A.j("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");f.length&&b.c.periods.forEach(function(b){b.variants.forEach(function(b){te(b).forEach(function(d){var f=
b.allowedByKeySystem;d.keyId&&(d=c[g?"00":d.keyId],b.allowedByKeySystem=!!d&&!xi.includes(d));f!=b.allowedByKeySystem&&(e=!0)})})});f=ch(b.f);var h=eh(b.f);(f=se(f,h,d.variants))&&!f.allowedByKeySystem&&(A.debug("Choosing new variants after key status changed"),rj(b,d));e&&(Wi(b),Yi(b,d.variants))}}function Ji(b,c,d){if(b.u&&b.u.onExpirationUpdated)b.u.onExpirationUpdated(c,d);b.dispatchEvent(new H("expirationupdated"))}
function Ni(b,c,d){0<c&&(b.da()?A.j("|playRangeStart| has been configured for live content. Ignoring the setting."):b.Gd(c));d<b.ba()&&(b.da()?A.j("|playRangeEnd| has been configured for live content. Ignoring the setting."):b.Za(d))}
function tj(b,c){var d=b.h?Yb(b.h.ea):{},e=Object.keys(d);e=e.length&&"00"==e[0];for(var f=!1,g=!1,h=[],k=[],m=q(c),n=m.next();!n.done;n=m.next()){n=n.value;var p=[];n.audio&&p.push(n.audio);n.video&&p.push(n.video);p=q(p);for(var r=p.next();!r.done;r=p.next())if(r=r.value,r.keyId){var u=d[e?"00":r.keyId];u?xi.includes(u)&&(k.includes(u)||k.push(u)):h.includes(r.keyId)||h.push(r.keyId)}n.allowedByApplication?n.allowedByKeySystem&&(f=!0):g=!0}if(!f)throw new D(2,4,4012,{hasAppRestrictions:g,missingKeys:h,
restrictedKeyStatuses:k});}function uj(b,c){t(function e(){return y(e,function(e){switch(e.l){case 1:return v(e,Promise.resolve(),2);case 2:b.i!=vi&&b.dispatchEvent(c),w(e)}})})}function qj(b){var c=new Set;b=q(b);for(var d=b.next();!d.done;d=b.next())d=d.value,d.language?c.add(O(d.language)):c.add("und");return c}
function pj(b){var c=new Map;b=q(b);for(var d=b.next();!d.done;d=b.next()){var e=d.value;d="und";var f=[];e.language&&(d=O(e.language));"variant"==e.type?f=e.audioRoles:f=e.roles;f&&f.length||(f=[""]);c.has(d)||c.set(d,new Set);e=q(f);for(f=e.next();!f.done;f=e.next())f=f.value,c.get(d).add(f)}var g=[];c.forEach(function(b,c){for(var d=q(b),e=d.next();!e.done;e=d.next())g.push({language:c,role:e.value})});return g}
function hj(b){b=Xi(b);return null==b?[]:b.variants.filter(function(b){return pe(b)})}function jj(b){var c=Xi(b);return null==c?[]:c.textStreams.filter(function(c){return!b.Lb.has(c)})}function Xi(b){var c=b.o.g(),d=null;b=q(b.c.periods);for(var e=b.next();!e.done;e=b.next())e=e.value,e.startTime<=c&&(d=e);return d}function gj(b){var c=Xi(b);return Rf(b.ka,c).variant}
function ij(b){var c=Xi(b);if(null==c)return null;if(!Rf(b.ka,c).text){var d=qe(c.textStreams,b.la,b.fb);d.length&&Qf(b.ka,c,d[0])}return Rf(b.ka,c).text}function zi(){return new D(2,7,7E3)}function ui(b,c,d,e,f,g){return e==b&&f.s==g.s&&f.uri==g.uri&&f.mimeType==g.mimeType&&f.wa==g.wa?c:d}function Ph(){return{wa:null,s:null,mimeType:null,startTime:null,Xc:null,uri:null}}
function Ai(b){return new Promise(function(c,d){b.Wa=function(){return d(zi())};b.bc=function(){return c()};b.onError=function(b){return d(b)};b.cc=function(){return d(zi())}})}var vi=0,ii=1,Ui=2,Zi=3;Z.LoadMode={DESTROYED:vi,NOT_LOADED:ii,MEDIA_SOURCE:Ui,SRC_EQUALS:Zi};z("shaka.polyfill.installAll",function(){for(var b=0;b<vj.length;++b)try{vj[b].Nd()}catch(c){A.qa("Error installing polyfill!",c)}});var vj=[];function wj(b,c){c=c||0;for(var d={priority:c,Nd:b},e=0;e<vj.length;e++)if(vj[e].priority<c){vj.splice(e,0,d);return}vj.push(d)}z("shaka.polyfill.register",wj);wj(function(){xj()},-1);function yj(b,c,d){if("input"==b)switch(this.type){case "range":b="change"}HTMLInputElement.prototype.originalAddEventListener.call(this,b,c,d)}wj(function(){A.debug("InputEvent.install");hc("Trident/")&&!HTMLInputElement.prototype.originalAddEventListener&&(A.info("Patching input event support on IE."),HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=yj)});wj(function(){navigator.languages||Object.defineProperty(navigator,"languages",{get:function(){return navigator.language?[navigator.language]:["en"]}})});wj(function(){A.debug("mathRound.install")});function zj(){var b=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(c){for(var d=[],e=0;e<arguments.length;++e)d[e]=arguments[e];d=b.apply(this,d);d.abort=function(){};return d}}function Aj(){var b=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(c,d){return b.call(this,c,d-.001)}}function Dj(){var b=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(c){return"mp2t"==c.split(/ *; */)[0].split("/")[1].toLowerCase()?!1:b(c)}}
function Ej(){var b=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(c){return"opus"!=bc(c)[0]&&b(c)}}function Fj(){var b=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(c){var d=c.split(/ *; */);d.shift();return d.some(function(b){return b.startsWith("codecs=")})?cast.__platform__.canDisplayType(c):b(c)}}
wj(function(){A.debug("MediaSource.install");var b=ic();window.MediaSource?window.cast&&cast.__platform__&&cast.__platform__.canDisplayType?(A.info("Patching Chromecast MSE bugs."),Fj()):b?(Dj(),12>=b?(A.info("Patching Safari 11 & 12 MSE bugs."),zj(),Aj()):(A.info("Patching Safari 13 MSE bugs."),zj())):hc("Tizen 2")||hc("Tizen 3")||hc("Tizen 4")?Ej():A.info("Using native MSE as-is."):A.info("No MSE implementation available.")});function Gj(b,c){A.debug("PatchedMediaKeysMs.requestMediaKeySystemAccess");try{var d=new Hj(b,c);return Promise.resolve(d)}catch(e){return Promise.reject(e)}}
function Hj(b,c){A.debug("PatchedMediaKeysMs.MediaKeySystemAccess");this.keySystem=b;for(var d=!1,e=0;e<c.length;++e){var f=c[e],g={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:f.initDataTypes,sessionTypes:["temporary"],label:f.label},h=!1;if(f.audioCapabilities)for(var k=0;k<f.audioCapabilities.length;++k){var m=f.audioCapabilities[k];if(m.contentType){h=!0;var n=m.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,
n)&&(g.audioCapabilities.push(m),d=!0)}}if(f.videoCapabilities)for(k=0;k<f.videoCapabilities.length;++k)m=f.videoCapabilities[k],m.contentType&&(h=!0,n=m.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,n)&&(g.videoCapabilities.push(m),d=!0));h||(d=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));"required"==f.persistentState&&(d=!1);if(d){this.a=g;return}}d=Error("Unsupported keySystem");d.name="NotSupportedError";d.code=DOMException.NOT_SUPPORTED_ERR;throw d;}
Hj.prototype.createMediaKeys=function(){A.debug("PatchedMediaKeysMs.MediaKeySystemAccess.createMediaKeys");var b=new Ij(this.keySystem);return Promise.resolve(b)};Hj.prototype.getConfiguration=function(){A.debug("PatchedMediaKeysMs.MediaKeySystemAccess.getConfiguration");return this.a};function Jj(b){A.debug("PatchedMediaKeysMs.setMediaKeys");var c=this.mediaKeys;c&&c!=b&&Kj(c,null);delete this.mediaKeys;return(this.mediaKeys=b)?Kj(b,this):Promise.resolve()}
function Ij(b){A.debug("PatchedMediaKeysMs.MediaKeys");this.b=new MSMediaKeys(b);this.a=new J}Ij.prototype.createSession=function(b){A.debug("PatchedMediaKeysMs.MediaKeys.createSession");b=b||"temporary";if("temporary"!=b)throw new TypeError("Session type "+b+" is unsupported on this platform.");return new Lj(this.b,b)};Ij.prototype.setServerCertificate=function(){A.debug("PatchedMediaKeysMs.MediaKeys.setServerCertificate");return Promise.resolve(!1)};
function Kj(b,c){b.a.Hb();if(!c)return Promise.resolve();b.a.B(c,"msneedkey",Mj);try{return Bg(c,HTMLMediaElement.HAVE_METADATA,b.a,function(){c.msSetMediaKeys(b.b)}),Promise.resolve()}catch(d){return Promise.reject(d)}}function Lj(b){A.debug("PatchedMediaKeysMs.MediaKeySession");tb.call(this);this.c=null;this.g=b;this.b=this.a=null;this.f=new J;this.sessionId="";this.expiration=NaN;this.closed=new E;this.keyStatuses=new Nj}La(Lj,tb);l=Lj.prototype;
l.generateRequest=function(b,c){A.debug("PatchedMediaKeysMs.MediaKeySession.generateRequest");this.a=new E;try{this.c=this.g.createSession("video/mp4",new Uint8Array(c),null),this.f.B(this.c,"mskeymessage",this.De.bind(this)),this.f.B(this.c,"mskeyadded",this.Be.bind(this)),this.f.B(this.c,"mskeyerror",this.Ce.bind(this)),Oj(this,"status-pending")}catch(d){this.a.reject(d)}return this.a};l.load=function(){A.debug("PatchedMediaKeysMs.MediaKeySession.load");return Promise.reject(Error("MediaKeySession.load not yet supported"))};
l.update=function(b){A.debug("PatchedMediaKeysMs.MediaKeySession.update");this.b=new E;try{this.c.update(new Uint8Array(b))}catch(c){this.b.reject(c)}return this.b};l.close=function(){A.debug("PatchedMediaKeysMs.MediaKeySession.close");try{this.c.close(),this.closed.resolve(),this.f.Hb()}catch(b){this.closed.reject(b)}return this.closed};l.remove=function(){A.debug("PatchedMediaKeysMs.MediaKeySession.remove");return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};
function Mj(b){A.debug("PatchedMediaKeysMs.onMsNeedKey_",b);if(b.initData){var c=document.createEvent("CustomEvent");c.initCustomEvent("encrypted",!1,!1,null);c.initDataType="cenc";c.initData=De(b.initData).buffer;this.dispatchEvent(c)}}l.De=function(b){A.debug("PatchedMediaKeysMs.onMsKeyMessage_",b);this.a&&(this.a.resolve(),this.a=null);this.dispatchEvent(new H("message",{messageType:void 0==this.keyStatuses.a?"license-request":"license-renewal",message:b.message.buffer}))};
l.Be=function(b){A.debug("PatchedMediaKeysMs.onMsKeyAdded_",b);this.a?(A.debug("Simulating completion for a PR persistent license."),Oj(this,"usable"),this.a.resolve(),this.a=null):this.b&&(Oj(this,"usable"),this.b.resolve(),this.b=null)};
l.Ce=function(b){A.debug("PatchedMediaKeysMs.onMsKeyError_",b);b=Error("EME PatchedMediaKeysMs key error");b.errorCode=this.c.error;if(null!=this.a)this.a.reject(b),this.a=null;else if(null!=this.b)this.b.reject(b),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:Oj(this,"output-not-allowed");break;default:Oj(this,"internal-error")}};
function Oj(b,c){var d=b.keyStatuses;d.size=void 0==c?0:1;d.a=c;b.dispatchEvent(new H("keystatuseschange"))}function Nj(){this.size=0;this.a=void 0}var Pj;l=Nj.prototype;l.forEach=function(b){this.a&&b(this.a,Pj)};l.get=function(b){if(this.has(b))return this.a};l.has=function(b){var c=Pj;return this.a&&K.Fa(new Uint8Array(b),new Uint8Array(c))?!0:!1};l.entries=function(){};l.keys=function(){};l.values=function(){};
wj(function(){!window.HTMLVideoElement||!window.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(A.info("Using ms-prefixed EME v20140218"),Pj=(new Uint8Array([0])).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Jj,window.MediaKeys=Ij,window.MediaKeySystemAccess=Hj,navigator.requestMediaKeySystemAccess=Gj)});function Qj(){A.debug("PatchedMediaKeysNop.requestMediaKeySystemAccess");return Promise.reject(Error("The key system specified is not supported."))}function Rj(b){A.debug("PatchedMediaKeysNop.setMediaKeys");return null==b?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function Sj(){throw new TypeError("Illegal constructor.");}Sj.prototype.createSession=function(){};Sj.prototype.setServerCertificate=function(){};function Tj(){throw new TypeError("Illegal constructor.");}
Tj.prototype.getConfiguration=function(){};Tj.prototype.createMediaKeys=function(){};wj(function(){!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(A.info("EME not available."),navigator.requestMediaKeySystemAccess=Qj,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Rj,window.MediaKeys=Sj,window.MediaKeySystemAccess=Tj)},-10);var Uj="";function Vj(b){var c=Uj;return c?c+b.charAt(0).toUpperCase()+b.slice(1):b}function Wj(b,c){A.debug("PatchedMediaKeysWebkit.requestMediaKeySystemAccess");try{var d=new Xj(b,c);return Promise.resolve(d)}catch(e){return Promise.reject(e)}}function Yj(b){A.debug("PatchedMediaKeysWebkit.setMediaKeys");var c=this.mediaKeys;c&&c!=b&&Zj(c,null);delete this.mediaKeys;(this.mediaKeys=b)&&Zj(b,this);return Promise.resolve()}
function Xj(b,c){A.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess");this.a=this.keySystem=b;var d=!1;"org.w3.clearkey"==b&&(this.a="webkit-org.w3.clearkey",d=!1);var e=!1;var f=document.getElementsByTagName("video");f=f.length?f[0]:document.createElement("video");for(var g=0;g<c.length;++g){var h=c[g],k={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:h.initDataTypes,sessionTypes:["temporary"],label:h.label},m=!1;if(h.audioCapabilities)for(var n=
0;n<h.audioCapabilities.length;++n){var p=h.audioCapabilities[n];if(p.contentType){m=!0;var r=p.contentType.split(";")[0];f.canPlayType(r,this.a)&&(k.audioCapabilities.push(p),e=!0)}}if(h.videoCapabilities)for(n=0;n<h.videoCapabilities.length;++n)p=h.videoCapabilities[n],p.contentType&&(m=!0,f.canPlayType(p.contentType,this.a)&&(k.videoCapabilities.push(p),e=!0));m||(e=f.canPlayType("video/mp4",this.a)||f.canPlayType("video/webm",this.a));"required"==h.persistentState&&(d?(k.persistentState="required",
k.sessionTypes=["persistent-license"]):e=!1);if(e){this.b=k;return}}d="Unsupported keySystem";if("org.w3.clearkey"==b||"com.widevine.alpha"==b)d="None of the requested configurations were supported.";d=Error(d);d.name="NotSupportedError";d.code=DOMException.NOT_SUPPORTED_ERR;throw d;}Xj.prototype.createMediaKeys=function(){A.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var b=new ak(this.a);return Promise.resolve(b)};
Xj.prototype.getConfiguration=function(){A.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration");return this.b};function ak(b){A.debug("PatchedMediaKeysWebkit.MediaKeys");this.g=b;this.b=null;this.a=new J;this.c=[];this.f={}}function Zj(b,c){b.b=c;b.a.Hb();var d=Uj;c&&(b.a.B(c,d+"needkey",b.Je.bind(b)),b.a.B(c,d+"keymessage",b.Ie.bind(b)),b.a.B(c,d+"keyadded",b.Ge.bind(b)),b.a.B(c,d+"keyerror",b.He.bind(b)))}l=ak.prototype;
l.createSession=function(b){A.debug("PatchedMediaKeysWebkit.MediaKeys.createSession");b=b||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+b+" is unsupported on this platform.");var c=this.b||document.createElement("video");c.src||(c.src="about:blank");b=new bk(c,this.g,b);this.c.push(b);return b};l.setServerCertificate=function(){A.debug("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate");return Promise.resolve(!1)};
l.Je=function(b){A.debug("PatchedMediaKeysWebkit.onWebkitNeedKey_",b);var c=document.createEvent("CustomEvent");c.initCustomEvent("encrypted",!1,!1,null);c.initDataType="cenc";b.initData instanceof ArrayBuffer?c.initData=b.initData:c.initData=b.initData.buffer;this.b.dispatchEvent(c)};
l.Ie=function(b){A.debug("PatchedMediaKeysWebkit.onWebkitKeyMessage_",b);var c=ck(this,b.sessionId);c?(b=new H("message",{messageType:void 0==c.keyStatuses.a?"licenserequest":"licenserenewal",message:b.message}),A.debug("PatchedMediaKeysWebkit.MediaKeySession.generated"),c.b&&(c.b.resolve(),c.b=null),c.dispatchEvent(b)):A.error("Session not found",b.sessionId)};
l.Ge=function(b){A.debug("PatchedMediaKeysWebkit.onWebkitKeyAdded_",b);if(b=ck(this,b.sessionId))A.debug("PatchedMediaKeysWebkit.MediaKeySession.ready"),dk(b,"usable"),b.a&&b.a.resolve(),b.a=null};l.He=function(b){A.debug("PatchedMediaKeysWebkit.onWebkitKeyError_",b);var c=ck(this,b.sessionId);c&&c.handleError(b)};
function ck(b,c){var d=b.f[c];return d?(A.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",d),d):(d=b.c.shift())?(d.sessionId=c,b.f[c]=d,A.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",d),d):null}function bk(b,c,d){A.debug("PatchedMediaKeysWebkit.MediaKeySession");tb.call(this);this.f=b;this.h=!1;this.a=this.b=null;this.c=c;this.g=d;this.sessionId="";this.expiration=NaN;this.closed=new E;this.keyStatuses=new ek}La(bk,tb);l=bk.prototype;
l.handleError=function(b){A.debug("PatchedMediaKeysWebkit.MediaKeySession.handleError",b);var c=Error("EME v0.1b key error"),d=b.errorCode;d.systemCode=b.systemCode;c.errorCode=d;!b.sessionId&&this.b?(45==b.systemCode&&(c.message="Unsupported session type."),this.b.reject(c),this.b=null):b.sessionId&&this.a?(this.a.reject(c),this.a=null):(c=b.systemCode,b.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?dk(this,"output-restricted"):1==c?dk(this,"expired"):dk(this,"internal-error"))};
function fk(b,c,d){if(b.h)return Promise.reject(Error("The session is already initialized."));b.h=!0;try{if("persistent-license"==b.g)if(d)var e=new Uint8Array(oc("LOAD_SESSION|"+d));else{var f=oc("PERSISTENT|"),g=new Uint8Array(f.byteLength+c.byteLength);g.set(new Uint8Array(f),0);g.set(new Uint8Array(c),f.byteLength);e=g}else e=new Uint8Array(c)}catch(k){return Promise.reject(k)}b.b=new E;var h=Vj("generateKeyRequest");try{b.f[h](b.c,e)}catch(k){if("InvalidStateError"!=k.name)return b.b=null,Promise.reject(k);
(new B(function(){try{b.f[h](b.c,e)}catch(m){b.b.reject(m),b.b=null}})).U(.01)}return b.b}
l.Wc=function(b,c){if(this.a)this.a.then(this.Wc.bind(this,b,c))["catch"](this.Wc.bind(this,b,c));else{this.a=b;if("webkit-org.w3.clearkey"==this.c){var d=lc(c);var e=JSON.parse(d);"oct"!=e.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null);d=K.Ga(e.keys[0].k);e=K.Ga(e.keys[0].kid)}else d=new Uint8Array(c),e=null;var f=Vj("addKey");try{this.f[f](this.c,d,e,this.sessionId)}catch(g){this.a.reject(g),this.a=null}}};
function dk(b,c){var d=b.keyStatuses;d.size=void 0==c?0:1;d.a=c;b.dispatchEvent(new H("keystatuseschange"))}l.generateRequest=function(b,c){A.debug("PatchedMediaKeysWebkit.MediaKeySession.generateRequest");return fk(this,c,null)};l.load=function(b){A.debug("PatchedMediaKeysWebkit.MediaKeySession.load");return"persistent-license"==this.g?fk(this,null,b):Promise.reject(Error("Not a persistent session."))};
l.update=function(b){A.debug("PatchedMediaKeysWebkit.MediaKeySession.update",b);var c=new E;this.Wc(c,b);return c};l.close=function(){A.debug("PatchedMediaKeysWebkit.MediaKeySession.close");if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var b=Vj("cancelKeyRequest");try{this.f[b](this.c,this.sessionId)}catch(c){}}this.closed.resolve();return this.closed};
l.remove=function(){A.debug("PatchedMediaKeysWebkit.MediaKeySession.remove");return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()};function ek(){this.size=0;this.a=void 0}var gk;l=ek.prototype;l.forEach=function(b){this.a&&b(this.a,gk)};l.get=function(b){if(this.has(b))return this.a};l.has=function(b){var c=gk;return this.a&&K.Fa(new Uint8Array(b),new Uint8Array(c))?!0:!1};l.entries=function(){};l.keys=function(){};l.values=function(){};
wj(function(){if(!(!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)A.info("Using webkit-prefixed EME v0.1b"),Uj="webkit";else if(HTMLMediaElement.prototype.generateKeyRequest)A.info("Using nonprefixed EME v0.1b");else return;gk=(new Uint8Array([0])).buffer;navigator.requestMediaKeySystemAccess=Wj;delete HTMLMediaElement.prototype.mediaKeys;HTMLMediaElement.prototype.mediaKeys=
null;HTMLMediaElement.prototype.setMediaKeys=Yj;window.MediaKeys=ak;window.MediaKeySystemAccess=Xj}});wj(function(){A.debug("VideoPlayPromise.install");if(window.HTMLMediaElement){var b=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var c=b.apply(this);c&&c["catch"](function(){});return c}}});function hk(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}wj(function(){if(window.HTMLVideoElement){var b=HTMLVideoElement.prototype;!b.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in b&&(b.getVideoPlaybackQuality=hk)}});function ik(b,c,d){return new window.TextTrackCue(b,c,d)}function jk(b,c,d){return new window.TextTrackCue(b+"-"+c+"-"+d,b,c,d)}
wj(function(){if(window.VTTCue)A.info("Using native VTTCue.");else if(window.TextTrackCue){var b=TextTrackCue.length;if(3==b)A.info("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=ik;else if(6==b)A.info("Using VTTCue polyfill from 6 argument TextTrackCue."),window.VTTCue=jk;else{try{var c=!!ik(1,2,"")}catch(d){c=!1}c&&(A.info("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=ik)}}else A.error("VTTCue not available.")});function kk(){}z("shaka.text.TtmlTextParser",kk);kk.prototype.parseInit=function(){};kk.prototype.parseInit=kk.prototype.parseInit;
kk.prototype.parseMedia=function(b,c){var d=lc(b),e=[],f=new DOMParser,g=null;if(""==d)return e;try{g=f.parseFromString(d,"text/xml")}catch(Xa){throw new D(2,2,2005,"Failed to parse TTML.");}if(g){if(d=g.getElementsByTagName("parsererror")[0])throw new D(2,2,2005,d.textContent);if(f=g.getElementsByTagName("tt")[0]){var h=S.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter","frameRate");var k=S.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter","subFrameRate");var m=S.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter",
"frameRateMultiplier");var n=S.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter","tickRate");g=f.getAttribute("xml:space")||"default";d=S.getAttributeNS(f,"http://www.w3.org/ns/ttml#styling","extent")}else throw new D(2,2,2005,"TTML does not contain <tt> tag.");if("default"!=g&&"preserve"!=g)throw new D(2,2,2005,"Invalid xml:space value: "+g);g="default"==g;h=new lk(h,k,m,n);k=mk(f.getElementsByTagName("metadata")[0]);m=mk(f.getElementsByTagName("styling")[0]);n=mk(f.getElementsByTagName("layout")[0]);
for(var p=[],r=0;r<n.length;r++){var u=n[r],x=m,G=d;var C=new nd;var L=u.getAttribute("xml:id");if(L){C.id=L;L=null;G&&(L=nk.exec(G)||ok.exec(G));G=L?Number(L[1]):null;L=L?Number(L[2]):null;var U,ha;if(U=pk(u,x,"extent"))U=(ha=nk.exec(U))||ok.exec(U),null!=U&&(C.width=null!=G?100*Number(U[1])/G:Number(U[1]),C.height=null!=L?100*Number(U[2])/L:Number(U[2]),C.widthUnits=ha||null!=G?Ad:0,C.heightUnits=ha||null!=L?Ad:0);if(u=pk(u,x,"origin"))U=(ha=nk.exec(u))||ok.exec(u),null!=U&&(C.viewportAnchorX=null!=
L?100*Number(U[1])/L:Number(U[1]),C.viewportAnchorY=null!=G?100*Number(U[2])/G:Number(U[2]),C.viewportAnchorUnits=ha||null!=G?Ad:0)}else A.j("TtmlTextParser parser encountered a region with no id. Region will be ignored."),C=null;C&&p.push(C)}d=qk(f.getElementsByTagName("body")[0]);d=q(d);for(f=d.next();!f.done;f=d.next())(f=rk(f.value,c.periodStart,h,k,m,n,p,g,!1))&&e.push(f)}return e};kk.prototype.parseMedia=kk.prototype.parseMedia;
var nk=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,sk=/^(\d+px|\d+em)$/,ok=/^(\d+)px (\d+)px$/,tk=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,uk=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,vk=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,wk=/^(\d*(?:\.\d*)?)f$/,xk=/^(\d*(?:\.\d*)?)t$/,yk=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,zk={left:sd,center:"center",right:"end",start:sd,end:"end"},Ak={left:"line-left",center:"center",right:"line-right"};
function mk(b){var c=[];if(!b)return c;for(var d=q(b.childNodes),e=d.next();!e.done;e=d.next())e=e.value,e.nodeType==Node.ELEMENT_NODE&&"br"!==e.nodeName&&(e=mk(e),c=c.concat(e));c.length||c.push(b);return c}function qk(b){if(!b)return[];var c=[];b=q(b.childNodes);for(var d=b.next();!d.done;d=b.next())d=d.value,d instanceof Element&&(d.hasAttribute("begin")?c.push(d):c=c.concat(qk(d)));return c}
function Bk(b,c){for(var d="",e=q(b.childNodes),f=e.next();!f.done;f=e.next())f=f.value,"br"==f.nodeName&&b.childNodes[0]!==f?d+="\n":f.childNodes&&0<f.childNodes.length?d+=Bk(f,c):c?(f=f.textContent.trim(),f=f.replace(/\s+/g," "),d+=f):d+=f.textContent;return d}
function rk(b,c,d,e,f,g,h,k,m){if(m&&"br"==b.nodeName)return b=new N(0,0,""),b.spacer=!0,b;var n=/^[\s\n]*$/.test(b.textContent),p=b.nodeType==Node.ELEMENT_NODE&&!b.hasAttribute("begin")&&!b.hasAttribute("end");if(b.nodeType!=Node.ELEMENT_NODE||p&&n||p&&!m)return null;n=Ck(b.getAttribute("begin"),d);p=Ck(b.getAttribute("end"),d);var r=Ck(b.getAttribute("dur"),d);null==p&&null!=r&&(p=n+r);if(!m&&(null==n||null==p))throw new D(2,2,2001);n=m&&null==n?0:n+c;p=m&&null==p?0:p+c;r="";m=[];if(Array.from(b.childNodes).find(function(b){return b.nodeType===
Node.TEXT_NODE&&/\S+/.test(b.textContent)}))r=Bk(b,k);else for(var u=q(b.childNodes),x=u.next();!x.done;x=u.next())if(x=rk(x.value,c,d,e,f,g,h,k,!0))x.startTime=x.startTime||n,x.endTime=x.endTime||p,m.push(x);c=new N(n,p,r);c.nestedCues=m;if((g=Dk(b,"region",g,"")[0])&&g.getAttribute("xml:id")){var G=g.getAttribute("xml:id");c.region=h.filter(function(b){return b.id==G})[0]}e=Dk(b,"smpte:backgroundImage",e,"#")[0];Ek(c,b,g,e,f);return c}
function Ek(b,c,d,e,f){"rtl"==Fk(c,d,f,"direction")&&(b.direction="rtl");var g=Fk(c,d,f,"writingMode");"tb"==g||"tblr"==g?b.writingMode="vertical-lr":"tbrl"==g?b.writingMode="vertical-rl":"rltb"==g||"rl"==g?b.direction="rtl":g&&(b.direction=md);(g=Fk(c,d,f,"textAlign"))?(b.positionAlign=Ak[g],b.lineAlign=zk[g],b.textAlign=wd[g.toUpperCase()]):b.textAlign="start";if(g=Fk(c,d,f,"displayAlign"))b.displayAlign=xd[g.toUpperCase()];if(g=Fk(c,d,f,"color"))b.color=g;if(g=Fk(c,d,f,"backgroundColor"))b.backgroundColor=
g;if(g=Fk(c,d,f,"fontFamily"))b.fontFamily=g;(g=Fk(c,d,f,"fontWeight"))&&"bold"==g&&(b.fontWeight=700);(g=Fk(c,d,f,"wrapOption"))&&"noWrap"==g&&(b.wrapLine=!1);(g=Fk(c,d,f,"lineHeight"))&&g.match(sk)&&(b.lineHeight=g);(g=Fk(c,d,f,"fontSize"))&&g.match(sk)&&(b.fontSize=g);if(g=Fk(c,d,f,"fontStyle"))b.fontStyle=zd[g.toUpperCase()];if(e){g=e.getAttribute("imagetype");var h=e.getAttribute("encoding");e=e.textContent.trim();"PNG"==g&&"Base64"==h&&e&&(b.backgroundImage="data:image/png;base64,"+e)}(d=pk(d,
f,"textDecoration"))&&Gk(b,d);(c=Hk(c,f,"textDecoration"))&&Gk(b,c)}
function Gk(b,c){for(var d=c.split(" "),e=0;e<d.length;e++)switch(d[e]){case "underline":b.textDecoration.includes("underline")||b.textDecoration.push("underline");break;case "noUnderline":b.textDecoration.includes("underline")&&vb(b.textDecoration,"underline");break;case "lineThrough":b.textDecoration.includes("lineThrough")||b.textDecoration.push("lineThrough");break;case "noLineThrough":b.textDecoration.includes("lineThrough")&&vb(b.textDecoration,"lineThrough");break;case "overline":b.textDecoration.includes("overline")||
b.textDecoration.push("overline");break;case "noOverline":b.textDecoration.includes("overline")&&vb(b.textDecoration,"overline")}}function Fk(b,c,d,e){return(b=Hk(b,d,e))?b:pk(c,d,e)}function pk(b,c,d){if(!b)return null;for(var e=mk(b),f=0;f<e.length;f++){var g=S.getAttributeNS(e[f],"http://www.w3.org/ns/ttml#styling",d);if(g)return g}return Ik(b,c,d)}function Hk(b,c,d){var e=S.getAttributeNS(b,"http://www.w3.org/ns/ttml#styling",d);return e?e:Ik(b,c,d)}
function Ik(b,c,d){b=Dk(b,"style",c,"");for(var e=null,f=0;f<b.length;f++){var g=S.getAttributeNS(b[f],"http://www.w3.org/ns/ttml#styling",d);g||(g=Hk(b[f],c,d));g&&(e=g)}return e}
function Dk(b,c,d,e){var f=[];if(!b||1>d.length)return f;var g=b;for(b=null;g&&!(b=g.getAttribute(c))&&(g=g.parentNode,g instanceof Element););if(c=b)for(c=c.split(" "),c=q(c),b=c.next();!b.done;b=c.next()){b=b.value;g=q(d);for(var h=g.next();!h.done;h=g.next())if(h=h.value,e+h.getAttribute("xml:id")==b){f.push(h);break}}return f}
function Ck(b,c){var d=null;if(tk.test(b)){d=tk.exec(b);var e=Number(d[1]),f=Number(d[2]),g=Number(d[3]),h=Number(d[4]);h+=(Number(d[5])||0)/c.b;g+=h/c.frameRate;d=g+60*f+3600*e}else uk.test(b)?d=Jk(uk,b):vk.test(b)?d=Jk(vk,b):wk.test(b)?(d=wk.exec(b),d=Number(d[1])/c.frameRate):xk.test(b)?(d=xk.exec(b),d=Number(d[1])/c.a):yk.test(b)&&(d=Jk(yk,b));return d}
function Jk(b,c){var d=b.exec(c);return null==d||""==d[0]?null:(Number(d[4])||0)/1E3+(Number(d[3])||0)+60*(Number(d[2])||0)+3600*(Number(d[1])||0)}function lk(b,c,d,e){this.frameRate=Number(b)||30;this.b=Number(c)||1;this.a=Number(e);0==this.a&&(this.a=b?this.frameRate*this.b:1);d&&(b=/^(\d+) (\d+)$/g.exec(d))&&(this.frameRate*=Number(b[1])/Number(b[2]))}Dd["application/ttml+xml"]=kk;function Kk(){this.a=new kk}z("shaka.text.Mp4TtmlParser",Kk);Kk.prototype.parseInit=function(b){var c=!1;(new R).L("moov",ze).L("trak",ze).L("mdia",ze).L("minf",ze).L("stbl",ze).sa("stsd",Ae).L("stpp",function(b){c=!0;b.parser.stop()}).parse(b);if(!c)throw new D(2,2,2007);};Kk.prototype.parseInit=Kk.prototype.parseInit;Kk.prototype.parseMedia=function(b,c){var d=!1,e=[];(new R).L("mdat",Be(function(b){d=!0;e=e.concat(this.a.parseMedia(b,c))}.bind(this))).parse(b);if(!d)throw new D(2,2,2007);return e};
Kk.prototype.parseMedia=Kk.prototype.parseMedia;Dd['application/mp4; codecs="stpp"']=Kk;Dd['application/mp4; codecs="stpp.ttml.im1t"']=Kk;Dd['application/mp4; codecs="stpp.TTML.im1t"']=Kk;function Lk(b){this.b=b;this.a=0}function Mk(b){Nk(b,/[ \t]+/gm)}function Nk(b,c){c.lastIndex=b.a;var d=c.exec(b.b);d=null==d?null:{position:d.index,length:d[0].length,We:d};if(b.a==b.b.length||null==d||d.position!=b.a)return null;b.a+=d.length;return d.We}function Ok(b){return b.a==b.b.length?null:(b=Nk(b,/[^ \t\n]*/gm))?b[0]:null};function Pk(){}z("shaka.text.VttTextParser",Pk);Pk.prototype.parseInit=function(){};Pk.prototype.parseInit=Pk.prototype.parseInit;
Pk.prototype.parseMedia=function(b,c){var d=lc(b);d=d.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n");d=d.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(d[0]))throw new D(2,2,2E3);var e=c.segmentStart;if(null==e&&(e=0,d[0].includes("X-TIMESTAMP-MAP"))){var f=d[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),g=d[0].match(/MPEGTS:(\d+)/m);if(f&&g){e=Qk(new Lk(f[1]));if(null==e)throw new D(2,2,2E3);e=c.periodStart+(Number(g[1])/9E4-e)}}g=[];var h=d[0].split("\n");for(f=1;f<h.length;f++)if(/^Region:/.test(h[f])){var k=
new Lk(h[f]),m=new nd;Ok(k);Mk(k);for(var n=Ok(k);n;){var p;a:{var r=m,u=n;if(p=/^id=(.*)$/.exec(u))r.id=p[1];else if(p=/^width=(\d{1,2}|100)%$/.exec(u))r.width=Number(p[1]);else if(p=/^lines=(\d+)$/.exec(u))r.height=Number(p[1]),r.heightUnits=2;else if(p=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(u))r.regionAnchorX=Number(p[1]),r.regionAnchorY=Number(p[2]);else if(p=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(u))r.viewportAnchorX=Number(p[1]),r.viewportAnchorY=Number(p[2]);else if(/^scroll=up$/.exec(u))r.scroll=
"up";else{p=!1;break a}p=!0}p||A.j("VTT parser encountered an invalid VTTRegion setting: ",n," The setting will be ignored.");Mk(k);n=Ok(k)}g.push(m)}f=[];for(k=1;k<d.length;k++){h=d[k].split("\n");p=h;r=e;h=g;if(1==p.length&&!p[0]||/^NOTE($|[ \t])/.test(p[0])||"STYLE"==p[0])h=null;else{m=null;p[0].includes("--\x3e")||(m=p[0],p.splice(0,1));n=new Lk(p[0]);u=Qk(n);var x=Nk(n,/[ \t]+--\x3e[ \t]+/g),G=Qk(n);if(null==u||null==x||null==G)throw new D(2,2,2001);p=new N(u+r,G+r,p.slice(1).join("\n").trim());
Mk(n);for(r=Ok(n);r;)Rk(p,r,h)||A.j("VTT parser encountered an invalid VTT setting: ",r," The setting will be ignored."),Mk(n),r=Ok(n);null!=m&&(p.id=m);h=p}h&&f.push(h)}return f};Pk.prototype.parseMedia=Pk.prototype.parseMedia;
function Rk(b,c,d){var e;if(e=/^align:(start|middle|center|end|left|right)$/.exec(c))c=e[1],"middle"==c?b.textAlign=pd:b.textAlign=wd[c.toUpperCase()];else if(e=/^vertical:(lr|rl)$/.exec(c))b.writingMode="lr"==e[1]?"vertical-lr":"vertical-rl";else if(e=/^size:([\d.]+)%$/.exec(c))b.size=Number(e[1]);else if(e=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(c))b.position=Number(e[1]),e[2]&&(c=e[2],b.positionAlign="line-left"==c||"start"==c?"line-left":"line-right"==c||"end"==
c?"line-right":"center");else if(e=/^region:(.*)$/.exec(c)){if(c=Sk(d,e[1]))b.region=c}else{a:{if(d=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(c))b.lineInterpretation=1,b.line=Number(d[1]),d[2]&&(b.lineAlign=yd[d[2].toUpperCase()]);else if(d=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(c))b.lineInterpretation=rd,b.line=Number(d[1]),d[2]&&(b.lineAlign=yd[d[2].toUpperCase()]);else{b=!1;break a}b=!0}return b}return!0}
function Sk(b,c){var d=b.filter(function(b){return b.id==c});return d.length?d[0]:(A.j("VTT parser could not find a region with id: ",c," The region will be ignored."),null)}function Qk(b){b=Nk(b,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g);if(null==b)return null;var c=Number(b[2]),d=Number(b[3]);return 59<c||59<d?null:Number(b[4])/1E3+d+60*c+3600*(Number(b[1])||0)}Dd["text/vtt"]=Pk;Dd['text/vtt; codecs="vtt"']=Pk;Dd['text/vtt; codecs="wvtt"']=Pk;function Tk(){this.a=null}z("shaka.text.Mp4VttParser",Tk);Tk.prototype.parseInit=function(b){var c=!1;(new R).L("moov",ze).L("trak",ze).L("mdia",ze).sa("mdhd",function(b){0==b.version?(b.reader.P(4),b.reader.P(4),this.a=b.reader.F(),b.reader.P(4)):(b.reader.P(8),b.reader.P(8),this.a=b.reader.F(),b.reader.P(8));b.reader.P(4)}.bind(this)).L("minf",ze).L("stbl",ze).sa("stsd",Ae).L("wvtt",function(){c=!0}).parse(b);if(!this.a)throw new D(2,2,2008);if(!c)throw new D(2,2,2008);};
Tk.prototype.parseInit=Tk.prototype.parseInit;
Tk.prototype.parseMedia=function(b,c){var d=this;if(!this.a)throw A.error("No init segment for MP4+VTT!"),new D(2,2,2008);var e=0,f=[],g,h=[],k=!1,m=!1,n=!1,p=null;(new R).L("moof",ze).L("traf",ze).sa("tfdt",function(b){k=!0;e=0==b.version?b.reader.F():b.reader.Gb()}).sa("tfhd",function(b){var c=b.flags;b=b.reader;b.P(4);c&1&&b.P(8);c&2&&b.P(4);p=c&8?b.F():null}).sa("trun",function(b){m=!0;var c=b.version,d=b.flags;b=b.reader;var e=b.F();d&1&&b.P(4);d&4&&b.P(4);for(var g=[],h=0;h<e;h++){var k={duration:null,
sampleSize:null,Yc:null};d&256&&(k.duration=b.F());d&512&&(k.sampleSize=b.F());d&1024&&b.P(4);d&2048&&(k.Yc=0==c?b.F():b.xd());g.push(k)}f=g}).L("mdat",Be(function(b){n=!0;g=b})).parse(b);if(!n&&!k&&!m)throw new D(2,2,2008);var r=e,u=new DataView(g.buffer,g.byteOffset,g.byteLength),x=new Q(u,0);f.forEach(function(b){var f=b.duration||p,g=b.Yc?e+b.Yc:r;r=g+(f||0);var k=0;do{var m=x.F();k+=m;var n=x.F();n=ye(n);var u=null;"vttc"==n?8<m&&(u=x.Ya(m-8)):("vtte"!=n&&A.error("Unknown box "+n+"! Skipping!"),
x.P(m-8));f?u&&h.push(Uk(u,c.periodStart+g/d.a,c.periodStart+r/d.a)):A.error("WVTT sample duration unknown, and no default found!")}while(b.sampleSize&&k<b.sampleSize)});return h.filter(ed.Ha)};Tk.prototype.parseMedia=Tk.prototype.parseMedia;function Uk(b,c,d){var e,f,g;(new R).L("payl",Be(function(b){e=lc(b)})).L("iden",Be(function(b){f=lc(b)})).L("sttg",Be(function(b){g=lc(b)})).parse(b);return e?Vk(e,f,g,c,d):null}
function Vk(b,c,d,e,f){b=new N(e,f,b);c&&(b.id=c);if(d)for(c=new Lk(d),d=Ok(c);d;)Rk(b,d,[])||A.j("VTT parser encountered an invalid VTT setting: ",d," The setting will be ignored."),Mk(c),d=Ok(c);return b}Dd['application/mp4; codecs="wvtt"']=Tk;z("shaka.util.Dom.createHTMLElement",function(b){return document.createElement(b)});z("shaka.util.Dom.createVideoElement",function(){var b=document.createElement("video");b.muted=!0;b.width=600;b.height=400;return b});z("shaka.util.Dom.asHTMLElement",function(b){return b});z("shaka.util.Dom.asHTMLMediaElement",function(b){return b});z("shaka.util.Dom.removeAllChildren",function(b){for(;b.firstChild;)b.removeChild(b.firstChild)});/*
 @license
 EME Encryption Scheme Polyfill
 Copyright 2019 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function Wk(){}var Xk;z("EmeEncryptionSchemePolyfill",Wk);function Yk(){Xk?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(Xk=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=Zk):console.debug("EmeEncryptionSchemePolyfill: EME not found")}Wk.install=Yk;
function Zk(b,c){var d=this;return t(function f(){var g;return y(f,function(f){switch(f.l){case 1:return console.assert(d==navigator,'bad "this" for requestMediaKeySystemAccess'),v(f,Xk.call(d,b,c),2);case 2:g=f.R;if($k(g))return console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=Xk,f["return"](g);console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support.");navigator.requestMediaKeySystemAccess=
al;return f["return"](al.call(d,b,c))}})})}
function al(b,c){var d=this;return t(function f(){var g,h,k,m,n,p,r,u;return y(f,function(f){switch(f.l){case 1:console.assert(d==navigator,'bad "this" for requestMediaKeySystemAccess');g=bl(b);h=[];for(var x=q(c),C=x.next();!C.done;C=x.next())k=C.value,m=cl(k.videoCapabilities,g),n=cl(k.audioCapabilities,g),k.videoCapabilities&&k.videoCapabilities.length&&!m.length||k.audioCapabilities&&k.audioCapabilities.length&&!n.length||(p=Object.assign({},k),p.videoCapabilities=m,p.audioCapabilities=n,h.push(p));
if(!h.length)throw r=Error("Unsupported keySystem or supportedConfigurations."),r.name="NotSupportedError",r.code=DOMException.NOT_SUPPORTED_ERR,r;return v(f,Xk.call(d,b,h),2);case 2:return u=f.R,f["return"](new dl(u,g))}})})}function cl(b,c){return b?b.filter(function(b){return!b.encryptionScheme||b.encryptionScheme==c}):b}function el(){}var fl;z("McEncryptionSchemePolyfill",el);
function gl(){navigator.mediaCapabilities?(fl=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=hl):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}el.install=gl;
function hl(b){var c=this;return t(function e(){var f,g;return y(e,function(e){switch(e.l){case 1:return console.assert(c==navigator.mediaCapabilities,'bad "this" for decodingInfo'),v(e,fl.call(c,b),2);case 2:f=e.R;if(!b.keySystemConfiguration)return e["return"](f);g=f.keySystemAccess;if($k(g))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=fl,e["return"](f);console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support.");
navigator.mediaCapabilities.decodingInfo=il;return e["return"](il.call(c,b))}})})}
function il(b){var c=this;return t(function e(){var f,g,h,k,m,n,p;return y(e,function(e){switch(e.l){case 1:return console.assert(c==navigator.mediaCapabilities,'bad "this" for decodingInfo'),f=null,b.keySystemConfiguration&&(g=b.keySystemConfiguration,h=g.keySystem,k=g.audio&&g.audio.encryptionScheme,m=g.video&&g.video.encryptionScheme,f=bl(h),n={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:b},k&&k!=f||m&&m!=f)?e["return"](n):v(e,fl.call(c,b),2);case 2:return p=e.R,
p.keySystemAccess&&(p.keySystemAccess=new dl(p.keySystemAccess,f)),e["return"](p)}})})}function dl(b,c){this.b=b;this.a=c;this.keySystem=b.keySystem}dl.prototype.getConfiguration=function(){var b=this.b.getConfiguration();if(b.videoCapabilities)for(var c=q(b.videoCapabilities),d=c.next();!d.done;d=c.next())d.value.encryptionScheme=this.a;if(b.audioCapabilities)for(c=q(b.audioCapabilities),d=c.next();!d.done;d=c.next())d.value.encryptionScheme=this.a;return b};dl.prototype.createMediaKeys=function(){return this.b.createMediaKeys()};
function bl(b){if(b.startsWith("com.widevine")||b.startsWith("com.microsoft")||b.startsWith("com.adobe")||b.startsWith("org.w3"))return"cenc";if(b.startsWith("com.apple"))return"cbcs-1-9";console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",b,"Please contribute!");return null}function $k(b){b=b.getConfiguration();var c=b.audioCapabilities&&b.audioCapabilities[0];return(b=b.videoCapabilities&&b.videoCapabilities[0]||c)&&void 0!==b.encryptionScheme?!0:!1}function jl(){}
z("EncryptionSchemePolyfills",jl);function xj(){Yk();gl()}jl.install=xj;"undefined"!==typeof module&&module.Vd&&(module.Vd=jl);}).call(exportTo,innerGlobal,innerGlobal,undefined);if(typeof exports!="undefined")for(var k in exportTo.shaka)exports[k]=exportTo.shaka[k];else if(typeof define=="function"&&define.amd)define(function(){return exportTo.shaka});else innerGlobal.shaka=exportTo.shaka})();

//# sourceMappingURL=shaka-player.compiled.map