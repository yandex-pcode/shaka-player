/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
(function(){var innerGlobal=typeof window!="undefined"?window:global;var exportTo={};(function(window,global,module){var l,ba="function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,d){b!=Array.prototype&&b!=Object.prototype&&(b[c]=d.value)},ca="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function da(){da=function(){};ca.Symbol||(ca.Symbol=ea)}var ea=function(){var b=0;return function(c){return"jscomp_symbol_"+(c||"")+b++}}();
function fa(){da();var b=ca.Symbol.iterator;b||(b=ca.Symbol.iterator=ca.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&ba(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return ia(this)}});fa=function(){}}function ia(b){var c=0;return ka(function(){return c<b.length?{done:!1,value:b[c++]}:{done:!0}})}function ka(b){fa();b={next:b};b[ca.Symbol.iterator]=function(){return this};return b}function q(b){fa();var c=b[Symbol.iterator];return c?c.call(b):ia(b)}
function la(b,c){if(c){for(var d=ca,e=b.split("."),f=0;f<e.length-1;f++){var g=e[f];g in d||(d[g]={});d=d[g]}e=e[e.length-1];f=d[e];g=c(f);g!=f&&null!=g&&ba(d,e,{configurable:!0,writable:!0,value:g})}}
la("Promise",function(b){function c(b){this.b=0;this.g=void 0;this.a=[];var c=this.c();try{b(c.resolve,c.reject)}catch(m){c.reject(m)}}function d(){this.a=null}function e(b){return b instanceof c?b:new c(function(c){c(b)})}if(b)return b;d.prototype.b=function(b){null==this.a&&(this.a=[],this.f());this.a.push(b)};d.prototype.f=function(){var b=this;this.c(function(){b.h()})};var f=ca.setTimeout;d.prototype.c=function(b){f(b,0)};d.prototype.h=function(){for(;this.a&&this.a.length;){var b=this.a;this.a=
[];for(var c=0;c<b.length;++c){var d=b[c];b[c]=null;try{d()}catch(n){this.g(n)}}}this.a=null};d.prototype.g=function(b){this.c(function(){throw b;})};c.prototype.c=function(){function b(b){return function(e){d||(d=!0,b.call(c,e))}}var c=this,d=!1;return{resolve:b(this.u),reject:b(this.f)}};c.prototype.u=function(b){if(b===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(b instanceof c)this.w(b);else{a:switch(typeof b){case "object":var d=null!=b;break a;case "function":d=!0;
break a;default:d=!1}d?this.o(b):this.h(b)}};c.prototype.o=function(b){var c=void 0;try{c=b.then}catch(m){this.f(m);return}"function"==typeof c?this.C(c,b):this.h(b)};c.prototype.f=function(b){this.i(2,b)};c.prototype.h=function(b){this.i(1,b)};c.prototype.i=function(b,c){if(0!=this.b)throw Error("Cannot settle("+b+", "+c+"): Promise already settled in state"+this.b);this.b=b;this.g=c;this.m()};c.prototype.m=function(){if(null!=this.a){for(var b=0;b<this.a.length;++b)g.b(this.a[b]);this.a=null}};
var g=new d;c.prototype.w=function(b){var c=this.c();b.Qb(c.resolve,c.reject)};c.prototype.C=function(b,c){var d=this.c();try{b.call(c,d.resolve,d.reject)}catch(n){d.reject(n)}};c.prototype.then=function(b,d){function e(b,c){return"function"==typeof b?function(c){try{f(b(c))}catch(B){g(B)}}:c}var f,g,h=new c(function(b,c){f=b;g=c});this.Qb(e(b,f),e(d,g));return h};c.prototype["catch"]=function(b){return this.then(void 0,b)};c.prototype.Qb=function(b,c){function d(){switch(e.b){case 1:b(e.g);break;
case 2:c(e.g);break;default:throw Error("Unexpected state: "+e.b);}}var e=this;null==this.a?g.b(d):this.a.push(d)};c.resolve=e;c.reject=function(b){return new c(function(c,d){d(b)})};c.race=function(b){return new c(function(c,d){for(var f=q(b),g=f.next();!g.done;g=f.next())e(g.value).Qb(c,d)})};c.all=function(b){var d=q(b),f=d.next();return f.done?e([]):new c(function(b,c){function g(c){return function(d){h[c]=d;k--;0==k&&b(h)}}var h=[],k=0;do h.push(void 0),k++,e(f.value).Qb(g(h.length-1),c),f=d.next();
while(!f.done)})};return c});la("Promise.prototype.finally",function(b){return b?b:function(b){return this.then(function(c){return Promise.resolve(b()).then(function(){return c})},function(c){return Promise.resolve(b()).then(function(){throw c;})})}});function ma(b){function c(c){return b.next(c)}function d(c){return b["throw"](c)}return new Promise(function(e,f){function g(b){b.done?e(b.value):Promise.resolve(b.value).then(c,d).then(g,f)}g(b.next())})}function t(b){return ma(b())}
function oa(b){for(var c,d=[];!(c=b.next()).done;)d.push(c.value);return d}var pa="function"==typeof Object.create?Object.create:function(b){function c(){}c.prototype=b;return new c},qa;if("function"==typeof Object.setPrototypeOf)qa=Object.setPrototypeOf;else{var sa;a:{var ta={Od:!0},ua={};try{ua.__proto__=ta;sa=ua.Od;break a}catch(b){}sa=!1}qa=sa?function(b,c){b.__proto__=c;if(b.__proto__!==c)throw new TypeError(b+" is not extensible");return b}:null}var va=qa;
function wa(){this.c=!1;this.a=null;this.N=void 0;this.l=1;this.g=this.U=0;this.b=null}function za(b){if(b.c)throw new TypeError("Generator is already running");b.c=!0}wa.prototype.f=function(b){this.N=b};function Aa(b,c){b.b={gd:c,xe:!0};b.l=b.U||b.g}wa.prototype["return"]=function(b){this.b={"return":b};this.l=this.g};function v(b,c,d){b.l=d;return{value:c}}function x(b){b.l=0}function Da(b,c){b.l=c;b.U=0}function Ea(b){b.U=0;var c=b.b.gd;b.b=null;return c}
function Fa(b){this.a=new wa;this.b=b}function Ga(b,c){za(b.a);var d=b.a.a;if(d)return Ha(b,"return"in d?d["return"]:function(b){return{value:b,done:!0}},c,b.a["return"]);b.a["return"](c);return Ia(b)}function Ha(b,c,d,e){try{var f=c.call(b.a.a,d);if(!(f instanceof Object))throw new TypeError("Iterator result "+f+" is not an object");if(!f.done)return b.a.c=!1,f;var g=f.value}catch(h){return b.a.a=null,Aa(b.a,h),Ia(b)}b.a.a=null;e.call(b.a,g);return Ia(b)}
function Ia(b){for(;b.a.l;)try{var c=b.b(b.a);if(c)return b.a.c=!1,{value:c.value,done:!1}}catch(d){b.a.N=void 0,Aa(b.a,d)}b.a.c=!1;if(b.a.b){c=b.a.b;b.a.b=null;if(c.xe)throw c.gd;return{value:c["return"],done:!0}}return{value:void 0,done:!0}}
function Ja(b){this.next=function(c){za(b.a);b.a.a?c=Ha(b,b.a.a.next,c,b.a.f):(b.a.f(c),c=Ia(b));return c};this["throw"]=function(c){za(b.a);b.a.a?c=Ha(b,b.a.a["throw"],c,b.a.f):(Aa(b.a,c),c=Ia(b));return c};this["return"]=function(c){return Ga(b,c)};fa();this[Symbol.iterator]=function(){return this}}function y(b,c){Ja.prototype=b.prototype;return new Ja(new Fa(c))}
function Ka(b,c){fa();b instanceof String&&(b+="");var d=0,e={next:function(){if(d<b.length){var f=d++;return{value:c(f,b[f]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e}la("Array.prototype.keys",function(b){return b?b:function(){return Ka(this,function(b){return b})}});function La(b,c){return Object.prototype.hasOwnProperty.call(b,c)}
la("WeakMap",function(b){function c(b){this.a=(g+=Math.random()+1).toString();if(b){da();fa();b=q(b);for(var c;!(c=b.next()).done;)c=c.value,this.set(c[0],c[1])}}function d(b){La(b,f)||ba(b,f,{value:{}})}function e(b){var c=Object[b];c&&(Object[b]=function(b){d(b);return c(b)})}if(function(){if(!b||!Object.seal)return!1;try{var c=Object.seal({}),d=Object.seal({}),e=new b([[c,2],[d,3]]);if(2!=e.get(c)||3!=e.get(d))return!1;e["delete"](c);e.set(d,4);return!e.has(c)&&4==e.get(d)}catch(n){return!1}}())return b;
var f="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var g=0;c.prototype.set=function(b,c){d(b);if(!La(b,f))throw Error("WeakMap key fail: "+b);b[f][this.a]=c;return this};c.prototype.get=function(b){return La(b,f)?b[f][this.a]:void 0};c.prototype.has=function(b){return La(b,f)&&La(b[f],this.a)};c.prototype["delete"]=function(b){return La(b,f)&&La(b[f],this.a)?delete b[f][this.a]:!1};return c});
la("Map",function(b){function c(){var b={};return b.Ba=b.next=b.head=b}function d(b,c){var d=b.a;return ka(function(){if(d){for(;d.head!=b.a;)d=d.Ba;for(;d.next!=d.head;)return d=d.next,{done:!1,value:c(d)};d=null}return{done:!0,value:void 0}})}function e(b,c){var d=c&&typeof c;"object"==d||"function"==d?g.has(c)?d=g.get(c):(d=""+ ++h,g.set(c,d)):d="p_"+c;var e=b.b[d];if(e&&La(b.b,d))for(var f=0;f<e.length;f++){var k=e[f];if(c!==c&&k.key!==k.key||c===k.key)return{id:d,list:e,index:f,X:k}}return{id:d,
list:e,index:-1,X:void 0}}function f(b){this.b={};this.a=c();this.size=0;if(b){b=q(b);for(var d;!(d=b.next()).done;)d=d.value,this.set(d[0],d[1])}}if(function(){if(!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),d=new b(q([[c,"s"]]));if("s"!=d.get(c)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var e=d.entries(),f=e.next();if(f.done||f.value[0]!=c||"s"!=f.value[1])return!1;f=e.next();return f.done||4!=f.value[0].x||
"t"!=f.value[1]||!e.next().done?!1:!0}catch(r){return!1}}())return b;da();fa();var g=new WeakMap;f.prototype.set=function(b,c){var d=e(this,b);d.list||(d.list=this.b[d.id]=[]);d.X?d.X.value=c:(d.X={next:this.a,Ba:this.a.Ba,head:this.a,key:b,value:c},d.list.push(d.X),this.a.Ba.next=d.X,this.a.Ba=d.X,this.size++);return this};f.prototype["delete"]=function(b){b=e(this,b);return b.X&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.b[b.id],b.X.Ba.next=b.X.next,b.X.next.Ba=b.X.Ba,b.X.head=
null,this.size--,!0):!1};f.prototype.clear=function(){this.b={};this.a=this.a.Ba=c();this.size=0};f.prototype.has=function(b){return!!e(this,b).X};f.prototype.get=function(b){return(b=e(this,b).X)&&b.value};f.prototype.entries=function(){return d(this,function(b){return[b.key,b.value]})};f.prototype.keys=function(){return d(this,function(b){return b.key})};f.prototype.values=function(){return d(this,function(b){return b.value})};f.prototype.forEach=function(b,c){for(var d=this.entries(),e;!(e=d.next()).done;)e=
e.value,b.call(c,e[1],e[0],this)};f.prototype[Symbol.iterator]=f.prototype.entries;var h=0;return f});
la("Set",function(b){function c(b){this.a=new Map;if(b){b=q(b);for(var c;!(c=b.next()).done;)this.add(c.value)}this.size=this.a.size}if(function(){if(!b||"function"!=typeof b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),e=new b(q([c]));if(!e.has(c)||1!=e.size||e.add(c)!=e||1!=e.size||e.add({x:4})!=e||2!=e.size)return!1;var f=e.entries(),g=f.next();if(g.done||g.value[0]!=c||g.value[1]!=c)return!1;g=f.next();return g.done||g.value[0]==c||4!=g.value[0].x||
g.value[1]!=g.value[0]?!1:f.next().done}catch(h){return!1}}())return b;da();fa();c.prototype.add=function(b){this.a.set(b,b);this.size=this.a.size;return this};c.prototype["delete"]=function(b){b=this.a["delete"](b);this.size=this.a.size;return b};c.prototype.clear=function(){this.a.clear();this.size=0};c.prototype.has=function(b){return this.a.has(b)};c.prototype.entries=function(){return this.a.entries()};c.prototype.values=function(){return this.a.values()};c.prototype.keys=c.prototype.values;
c.prototype[Symbol.iterator]=c.prototype.values;c.prototype.forEach=function(b,c){var d=this;this.a.forEach(function(e){return b.call(c,e,e,d)})};return c});la("Object.is",function(b){return b?b:function(b,d){return b===d?0!==b||1/b===1/d:b!==b&&d!==d}});la("Array.prototype.includes",function(b){return b?b:function(b,d){var c=this;c instanceof String&&(c=String(c));var f=c.length,g=d||0;for(0>g&&(g=Math.max(g+f,0));g<f;g++){var h=c[g];if(h===b||Object.is(h,b))return!0}return!1}});
function Ma(b,c,d){if(null==b)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return b+""}la("String.prototype.includes",function(b){return b?b:function(b,d){return-1!==Ma(this,b,"includes").indexOf(b,d||0)}});
la("Array.from",function(b){return b?b:function(b,d,e){fa();d=null!=d?d:function(b){return b};var c=[],g=b[Symbol.iterator];if("function"==typeof g)for(b=g.call(b);!(g=b.next()).done;)c.push(d.call(e,g.value));else{g=b.length;for(var h=0;h<g;h++)c.push(d.call(e,b[h]))}return c}});la("String.prototype.startsWith",function(b){return b?b:function(b,d){for(var c=Ma(this,b,"startsWith"),f=c.length,g=b.length,h=Math.max(0,Math.min(d|0,c.length)),k=0;k<g&&h<f;)if(c[h++]!=b[k++])return!1;return k>=g}});
la("Array.prototype.find",function(b){return b?b:function(b,d){a:{var c=this;c instanceof String&&(c=String(c));for(var f=c.length,g=0;g<f;g++){var h=c[g];if(b.call(d,h,g,c)){c=h;break a}}c=void 0}return c}});var Na="function"==typeof Object.assign?Object.assign:function(b,c){for(var d=1;d<arguments.length;d++){var e=arguments[d];if(e)for(var f in e)La(e,f)&&(b[f]=e[f])}return b};la("Object.assign",function(b){return b||Na});var Oa=this;Oa.a=!0;
function z(b,c){var d=b.split("."),e=Oa;d[0]in e||!e.execScript||e.execScript("var "+d[0]);for(var f;d.length&&(f=d.shift());)d.length||void 0===c?e[f]?e=e[f]:e=e[f]={}:e[f]=c}function Qa(b,c){function d(){}d.prototype=c.prototype;b.kf=c.prototype;b.prototype=new d;b.prototype.constructor=b;b.yf=function(b,d,g){return c.prototype[d].apply(b,Array.prototype.slice.call(arguments,2))}};/*

 Copyright 2016 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
function Ra(b){this.c=Math.exp(Math.log(.5)/b);this.b=this.a=0}function Sa(b,c,d){var e=Math.pow(b.c,c);d=d*(1-e)+e*b.a;isNaN(d)||(b.a=d,b.b+=c)}function Ta(b){return b.a/(1-Math.pow(b.c,b.b))};function Wa(){this.b=new Ra(2);this.c=new Ra(5);this.a=0}Wa.prototype.getBandwidthEstimate=function(b){return 128E3>this.a?b:Math.min(Ta(this.b),Ta(this.c))};var A={hb:0,Pb:function(){},qa:function(){},error:function(){},j:function(){},info:function(){},debug:function(){},A:function(){},H:function(){}};window.console&&window.console.log.bind&&(A.qa=console.warn.bind(console),A.Pb=console.error.bind(console),1<=A.hb&&(A.error=console.error.bind(console)),2<=A.hb&&(A.j=console.warn.bind(console)),3<=A.hb&&(A.info=console.info.bind(console)),4<=A.hb&&(A.debug=console.log.bind(console)),5<=A.hb&&(A.A=console.debug.bind(console)),6<=A.hb&&(A.H=console.debug.bind(console)));/*
 @license
 Copyright 2008 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
var Xa=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;/*
 @license
 Copyright 2006 The Closure Library Authors
 SPDX-License-Identifier: Apache-2.0
*/
function Ya(b){var c;b instanceof Ya?(Za(this,b.ta),this.bb=b.bb,this.ra=b.ra,$a(this,b.yb),this.pa=b.pa,ab(this,b.a.clone()),this.Ra=b.Ra):b&&(c=String(b).match(Xa))?(Za(this,c[1]||"",!0),this.bb=db(c[2]||""),this.ra=db(c[3]||"",!0),$a(this,c[4]),this.pa=db(c[5]||"",!0),ab(this,c[6]||"",!0),this.Ra=db(c[7]||"")):this.a=new eb(null)}l=Ya.prototype;l.ta="";l.bb="";l.ra="";l.yb=null;l.pa="";l.Ra="";
l.toString=function(){var b=[],c=this.ta;c&&b.push(fb(c,gb,!0),":");if(c=this.ra){b.push("//");var d=this.bb;d&&b.push(fb(d,gb,!0),"@");b.push(encodeURIComponent(c).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));c=this.yb;null!=c&&b.push(":",String(c))}if(c=this.pa)this.ra&&"/"!=c.charAt(0)&&b.push("/"),b.push(fb(c,"/"==c.charAt(0)?hb:ib,!0));(c=this.a.toString())&&b.push("?",c);(c=this.Ra)&&b.push("#",fb(c,jb));return b.join("")};
l.resolve=function(b){var c=this.clone();"data"===c.ta&&(c=new Ya);var d=!!b.ta;d?Za(c,b.ta):d=!!b.bb;d?c.bb=b.bb:d=!!b.ra;d?c.ra=b.ra:d=null!=b.yb;var e=b.pa;if(d)$a(c,b.yb);else if(d=!!b.pa){if("/"!=e.charAt(0))if(this.ra&&!this.pa)e="/"+e;else{var f=c.pa.lastIndexOf("/");-1!=f&&(e=c.pa.substr(0,f+1)+e)}if(".."==e||"."==e)e="";else if(-1!=e.indexOf("./")||-1!=e.indexOf("/.")){f=0==e.lastIndexOf("/",0);e=e.split("/");for(var g=[],h=0;h<e.length;){var k=e[h++];"."==k?f&&h==e.length&&g.push(""):".."==
k?((1<g.length||1==g.length&&""!=g[0])&&g.pop(),f&&h==e.length&&g.push("")):(g.push(k),f=!0)}e=g.join("/")}}d?c.pa=e:d=""!==b.a.toString();d?ab(c,b.a.clone()):d=!!b.Ra;d&&(c.Ra=b.Ra);return c};l.clone=function(){return new Ya(this)};function Za(b,c,d){b.ta=d?db(c,!0):c;b.ta&&(b.ta=b.ta.replace(/:$/,""))}function $a(b,c){if(c){c=Number(c);if(isNaN(c)||0>c)throw Error("Bad port number "+c);b.yb=c}else b.yb=null}function ab(b,c,d){c instanceof eb?b.a=c:(d||(c=fb(c,kb)),b.a=new eb(c))}
function db(b,c){return b?c?decodeURI(b):decodeURIComponent(b):""}function fb(b,c,d){return"string"==typeof b?(b=encodeURI(b).replace(c,lb),d&&(b=b.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b):null}function lb(b){b=b.charCodeAt(0);return"%"+(b>>4&15).toString(16)+(b&15).toString(16)}var gb=/[#\/\?@]/g,ib=/[#\?:]/g,hb=/[#\?]/g,kb=/[#\?@]/g,jb=/#/g;function eb(b){this.a=b||null}l=eb.prototype;l.ga=null;l.Sb=null;
l.add=function(b,c){if(!this.ga&&(this.ga={},this.Sb=0,this.a))for(var d=this.a.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null;if(0<=f){var h=d[e].substring(0,f);g=d[e].substring(f+1)}else h=d[e];h=decodeURIComponent(h.replace(/\+/g," "));g=g||"";this.add(h,decodeURIComponent(g.replace(/\+/g," ")))}this.a=null;(d=this.ga.hasOwnProperty(b)&&this.ga[b])||(this.ga[b]=d=[]);d.push(c);this.Sb++;return this};
l.toString=function(){if(this.a)return this.a;if(!this.ga)return"";var b=[],c;for(c in this.ga)for(var d=encodeURIComponent(c),e=this.ga[c],f=0;f<e.length;f++){var g=d;""!==e[f]&&(g+="="+encodeURIComponent(e[f]));b.push(g)}return this.a=b.join("&")};l.clone=function(){var b=new eb;b.a=this.a;if(this.ga){var c={},d;for(d in this.ga)c[d]=this.ga[d].concat();b.ga=c;b.Sb=this.Sb}return b};function mb(b){this.b=b;this.a=null}mb.prototype.V=function(b){var c=this;this.stop();var d=!0,e=null;this.a=function(){window.clearTimeout(e);d=!1};e=window.setTimeout(function(){d&&c.b()},1E3*b);return this};mb.prototype.stop=function(){this.a&&(this.a(),this.a=null)};function C(b){this.b=b;this.a=null}z("shaka.util.Timer",C);C.prototype.lf=function(){this.stop();this.b();return this};C.prototype.tickNow=C.prototype.lf;C.prototype.V=function(b){var c=this;this.stop();this.a=(new mb(function(){c.b()})).V(b);return this};C.prototype.tickAfter=C.prototype.V;C.prototype.Ca=function(b){var c=this;this.stop();this.a=(new mb(function(){c.a.V(b);c.b()})).V(b);return this};C.prototype.tickEvery=C.prototype.Ca;C.prototype.stop=function(){this.a&&(this.a.stop(),this.a=null)};
C.prototype.stop=C.prototype.stop;function nb(b,c){var d=ob();this.i=null==b.maxAttempts?d.maxAttempts:b.maxAttempts;this.f=null==b.baseDelay?d.baseDelay:b.baseDelay;this.h=null==b.fuzzFactor?d.fuzzFactor:b.fuzzFactor;this.g=null==b.backoffFactor?d.backoffFactor:b.backoffFactor;this.a=0;this.b=this.f;if(this.c=void 0===c?!1:c)this.a=1}
function pb(b){return t(function d(){var e,f;return y(d,function(d){switch(d.l){case 1:if(b.a>=b.i)if(b.c)b.a=1,b.b=b.f;else return d["return"](Promise.reject());e=b.a;b.a++;if(0==e)return d["return"]();f=b.b*(1+(2*Math.random()-1)*b.h);return v(d,new Promise(function(b){(new C(b)).V(f/1E3)}),2);case 2:b.b*=b.g,x(d)}})})}function ob(){return{maxAttempts:2,baseDelay:1E3,backoffFactor:2,fuzzFactor:.5,timeout:0}};function D(b,c,d,e){for(var f=[],g=3;g<arguments.length;++g)f[g-3]=arguments[g];this.severity=b;this.category=c;this.code=d;this.data=f;this.handled=!1}z("shaka.util.Error",D);D.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")};D.Severity={RECOVERABLE:1,CRITICAL:2};D.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9};
D.Code={UNSUPPORTED_SCHEME:1E3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2E3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3E3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,
MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4E3,
DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,
HLS_COULD_NOT_GUESS_MIME_TYPE:4021,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,HLS_INTERNAL_SKIP_STREAM:4035,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6E3,
REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,LOAD_INTERRUPTED:7E3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,
CAST_API_UNAVAILABLE:8E3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9E3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,
MISSING_STORAGE_CELL:9013};function E(){var b,c,d=new Promise(function(d,f){b=d;c=f});d.resolve=b;d.reject=c;return d}E.prototype.resolve=function(){};E.prototype.reject=function(){};function G(b,c){this.promise=b;this.rd=c;this.a=!1}z("shaka.util.AbortableOperation",G);function sb(b){return new G(Promise.reject(b),function(){return Promise.resolve()})}G.failed=sb;function tb(){var b=Promise.reject(new D(2,7,7001));b["catch"](function(){});return new G(b,function(){return Promise.resolve()})}G.aborted=tb;function ub(b){return new G(Promise.resolve(b),function(){return Promise.resolve()})}G.completed=ub;
function vb(b){return new G(b,function(){return b["catch"](function(){})})}G.notAbortable=vb;G.prototype.abort=function(){this.a=!0;return this.rd()};G.prototype.abort=G.prototype.abort;function wb(b){return new G(Promise.all(b.map(function(b){return b.promise})),function(){return Promise.all(b.map(function(b){return b.abort()}))})}G.all=wb;G.prototype["finally"]=function(b){this.promise.then(function(){return b(!0)},function(){return b(!1)});return this};G.prototype["finally"]=G.prototype["finally"];
G.prototype.aa=function(b,c){function d(d){return function(k){if(f.a&&d)g.reject(h);else{var m=d?b:c;m?e=xb(m,k,g):(d?g.resolve:g.reject)(k)}}}function e(){g.reject(h);return f.abort()}var f=this,g=new E,h=new D(2,7,7001);this.promise.then(d(!0),d(!1));return new G(g,function(){return e()})};G.prototype.chain=G.prototype.aa;
function xb(b,c,d){try{var e=b(c);if(e&&e.promise&&e.abort)return d.resolve(e.promise),function(){return e.abort()};d.resolve(e);return function(){return Promise.resolve(e).then(function(){},function(){})}}catch(f){return d.reject(f),function(){return Promise.resolve()}}};function I(b,c){c=void 0===c?{}:c;for(var d in c)this[d]=c[d];this.defaultPrevented=this.cancelable=this.bubbles=!1;this.timeStamp=window.performance&&window.performance.now?window.performance.now():Date.now();this.type=b;this.isTrusted=!1;this.target=this.currentTarget=null;this.a=!1}I.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)};I.prototype.stopImmediatePropagation=function(){this.a=!0};I.prototype.stopPropagation=function(){};function yb(){this.a={}}l=yb.prototype;l.push=function(b,c){this.a.hasOwnProperty(b)?this.a[b].push(c):this.a[b]=[c]};l.get=function(b){return(b=this.a[b])?b.slice():null};l.remove=function(b,c){var d=this.a[b];if(d)for(var e=0;e<d.length;++e)d[e]==c&&(d.splice(e,1),--e)};l.forEach=function(b){for(var c in this.a)b(c,this.a[c])};l.size=function(){return Object.keys(this.a).length};function zb(){this.oc=new yb;this.md=this}zb.prototype.addEventListener=function(b,c){this.oc.push(b,c)};zb.prototype.removeEventListener=function(b,c){this.oc.remove(b,c)};zb.prototype.dispatchEvent=function(b){for(var c=this.oc.get(b.type)||[],d=0;d<c.length;++d){b.target=this.md;b.currentTarget=this.md;var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(this,b)}catch(f){A.error("Uncaught exception in event handler",f,f?f.message:null,f?f.stack:null)}if(b.a)break}return b.defaultPrevented};function Ab(b){function c(b){switch(typeof b){case "undefined":case "boolean":case "number":case "string":case "symbol":case "function":return b;default:if(!b||b.buffer&&b.buffer.constructor==ArrayBuffer)return b;if(d.has(b))return null;var e=b.constructor==Array;if(b.constructor!=Object&&!e)return null;d.add(b);var g=e?[]:{},h;for(h in b)g[h]=c(b[h]);e&&(g.length=b.length);return g}}var d=new Set;return c(b)};function Bb(b,c){var d=b.indexOf(c);-1<d&&b.splice(d,1)}function Cb(b,c){var d=0;b.forEach(function(b){d+=c(b)?1:0});return d};function Db(){this.a=[]}function Eb(b,c){b.a.push(c["finally"](function(){Bb(b.a,c)}))}Db.prototype.destroy=function(){var b=[];this.a.forEach(function(c){c.promise["catch"](function(){});b.push(c.abort())});this.a=[];return Promise.all(b)};function J(b){zb.call(this);this.f=!1;this.g=new Db;this.a=new Set;this.b=new Set;this.c=b||null}Qa(J,zb);z("shaka.net.NetworkingEngine",J);J.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4};J.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var Fb={};function Gb(b,c,d){d=d||3;var e=Fb[b];if(!e||d>=e.priority)Fb[b]={priority:d,Re:c}}J.registerScheme=Gb;J.unregisterScheme=function(b){delete Fb[b]};J.prototype.Te=function(b){this.a.add(b)};J.prototype.registerRequestFilter=J.prototype.Te;
J.prototype.pf=function(b){this.a["delete"](b)};J.prototype.unregisterRequestFilter=J.prototype.pf;J.prototype.Td=function(){this.a.clear()};J.prototype.clearAllRequestFilters=J.prototype.Td;J.prototype.Ue=function(b){this.b.add(b)};J.prototype.registerResponseFilter=J.prototype.Ue;J.prototype.qf=function(b){this.b["delete"](b)};J.prototype.unregisterResponseFilter=J.prototype.qf;J.prototype.Ud=function(){this.b.clear()};J.prototype.clearAllResponseFilters=J.prototype.Ud;
J.defaultRetryParameters=function(){return ob()};function Hb(b,c,d,e,f){return{uris:b,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:c,licenseRequestType:null,sessionId:null,stream:void 0===d?null:d,streamDataCallback:void 0===e?null:e,wd:void 0===f?null:f}}J.makeRequest=Hb;J.prototype.destroy=function(){this.f=!0;this.a.clear();this.b.clear();return this.g.destroy()};J.prototype.destroy=J.prototype.destroy;
J.prototype.request=function(b,c){var d=this,e=new Ib;if(this.f){var f=Promise.reject(new D(2,7,7001));f["catch"](function(){});return new Jb(f,function(){return Promise.resolve()},e)}c.method=c.method||"GET";c.headers=c.headers||{};c.retryParameters=c.retryParameters?Ab(c.retryParameters):ob();c.uris=Ab(c.uris);f=Kb(this,b,c);var g=f.aa(function(){return Lb(d,b,c,new nb(c.retryParameters,!1),0,null,e)}),h=g.aa(function(c){return Mb(d,b,c)}),k=Date.now(),m=0;f.promise.then(function(){m=Date.now()-
k},function(){});var n=0;g.promise.then(function(){n=Date.now()},function(){});f=h.aa(function(c){var e=Date.now()-n,f=c.response;f.timeMs+=m;f.timeMs+=e;c.ve||!d.c||f.fromCache||1!=b||d.c(f.timeMs,f.data.byteLength);return f},function(b){b&&(b.severity=2);throw b;});f=new Jb(f.promise,f.rd,e);Eb(this.g,f);return f};J.prototype.request=J.prototype.request;
function Kb(b,c,d){var e=ub(void 0),f={};b=q(b.a);for(var g=b.next();!g.done;f={Rc:f.Rc},g=b.next())f.Rc=g.value,e=e.aa(function(b){return function(){return b.Rc(c,d)}}(f));return e.aa(void 0,function(b){if(b&&7001==b.code)throw b;throw new D(2,1,1006,b);})}
function Lb(b,c,d,e,f,g,h){var k=new Ya(d.uris[f]),m=k.ta,n=!1;m||(m=location.protocol,m=m.slice(0,-1),Za(k,m),d.uris[f]=k.toString());m=m.toLowerCase();var p=(m=Fb[m])?m.Re:null;if(!p)return sb(new D(2,1,1E3,k));var r;return vb(pb(e)).aa(function(){if(b.f)return tb();r=Date.now();return p(d.uris[f],d,c,function(d,e,f){b.c&&1==c&&(b.c(d,e),n=!0,h.a=f)})}).aa(function(b){void 0==b.timeMs&&(b.timeMs=Date.now()-r);return{response:b,ve:n}},function(k){if(k&&7001==k.code)throw k;if(b.f)return tb();if(k&&
1==k.severity)return b.dispatchEvent(new I("retry",{error:k instanceof D?k:null})),d.wd&&d.wd(),f=(f+1)%d.uris.length,Lb(b,c,d,e,f,k,h);throw k||g;})}function Mb(b,c,d){var e=ub(void 0);b=q(b.b);for(var f=b.next();!f.done;f=b.next())e=e.aa(f.value.bind(null,c,d.response));return e.aa(function(){return d},function(b){if(b&&7001==b.code)throw b;var c=2;b instanceof D&&(c=b.severity);throw new D(c,1,1007,b);})}function Ib(){this.a=0}J.NumBytesRemainingClass=Ib;
function Jb(b,c,d){G.call(this,b,c);this.b=d}var Nb=Jb;Nb.prototype=pa(G.prototype);Nb.prototype.constructor=Nb;if(va)va(Nb,G);else for(var Ob in G)if("prototype"!=Ob)if(Object.defineProperties){var Pb=Object.getOwnPropertyDescriptor(G,Ob);Pb&&Object.defineProperty(Nb,Ob,Pb)}else Nb[Ob]=G[Ob];Nb.kf=G.prototype;J.PendingRequest=Jb;Jb.all=wb;Jb.notAbortable=vb;Jb.completed=ub;Jb.aborted=tb;Jb.failed=sb;function Qb(){}z("shaka.util.IReleasable",Qb);Qb.prototype.release=function(){};function K(){this.a=new yb}z("shaka.util.EventManager",K);K.prototype.release=function(){this.Ib();this.a=null};K.prototype.release=K.prototype.release;K.prototype.B=function(b,c,d,e){this.a&&(b=new Rb(b,c,d,e),this.a.push(c,b))};K.prototype.listen=K.prototype.B;K.prototype.oa=function(b,c,d,e){function f(e){g.ja(b,c,f);d(e)}var g=this;this.B(b,c,f,e)};K.prototype.listenOnce=K.prototype.oa;
K.prototype.ja=function(b,c,d){if(this.a){var e=this.a.get(c)||[];e=q(e);for(var f=e.next();!f.done;f=e.next())f=f.value,f.target!=b||d!=f.listener&&d||(f.ja(),this.a.remove(c,f))}};K.prototype.unlisten=K.prototype.ja;K.prototype.Ib=function(){if(this.a){var b=this.a,c=[],d;for(d in b.a)c.push.apply(c,b.a[d]);b=q(c);for(c=b.next();!c.done;c=b.next())c.value.ja();this.a.a={}}};K.prototype.removeAll=K.prototype.Ib;
function Rb(b,c,d,e){this.target=b;this.type=c;this.listener=d;this.a=Sb(b,e);this.target.addEventListener(c,d,this.a)}Rb.prototype.ja=function(){this.target.removeEventListener(this.type,this.listener,this.a);this.listener=this.target=null;this.a=!1};Rb.prototype.unlisten=Rb.prototype.ja;function Sb(b,c){if(void 0==c)return!1;if("boolean"==typeof c)return c;var d=new Set(["passive","capture"]);Object.keys(c).filter(function(b){return!d.has(b)});return Vb(b)?c:c.capture||!1}
function Vb(b){var c=Wb;if(void 0==c){c=!1;try{var d={},e={get:function(){c=!0;return!1}};Object.defineProperty(d,"passive",e);Object.defineProperty(d,"capture",e);e=function(){};b.addEventListener("test",e,d);b.removeEventListener("test",e,d)}catch(f){c=!1}Wb=c}return c||!1}var Wb=void 0;function Xb(b){b=Yb(b);return(new Ya(b)).ra}z("shaka.util.FairPlayUtils.defaultGetContentId",Xb);function Zb(b,c,d){function e(b){(new DataView(f.buffer)).setUint32(g,b.byteLength,!0);g+=4;f.set(b,g);g+=b.byteLength}if(!d||!d.byteLength)throw new D(2,6,6015);c="string"==typeof c?new Uint8Array($b(c,!0)):new Uint8Array(c);b=Yb(b);b=$b(b,!0);var f=new Uint8Array(12+b.byteLength+c.byteLength+d.byteLength),g=0;e(new Uint8Array(b));e(c);e(new Uint8Array(d));return f}
z("shaka.util.FairPlayUtils.initDataTransform",Zb);function ac(b,c){for(var d=q(b),e=d.next();!e.done;e=d.next())if(!c(e.value))return!1;return!0};function bc(b){var c=new Map;Object.keys(b).forEach(function(d){c.set(d,b[d])});return c}function cc(b){var c={};b.forEach(function(b,e){c[e]=b});return c};function dc(b,c){var d=b;c&&(d+='; codecs="'+c+'"');return d}function ec(b){var c=[b.mimeType];fc.forEach(function(d,e){var f=b[e];f&&c.push(d+'="'+f+'"')});return c.join(";")}function gc(b){b=b.split(".");var c=b[0];b.pop();return[c,b.join(".")]}var fc=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function hc(){return window.MediaSource&&MediaSource.isTypeSupported?!0:!1}function ic(b){return""!=jc().canPlayType(b)}function kc(){return navigator.userAgent.match(/Edge?\//)?!0:!1}function lc(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!mc("Tizen")}function nc(){if(!lc())return null;var b=navigator.userAgent.match(/Version\/(\d+)/);return b?parseInt(b[1],10):(b=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(b[1],10):null}
function mc(b){return(navigator.userAgent||"").includes(b)}function jc(){if(oc)return oc;pc||(pc=new C(function(){oc=null}));(oc=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(oc=document.createElement("video"));pc.V(1);return oc}var pc=null,oc=null;function qc(b){if(!b)return"";b=new Uint8Array(b);239==b[0]&&187==b[1]&&191==b[2]&&(b=b.subarray(3));b=rc(b);b=escape(b);try{return decodeURIComponent(b)}catch(c){throw new D(2,2,2004);}}z("shaka.util.StringUtils.fromUTF8",qc);
function sc(b,c,d){if(!b)return"";if(!d&&0!=b.byteLength%2)throw A.error("Data has an incorrect length, must be even."),new D(2,2,2004);if(b instanceof ArrayBuffer)var e=b;else d=new Uint8Array(b.byteLength),d.set(new Uint8Array(b)),e=d.buffer;b=Math.floor(b.byteLength/2);d=new Uint16Array(b);e=new DataView(e);for(var f=0;f<b;f++)d[f]=e.getUint16(2*f,c);return rc(d)}z("shaka.util.StringUtils.fromUTF16",sc);
function Yb(b){var c=new Uint8Array(b);if(239==c[0]&&187==c[1]&&191==c[2])return qc(c);if(254==c[0]&&255==c[1])return sc(c.subarray(2),!1);if(255==c[0]&&254==c[1])return sc(c.subarray(2),!0);var d=function(b,c){return b.byteLength<=c||32<=b[c]&&126>=b[c]}.bind(null,c);A.debug("Unable to find byte-order-mark, making an educated guess.");if(0==c[0]&&0==c[2])return sc(b,!1);if(0==c[1]&&0==c[3])return sc(b,!0);if(d(0)&&d(1)&&d(2)&&d(3))return qc(b);throw new D(2,2,2003);}
z("shaka.util.StringUtils.fromBytesAutoDetect",Yb);function tc(b){b=encodeURIComponent(b);b=unescape(b);for(var c=new Uint8Array(b.length),d=0;d<b.length;++d)c[d]=b.charCodeAt(d);return c.buffer}z("shaka.util.StringUtils.toUTF8",tc);function $b(b,c){for(var d=new Uint8Array(2*b.length),e=new DataView(d.buffer),f=0;f<b.length;++f)e.setUint16(2*f,b.charCodeAt(f),c);return d.buffer}z("shaka.util.StringUtils.toUTF16",$b);
function rc(b){if(!uc)for(var c=function(b){try{var c=new Uint8Array(b);return 0<String.fromCharCode.apply(null,c).length}catch(g){return!1}},d={size:65536};0<d.size;d={size:d.size},d.size/=2)if(c(d.size)){uc=function(b){return function(c){for(var d="",e=0;e<c.length;e+=b.size)d+=String.fromCharCode.apply(null,c.subarray(e,e+b.size));return d}}(d);break}return uc(b)}var uc=null;z("shaka.util.StringUtils.resetFromCharCode",function(){uc=null});var L={hc:function(b,c){var d=rc(b);c=void 0==c?!0:c;d=window.btoa(d).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")}};z("shaka.util.Uint8ArrayUtils.toBase64",L.hc);L.Ha=function(b){b=window.atob(b.replace(/-/g,"+").replace(/_/g,"/"));for(var c=new Uint8Array(b.length),d=0;d<b.length;++d)c[d]=b.charCodeAt(d);return c};z("shaka.util.Uint8ArrayUtils.fromBase64",L.Ha);
L.xc=function(b){for(var c=new Uint8Array(b.length/2),d=0;d<b.length;d+=2)c[d/2]=window.parseInt(b.substr(d,2),16);return c};z("shaka.util.Uint8ArrayUtils.fromHex",L.xc);L.ic=function(b){for(var c="",d=0;d<b.length;++d){var e=b[d].toString(16);1==e.length&&(e="0"+e);c+=e}return c};z("shaka.util.Uint8ArrayUtils.toHex",L.ic);L.Ga=function(b,c){if(!b&&!c)return!0;if(!b||!c||b.length!=c.length)return!1;for(var d=0;d<b.length;++d)if(b[d]!=c[d])return!1;return!0};z("shaka.util.Uint8ArrayUtils.equal",L.Ga);
L.concat=function(b){for(var c=[],d=0;d<arguments.length;++d)c[d]=arguments[d];for(var e=d=0;e<c.length;++e)d+=c[e].length;d=new Uint8Array(d);for(var f=e=0;f<c.length;++f)d.set(c[f],e),e+=c[f].length;return d};z("shaka.util.Uint8ArrayUtils.concat",L.concat);function vc(b,c){var d=this;c=void 0===c?1:c;this.C=b;this.u=new Set;this.h=this.m=null;this.$=!1;this.M=0;this.a=null;this.i=new K;this.b=new Map;this.w=[];this.o=new E;this.f=null;this.g=function(c){d.o.reject(c);b.onError(c)};this.na=new Map;this.fa=new Map;this.Z=new C(function(){return wc(d)});this.c=!1;this.la=new E;this.S=!1;this.L=[];this.ma=!1;this.ka=(new C(function(){xc(d)})).Ca(c);this.o["catch"](function(){})}l=vc.prototype;
l.destroy=function(){var b=this;return t(function d(){return y(d,function(d){switch(d.l){case 1:if(b.c)return v(d,b.la,0);b.c=!0;return v(d,yc(b),4);case 4:b.la.resolve(),d.l=0}})})};
function yc(b){return t(function d(){return y(d,function(d){switch(d.l){case 1:return b.i.release(),b.i=null,b.o.reject(),b.ka.stop(),b.ka=null,b.Z.stop(),b.Z=null,v(d,zc(b),2);case 2:if(!b.h){d.l=3;break}d.U=4;return v(d,b.h.setMediaKeys(null),6);case 6:Da(d,5);break;case 4:Ea(d);case 5:b.h=null;case 3:b.a=null,b.u.clear(),b.m=null,b.w=[],b.f=null,b.g=null,b.C=null,x(d)}})})}l.configure=function(b){this.f=b};function Ac(b,c,d){b.w=d;b.S=0<d.length;return Bc(b,c)}
function Bc(b,c){var d=Cc(b);if(d)for(var e=q(c),f=e.next();!f.done;f=e.next())f.value.drmInfos=[d];d=c.some(function(b){return 0<b.drmInfos.length});d||(f=bc(b.f.servers),Dc(c,f));e=q(c);for(f=e.next();!f.done;f=e.next()){f=q(f.value.drmInfos);for(var g=f.next();!g.done;g=f.next())Ec(g.value,bc(b.f.servers),bc(b.f.advanced||{}))}f=Fc(b,c);if(!f.size)return b.$=!0,Promise.resolve();f=Gc(b,f);return d?f:f["catch"](function(){})}
l.Bb=function(b){var c=this;if(!this.m)return this.i.oa(b,"encrypted",function(){c.g(new D(2,6,6010))}),Promise.resolve();this.h=b;this.i.oa(this.h,"play",function(){for(var b=0;b<c.L.length;b++)Hc(c,c.L[b]);c.ma=!0;c.L=[]});"webkitCurrentPlaybackTargetIsWireless"in this.h&&this.i.B(this.h,"webkitcurrentplaybacktargetiswirelesschanged",function(){return zc(c)});b=this.h.setMediaKeys(this.m);b=b["catch"](function(b){return Promise.reject(new D(2,6,6003,b.message))});var d=Ic(this);return Promise.all([b,
d]).then(function(){if(c.c)return Promise.reject();Jc(c);c.a.initData.length||c.w.length||c.i.B(c.h,"encrypted",function(b){return Kc(c,b.initDataType,new Uint8Array(b.initData))})})["catch"](function(b){if(!c.c)return Promise.reject(b)})};
function Ic(b){return t(function d(){var e,f;return y(d,function(d){switch(d.l){case 1:if(!(b.m&&b.a&&b.a.serverCertificate&&b.a.serverCertificate.length)){d.l=0;break}d.U=3;return v(d,b.m.setServerCertificate(b.a.serverCertificate),5);case 5:(e=d.N)||A.j("Server certificates are not supported by the key system.  The server certificate has been ignored.");Da(d,0);break;case 3:return f=Ea(d),d["return"](Promise.reject(new D(2,6,6004,f.message)))}})})}
function Jc(b){var c=b.a?b.a.initData:[];c.forEach(function(c){return Kc(b,c.initDataType,c.initData)});b.w.forEach(function(c){return Nc(b,c)});c.length||b.w.length||b.o.resolve()}function Kc(b,c,d){var e=b.b.values();e=q(e);for(var f=e.next();!f.done;f=e.next())if(L.Ga(d,f.value.initData)&&!mc("Tizen 2")){A.debug("Ignoring duplicate init data.");return}Oc(b,c,d)}function Pc(b){return b?b.keySystem:""}
l.Ac=function(){var b=Infinity,c=this.b.keys();c=q(c);for(var d=c.next();!d.done;d=c.next())d=d.value,isNaN(d.expiration)||(b=Math.min(b,d.expiration));return b};
function Fc(b,c){for(var d=new Set,e=q(c),f=e.next();!f.done;f=e.next()){var g=q(f.value.drmInfos);for(f=g.next();!f.done;f=g.next())d.add(f.value)}e=q(d);for(f=e.next();!f.done;f=e.next())Ec(f.value,bc(b.f.servers),bc(b.f.advanced||{}));g=b.S?"required":"optional";var h=b.S?["persistent-license"]:["temporary"];e=new Map;d=q(d);for(f=d.next();!f.done;f=d.next())f=f.value,e.set(f.keySystem,{audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:g,sessionTypes:h,
label:f.keySystem,drmInfos:[]});d=q(c);for(f=d.next();!f.done;f=d.next()){f=f.value;g=f.audio;h=f.video;var k=g?dc(g.mimeType,g.codecs):"",m=h?dc(h.mimeType,h.codecs):"",n=q(f.drmInfos);for(f=n.next();!f.done;f=n.next()){f=f.value;var p=e.get(f.keySystem);p.drmInfos.push(f);f.distinctiveIdentifierRequired&&(p.distinctiveIdentifier="required");f.persistentStateRequired&&(p.persistentState="required");g&&p.audioCapabilities.push({robustness:f.audioRobustness||"",contentType:k});h&&p.videoCapabilities.push({robustness:f.videoRobustness||
"",contentType:m})}}return e}
function Gc(b,c){if(1==c.size&&c.has(""))return Promise.reject(new D(2,6,6E3));for(var d=q(c.values()),e=d.next();!e.done;e=d.next())e=e.value,0==e.audioCapabilities.length&&delete e.audioCapabilities,0==e.videoCapabilities.length&&delete e.videoCapabilities;var f=d=new E;[!0,!1].forEach(function(b){var d=this;c.forEach(function(c,e){c.drmInfos.some(function(b){return!!b.licenseServerUri})==b&&(f=f["catch"](function(){if(!this.c)return navigator.requestMediaKeySystemAccess(e,[c])}.bind(d)))})}.bind(b));
f=f["catch"](function(){return Promise.reject(new D(2,6,6001))});f=f.then(function(b){if(this.c)return Promise.reject();this.u.clear();var d=b.getConfiguration(),e=d.videoCapabilities||[],f=q(d.audioCapabilities||[]);for(d=f.next();!d.done;d=f.next())this.u.add(d.value.contentType.toLowerCase());e=q(e);for(d=e.next();!d.done;d=e.next())this.u.add(d.value.contentType.toLowerCase());e=b.keySystem;d=c.get(b.keySystem);f=[];var g=[],p=[],r=[];Qc(d.drmInfos,f,g,p,r);1<g.length&&A.j("Multiple unique server certificates found! Only the first will be used.");
1<f.length&&A.j("Multiple unique license server URIs found! Only the first will be used.");this.a={keySystem:e,licenseServerUri:f[0],distinctiveIdentifierRequired:"required"==d.distinctiveIdentifier,persistentStateRequired:"required"==d.persistentState,audioRobustness:(d.audioCapabilities?d.audioCapabilities[0].robustness:"")||"",videoRobustness:(d.videoCapabilities?d.videoCapabilities[0].robustness:"")||"",serverCertificate:g[0],initData:p,keyIds:r};return this.a.licenseServerUri?b.createMediaKeys():
Promise.reject(new D(2,6,6012,this.a.keySystem))}.bind(b)).then(function(b){if(this.c)return Promise.reject();A.info("Created MediaKeys object for key system",this.a.keySystem);this.m=b;this.$=!0}.bind(b))["catch"](function(b){if(!this.c)return this.a=null,this.u.clear(),b instanceof D?Promise.reject(b):Promise.reject(new D(2,6,6002,b.message))}.bind(b));d.reject();return f}
function Cc(b){b=bc(b.f.clearKeys);if(0==b.size)return null;var c=[],d=[];b.forEach(function(b,e){var f=L.xc(e),g=L.xc(b);f={kty:"oct",kid:L.hc(f,!1),k:L.hc(g,!1)};c.push(f);d.push(f.kid)});b=JSON.stringify({keys:c});var e=JSON.stringify({kids:d});e=[{initData:new Uint8Array(tc(e)),initDataType:"keyids"}];return{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+window.btoa(b),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",
serverCertificate:null,initData:e,keyIds:[]}}
function Nc(b,c){try{A.A("Attempting to load an offline session",c);var d=b.m.createSession("persistent-license")}catch(g){var e=new D(2,6,6005,g.message);b.g(e);return Promise.reject(e)}b.i.B(d,"message",b.xd.bind(b));b.i.B(d,"keystatuseschange",b.vd.bind(b));var f={initData:null,loaded:!1,Lc:Infinity,Na:null};b.b.set(d,f);return d.load(c).then(function(b){if(this.c)return Promise.reject();A.H("Loaded offline session",c,b);if(b)return f.loaded=!0,Rc(this)&&this.o.resolve(),d;this.b["delete"](d);
this.g(new D(2,6,6013))}.bind(b),function(b){this.c||(this.b["delete"](d),this.g(new D(2,6,6005,b.message)))}.bind(b))}
function Oc(b,c,d){try{if(b.S){A.A("Creating new persistent session");var e=b.m.createSession("persistent-license")}else A.A("Creating new temporary session"),e=b.m.createSession()}catch(f){b.g(new D(2,6,6005,f.message));return}b.i.B(e,"message",b.xd.bind(b));b.i.B(e,"keystatuseschange",b.vd.bind(b));b.b.set(e,{initData:d,loaded:!1,Lc:Infinity,Na:null});try{d=b.f.initDataTransform(d,b.a)}catch(f){c=f;f instanceof D||(c=new D(2,6,6016,f));b.g(c);return}e.generateRequest(c,d)["catch"](function(c){if(!b.c){b.b["delete"](e);
if(c.errorCode&&c.errorCode.systemCode){var d=c.errorCode.systemCode;0>d&&(d+=Math.pow(2,32));d="0x"+d.toString(16)}b.g(new D(2,6,6006,c.message,c,d))}})}function Sc(b,c){if(Pc(c).startsWith("com.apple.fps")){var d=c.serverCertificate,e=Xb(b);b=Zb(b,e,d)}return b}l.xd=function(b){this.h&&this.f.delayLicenseRequestUntilPlayed&&this.h.paused&&!this.ma?this.L.push(b):Hc(this,b)};
function Hc(b,c){var d=c.target;A.A("Sending license request for session",d.sessionId,"of type",c.messageType);var e=b.b.get(d),f=b.a.licenseServerUri,g=b.f.advanced[b.a.keySystem];"individualization-request"==c.messageType&&g&&g.individualizationServer&&(f=g.individualizationServer);f=Hb([f],b.f.retryParameters);f.body=c.message;f.method="POST";f.licenseRequestType=c.messageType;f.sessionId=d.sessionId;"com.microsoft.playready"!=b.a.keySystem&&"com.chromecast.playready"!=b.a.keySystem||Tc(f);b.a.keySystem.startsWith("com.apple.fps")&&
b.f.fairPlayTransform&&Uc(f);var h=Date.now();b.C.$b.request(2,f).promise.then(function(b){if(this.c)return Promise.reject();this.a.keySystem.startsWith("com.apple.fps")&&this.f.fairPlayTransform&&Vc(b);this.M+=(Date.now()-h)/1E3;A.A("Updating session",d.sessionId);return d.update(b.data).then(function(){var b=this;this.C.onEvent(new I("drmsessionupdate"));e&&(e.Na&&e.Na.resolve(),(new C(function(){e.loaded=!0;Rc(b)&&b.o.resolve()})).V(Wc))}.bind(this))}.bind(b),function(b){this.c||(b=new D(2,6,6007,
b),this.g(b),e&&e.Na&&e.Na.reject(b))}.bind(b))["catch"](function(b){this.c||(b=new D(2,6,6008,b.message),this.g(b),e&&e.Na&&e.Na.reject(b))}.bind(b))}
function Tc(b){var c=sc(b.body,!0,!0);if(c.includes("PlayReadyKeyMessage")){A.debug("Unwrapping PlayReady request.");c=(new DOMParser).parseFromString(c,"application/xml");for(var d=c.getElementsByTagName("HttpHeader"),e=0;e<d.length;++e)b.headers[d[e].getElementsByTagName("name")[0].textContent]=d[e].getElementsByTagName("value")[0].textContent;b.body=L.Ha(c.getElementsByTagName("Challenge")[0].textContent).buffer}else A.debug("PlayReady request is already unwrapped."),b.headers["Content-Type"]=
"text/xml; charset=utf-8"}function Uc(b){var c=new Uint8Array(b.body);c="spc="+L.hc(c);b.headers["Content-Type"]="application/x-www-form-urlencoded";b.body=tc(c)}function Vc(b){try{var c=qc(b.data)}catch(d){return}c=c.trim();"<ckc>"===c.substr(0,5)&&"</ckc>"===c.substr(-6)&&(c=c.slice(5,-6));try{c=JSON.parse(c).ckc}catch(d){}b.data=L.Ha(c).buffer}
l.vd=function(b){b=b.target;A.H("Key status changed for session",b.sessionId);var c=this.b.get(b),d=!1;b.keyStatuses.forEach(function(b,e){if("string"==typeof e){var f=e;e=b;b=f}if("com.microsoft.playready"==this.a.keySystem&&16==e.byteLength&&(mc("Trident/")||kc())){f=new DataView(e);var g=f.getUint32(0,!0),m=f.getUint16(4,!0),n=f.getUint16(6,!0);f.setUint32(0,g,!1);f.setUint16(4,m,!1);f.setUint16(6,n,!1)}"com.microsoft.playready"==this.a.keySystem&&"status-pending"==b&&(b="usable");"status-pending"!=
b&&(c.loaded=!0);"expired"==b&&(d=!0);f=L.ic(new Uint8Array(e));this.na.set(f,b)}.bind(this));var e=b.expiration-Date.now();(0>e||d&&1E3>e)&&c&&!c.Na&&(A.debug("Session has expired",b.sessionId),this.b["delete"](b),b.close()["catch"](function(){}));Rc(this)&&(this.o.resolve(),this.Z.V(Xc))};function wc(b){var c=b.na,d=b.fa;d.clear();c.forEach(function(b,c){return d.set(c,b)});c=Array.from(d.values());c.length&&c.every(function(b){return"expired"==b})&&b.g(new D(2,6,6014));b.C.ud(cc(d))}
function Yc(){function b(b){return t(function h(){var c,f,n;return y(h,function(h){switch(h.l){case 1:return h.U=2,v(h,navigator.requestMediaKeySystemAccess(b,d),4);case 4:return c=h.N,n=(f=c.getConfiguration().sessionTypes)?f.includes("persistent-license"):!1,mc("Tizen 3")&&(n=!1),e.set(b,{persistentState:n}),v(h,c.createMediaKeys(),5);case 5:Da(h,0);break;case 2:Ea(h),e.set(b,null),x(h)}})})}var c=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],d=[{videoCapabilities:c,
persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:c}],e=new Map;c="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").map(function(c){return b(c)});return Promise.all(c).then(function(){return cc(e)})}
function Zc(b,c){var d=c.audio,e=c.video;if(d&&d.encrypted&&!kc()&&!b.u.has(dc(d.mimeType,d.codecs).toLowerCase())||e&&e.encrypted&&!kc()&&!b.u.has(dc(e.mimeType,e.codecs).toLowerCase()))return!1;var f=Pc(b.a);return 0==c.drmInfos.length||c.drmInfos.some(function(b){return b.keySystem==f})}
function $c(b,c){if(!b.length)return c;if(!c.length)return b;for(var d=[],e=0;e<b.length;e++)for(var f=0;f<c.length;f++)if(b[e].keySystem==c[f].keySystem){var g=b[e];f=c[f];var h=[];h=h.concat(g.initData||[]);h=h.concat(f.initData||[]);var k=[];k=k.concat(g.keyIds);k=k.concat(f.keyIds);d.push({keySystem:g.keySystem,licenseServerUri:g.licenseServerUri||f.licenseServerUri,distinctiveIdentifierRequired:g.distinctiveIdentifierRequired||f.distinctiveIdentifierRequired,persistentStateRequired:g.persistentStateRequired||
f.persistentStateRequired,videoRobustness:g.videoRobustness||f.videoRobustness,audioRobustness:g.audioRobustness||f.audioRobustness,serverCertificate:g.serverCertificate||f.serverCertificate,initData:h,keyIds:k});break}return d}
function ad(b){return t(function d(){var e;return y(d,function(d){switch(d.l){case 1:return e=new Promise(function(b,d){(new C(d)).V(bd)}),d.U=2,v(d,Promise.race([Promise.all([b.close(),b.closed]),e]),4);case 4:Da(d,0);break;case 2:Ea(d),A.j("Timeout waiting for session close"),x(d)}})})}
function zc(b){return t(function d(){var e;return y(d,function(d){switch(d.l){case 1:return e=Array.from(b.b.keys()),b.b.clear(),v(d,Promise.all(e.map(function(b){return t(function k(){return y(k,function(d){switch(d.l){case 1:return A.A("Closing session",b.sessionId),d.U=2,v(d,ad(b),4);case 4:Da(d,0);break;case 2:Ea(d),x(d)}})})})),0)}})})}function xc(b){b.b.forEach(function(c,d){var e=c.Lc,f=d.expiration;isNaN(f)&&(f=Infinity);f!=e&&(b.C.onExpirationUpdated(d.sessionId,f),c.Lc=f)})}
function Rc(b){b=b.b.values();return ac(b,function(b){return b.loaded})}function Dc(b,c){var d=[];c.forEach(function(b,c){d.push({keySystem:c,licenseServerUri:b,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})});for(var e=q(b),f=e.next();!f.done;f=e.next())f.value.drmInfos=d}
function Qc(b,c,d,e,f){b.forEach(function(b){c.includes(b.licenseServerUri)||c.push(b.licenseServerUri);b.serverCertificate&&(d.some(function(c){return L.Ga(c,b.serverCertificate)})||d.push(b.serverCertificate));b.initData&&b.initData.forEach(function(b){e.some(function(c){return c.keyId&&c.keyId==b.keyId?!0:c.initDataType==b.initDataType&&L.Ga(c.initData,b.initData)})||e.push(b)});if(b.keyIds)for(var g=0;g<b.keyIds.length;++g)f.includes(b.keyIds[g])||f.push(b.keyIds[g])})}
function Ec(b,c,d){if(b.keySystem&&("org.w3.clearkey"!=b.keySystem||!b.licenseServerUri)){c.size&&(c=c.get(b.keySystem)||"",b.licenseServerUri=c);b.keyIds||(b.keyIds=[]);if(d=d.get(b.keySystem))b.distinctiveIdentifierRequired||(b.distinctiveIdentifierRequired=d.distinctiveIdentifierRequired),b.persistentStateRequired||(b.persistentStateRequired=d.persistentStateRequired),b.videoRobustness||(b.videoRobustness=d.videoRobustness),b.audioRobustness||(b.audioRobustness=d.audioRobustness),b.serverCertificate||
(b.serverCertificate=d.serverCertificate);window.cast&&window.cast.__platform__&&"com.microsoft.playready"==b.keySystem&&(b.keySystem="com.chromecast.playready")}}var bd=1,Wc=5,Xc=.5;function cd(){this.a=new muxjs.mp4.CaptionParser;this.g=[];this.f={}}cd.prototype.init=function(b){var c=muxjs.mp4.probe;b=new Uint8Array(b);this.g=c.videoTrackIds(b);this.f=c.timescale(b);this.a.init()};cd.prototype.b=function(b,c){var d=new Uint8Array(b);(d=this.a.parse(d,this.g,this.f))&&d.captions&&c(d.captions);this.a.clearParsedCaptions()};cd.prototype.c=function(){this.a.resetCaptionStream()};function dd(){}dd.prototype.init=function(){};dd.prototype.b=function(){};dd.prototype.c=function(){};function ed(b){return!b||1==b.length&&1E-6>b.end(0)-b.start(0)?null:b.length?b.end(b.length-1):null}function fd(b,c,d){d=void 0===d?0:d;return!b||!b.length||1==b.length&&1E-6>b.end(0)-b.start(0)||c>b.end(b.length-1)?!1:c+d>=b.start(0)}function gd(b,c){if(!b||!b.length||1==b.length&&1E-6>b.end(0)-b.start(0))return 0;for(var d=0,e=b.length-1;0<=e&&b.end(e)>c;--e)d+=b.end(e)-Math.max(b.start(e),c);return d}
function hd(b){if(!b)return[];for(var c=[],d=0;d<b.length;d++)c.push({start:b.start(d),end:b.end(d)});return c};var id={Vd:function(b,c){return b.reduce(function(b,c,f){return c["catch"](b.bind(null,f))}.bind(null,c),Promise.reject())},ed:function(b,c){return b.concat(c)},ac:function(){},Ia:function(b){return null!=b}};function N(b,c){if(0==c.length)return b;var d=c.map(function(b){return new Ya(b)});return b.map(function(b){return new Ya(b)}).map(function(b){return d.map(b.resolve.bind(b))}).reduce(id.ed,[]).map(function(b){return b.toString()})}function jd(b,c){return{keySystem:b,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:c||[],keyIds:[]}}
var kd={dd:"video",Nd:"audio",xa:"text",wf:"image",uf:"application"},ld=1/15;function md(){this.a=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0});this.b=null;this.g=[];this.c=[];this.f=!1;this.a.on("data",this.i.bind(this));this.a.on("done",this.h.bind(this))}md.prototype.destroy=function(){this.a.dispose();this.a=null;return Promise.resolve()};function nd(b,c){return window.muxjs&&"mp2t"==b.toLowerCase().split(";")[0].split("/")[1]?c?MediaSource.isTypeSupported(od(c,b)):MediaSource.isTypeSupported(od("audio",b))||MediaSource.isTypeSupported(od("video",b)):!1}
function od(b,c){var d=c.replace(/mp2t/i,"mp4");"audio"==b&&(d=d.replace("video","audio"));var e=/avc1\.(66|77|100)\.(\d+)/.exec(d);if(e){var f="avc1.",g=e[1],h=Number(e[2]);f=("66"==g?f+"4200":"77"==g?f+"4d00":f+"6400")+(h>>4).toString(16);f+=(h&15).toString(16);d=d.replace(e[0],f)}return d}function pd(b,c){b.f=!0;b.b=new E;b.g=[];b.c=[];var d=new Uint8Array(c);b.a.push(d);b.a.flush();b.f&&b.b.reject(new D(2,3,3018));return b.b}
md.prototype.i=function(b){this.c=b.captions;var c=new Uint8Array(b.data.byteLength+b.initSegment.byteLength);c.set(b.initSegment,0);c.set(b.data,b.initSegment.byteLength);this.g.push(c)};md.prototype.h=function(){var b={data:L.concat.apply(null,this.g),captions:this.c};this.b.resolve(b);this.f=!1};function O(b,c,d){this.startTime=b;this.direction=qd;this.endTime=c;this.payload=d;this.region=new rd;this.position=null;this.positionAlign=sd;this.size=0;this.textAlign=td;this.writingMode=ud;this.lineInterpretation=vd;this.line=null;this.lineHeight="";this.lineAlign=wd;this.displayAlign=xd;this.fontSize=this.backgroundImage=this.backgroundColor=this.color="";this.fontWeight=yd;this.fontStyle=zd;this.fontFamily="";this.textDecoration=[];this.wrapLine=!0;this.id="";this.nestedCues=[];this.spacer=
!1}z("shaka.text.Cue",O);O.prototype.clone=function(){var b=new O(0,0,""),c;for(c in this)b[c]=this[c],b[c]&&b[c].constructor==Array&&(b[c]=b[c].slice());return b};var sd="auto";O.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:sd};var td="center",Ad={LEFT:"left",RIGHT:"right",CENTER:td,START:"start",END:"end"};O.textAlign=Ad;var xd="after",Bd={BEFORE:"before",CENTER:"center",AFTER:xd};O.displayAlign=Bd;var qd="ltr";O.direction={HORIZONTAL_LEFT_TO_RIGHT:qd,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};
var ud="horizontal-tb";O.writingMode={HORIZONTAL_TOP_TO_BOTTOM:ud,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var vd=0;O.lineInterpretation={LINE_NUMBER:vd,PERCENTAGE:1};var wd="start",Cd={CENTER:"center",START:wd,END:"end"};O.lineAlign=Cd;var yd=400;O.fontWeight={NORMAL:yd,BOLD:700};var zd="normal",Dd={NORMAL:zd,ITALIC:"italic",OBLIQUE:"oblique"};O.fontStyle=Dd;O.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"};
function rd(){this.id="";this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0;this.height=this.width=100;this.viewportAnchorUnits=this.widthUnits=this.heightUnits=Ed;this.scroll=Fd}z("shaka.text.CueRegion",rd);var Ed=1;rd.units={PX:0,PERCENTAGE:Ed,LINES:2};var Fd="";rd.scrollMode={NONE:Fd,UP:"up"};function Gd(b){this.g=null;this.c=b;this.f=this.o=0;this.h=Infinity;this.b=this.a=null;this.m="";this.i=new Map}var Hd={};z("shaka.text.TextEngine.registerParser",function(b,c){Hd[b]=c});z("shaka.text.TextEngine.unregisterParser",function(b){delete Hd[b]});function Id(b){return Hd[b]||window.muxjs&&"application/cea-608"==b?!0:!1}Gd.prototype.destroy=function(){this.c=this.g=null;this.i.clear();return Promise.resolve()};
Gd.prototype.Cc=function(b){var c={periodStart:0,segmentStart:null,segmentEnd:0};try{return this.g.parseMedia(new Uint8Array(b),c)[0].startTime}catch(d){throw new D(2,2,2009,d);}};
function Jd(b,c,d,e){return Promise.resolve().then(function(){if(this.g&&this.c)if(null==d||null==e)this.g.parseInit(new Uint8Array(c));else{var b={periodStart:this.o,segmentStart:d,segmentEnd:e};b=this.g.parseMedia(new Uint8Array(c),b).filter(function(b){return b.startTime>=this.f&&b.startTime<this.h}.bind(this));this.c.append(b);null==this.a&&(this.a=Math.max(d,this.f));this.b=Math.min(e,this.h)}}.bind(b))}
Gd.prototype.remove=function(b,c){return Promise.resolve().then(function(){!this.c||!this.c.remove(b,c)||null==this.a||c<=this.a||b>=this.b||(b<=this.a&&c>=this.b?this.a=this.b=null:b<=this.a&&c<this.b?this.a=c:b>this.a&&c>=this.b&&(this.b=b))}.bind(this))};function Kd(b,c,d){b.m=c;if(c=b.i.get(c))for(var e=q(c.keys()),f=e.next();!f.done;f=e.next())(f=c.get(f.value).filter(function(b){return b.endTime<=d}))&&b.c.append(f)}
function Ld(b,c,d,e,f){var g=d+" "+e,h=new Map;c=q(c);for(var k=c.next();!k.done;k=c.next()){var m=k.value;k=m.stream;h.has(k)||h.set(k,new Map);h.get(k).has(g)||h.get(k).set(g,[]);m.startTime+=f;m.endTime+=f;m.startTime>=b.f&&m.startTime<b.h&&(m=new O(m.startTime,m.endTime,m.text),h.get(k).get(g).push(m),k==b.m&&b.c.append([m]))}f=q(h.keys());for(g=f.next();!g.done;g=f.next())for(g=g.value,b.i.has(g)||b.i.set(g,new Map),c=q(h.get(g).keys()),k=c.next();!k.done;k=c.next())k=k.value,m=h.get(g).get(k),
b.i.get(g).set(k,m);b.a=null==b.a?Math.max(d,b.f):Math.min(b.a,Math.max(d,b.f));b.b=Math.max(b.b,Math.min(e,b.h))};function Md(b,c,d){this.f=b;this.g=d;this.b={};this.a=null;this.c={};this.i=new K;this.w=!1;this.m={};this.o=c;b=this.u=new E;c=new MediaSource;this.i.oa(c,"sourceopen",b.resolve);this.f.src=Nd(c);this.h=c}var Nd=window.URL.createObjectURL;function Od(b){var c=dc(b.mimeType,b.codecs),d=ec(b);return Id(c)||MediaSource.isTypeSupported(d)||nd(c,b.type)}l=Md.prototype;
l.destroy=function(){var b=this;this.w=!0;var c=[],d;for(d in this.c){var e=this.c[d],f=e[0];this.c[d]=e.slice(0,1);f&&c.push(f.p["catch"](id.ac));for(f=1;f<e.length;++f)e[f].p.reject()}this.a&&c.push(this.a.destroy());this.g&&c.push(this.g.destroy());for(var g in this.m)c.push(this.m[g].destroy());return Promise.all(c).then(function(){b.i&&(b.i.release(),b.i=null);b.f&&(b.f.removeAttribute("src"),b.f.load(),b.f=null);b.h=null;b.a=null;b.g=null;b.b={};b.m={};b.o=null;b.c={}})};
l.init=function(b,c){var d=this;return t(function f(){var g;return y(f,function(f){switch(f.l){case 1:return g=kd,v(f,d.u,2);case 2:b.forEach(function(b,f){var h=dc(b.mimeType,b.codecs);f==g.xa?Pd(d,h):(!c&&MediaSource.isTypeSupported(h)||!nd(h,f)||(d.m[f]=new md,h=od(f,h)),h=d.h.addSourceBuffer(h),d.i.B(h,"error",d.jf.bind(d,f)),d.i.B(h,"updateend",d.vb.bind(d,f)),d.b[f]=h,d.c[f]=[])}),x(f)}})})};function Pd(b,c){b.a||(b.a=new Gd(b.g));"application/cea-608"!=c&&(b.a.g=new Hd[c])}
function Qd(b){return b.h?"ended"==b.h.readyState:!0}function Rd(b,c){if("text"==c)var d=b.a.a;else d=Sd(b,c),d=!d||1==d.length&&1E-6>d.end(0)-d.start(0)?null:1==d.length&&0>d.start(0)?0:d.length?d.start(0):null;return d}function Td(b,c){return"text"==c?b.a.b:ed(Sd(b,c))}function Ud(b,c,d){if("text"==c)return b=b.a,null==b.b||b.b<d?0:b.b-Math.max(d,b.a);b=Sd(b,c);return gd(b,d)}
l.yc=function(b){b.total=hd(this.f.buffered);b.audio=hd(Sd(this,"audio"));b.video=hd(Sd(this,"video"));b.text=[];if(this.a){var c=this.a.a,d=this.a.b;null!=c&&null!=d&&b.text.push({start:c,end:d})}};function Sd(b,c){try{return b.b[c].buffered}catch(d){return c in b.b&&A.error("failed to get buffered range for "+c,d),null}}
function Vd(b,c,d,e,f,g){if("text"==c)return Jd(b.a,d,e,f);if(b.m[c])return pd(b.m[c],d).then(function(b){this.a||Pd(this,"text/vtt");b.captions&&b.captions.length&&Ld(this.a,b.captions,e,f,this.b.video.timestampOffset);return Wd(this,c,this.Ld.bind(this,c,b.data.buffer))}.bind(b));g&&window.muxjs&&(b.a||Pd(b,"text/vtt"),null==e&&null==f?b.o.init(d):b.o.b(d,function(c){c.length&&Ld(b.a,c,e,f,b.b.video.timestampOffset)}));return Wd(b,c,b.Ld.bind(b,c,d))}
function Xd(b,c){var d=Td(b,"video")||0;Kd(b.a,c,d)}l.remove=function(b,c,d){return"text"==b?this.a.remove(c,d):Wd(this,b,this.Dd.bind(this,b,c,d))};function Yd(b,c){if("text"==c){if(!b.a)return Promise.resolve();b.o.c();return b.a.remove(0,Infinity)}return Wd(b,c,b.Dd.bind(b,c,0,b.h.duration))}l.flush=function(b){return"text"==b?Promise.resolve():Wd(this,b,this.Zd.bind(this,b))};
function Zd(b,c,d,e,f){return"text"==c?(b.a.o=d,b=b.a,b.f=e,b.h=f,Promise.resolve()):Promise.all([Wd(b,c,b.Pd.bind(b,c)),Wd(b,c,b.hf.bind(b,c,d)),Wd(b,c,b.df.bind(b,c,e,f))])}l.endOfStream=function(b){return $d(this,function(){Qd(this)||(b?this.h.endOfStream(b):this.h.endOfStream())}.bind(this))};l.$a=function(b){return $d(this,function(){this.h.duration=b}.bind(this))};l.ba=function(){return this.h.duration};l.Ld=function(b,c){this.b[b].appendBuffer(c)};
l.Dd=function(b,c,d){d<=c?this.vb(b):this.b[b].remove(c,d)};l.Pd=function(b){var c=this.b[b].appendWindowStart,d=this.b[b].appendWindowEnd;this.b[b].abort();this.b[b].appendWindowStart=c;this.b[b].appendWindowEnd=d;this.vb(b)};l.Zd=function(b){this.f.currentTime-=.001;this.vb(b)};l.hf=function(b,c){0>c&&(c+=.001);this.b[b].timestampOffset=c;this.vb(b)};l.df=function(b,c,d){this.b[b].appendWindowStart=0;this.b[b].appendWindowEnd=d;this.b[b].appendWindowStart=c;this.vb(b)};
l.jf=function(b){this.c[b][0].p.reject(new D(2,3,3014,this.f.error?this.f.error.code:0))};l.vb=function(b){var c=this.c[b][0];c&&(c.p.resolve(),ae(this,b))};function Wd(b,c,d){if(b.w)return Promise.reject();d={start:d,p:new E};b.c[c].push(d);if(1==b.c[c].length)try{d.start()}catch(e){"QuotaExceededError"==e.name?d.p.reject(new D(2,3,3017,c)):d.p.reject(new D(2,3,3015,e)),ae(b,c)}return d.p}
function $d(b,c){if(b.w)return Promise.reject();var d=[],e;for(e in b.b){var f=new E,g={start:function(b){b.resolve()}.bind(null,f),p:f};b.c[e].push(g);d.push(f);1==b.c[e].length&&g.start()}return Promise.all(d).then(function(){try{c()}catch(m){var b=Promise.reject(new D(2,3,3015,m))}for(var d in this.b)ae(this,d);return b}.bind(b),function(b){throw b;}.bind(b))}function ae(b,c){b.c[c].shift();var d=b.c[c][0];if(d)try{d.start()}catch(e){d.p.reject(new D(2,3,3015,e)),ae(b,c)}};function be(b,c){b=P(b);c=P(c);return b.split("-")[0]==c.split("-")[0]}function ce(b,c){b=P(b);c=P(c);var d=b.split("-"),e=c.split("-");return d[0]==e[0]&&1==d.length&&2==e.length}function P(b){b=b.split("-");b=q(b);var c=b.next().value;c=void 0===c?"":c;var d=b.next().value;d=void 0===d?"":d;b=oa(b);c=c.toLowerCase();c=de.get(c)||c;d=d.toUpperCase();return[d?c+"-"+d:c].concat(b instanceof Array?b:oa(q(b))).join("-")}
function ee(b){return b.language?P(b.language):b.audio&&b.audio.language?P(b.audio.language):b.video&&b.video.language?P(b.video.language):"und"}
function fe(b,c){for(var d=P(b),e=new Set,f=q(c),g=f.next();!g.done;g=f.next())e.add(P(g.value));f=q(e);for(g=f.next();!g.done;g=f.next())if(g=g.value,g==d)return g;f=q(e);for(g=f.next();!g.done;g=f.next())if(g=g.value,ce(g,d))return g;f=q(e);for(g=f.next();!g.done;g=f.next()){var h=g=g.value,k=d;h=P(h);k=P(k);h=h.split("-");k=k.split("-");if(2==h.length&&2==k.length&&h[0]==k[0])return g}e=q(e);for(g=e.next();!g.done;g=e.next())if(f=g.value,ce(d,f))return f;return null}
var de=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze",
"cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice",
"is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao",
"mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san",
"sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie",
"vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]);function ge(b,c){var d=b.periods.reduce(function(b,c){return b.concat(c.variants)},[]);d=he(d,c);var e=new yb;d=q(d);for(var f=d.next();!f.done;f=d.next()){f=f.value;var g=ie(f);e.push(g,f)}e=je(e);var h=ke(e);e=q(b.periods);for(d=e.next();!d.done;d=e.next())d=d.value,d.variants=d.variants.filter(function(b){if(ie(b)==h)return!0;A.debug("Dropping Variant (better codec available)",b);return!1})}
function ie(b){var c="";b.video&&(c=gc(b.video.codecs)[0]);var d="";b.audio&&(d=gc(b.audio.codecs)[0]);return c+"-"+d}function ke(b){var c="",d=Infinity;b.forEach(function(b,f){for(var e=0,h=0,k=q(f),m=k.next();!m.done;m=k.next())e+=m.value.bandwidth||0,++h;e/=h;A.debug("codecs",b,"avg bandwidth",e);e<d&&(c=b,d=e)});return c}
function je(b){var c=new Map;b.forEach(function(b,d){for(var e=q(d),f=e.next();!f.done;f=e.next())f=f.value,f.video&&(f=f.video.height,c.has(f)||c.set(f,new Set),c.get(f).add(b))});var d=b.size(),e=new yb;b.forEach(function(b,g){for(var f=q(g),k=f.next();!k.done;k=f.next())k=k.value,k.video&&c.has(k.video.height)&&c.get(k.video.height).size!==d||e.push(b,k)});return e}
function le(b,c,d){function e(b,c,d){return b>=c&&b<=d}var f=b.video;return f&&f.width&&f.height&&(!e(f.width,c.minWidth,Math.min(c.maxWidth,d.width))||!e(f.height,c.minHeight,Math.min(c.maxHeight,d.height))||!e(f.width*f.height,c.minPixels,c.maxPixels))||b&&b.video&&b.video.frameRate&&!e(b.video.frameRate,c.minFrameRate,c.maxFrameRate)||!e(b.bandwidth,c.minBandwidth,c.maxBandwidth)?!1:!0}
function me(b,c,d){var e=!1;b.forEach(function(b){var f=b.allowedByApplication;b.allowedByApplication=le(b,c,d);f!=b.allowedByApplication&&(e=!0)});return e}
function ne(b,c,d,e){e.variants=e.variants.filter(function(e){if(b&&b.$&&!Zc(b,e))return A.debug("Dropping variant - not compatible with key system",e),!1;var f=e.audio;e=e.video;return f&&!Od(f)?(A.debug("Dropping variant - audio not compatible with platform",oe(f)),!1):e&&!Od(e)?(A.debug("Dropping variant - video not compatible with platform",oe(e)),!1):f&&c&&!pe(f,c)?(A.debug("Droping variant - not compatible with active audio","active audio",oe(c),"variant.audio",oe(f)),!1):e&&d&&!pe(e,d)?(A.debug("Droping variant - not compatible with active video",
"active video",oe(d),"variant.video",oe(e)),!1):!0});e.textStreams=e.textStreams.filter(function(b){var c=Id(dc(b.mimeType,b.codecs));c||A.debug("Dropping text stream. Is not supported by the platform.",b);return c})}function pe(b,c){return b.mimeType!=c.mimeType||b.codecs.split(".")[0]!=c.codecs.split(".")[0]?!1:!0}
function qe(b){var c=b.audio,d=b.video,e=c?c.codecs:null,f=d?d.codecs:null,g=[];f&&g.push(f);e&&g.push(e);var h=[];d&&h.push(d.mimeType);c&&h.push(c.mimeType);h=h[0]||null;var k=[];c&&k.push(c.kind);d&&k.push(d.kind);k=k[0]||null;var m=new Set;c&&c.roles.forEach(function(b){return m.add(b)});d&&d.roles.forEach(function(b){return m.add(b)});b={id:b.id,active:!1,type:"variant",bandwidth:b.bandwidth,language:b.language,label:null,kind:k,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:h,
codecs:g.join(", "),audioCodec:e,videoCodec:f,primary:b.primary,roles:Array.from(m),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null};d&&(b.videoId=d.id,b.originalVideoId=d.originalId,b.width=d.width||null,b.height=d.height||null,b.frameRate=d.frameRate||null,b.pixelAspectRatio=d.pixelAspectRatio||null,b.videoBandwidth=d.bandwidth||null);c&&(b.audioId=c.id,b.originalAudioId=
c.originalId,b.channelsCount=c.channelsCount,b.audioSamplingRate=c.audioSamplingRate,b.audioBandwidth=c.bandwidth||null,b.label=c.label,b.audioRoles=c.roles);return b}
function re(b){return{id:b.id,active:!1,type:"text",bandwidth:0,language:b.language,label:b.label,kind:b.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:b.mimeType,codecs:b.codecs||null,audioCodec:null,videoCodec:null,primary:b.primary,roles:b.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:b.originalId}}
function se(b){b.__shaka_id||(b.__shaka_id=te++);return b.__shaka_id}var te=0;function ue(b){var c=ve(b);c.active=b.enabled;c.type="variant";c.originalAudioId=b.id;"main"==b.kind&&(c.primary=!0);b.kind&&(c.roles=[b.kind],c.audioRoles=[b.kind]);return c}
function ve(b){return{id:se(b),active:!1,type:"",bandwidth:0,language:P(b.language),label:b.label,kind:b.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}}
function we(b){return b.allowedByApplication&&b.allowedByKeySystem}function he(b,c){var d=b.filter(function(b){return b.audio&&b.audio.channelsCount}),e=new Map;d=q(d);for(var f=d.next();!f.done;f=d.next()){f=f.value;var g=f.audio.channelsCount;e.has(g)||e.set(g,[]);e.get(g).push(f)}d=Array.from(e.keys());if(0==d.length)return b;f=d.filter(function(b){return b<=c});return f.length?e.get(Math.max.apply(null,f)):e.get(Math.min.apply(null,d))}
function xe(b,c,d){var e=b,f=b.filter(function(b){return b.primary});f.length&&(e=f);var g=e.length?e[0].language:"";e=e.filter(function(b){return b.language==g});if(c){var h=fe(P(c),b.map(function(b){return b.language}));h&&(e=b.filter(function(b){return P(b.language)==h}))}if(d){b=ye(e,d);if(b.length)return b;A.j("No exact match for the text role could be found.")}else if(b=e.filter(function(b){return 0==b.roles.length}),b.length)return b;b=e.map(function(b){return b.roles}).reduce(id.ed,[]);return b.length?
ye(e,b[0]):e}function ye(b,c){return b.filter(function(b){return b.roles.includes(c)})}function ze(b,c,d){for(var e=0;e<d.length;e++)if(d[e].audio==b&&d[e].video==c)return d[e];return null}function Ae(b){var c=[];b.audio&&c.push(b.audio);b.video&&c.push(b.video);return c}
function oe(b){return"audio"==b.type?"type=audio codecs="+b.codecs+" bandwidth="+b.bandwidth+" channelsCount="+b.channelsCount+" audioSamplingRate="+b.audioSamplingRate:"video"==b.type?"type=video codecs="+b.codecs+" bandwidth="+b.bandwidth+" frameRate="+b.frameRate+" width="+b.width+" height="+b.height:"unexpected stream type"};function Q(){this.h=null;this.c=!1;this.b=new Wa;this.g=[];this.i=!1;this.a=this.f=null}z("shaka.abr.SimpleAbrManager",Q);Q.prototype.stop=function(){this.h=null;this.c=!1;this.g=[];this.f=null};Q.prototype.stop=Q.prototype.stop;Q.prototype.init=function(b){this.h=b};Q.prototype.init=Q.prototype.init;
Q.prototype.chooseVariant=function(){var b=Be(this.a.restrictions,this.g),c=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);this.g.length&&!b.length&&(A.j("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),b=Be(null,this.g),b=[b[0]]);for(var d=b[0]||null,e=0;e<b.length;++e){var f=b[e],g=f.bandwidth/this.a.bandwidthDowngradeTarget,h=(b[e+1]||{bandwidth:Infinity}).bandwidth/this.a.bandwidthUpgradeTarget;A.H("Bandwidth ranges:",(f.bandwidth/1E6).toFixed(3),
(g/1E6).toFixed(3),(h/1E6).toFixed(3));c>=g&&c<=h&&(d=f)}this.f=Date.now();return d};Q.prototype.chooseVariant=Q.prototype.chooseVariant;Q.prototype.enable=function(){this.c=!0};Q.prototype.enable=Q.prototype.enable;Q.prototype.disable=function(){this.c=!1};Q.prototype.disable=Q.prototype.disable;
Q.prototype.segmentDownloaded=function(b,c){A.H("Segment downloaded:","deltaTimeMs="+b,"numBytes="+c,"lastTimeChosenMs="+this.f,"enabled="+this.c);var d=this.b;if(!(16E3>c)){var e=8E3*c/b,f=b/1E3;d.a+=c;Sa(d.b,f,e);Sa(d.c,f,e)}if(null!=this.f&&this.c)a:{A.H("Suggesting Streams...");if(!this.i){if(!(128E3<=this.b.a)){A.H("Still waiting for a good estimate...");break a}this.i=!0}else if(Date.now()-this.f<1E3*this.a.switchInterval){A.H("Still within switch interval...");break a}d=this.chooseVariant();
e=this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate);A.debug("Calling switch_(), bandwidth="+Math.round(e/1E3)+" kbps");this.h(d)}};Q.prototype.segmentDownloaded=Q.prototype.segmentDownloaded;Q.prototype.getBandwidthEstimate=function(){return this.b.getBandwidthEstimate(this.a.defaultBandwidthEstimate)};Q.prototype.getBandwidthEstimate=Q.prototype.getBandwidthEstimate;Q.prototype.setVariants=function(b){this.g=b};Q.prototype.setVariants=Q.prototype.setVariants;
Q.prototype.configure=function(b){this.a=b};Q.prototype.configure=Q.prototype.configure;function Be(b,c){b&&(c=c.filter(function(c){return le(c,b,{width:Infinity,height:Infinity})}));return c.sort(function(b,c){return b.bandwidth-c.bandwidth})};function R(b,c){this.F=b;this.b=c==Ce;this.a=0}z("shaka.util.DataViewReader",R);var Ce=1;R.Endianness={vf:0,xf:Ce};R.prototype.ua=function(){return this.a<this.F.byteLength};R.prototype.hasMoreData=R.prototype.ua;R.prototype.ca=function(){return this.a};R.prototype.getPosition=R.prototype.ca;R.prototype.fe=function(){return this.F.byteLength};R.prototype.getLength=R.prototype.fe;R.prototype.Oc=function(){try{var b=this.F.getUint8(this.a);this.a+=1;return b}catch(c){De()}};R.prototype.readUint8=R.prototype.Oc;
R.prototype.Bd=function(){try{var b=this.F.getUint16(this.a,this.b);this.a+=2;return b}catch(c){De()}};R.prototype.readUint16=R.prototype.Bd;R.prototype.G=function(){try{var b=this.F.getUint32(this.a,this.b);this.a+=4;return b}catch(c){De()}};R.prototype.readUint32=R.prototype.G;R.prototype.Ad=function(){try{var b=this.F.getInt32(this.a,this.b);this.a+=4;return b}catch(c){De()}};R.prototype.readInt32=R.prototype.Ad;
R.prototype.Hb=function(){try{if(this.b){var b=this.F.getUint32(this.a,!0);var c=this.F.getUint32(this.a+4,!0)}else c=this.F.getUint32(this.a,!1),b=this.F.getUint32(this.a+4,!1)}catch(d){De()}if(2097151<c)throw new D(2,3,3001);this.a+=8;return c*Math.pow(2,32)+b};R.prototype.readUint64=R.prototype.Hb;R.prototype.Za=function(b){this.a+b>this.F.byteLength&&De();var c=new Uint8Array(this.F.buffer,this.F.byteOffset+this.a,b);this.a+=b;return c};R.prototype.readBytes=R.prototype.Za;
R.prototype.R=function(b){this.a+b>this.F.byteLength&&De();this.a+=b};R.prototype.skip=R.prototype.R;R.prototype.$e=function(b){this.a<b&&De();this.a-=b};R.prototype.rewind=R.prototype.$e;R.prototype.seek=function(b){(0>b||b>this.F.byteLength)&&De();this.a=b};R.prototype.seek=R.prototype.seek;R.prototype.Nc=function(){for(var b=this.a;this.ua()&&0!=this.F.getUint8(this.a);)this.a+=1;b=new Uint8Array(this.F.buffer,this.F.byteOffset+b,this.a-b);this.a+=1;return qc(b)};
R.prototype.readTerminatedString=R.prototype.Nc;function De(){throw new D(2,3,3E3);};function S(){this.c=[];this.b=[];this.a=!1}z("shaka.util.Mp4Parser",S);S.prototype.J=function(b,c){var d=Ee(b);this.c[d]=0;this.b[d]=c;return this};S.prototype.box=S.prototype.J;S.prototype.sa=function(b,c){var d=Ee(b);this.c[d]=1;this.b[d]=c;return this};S.prototype.fullBox=S.prototype.sa;S.prototype.stop=function(){this.a=!0};S.prototype.stop=S.prototype.stop;
S.prototype.parse=function(b,c,d){b=new Uint8Array(b);b=new R(new DataView(b.buffer,b.byteOffset,b.byteLength),0);for(this.a=!1;b.ua()&&!this.a;)this.ec(0,b,c,d)};S.prototype.parse=S.prototype.parse;
S.prototype.ec=function(b,c,d,e){var f=c.ca(),g=c.G(),h=c.G();A.H("Parsing MP4 box",Fe(h));switch(g){case 0:g=c.F.byteLength-f;break;case 1:g=c.Hb()}var k=this.b[h];if(k){var m=null,n=null;1==this.c[h]&&(n=c.G(),m=n>>>24,n&=16777215);h=f+g;d&&h>c.F.byteLength&&(h=c.F.byteLength);e&&h>c.F.byteLength?this.a=!0:(e=h-c.ca(),c=0<e?c.Za(e):new Uint8Array(0),c=new R(new DataView(c.buffer,c.byteOffset,c.byteLength),0),k({parser:this,partialOkay:d||!1,version:m,flags:n,reader:c,size:g,start:f+b}))}else c.R(Math.min(f+
g-c.ca(),c.F.byteLength-c.ca()))};S.prototype.parseNext=S.prototype.ec;function Ge(b){for(var c=null!=b.flags?12:8;b.reader.ua()&&!b.parser.a;)b.parser.ec(b.start+c,b.reader,b.partialOkay)}S.children=Ge;function He(b){for(var c=null!=b.flags?12:8,d=b.reader.G();0<d&&!b.parser.a;--d)b.parser.ec(b.start+c,b.reader,b.partialOkay)}S.sampleDescription=He;function Ie(b){return function(c){b(c.reader.Za(c.reader.F.byteLength-c.reader.ca()))}}S.allData=Ie;
function Ee(b){for(var c=0,d=0;d<b.length;d++)c=c<<8|b.charCodeAt(d);return c}function Fe(b){return String.fromCharCode(b>>24&255,b>>16&255,b>>8&255,b&255)}S.typeToString=Fe;function Je(b){var c=this;this.b=[];this.a=[];this.data=[];(new S).J("moov",Ge).sa("pssh",function(b){if(1<b.version)A.j("Unrecognized PSSH version found!");else{var d=b.reader.F;d=new Uint8Array(d.buffer,d.byteOffset-12,b.size);c.data.push(d);c.b.push(L.ic(b.reader.Za(16)));if(0<b.version){d=b.reader.G();for(var f=0;f<d;++f){var g=L.ic(b.reader.Za(16));c.a.push(g)}}}}).parse(b);0==this.data.length&&A.j("No pssh box found!")}
function Ke(b){if(!b)return b;var c=new Je(b);if(1>=c.data.length)return b;b=[];var d={};c=q(c.data);for(var e=c.next();!e.done;d={Xb:d.Xb},e=c.next())d.Xb=e.value,b.some(function(b){return function(c){return L.Ga(c,b.Xb)}}(d))||b.push(d.Xb);return L.concat.apply(L,b instanceof Array?b:oa(q(b)))};var T={Tb:function(b,c){var d=T.P(b,c);return 1!=d.length?null:d[0]},wc:function(b,c,d){b=T.jd(b,c,d);return 1!=b.length?null:b[0]},P:function(b,c){return Array.prototype.filter.call(b.childNodes,function(b){return b instanceof Element&&b.tagName==c})},jd:function(b,c,d){return Array.prototype.filter.call(b.childNodes,function(b){return b instanceof Element&&b.localName==d&&b.namespaceURI==c})},getAttributeNS:function(b,c,d){return b.hasAttributeNS(c,d)?b.getAttributeNS(c,d):null},Ub:function(b){return Array.prototype.every.call(b.childNodes,
function(b){return b.nodeType==Node.TEXT_NODE||b.nodeType==Node.CDATA_SECTION_NODE})?b.textContent.trim():null},D:function(b,c,d,e){e=void 0===e?null:e;var f=null;b=b.getAttribute(c);null!=b&&(f=d(b));return null==f?e:f},Oe:function(b){if(!b)return null;/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(b)&&(b+="Z");b=Date.parse(b);return isNaN(b)?null:Math.floor(b/1E3)},Aa:function(b){if(!b)return null;var c=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(b);
if(!c)return A.j("Invalid duration string:",b),null;b=31536E3*Number(c[1]||null)+2592E3*Number(c[2]||null)+86400*Number(c[3]||null)+3600*Number(c[4]||null)+60*Number(c[5]||null)+Number(c[6]||null);return isFinite(b)?b:null},gc:function(b){var c=/([0-9]+)-([0-9]+)/.exec(b);if(!c)return null;b=Number(c[1]);if(!isFinite(b))return null;c=Number(c[2]);return isFinite(c)?{start:b,end:c}:null},parseInt:function(b){b=Number(b);return 0===b%1?b:null},fc:function(b){b=Number(b);return 0===b%1&&0<b?b:null},
wb:function(b){b=Number(b);return 0===b%1&&0<=b?b:null},parseFloat:function(b){b=Number(b);return isNaN(b)?null:b},Xd:function(b){var c;b=(c=b.match(/^(\d+)\/(\d+)$/))?Number(c[1])/Number(c[2]):Number(b);return isNaN(b)?null:b},zd:function(b,c){var d=new DOMParser;try{var e=d.parseFromString(b,"text/xml")}catch(g){}if(e&&e.documentElement.tagName==c)var f=e.documentElement;return f&&0<f.getElementsByTagName("parsererror").length?null:f},yd:function(b,c){try{var d=qc(b);return T.zd(d,c)}catch(e){}}};var Le=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime");
function Me(b,c,d){var e=Ne(b),f=null;b=[];var g=[],h=new Set(e.map(function(b){return b.keyId}));h["delete"](null);if(1<h.size)throw new D(2,4,4010);d||(g=e.filter(function(b){return"urn:mpeg:dash:mp4protection:2011"==b.Ed?(f=b.init||f,!1):!0}),g.length&&(b=Oe(f,c,g),0==b.length&&(b=[jd("",f)])));if(e.length&&(d||!g.length))for(b=[],c=q(Le.values()),d=c.next();!d.done;d=c.next())d=d.value,"org.w3.clearkey"!=d&&b.push(jd(d,f));if(h=Array.from(h)[0]||null)for(c=q(b),d=c.next();!d.done;d=c.next())for(d=
q(d.value.initData),e=d.next();!e.done;e=d.next())e.value.keyId=h;return{fd:h,zf:f,drmInfos:b,kd:!0}}function Pe(b,c,d,e){var f=Me(b,c,e);if(d.kd){b=1==d.drmInfos.length&&!d.drmInfos[0].keySystem;c=0==f.drmInfos.length;if(0==d.drmInfos.length||b&&!c)d.drmInfos=f.drmInfos;d.kd=!1}else if(0<f.drmInfos.length&&(d.drmInfos=d.drmInfos.filter(function(b){return f.drmInfos.some(function(c){return c.keySystem==b.keySystem})}),0==d.drmInfos.length))throw new D(2,4,4008);return f.fd||d.fd}
function Qe(b){var c=0,d=(new DataView(b)).getUint32(c,!0);c+=4;if(d!==b.byteLength)return A.j("PlayReady Object with invalid length encountered."),[];c+=2;d=[];for(var e=new DataView(b);c<b.byteLength-1;){var f=e.getUint16(c,!0);c+=2;var g=e.getUint16(c,!0);c+=2;var h=new Uint8Array(b,c,g);d.push({type:f,value:h});c+=g}return d}
function Re(b){b=q(b.getElementsByTagName("DATA"));for(var c=b.next();!c.done;c=b.next()){c=q(c.value.childNodes);for(var d=c.next();!d.done;d=c.next())if(d=d.value,d instanceof Element&&"LA_URL"==d.tagName)return d.textContent}return""}
function Oe(b,c,d){var e=[];d=q(d);for(var f=d.next();!f.done;f=d.next()){f=f.value;var g=Le.get(f.Ed);if(g){var h;if(h=T.wc(f.node,"urn:microsoft:playready","pro")){h=L.Ha(h.textContent);var k=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),m=h.length,n=k.length+16+m,p=new ArrayBuffer(n),r=new Uint8Array(p);p=new DataView(p);var u=0;p.setUint32(u,n);u+=4;p.setUint32(u,1886614376);u+=4;p.setUint32(u,0);u+=4;r.set(k,u);u+=k.length;p.setUint32(u,m);u+=4;r.set(h,u);h=[{initData:r,
initDataType:"cenc",keyId:f.keyId}]}else h=null;h=jd(g,f.init||b||h);if(g=Se.get(g))h.licenseServerUri=g(f);e.push(h)}else for(f=c(f.node)||[],f=q(f),g=f.next();!g.done;g=f.next())e.push(g.value)}return e}
var Se=(new Map).set("com.widevine.alpha",function(b){return(b=T.wc(b.node,"urn:microsoft","laurl"))?b.getAttribute("licenseUrl")||"":""}).set("com.microsoft.playready",function(b){b=T.wc(b.node,"urn:microsoft:playready","pro");if(!b)return"";b=L.Ha(b.textContent);b=Qe(b.buffer).filter(function(b){return 1===b.type})[0];if(!b)return"";b=sc(b.value,!0);return(b=T.zd(b,"WRMHEADER"))?Re(b):""});function Ne(b){var c=[];b=q(b);for(var d=b.next();!d.done;d=b.next())(d=Te(d.value))&&c.push(d);return c}
function Te(b){var c=b.getAttribute("schemeIdUri"),d=T.getAttributeNS(b,"urn:mpeg:cenc:2013","default_KID"),e=T.jd(b,"urn:mpeg:cenc:2013","pssh").map(T.Ub);if(!c)return A.error("Missing required schemeIdUri attribute on","ContentProtection element",b),null;c=c.toLowerCase();if(d&&(d=d.replace(/-/g,"").toLowerCase(),d.includes(" ")))throw new D(2,4,4009);var f=[];try{f=e.map(function(b){return{initDataType:"cenc",initData:L.Ha(b),keyId:null}})}catch(g){throw new D(2,4,4007);}return{node:b,Ed:c,keyId:d,
init:0<f.length?f:null}};function Ue(b,c,d,e,f){var g={RepresentationID:c,Number:d,Bandwidth:e,Time:f};return b.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,function(c,d,e,f){if("$$"==c)return"$";var h=g[d];if(null==h)return A.j("URL template does not have an available substitution for identifier",'"'+d+'":',b),c;"RepresentationID"==d&&e&&(A.j("URL template should not contain a width specifier for identifier",'"RepresentationID":',b),e=void 0);"Time"==d&&(h=Math.round(h));switch(f){case void 0:case "d":case "i":case "u":c=
h.toString();break;case "o":c=h.toString(8);break;case "x":c=h.toString(16);break;case "X":c=h.toString(16).toUpperCase();break;default:c=h.toString()}e=window.parseInt(e,10)||1;return Array(Math.max(0,e-c.length)+1).join("0")+c})}
function Ve(b,c){var d=We(b,c,"timescale"),e=1;d&&(e=T.fc(d)||1);d=We(b,c,"duration");(d=T.fc(d||""))&&(d/=e);var f=We(b,c,"startNumber"),g=Number(We(b,c,"presentationTimeOffset"))||0,h=T.wb(f||"");if(null==f||null==h)h=1;var k=Xe(b,c,"SegmentTimeline");f=null;if(k){f=e;var m=b.T.duration||Infinity;k=T.P(k,"S");for(var n=[],p=-g,r=0;r<k.length;++r){var u=k[r],w=T.D(u,"t",T.wb),F=T.D(u,"d",T.wb),B=T.D(u,"r",T.parseInt);null!=w&&(w-=g);if(!F){A.j('"S" element must have a duration:','ignoring the remaining "S" elements.',
u);break}w=null!=w?w:p;B=B||0;if(0>B)if(r+1<k.length){B=T.D(k[r+1],"t",T.wb);if(null==B){A.j('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',u);break}else if(w>=B){A.j('An "S" element cannot have a negative repeat','if its start time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',u);break}B=Math.ceil((B-w)/F)-1}else{if(Infinity==m){A.j('The last "S" element cannot have a negative repeat',
"if the Period has an infinite duration:",'ignoring the last "S" element.',u);break}else if(w/f>=m){A.j('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'igoring the last "S" element.',u);break}B=Math.ceil((m*f-w)/F)-1}0<n.length&&w!=p&&(Math.abs((w-p)/f)>=ld&&A.j("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",u),n[n.length-1].end=w/f);for(u=0;u<=B;++u)p=w+F,n.push({start:w/f,end:p/f,rf:w}),w=p}f=n}return{timescale:e,
Y:d,ab:h,ia:g/e||0,cd:g,K:f}}function We(b,c,d){return[c(b.v),c(b.W),c(b.ea)].filter(id.Ia).map(function(b){return b.getAttribute(d)}).reduce(function(b,c){return b||c})}function Xe(b,c,d){return[c(b.v),c(b.W),c(b.ea)].filter(id.Ia).map(function(b){return T.Tb(b,d)}).reduce(function(b,c){return b||c})}
function Ye(b,c,d,e,f,g){for(var h=T.getAttributeNS(b,"http://www.w3.org/1999/xlink","href"),k=T.getAttributeNS(b,"http://www.w3.org/1999/xlink","actuate")||"onRequest",m=0;m<b.attributes.length;m++){var n=b.attributes[m];"http://www.w3.org/1999/xlink"==n.namespaceURI&&(b.removeAttributeNS(n.namespaceURI,n.localName),--m)}if(5<=g)return sb(new D(2,4,4028));if("onLoad"!=k)return sb(new D(2,4,4027));var p=N([e],[h]);return f.request(0,Hb(p,c)).aa(function(e){e=T.yd(e.data,b.tagName);if(!e)return sb(new D(2,
4,4001,h));for(;b.childNodes.length;)b.removeChild(b.childNodes[0]);for(;e.childNodes.length;){var k=e.childNodes[0];e.removeChild(k);b.appendChild(k)}for(k=0;k<e.attributes.length;k++){var m=e.attributes[k].nodeName,n=e.getAttribute(m);b.setAttribute(m,n)}return Ze(b,c,d,p[0],f,g+1)})}
function Ze(b,c,d,e,f,g){g=void 0===g?0:g;if(T.getAttributeNS(b,"http://www.w3.org/1999/xlink","href")){var h=Ye(b,c,d,e,f,g);d&&(h=h.aa(void 0,function(){return Ze(b,c,d,e,f,g)}));return h}h=[];for(var k=0;k<b.childNodes.length;k++){var m=b.childNodes[k];m instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==T.getAttributeNS(m,"http://www.w3.org/1999/xlink","href")?(b.removeChild(m),--k):"SegmentTimeline"!=m.tagName&&h.push(Ze(m,c,d,e,f,g)))}return wb(h).aa(function(){return b})};function $e(b,c,d){this.c=b;this.b=c;this.a=d}z("shaka.media.InitSegmentReference",$e);$e.prototype.rc=function(){return this.c()};$e.prototype.createUris=$e.prototype.rc;$e.prototype.Bc=function(){return this.b};$e.prototype.getStartByte=$e.prototype.Bc;$e.prototype.zc=function(){return this.a};$e.prototype.getEndByte=$e.prototype.zc;function U(b,c,d,e,f,g){this.position=b;this.startTime=c;this.endTime=d;this.c=e;this.b=f;this.a=g}z("shaka.media.SegmentReference",U);U.prototype.ca=function(){return this.position};
U.prototype.getPosition=U.prototype.ca;U.prototype.Cc=function(){return this.startTime};U.prototype.getStartTime=U.prototype.Cc;U.prototype.de=function(){return this.endTime};U.prototype.getEndTime=U.prototype.de;U.prototype.rc=function(){return this.c()};U.prototype.createUris=U.prototype.rc;U.prototype.Bc=function(){return this.b};U.prototype.getStartByte=U.prototype.Bc;U.prototype.zc=function(){return this.a};U.prototype.getEndByte=U.prototype.zc;function af(b,c,d,e){var f,g=(new S).sa("sidx",function(b){f=bf(c,e,d,b)});b&&g.parse(b);if(f)return f;A.error('Invalid box type, expected "sidx".');throw new D(2,3,3004);}
function bf(b,c,d,e){var f=[];e.reader.R(4);var g=e.reader.G();if(0==g)throw A.error("Invalid timescale."),new D(2,3,3005);if(0==e.version){var h=e.reader.G();var k=e.reader.G()}else h=e.reader.Hb(),k=e.reader.Hb();e.reader.R(2);var m=e.reader.Bd();b=b+e.size+k;for(k=0;k<m;k++){var n=e.reader.G(),p=(n&2147483648)>>>31;n&=2147483647;var r=e.reader.G();e.reader.R(4);if(1==p)throw A.error("Heirarchical SIDXs are not supported."),new D(2,3,3006);f.push(new U(f.length,h/g-c,(h+r)/g-c,function(){return d},
b,b+n-1));h+=r;b+=n}e.parser.stop();return f};function V(b){this.a=b}z("shaka.media.SegmentIndex",V);V.prototype.destroy=function(){this.a=null;return Promise.resolve()};V.prototype.destroy=V.prototype.destroy;V.prototype.find=function(b){for(var c=this.a.length-1;0<=c;--c){var d=this.a[c];if(b>=d.startTime&&b<d.endTime)return d.position}return this.a.length&&b<this.a[0].startTime?this.a[0].position:null};V.prototype.find=V.prototype.find;
V.prototype.get=function(b){if(0==this.a.length)return null;b-=this.a[0].position;return 0>b||b>=this.a.length?null:this.a[b]};V.prototype.get=V.prototype.get;V.prototype.offset=function(b){for(var c=0;c<this.a.length;++c)this.a[c].startTime+=b,this.a[c].endTime+=b};V.prototype.offset=V.prototype.offset;
V.prototype.Hc=function(b){for(var c=[],d=0,e=0;d<this.a.length&&e<b.length;){var f=this.a[d],g=b[e];f.startTime<g.startTime?(c.push(f),d++):(f.startTime>g.startTime?0==d?c.push(g):A.j("Refusing to rewrite original references on update!"):(.1<Math.abs(f.endTime-g.endTime)?c.push(new U(f.position,g.startTime,g.endTime,g.c,g.b,g.a)):c.push(f),d++),e++)}for(;d<this.a.length;)c.push(this.a[d++]);if(c.length)for(d=c[c.length-1].position+1;e<b.length;)f=b[e++],f=new U(d++,f.startTime,f.endTime,f.c,f.b,
f.a),c.push(f);else c=b;this.a=c};V.prototype.merge=V.prototype.Hc;V.prototype.uc=function(b){for(var c=0;c<this.a.length;++c)if(this.a[c].endTime>b){this.a.splice(0,c);return}this.a=[]};V.prototype.evict=V.prototype.uc;function cf(b,c){for(;b.a.length;)if(b.a[b.a.length-1].startTime>=c)b.a.pop();else break;for(;b.a.length;)if(0>=b.a[0].endTime)b.a.shift();else break;if(0!=b.a.length){var d=b.a[b.a.length-1];b.a[b.a.length-1]=new U(d.position,d.startTime,c,d.c,d.b,d.a)}};function df(b){this.b=b;this.a=new R(b,0);ef||(ef=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var ef;df.prototype.ua=function(){return this.a.ua()};
function ff(b){var c=gf(b);if(7<c.length)throw new D(2,3,3002);for(var d=0,e=0;e<c.length;e++)d=256*d+c[e];c=d;d=gf(b);a:{e=L.Ga;for(var f=0;f<ef.length;f++)if(e(d,ef[f])){e=!0;break a}e=!1}if(e)d=b.b.byteLength-b.a.ca();else{if(8==d.length&&d[1]&224)throw new D(2,3,3001);e=d[0]&(1<<8-d.length)-1;for(f=1;f<d.length;f++)e=256*e+d[f];d=e}d=b.a.ca()+d<=b.b.byteLength?d:b.b.byteLength-b.a.ca();e=new DataView(b.b.buffer,b.b.byteOffset+b.a.ca(),d);b.a.R(d);return new hf(c,e)}
function gf(b){var c=b.a.Oc(),d;for(d=1;8>=d&&!(c&1<<8-d);d++);if(8<d)throw new D(2,3,3002);var e=new Uint8Array(d);e[0]=c;for(c=1;c<d;c++)e[c]=b.a.Oc();return e}function hf(b,c){this.id=b;this.a=c}function jf(b){if(8<b.a.byteLength)throw new D(2,3,3002);if(8==b.a.byteLength&&b.a.getUint8(0)&224)throw new D(2,3,3001);for(var c=0,d=0;d<b.a.byteLength;d++){var e=b.a.getUint8(d);c=256*c+e}return c};function kf(){}
kf.prototype.parse=function(b,c,d,e){var f;c=new df(new DataView(c));if(440786851!=ff(c).id)throw A.error("Not an EBML element."),new D(2,3,3008);var g=ff(c);if(408125543!=g.id)throw A.error("Not a Segment element."),new D(2,3,3009);c=g.a.byteOffset;g=new df(g.a);for(f=null;g.ua();){var h=ff(g);if(357149030==h.id){f=h;break}}if(!f)throw A.error("Not an Info element."),new D(2,3,3010);g=new df(f.a);f=1E6;for(h=null;g.ua();){var k=ff(g);if(2807729==k.id)f=jf(k);else if(17545==k.id)if(h=k,4==h.a.byteLength)h=
h.a.getFloat32(0);else if(8==h.a.byteLength)h=h.a.getFloat64(0);else throw new D(2,3,3003);}if(null==h)throw new D(2,3,3011);g=f/1E9;f=h*g;b=ff(new df(new DataView(b)));if(475249515!=b.id)throw A.error("Not a Cues element."),new D(2,3,3007);return lf(b,c,g,f,d,e)};
function lf(b,c,d,e,f,g){function h(){return f}var k=[];b=new df(b.a);for(var m=null,n=null;b.ua();){var p=ff(b);if(187==p.id){var r=mf(p);r&&(p=d*r.sf,r=c+r.Ve,null!=m&&k.push(new U(k.length,m-g,p-g,h,n,r-1)),m=p,n=r)}}null!=m&&k.push(new U(k.length,m-g,e-g,h,n,null));return k}
function mf(b){var c=new df(b.a);b=ff(c);if(179!=b.id)throw A.j("Not a CueTime element."),new D(2,3,3013);b=jf(b);c=ff(c);if(183!=c.id)throw A.j("Not a CueTrackPositions element."),new D(2,3,3012);c=new df(c.a);for(var d=0;c.ua();){var e=ff(c);if(241==e.id){d=jf(e);break}}return{sf:b,Ve:d}};function nf(b,c){var d=Xe(b,c,"Initialization");if(!d)return null;var e=N(b.O.Fa,b.v.O),f=d.getAttribute("sourceURL");f&&(e=N(e,[f]));f=0;var g=null;if(d=T.D(d,"range",T.gc))f=d.start,g=d.end;return new $e(function(){return e},f,g)}
function of(b,c){var d=Number(We(b,pf,"presentationTimeOffset"))||0,e=We(b,pf,"timescale"),f=1;e&&(f=T.fc(e)||1);d=d/f||0;e=nf(b,pf);var g=b.v.contentType;f=b.v.mimeType.split("/")[1];if("text"!=g&&"mp4"!=f&&"webm"!=f)throw A.error("SegmentBase specifies an unsupported container type.",b.v),new D(2,4,4006);if("webm"==f&&!e)throw A.error("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",b.v),new D(2,
4,4005);g=Xe(b,pf,"RepresentationIndex");var h=We(b,pf,"indexRange"),k=N(b.O.Fa,b.v.O);h=T.gc(h||"");if(g){var m=g.getAttribute("sourceURL");m&&(k=N(k,[m]));h=T.D(g,"range",T.gc,h)}if(!h)throw A.error("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",b.v),new D(2,4,4002);f=qf(b,c,e,k,h.start,h.end,f,d);return{createSegmentIndex:f.createSegmentIndex,findSegmentPosition:f.findSegmentPosition,getSegmentReference:f.getSegmentReference,
initSegmentReference:e,ia:d}}function qf(b,c,d,e,f,g,h,k){var m=b.presentationTimeline,n=!b.ob||!b.T.Ec,p=b.T.start,r=b.T.duration,u=c,w=null;return{createSegmentIndex:function(){var b=[u(e,f,g),"webm"==h?u(d.c(),d.b,d.a):null];u=null;return Promise.all(b).then(function(b){var c=b[0];b=b[1]||null;c="mp4"==h?af(c,f,e,k):(new kf).parse(c,b,e,k);m.bc(c,p);w=new V(c);n&&cf(w,r)})},findSegmentPosition:function(b){return w.find(b)},getSegmentReference:function(b){return w.get(b)}}}
function pf(b){return b.Jb};function rf(b,c){var d=nf(b,sf);var e=tf(b);var f=Ve(b,sf),g=f.ab;0==g&&(A.j("SegmentList@startNumber must be > 0"),g=1);var h=0;f.Y?h=f.Y*(g-1):f.K&&0<f.K.length&&(h=f.K[0].start);e={Y:f.Y,startTime:h,ab:g,ia:f.ia,K:f.K,Wa:e};if(!e.Y&&!e.K&&1<e.Wa.length)throw A.j("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",b.v),new D(2,4,4002);if(!e.Y&&!b.T.duration&&!e.K&&1==e.Wa.length)throw A.j("SegmentList does not contain sufficient segment information:",
"the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",b.v),new D(2,4,4002);if(e.K&&0==e.K.length)throw A.j("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",b.v),new D(2,4,4002);g=f=null;b.ea.id&&b.v.id&&(g=b.ea.id+","+b.v.id,f=c[g]);h=uf(b.T.duration,e.ab,b.v.O,e);f?(f.Hc(h),f.uc(b.presentationTimeline.Wb()-b.T.start)):(b.presentationTimeline.bc(h,b.T.start),f=new V(h),g&&b.ob&&(c[g]=
f));b.ob&&b.T.Ec||cf(f,b.T.duration);return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:f.find.bind(f),getSegmentReference:f.get.bind(f),initSegmentReference:d,ia:e.ia}}function sf(b){return b.La}
function uf(b,c,d,e){var f=e.Wa.length;e.K&&e.K.length!=e.Wa.length&&(f=Math.min(e.K.length,e.Wa.length),A.j("The number of items in the segment timeline and the number of segment","URLs do not match, truncating",e.Wa.length,"to",f));for(var g=[],h=e.startTime,k=0;k<f;k++){var m=e.Wa[k],n=N(d,[m.ye]),p=void 0;p=null!=e.Y?h+e.Y:e.K?e.K[k].end:h+b;g.push(new U(k+c,h,p,function(b){return b}.bind(null,n),m.start,m.end));h=p}return g}
function tf(b){return[b.v.La,b.W.La,b.ea.La].filter(id.Ia).map(function(b){return T.P(b,"SegmentURL")}).reduce(function(b,d){return 0<b.length?b:d}).map(function(c){c.getAttribute("indexRange")&&!b.od&&(b.od=!0,A.j("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate."));var d=c.getAttribute("media");c=T.D(c,"mediaRange",T.gc,{start:0,end:null});return{ye:d,start:c.start,end:c.end}})};function vf(b,c,d,e){var f=wf(b);var g=Ve(b,xf);var h=We(b,xf,"media"),k=We(b,xf,"index");g={Y:g.Y,timescale:g.timescale,ab:g.ab,ia:g.ia,cd:g.cd,K:g.K,Gc:h,Fb:k};h=g.Fb?1:0;h+=g.K?1:0;h+=g.Y?1:0;if(0==h)throw A.error("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",b.v),new D(2,4,4002);1!=h&&(A.j("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,",
"a SegmentTimeline or a segment duration.",b.v),g.Fb?(A.info("Using the index URL template by default."),g.K=null):A.info("Using the SegmentTimeline by default."),g.Y=null);if(!g.Fb&&!g.Gc)throw A.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",b.v),new D(2,4,4002);if(g.Fb){d=b.v.mimeType.split("/")[1];if("mp4"!=d&&"webm"!=d)throw A.error("SegmentTemplate specifies an unsupported container type.",b.v),new D(2,4,4006);
if("webm"==d&&!f)throw A.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate uses a WebM container,","but does not contain an initialization URL template.",b.v),new D(2,4,4005);e=Ue(g.Fb,b.v.id,null,b.bandwidth||null,null);h=N(b.O.Fa,b.v.O);e=N(h,[e]);b=qf(b,c,f,e,0,null,d,g.ia)}else g.Y?(e||(b.presentationTimeline.Ic(g.Y),b.presentationTimeline.Jc(b.T.start)),b=yf(b,g)):(e=c=null,b.ea.id&&b.v.id&&(e=b.ea.id+","+b.v.id,c=d[e]),h=zf(b,g),k=!b.ob||!b.T.Ec,c?
(k&&cf(new V(h),b.T.duration),c.Hc(h),c.uc(b.presentationTimeline.Wb()-b.T.start)):(b.presentationTimeline.bc(h,b.T.start),c=new V(h),e&&b.ob&&(d[e]=c)),k&&cf(c,b.T.duration),b={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:c.find.bind(c),getSegmentReference:c.get.bind(c)});return{createSegmentIndex:b.createSegmentIndex,findSegmentPosition:b.findSegmentPosition,getSegmentReference:b.getSegmentReference,initSegmentReference:f,ia:g.ia}}function xf(b){return b.Kb}
function yf(b,c){var d=b.T.duration,e=c.Y,f=c.ab,g=c.timescale,h=c.Gc,k=b.bandwidth||null,m=b.v.id,n=b.v;return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(b){return 0>b||d&&b>=d?null:Math.floor(b/e)},getSegmentReference:function(c){var p=c*e,u=p+e;d&&(u=Math.min(u,d));return 0>u||d&&p>=d?null:new U(c,p,u,function(){var d=N(b.O.Fa,n.O),e=Ue(h,m,c+f,k,p*g);return N(d,[e])},0,null)}}}
function zf(b,c){for(var d=[],e=0;e<c.K.length;e++){var f=e+c.ab;d.push(new U(f,c.K[e].start,c.K[e].end,function(b,c,d,e,f,p,r){e=N(e.Fa,f);b=Ue(b,c,p,d,r);return N(e,[b]).map(function(b){return b.toString()})}.bind(null,c.Gc,b.v.id,b.bandwidth||null,b.O,b.v.O,f,c.K[e].rf+c.cd),0,null))}return d}function wf(b){var c=We(b,xf,"initialization");if(!c)return null;var d=b.v.id,e=b.bandwidth||null,f=b.v;return new $e(function(){var g=Ue(c,d,null,e,null),h=N(b.O.Fa,f.O);return N(h,[g])},0,null)};var W={xb:{},Gb:{},Cd:function(b,c){W.Gb[b]=c}};z("shaka.media.ManifestParser.registerParserByExtension",W.Cd);W.Qc=function(b,c){W.xb[b]=c};z("shaka.media.ManifestParser.registerParserByMime",W.Qc);
W.Se=function(){var b={};if(hc()){for(var c in W.xb)b[c]=!0;for(var d in W.Gb)b[d]=!0}c={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};d=q(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"]);for(var e=d.next();!e.done;e=d.next())e=e.value,b[e]=hc()?!!W.xb[e]:ic(e);for(var f in c)b[f]=hc()?!!W.Gb[f]:ic(c[f]);return b};
W.create=function(b,c,d,e){return t(function g(){var h,k;return y(g,function(g){switch(g.l){case 1:return g.U=2,v(g,W.ee(b,c,d,e),4);case 4:return h=g.N,g["return"](new h);case 2:throw k=Ea(g),k.severity=2,k;}})})};
W.ee=function(b,c,d,e){return t(function g(){var h,k,m,n,p;return y(g,function(g){switch(g.l){case 1:h=W;if(e){if(k=h.xb[e.toLowerCase()])return g["return"](k);A.j("Could not determine manifest type using MIME type ",e)}if(m=h.getExtension(b)){if(n=h.Gb[m])return g["return"](n);A.j("Could not determine manifest type for extension ",m)}else A.j("Could not find extension for ",b);if(e){g.l=2;break}return v(g,h.me(b,c,d),3);case 3:if(e=g.N){if(p=W.xb[e])return g["return"](p);A.j("Could not determine manifest type using MIME type",
e)}case 2:throw new D(2,4,4E3,b);}})})};W.me=function(b,c,d){return t(function f(){var g,h,k;return y(f,function(f){switch(f.l){case 1:return g=Hb([b],d),g.method="HEAD",v(f,c.request(0,g).promise,2);case 2:return h=f.N,k=h.headers["content-type"],f["return"](k?k.toLowerCase().split(";").shift():"")}})})};W.getExtension=function(b){b=(new Ya(b)).pa.split("/").pop().split(".");return 1==b.length?"":b.pop().toLowerCase()};
W.isSupported=function(b,c){return hc()?c in W.xb||W.getExtension(b)in W.Gb?!0:!1:!1};function X(b,c,d){this.f=b;this.o=c;this.h=this.g=Infinity;this.a=1;this.b=this.c=null;this.m=0;this.u=!0;this.i=0;this.w=void 0===d?!0:d;this.C=0}z("shaka.media.PresentationTimeline",X);X.prototype.ba=function(){return this.g};X.prototype.getDuration=X.prototype.ba;X.prototype.ke=function(){return this.a};X.prototype.getMaxSegmentDuration=X.prototype.ke;X.prototype.$a=function(b){this.g=b};X.prototype.setDuration=X.prototype.$a;X.prototype.re=function(){return this.f};
X.prototype.getPresentationStartTime=X.prototype.re;X.prototype.Hd=function(b){this.m=b};X.prototype.setClockOffset=X.prototype.Hd;X.prototype.Jd=function(b){this.u=b};X.prototype.setStatic=X.prototype.Jd;X.prototype.Id=function(b){this.h=b};X.prototype.setSegmentAvailabilityDuration=X.prototype.Id;X.prototype.ef=function(b){this.o=b};X.prototype.setDelay=X.prototype.ef;X.prototype.ce=function(){return this.o};X.prototype.getDelay=X.prototype.ce;
X.prototype.bc=function(b,c){if(0!=b.length){var d=b[b.length-1].endTime+c;this.Jc(b[0].startTime+c);this.a=b.reduce(function(b,c){return Math.max(b,c.endTime-c.startTime)},this.a);this.b=Math.max(this.b,d);null!=this.f&&this.w&&(this.f=(Date.now()+this.m)/1E3-this.b-this.a);A.A("notifySegments:","maxSegmentDuration="+this.a)}};X.prototype.notifySegments=X.prototype.bc;X.prototype.Jc=function(b){this.c=null==this.c?b:Math.min(this.c,b)};X.prototype.notifyMinSegmentStartTime=X.prototype.Jc;
X.prototype.Ic=function(b){this.a=Math.max(this.a,b);A.A("notifyNewSegmentDuration:","maxSegmentDuration="+this.a)};X.prototype.notifyMaxSegmentDuration=X.prototype.Ic;X.prototype.offset=function(b){null!=this.c&&(this.c+=b);null!=this.b&&(this.b+=b)};X.prototype.offset=X.prototype.offset;X.prototype.da=function(){return Infinity==this.g&&!this.u};X.prototype.isLive=X.prototype.da;X.prototype.tb=function(){return Infinity!=this.g&&!this.u};X.prototype.isInProgress=X.prototype.tb;
X.prototype.Wb=function(){return Infinity==this.h?this.i:Math.max(this.i,this.qb()-this.h)};X.prototype.getSegmentAvailabilityStart=X.prototype.Wb;X.prototype.Kd=function(b){this.i=b};X.prototype.setUserSeekStart=X.prototype.Kd;X.prototype.qb=function(){return this.da()||this.tb()?Math.min(Math.max(0,(Date.now()+this.m)/1E3-this.a-this.f)+this.C,this.g):this.g};X.prototype.getSegmentAvailabilityEnd=X.prototype.qb;
X.prototype.Db=function(b){var c=Math.max(this.c,this.i);return Infinity==this.h?c:Math.max(c,Math.min(this.qb()-this.h+b,this.za()))};X.prototype.getSafeSeekRangeStart=X.prototype.Db;X.prototype.pb=function(){return this.Db(0)};X.prototype.getSeekRangeStart=X.prototype.pb;X.prototype.za=function(){return Math.max(0,this.qb()-(this.da()||this.tb()?this.o:0))};X.prototype.getSeekRangeEnd=X.prototype.za;X.prototype.Md=function(){return null==this.f||null!=this.b&&this.w?!1:!0};
X.prototype.usingPresentationStartTime=X.prototype.Md;X.prototype.Gd=function(b){this.C=b};X.prototype.setAvailabilityTimeOffset=X.prototype.Gd;function Af(b,c,d,e,f,g,h){b=Hb(b,e,f,g,h);if(0!=c||null!=d)b.headers.Range=d?"bytes="+c+"-"+d:"bytes="+c+"-";return b};function Bf(){var b=this;this.b=this.a=null;this.f=[];this.c=null;this.o=[];this.h=1;this.u={};this.w=0;this.C=new Ra(5);this.i=new C(function(){Cf(b)});this.g=new Db;this.m=Infinity}z("shaka.dash.DashParser",Bf);l=Bf.prototype;l.configure=function(b){this.a=b};l.start=function(b,c){var d=this;return t(function f(){var g;return y(f,function(f){switch(f.l){case 1:return d.f=[b],d.b=c,v(f,Df(d),2);case 2:g=f.N;d.b&&Ef(d,g);if(!d.b)throw new D(2,7,7001);return f["return"](d.c)}})})};
l.stop=function(){this.a=this.b=null;this.f=[];this.c=null;this.o=[];this.u={};null!=this.i&&(this.i.stop(),this.i=null);return this.g.destroy()};l.update=function(){Df(this)["catch"](function(b){if(this.b)this.b.onError(b)}.bind(this))};l.onExpirationUpdated=function(){};
function Df(b){var c=Date.now(),d=b.b.networkingEngine.request(0,Hb(b.f,b.a.retryParameters));Eb(b.g,d);return d.promise.then(function(c){if(b.b)return c.uri&&!b.f.includes(c.uri)&&b.f.unshift(c.uri),Ff(b,c.data,c.uri)}).then(function(){var d=(Date.now()-c)/1E3;Sa(b.C,1,d);return d})}function Gf(b){this.Fa=b}
function Ff(b,c,d){c=T.yd(c,"MPD");if(!c)throw new D(2,4,4001,d);c=Ze(c,b.a.retryParameters,b.a.dash.xlinkFailGracefully,d,b.b.networkingEngine);Eb(b.g,c);return c.promise.then(function(c){return Hf(b,c,d)})}
function Hf(b,c,d){return t(function f(){var g,h,k,m,n,p,r,u,w,F,B,H,M,aa,xa,na,ja,ra,Ua,bb,ha,ya,kg,cb,lg,mg,Lc,Gj,ng,og;return y(f,function(f){switch(f.l){case 1:m=id;n=T;p=[d];r=n.P(c,"Location").map(n.Ub).filter(m.Ia);0<r.length&&(u=N(p,r),p=b.f=u);w=n.P(c,"BaseURL");F=w.map(n.Ub);B=N(p,F);H=0;w&&w.length&&(H=n.D(w[0],"availabilityTimeOffset",n.parseFloat)||0);M=b.a.dash.ignoreMinBufferTime;aa=0;M||(aa=n.D(c,"minBufferTime",n.Aa));b.w=n.D(c,"minimumUpdatePeriod",n.Aa,-1);xa=n.D(c,"availabilityStartTime",
n.Oe);na=n.D(c,"timeShiftBufferDepth",n.Aa);ja=n.D(c,"maxSegmentDuration",n.Aa);ra=c.getAttribute("type")||"static";Ua=b.a.dash.ignoreSuggestedPresentationDelay;bb=null;Ua||(bb=n.D(c,"suggestedPresentationDelay",n.Aa));b.c?ha=b.c.presentationTimeline:(ya=Math.max(b.a.dash.defaultPresentationDelay,1.5*aa),kg=null!=bb?bb:ya,ha=new X(xa,kg,b.a.dash.autoCorrectDrift));b.c&&b.c.O?(cb=b.c.O,cb.Fa=B):cb=new Gf(B);lg={ob:"static"!=ra,presentationTimeline:ha,ea:null,T:null,W:null,v:null,bandwidth:0,od:!1,
O:cb,nb:H};for(var pg=lg,Hj=[""],Tb=T.D(c,"mediaPresentationDuration",T.Aa),Ub=[],Pa=0,qb=T.P(c,"Period"),Ba=0;Ba<qb.length;Ba++){var Va=qb[Ba];Pa=T.D(Va,"start",T.Aa,Pa);var rb=T.D(Va,"duration",T.Aa),Ca=null;if(Ba!=qb.length-1){var Mc=T.D(qb[Ba+1],"start",T.Aa);null!=Mc&&(Ca=Mc-Pa)}else null!=Tb&&(Ca=Tb-Pa);Mc=ld;Ca&&rb&&Math.abs(Ca-rb)>Mc&&A.j("There is a gap/overlap between Periods",Va);null==Ca&&(Ca=rb);Va=If(b,pg,Hj,{start:Pa,duration:Ca,node:Va,Ec:null==Ca||Ba==qb.length-1});Ub.push(Va);rb=
pg.ea.id;b.o.includes(rb)||(b.o.push(rb),b.c&&(b.b.filterNewPeriod(Va),b.c.periods.push(Va)));if(null==Ca){Ba!=qb.length-1&&A.j("Skipping Period",Ba+1,"and any subsequent Periods:","Period",Ba+1,"does not have a valid start time.",Ub[Ba+1]);Pa=null;break}Pa+=Ca}null==b.c&&b.b.filterAllPeriods(Ub);null!=Tb?(Pa!=Tb&&A.j("@mediaPresentationDuration does not match the total duration of all","Periods."),g=Ub,h=Tb,k=!1):(g=Ub,h=Pa,k=!0);mg=h;Lc=g;ha.Jd("static"==ra);"static"!=ra&&k||ha.$a(mg||Infinity);
ha.Gd(b.m);(Gj=ha.da())&&!isNaN(b.a.availabilityWindowOverride)&&(na=b.a.availabilityWindowOverride);null==na&&(na=Infinity);ha.Id(na);ha.Ic(ja||1);if(b.c){f.l=0;break}b.c={O:cb,presentationTimeline:ha,periods:Lc,offlineSessionIds:[],minBufferTime:aa||0};if(!ha.Md()){f.l=0;break}ng=n.P(c,"UTCTiming");return v(f,Jf(b,B,ng),4);case 4:og=f.N;if(!b.b)return f["return"]();ha.Hd(og);x(f)}})})}
function If(b,c,d,e){c.ea=Kf(e.node,null,d);c.T=e;c.ea.nb=c.nb;c.ea.id||(A.info("No Period ID given for Period with start time "+e.start+",  Assigning a default"),c.ea.id="__shaka_period_"+e.start);T.P(e.node,"EventStream").forEach(b.Pe.bind(b,e.start,e.duration));d=T.P(e.node,"AdaptationSet").map(b.Ne.bind(b,c)).filter(id.Ia);if(c.ob){c=[];for(var f=q(d),g=f.next();!g.done;g=f.next()){g=q(g.value.We);for(var h=g.next();!h.done;h=g.next())c.push(h.value)}if(c.length!=(new Set(c)).size)throw new D(2,
4,4018);}var k=d.filter(function(b){return!b.bd});d.filter(function(b){return b.bd}).forEach(function(b){var c=b.streams[0],d=b.bd;k.forEach(function(b){b.id==d&&b.streams.forEach(function(b){b.trickModeVideo=c})})});c=Lf(k,"video");f=Lf(k,"audio");if(!c.length&&!f.length)throw new D(2,4,4004);d=b.a.disableAudio;if(!f.length||d)f=[null];d=b.a.disableVideo;if(!c.length||d)c=[null];d=[];for(g=0;g<f.length;g++)for(h=0;h<c.length;h++)Mf(b,f[g],c[h],d);c=[];if(!b.a.disableText)for(b=Lf(k,"text"),f=0;f<
b.length;f++)c.push.apply(c,b[f].streams);return{startTime:e.start,textStreams:c,variants:d}}function Lf(b,c){return b.filter(function(b){return b.contentType==c})}
function Mf(b,c,d,e){if(c||d)if(c&&d){var f=c.drmInfos;var g=d.drmInfos;if(f.length&&g.length?0<$c(f,g).length:1){g=$c(c.drmInfos,d.drmInfos);for(var h=0;h<c.streams.length;h++)for(var k=0;k<d.streams.length;k++)f=(d.streams[k].bandwidth||0)+(c.streams[h].bandwidth||0),f={id:b.h++,language:c.language,primary:c.Fc||d.Fc,audio:c.streams[h],video:d.streams[k],bandwidth:f,drmInfos:g,allowedByApplication:!0,allowedByKeySystem:!0},e.push(f)}}else for(g=c||d,h=0;h<g.streams.length;h++)f=g.streams[h].bandwidth||
0,f={id:b.h++,language:g.language||"und",primary:g.Fc,audio:c?g.streams[h]:null,video:d?g.streams[h]:null,bandwidth:f,drmInfos:g.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},e.push(f)}
l.Ne=function(b,c){b.W=Kf(c,b.ea,null);if("image"==b.W.contentType)return A.j("Skipping Image AdaptationSet",b.W),null;var d=!1,e=T.P(c,"Role"),f=e.map(function(b){return b.getAttribute("value")}).filter(id.Ia),g=void 0,h="text"==b.W.contentType;h&&(g="subtitle");for(var k=0;k<e.length;k++){var m=e[k].getAttribute("schemeIdUri");if(null==m||"urn:mpeg:dash:role:2011"==m)switch(m=e[k].getAttribute("value"),m){case "main":d=!0;break;case "caption":case "subtitle":g=m}}var n=null,p=!1;T.P(c,"EssentialProperty").forEach(function(b){"http://dashif.org/guidelines/trickmode"==
b.getAttribute("schemeIdUri")?n=b.getAttribute("value"):p=!0});k=T.P(c,"Accessibility");var r=new Map;e={};k=q(k);for(m=k.next();!m.done;e={Cb:e.Cb},m=k.next()){var u=m.value;m=u.getAttribute("schemeIdUri");u=u.getAttribute("value");"urn:scte:dash:cc:cea-608:2015"==m||"urn:scte:dash:cc:cea-708:2015"==m?(e.Cb=1,null!=u?u.split(";").forEach(function(b){return function(c){if(c.includes("=")){c=c.split("=");var d=c[0].startsWith("CC")?c[0]:"CC"+c[0];c=c[1].split(",")[0].split(":").pop()}else d="CC"+b.Cb,
b.Cb+=2;r.set(d,P(c))}}(e)):r.set("CC1","und")):"urn:mpeg:dash:role:2011"==m&&null!=u&&(f.push(u),"captions"==u&&(g="caption"))}if(p)return null;e=T.P(c,"ContentProtection");var w=Me(e,this.a.dash.customScheme,this.a.dash.ignoreDrmInfo);e=P(c.getAttribute("lang")||"und");k=c.getAttribute("label");(m=T.P(c,"Label"))&&m.length&&(m=m[0],m.textContent&&(k=m.textContent));m=T.P(c,"Representation");f=m.map(this.Qe.bind(this,b,w,g,e,k,d,f,r)).filter(function(b){return!!b});if(0==f.length){if(this.a.dash.ignoreEmptyAdaptationSet||
h)return null;throw new D(2,4,4003);}b.W.contentType&&"application"!=b.W.contentType||(b.W.contentType=Nf(f[0].mimeType,f[0].codecs),f.forEach(function(c){c.type=b.W.contentType}));f.forEach(function(b){w.drmInfos.forEach(function(c){b.keyId&&c.keyIds.push(b.keyId)})});h=m.map(function(b){return b.getAttribute("id")}).filter(id.Ia);return{id:b.W.id||"__fake__"+this.h++,contentType:b.W.contentType,language:e,Fc:d,streams:f,drmInfos:w.drmInfos,bd:n,We:h}};
l.Qe=function(b,c,d,e,f,g,h,k,m){b.v=Kf(m,b.W,null);this.m=Math.min(this.m,b.v.nb);if(!Of(b.v))return A.j("Skipping Representation",b.v),null;b.bandwidth=T.D(m,"bandwidth",T.fc)||0;var n=b.v.contentType;n="text"==n||"application"==n;try{var p=this.Xe.bind(this);if(b.v.Jb)var r=of(b,p);else if(b.v.La)r=rf(b,this.u);else if(b.v.Kb)r=vf(b,p,this.u,!!this.c);else{var u=N(b.O.Fa,b.v.O),w=b.T.duration||0;r={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(b){return 0<=b&&b<
w?1:null},getSegmentReference:function(b){return 1!=b?null:new U(1,0,w,function(){return u},0,null)},initSegmentReference:null,ia:0}}}catch(F){if(n&&4002==F.code)return null;throw F;}m=T.P(m,"ContentProtection");m=Pe(m,this.a.dash.customScheme,c,this.a.dash.ignoreDrmInfo);return{id:this.h++,originalId:b.v.id,createSegmentIndex:r.createSegmentIndex,findSegmentPosition:r.findSegmentPosition,getSegmentReference:r.getSegmentReference,initSegmentReference:r.initSegmentReference,presentationTimeOffset:r.ia,
mimeType:b.v.mimeType,codecs:b.v.codecs,frameRate:b.v.frameRate,pixelAspectRatio:b.v.pixelAspectRatio,bandwidth:b.bandwidth,width:b.v.width,height:b.v.height,kind:d,encrypted:0<c.drmInfos.length,keyId:m,language:e,label:f,type:b.W.contentType,primary:g,trickModeVideo:null,emsgSchemeIdUris:b.v.emsgSchemeIdUris,roles:h,channelsCount:b.v.Kc,audioSamplingRate:b.v.audioSamplingRate,closedCaptions:k}};
function Cf(b){t(function d(){var e,f;return y(d,function(d){switch(d.l){case 1:return A.info("Updating manifest..."),e=0,d.U=2,v(d,Df(b),4);case 4:e=d.N;Da(d,3);break;case 2:f=Ea(d),b.b&&(f.severity=1,b.b.onError(f));case 3:if(!b.b)return d["return"]();Ef(b,e);x(d)}})})}function Ef(b,c){0>b.w||b.i.V(Math.max(3,b.w-c,Ta(b.C)))}
function Kf(b,c,d){c=c||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,Kc:null,audioSamplingRate:null,nb:0};d=d||c.O;var e=T.wb,f=T.Xd,g=T.P(b,"BaseURL"),h=g.map(T.Ub),k=b.getAttribute("contentType")||c.contentType,m=b.getAttribute("mimeType")||c.mimeType,n=b.getAttribute("codecs")||c.codecs;f=T.D(b,"frameRate",f)||c.frameRate;var p=b.getAttribute("sar")||c.pixelAspectRatio,r=T.P(b,"InbandEventStream"),u=c.emsgSchemeIdUris.slice();r=q(r);for(var w=r.next();!w.done;w=r.next())w=
w.value.getAttribute("schemeIdUri"),u.includes(w)||u.push(w);r=T.P(b,"AudioChannelConfiguration");r=Pf(r)||c.Kc;w=T.D(b,"audioSamplingRate",e)||c.audioSamplingRate;k||(k=Nf(m,n));var F=T.Tb(b,"SegmentBase"),B=T.Tb(b,"SegmentTemplate"),H=F?T.D(F,"availabilityTimeOffset",T.parseFloat)||0:0,M=B?T.D(B,"availabilityTimeOffset",T.parseFloat)||0:0;g=g&&g.length?T.D(g[0],"availabilityTimeOffset",T.parseFloat)||0:0;g=c.nb+g+H+M;return{O:N(d,h),Jb:F||c.Jb,La:T.Tb(b,"SegmentList")||c.La,Kb:B||c.Kb,width:T.D(b,
"width",e)||c.width,height:T.D(b,"height",e)||c.height,contentType:k,mimeType:m,codecs:n,frameRate:f,pixelAspectRatio:p,emsgSchemeIdUris:u,id:b.getAttribute("id"),Kc:r,audioSamplingRate:w,nb:g}}
function Pf(b){for(var c=0;c<b.length;++c){var d=b[c],e=d.getAttribute("schemeIdUri");if(e&&(d=d.getAttribute("value")))switch(e){case "urn:mpeg:dash:outputChannelPositionList:2012":return d.trim().split(/ +/).length;case "urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case "urn:dts:dash:audio_channel_configuration:2012":var f=parseInt(d,10);if(!f){A.j("Channel parsing failure! Ignoring scheme and value",e,d);continue}return f;case "tag:dolby.com,2014:dash:audio_channel_configuration:2011":case "urn:dolby:dash:audio_channel_configuration:2011":f=
parseInt(d,16);if(!f){A.j("Channel parsing failure! Ignoring scheme and value",e,d);continue}for(b=0;f;)f&1&&++b,f>>=1;return b;default:A.j("Unrecognized audio channel scheme:",e,d)}}return null}
function Of(b){var c=b.Jb?1:0;c+=b.La?1:0;c+=b.Kb?1:0;if(0==c){if("text"==b.contentType||"application"==b.contentType)return!0;A.j("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',b);return!1}1!=c&&(A.j("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",
b),b.Jb?(A.info("Using SegmentBase by default."),b.La=null):A.info("Using SegmentList by default."),b.Kb=null);return!0}
function Qf(b,c,d,e){c=N(c,[d]);c=Hb(c,b.a.retryParameters);c.method=e;c=b.b.networkingEngine.request(4,c);Eb(b.g,c);return c.promise.then(function(b){if("HEAD"==e){if(!b.headers||!b.headers.date)return A.j("UTC timing response is missing","expected date header"),0;b=b.headers.date}else b=qc(b.data);b=Date.parse(b);return isNaN(b)?(A.j("Unable to parse date from UTC timing response"),0):b-Date.now()})}
function Jf(b,c,d){d=d.map(function(b){return{scheme:b.getAttribute("schemeIdUri"),value:b.getAttribute("value")}});var e=b.a.dash.clockSyncUri;!d.length&&e&&d.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:e});return id.Vd(d,function(b){var d=b.scheme;b=b.value;switch(d){case "urn:mpeg:dash:utc:http-head:2014":case "urn:mpeg:dash:utc:http-head:2012":return Qf(this,c,b,"HEAD");case "urn:mpeg:dash:utc:http-xsdate:2014":case "urn:mpeg:dash:utc:http-iso:2014":case "urn:mpeg:dash:utc:http-xsdate:2012":case "urn:mpeg:dash:utc:http-iso:2012":return Qf(this,
c,b,"GET");case "urn:mpeg:dash:utc:direct:2014":case "urn:mpeg:dash:utc:direct:2012":return d=Date.parse(b),isNaN(d)?0:d-Date.now();case "urn:mpeg:dash:utc:http-ntp:2014":case "urn:mpeg:dash:utc:ntp:2014":case "urn:mpeg:dash:utc:sntp:2014":return A.qa("NTP UTCTiming scheme is not supported"),Promise.reject();default:return A.qa("Unrecognized scheme in UTCTiming element",d),Promise.reject()}}.bind(b))["catch"](function(){A.qa("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!");
return 0})}l.Pe=function(b,c,d){var e=T.wb,f=d.getAttribute("schemeIdUri")||"",g=d.getAttribute("value")||"",h=T.D(d,"timescale",e)||1;T.P(d,"Event").forEach(function(d){var k=T.D(d,"presentationTime",e)||0,n=T.D(d,"duration",e)||0;k=k/h+b;n=k+n/h;null!=c&&(k=Math.min(k,b+c),n=Math.min(n,b+c));d={schemeIdUri:f,value:g,startTime:k,endTime:n,id:d.getAttribute("id")||"",eventElement:d};this.b.onTimelineRegionAdded(d)}.bind(this))};
l.Xe=function(b,c,d){b=Af(b,c,d,this.a.retryParameters);b=this.b.networkingEngine.request(1,b);Eb(this.g,b);return b.promise.then(function(b){return b.data})};function Nf(b,c){return Id(dc(b,c))?"text":b.split("/")[0]}W.Cd("mpd",Bf);W.Qc("application/dash+xml",Bf);W.Qc("video/vnd.mpeg.dash.mpd",Bf);function Rf(b,c){this.a=b;this.b=c}Rf.prototype.toString=function(){return"v"+this.a+"."+this.b};function Sf(b,c){var d=new Rf(2,6),e=Tf,f=e.a,g=d.b-f.b;(0<(d.a-f.a||g)?e.c:e.b)(e.a,d,b,c)}function Uf(b,c,d,e){A.qa([d,"has been deprecated and will be removed in",c,". We are currently at version",b,". Additional information:",e].join(" "))}function Vf(b,c,d,e){A.Pb([d,"has been deprecated and has been removed in",c,". We are now at version",b,". Additional information:",e].join(""))}var Tf=null;function Wf(){this.a=new Map}function Xf(b,c,d){Yf(b,c).text=d}function Yf(b,c){b.a.has(c)||b.a.set(c,new Zf);return b.a.get(c)}function Zf(){this.text=this.variant=null};function $f(b,c){this.a=b;this.b=new Set([b]);c=c||[];for(var d=q(c),e=d.next();!e.done;e=d.next())this.add(e.value)}$f.prototype.add=function(b){if(ag(this.a,b))return this.b.add(b),!0;A.j("Rejecting variant - not compatible with root.");return!1};
function ag(b,c){var d;if(!(d=!!b.audio!=!!c.audio||!!b.video!=!!c.video||b.language!=c.language)&&(d=b.audio&&c.audio)){d=b.audio;var e=c.audio;d=!(d.channelsCount==e.channelsCount&&bg(d,e)&&cg(d.roles,e.roles))}!d&&(d=b.video&&c.video)&&(d=b.video,e=c.video,d=!(bg(d,e)&&cg(d.roles,e.roles)));return d?!1:!0}$f.prototype.values=function(){return this.b.values()};
function bg(b,c){if(b.mimeType!=c.mimeType)return!1;var d=b.codecs.split(",").map(function(b){return gc(b)[0]}),e=c.codecs.split(",").map(function(b){return gc(b)[0]});if(d.length!=e.length)return!1;d.sort();e.sort();for(var f=0;f<d.length;f++)if(d[f]!=e[f])return!1;return!0}function cg(b,c){var d=new Set(b),e=new Set(c);d["delete"]("main");e["delete"]("main");if(d.size!=e.size)return!1;d=q(d);for(var f=d.next();!f.done;f=d.next())if(!e.has(f.value))return!1;return!0};function dg(b){this.a=b;this.b=new eg(b.language,"",b.audio&&b.audio.channelsCount?b.audio.channelsCount:0,"")}dg.prototype.create=function(b){var c=this,d=b.filter(function(b){return ag(c.a,b)});return d.length?new $f(d[0],d):this.b.create(b)};function eg(b,c,d,e,f){this.f=b;this.c=c;this.a=d;this.b=void 0===e?"":e;this.g=void 0===f?"":f}
eg.prototype.create=function(b){var c=[];c=fg(b,this.f);var d=b.filter(function(b){return b.primary});c=c.length?c:d.length?d:b;this.c&&(b=gg(c,this.c,this.g),b.length?c=b:A.j("No exact match for variant role could be found."));this.a&&(b=he(c,this.a),b.length?c=b:A.j("No exact match for the channel count could be found."));this.b&&(b=hg(c,this.b),b.length?c=b:A.j("No exact match for variant label could be found."));b=new $f(c[0]);c=q(c);for(d=c.next();!d.done;d=c.next())d=d.value,ag(b.a,d)&&b.add(d);
return b};function fg(b,c){var d=P(c),e=fe(d,b.map(function(b){return ee(b)}));return e?b.filter(function(b){return e==ee(b)}):[]}function gg(b,c,d){return b.filter(function(b){if(d){var e=b[d];return e&&e.roles.includes(c)}e=b.audio;b=b.video;return e&&0<=e.roles.indexOf(c)||b&&0<=b.roles.indexOf(c)})}function hg(b,c){return b.filter(function(b){return b.audio?b.audio.label.toLowerCase()==c.toLowerCase():!1})};function ig(){this.a=jg;this.b=(new Map).set(jg,2).set(qg,1)}function rg(b,c,d){b.b.set(jg,d).set(qg,c)}var qg=0,jg=1;function sg(b,c){this.g=b;this.h=tg(b);this.a=b.a.currentTime;this.f=Date.now()/1E3;this.b=!1;this.i=c;this.c=function(){}}sg.prototype.release=function(){this.g=null;this.c=function(){}};function ug(b,c){b.c=c}function vg(b){this.a=b}function tg(b){if(b.a.paused||0==b.a.playbackRate||0==b.a.buffered.length)var c=!1;else a:{c=b.a.buffered;b=b.a.currentTime;for(var d=0;d<c.length;d++){var e=c.start(d),f=c.end(d);if(!(b<e-.1||b>f-.5)){c=!0;break a}}c=!1}return c};function wg(b,c,d,e,f){var g=this;this.a=b;this.w=c;this.u=d;this.m=f;this.f=new K;this.i=!1;this.o=b.readyState;this.c=!1;this.b=e;this.h=!1;this.f.B(b,"waiting",function(){return xg(g)});this.g=(new C(function(){xg(g)})).Ca(.25)}wg.prototype.release=function(){this.f&&(this.f.release(),this.f=null);null!=this.g&&(this.g.stop(),this.g=null);this.b&&(this.b.release(),this.b=null);this.a=this.w=this.m=null};wg.prototype.Mc=function(){this.h=!0;xg(this)};
function xg(b){if(0!=b.a.readyState){if(b.a.seeking){if(!b.i)return}else b.i=!1;if(!b.a.paused){b.a.readyState!=b.o&&(b.c=!1,b.o=b.a.readyState);var c;if(!(c=!b.b)){c=b.b;var d=c.g,e=tg(d),f=d.a.currentTime,g=Date.now()/1E3;if(c.a!=f||c.h!=e)c.f=g,c.a=f,c.h=e,c.b=!1;f=g-c.f;if(e=f>=c.i&&e&&!c.b)c.c(c.a,f),c.b=!0,c.a=d.a.currentTime;c=!e}if(c){var h=b.u.smallGapLimit;c=b.a.currentTime;d=b.a.buffered;a:{if(d&&d.length&&!(1==d.length&&1E-6>d.end(0)-d.start(0)))for(e=kc()||mc("Trident/")||mc("Tizen")||
mc("CrKey")?.5:.1,f=0;f<d.length;f++)if(d.start(f)>c&&(0==f||d.end(f-1)-c<=e)){e=f;break a}e=null}if(!(null==e||0==e&&!b.h||(f=d.start(e),f>=b.w.za()))){g=f-c;h=g<=h;var k=!1;if(!(.001>g)){if(!h&&!b.c){b.c=!0;var m=new I("largegap",{currentTime:c,gapSize:g});m.cancelable=!0;b.m(m);b.u.jumpLargeGaps&&!m.defaultPrevented?k=!0:A.info("Ignoring large gap at",c,"size",g)}if(h||k)0==e?A.info("Jumping forward",g,"seconds because of gap before start time of",f):A.info("Jumping forward",g,"seconds because of gap starting at",
d.end(e-1),"and ending at",f),b.a.currentTime=f}}}}}};function yg(b){var c=this;this.c=b;this.a=new Set;this.b=(new C(function(){zg(c,!1)})).Ca(.25)}yg.prototype.release=function(){this.b.stop();for(var b=q(this.a),c=b.next();!c.done;c=b.next())c.value.release();this.a.clear()};function zg(b,c){for(var d=q(b.a),e=d.next();!e.done;e=d.next())e.value.g(b.c.currentTime,c)};function Ag(b){var c=[];b=q(b);for(var d=b.next();!d.done;d=b.next()){d=q(d.value.variants);for(var e=d.next();!e.done;e=d.next())c.push(e.value)}return c}function Bg(b,c){for(var d=null,e=q(b),f=e.next();!f.done;f=e.next())f=f.value,c>=f.startTime&&(d=f);return d};function Cg(b){this.c=b;this.a=null;this.b=function(){}}Cg.prototype.release=function(){this.a=this.c=null;this.b=function(){}};Cg.prototype.g=function(b){var c=this.a,d=this.c.periods;b=Bg(d,b)||d[0];c!=b&&this.b(b);this.a=b};function Dg(b,c){b.b=c};function Eg(b){var c=this;this.a=b;this.f=!1;this.c=this.a.Vb();this.b=new C(function(){c.a.qd(.25*c.c)})}Eg.prototype.release=function(){this.b&&(this.b.stop(),this.b=null);this.a=null};Eg.prototype.set=function(b){this.c=b;Fg(this)};function Fg(b){b.b.stop();var c=b.f?0:b.c;if(0<=c)try{b.a.Vb()!=c&&b.a.Xc(c);return}catch(d){}b.b.Ca(.25);0!=b.a.Vb()&&b.a.Xc(0)};/*

 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function Gg(b,c,d,e){c==HTMLMediaElement.HAVE_NOTHING||b.readyState>=c?e():(c=Hg.get(c),d.oa(b,c,e))}var Hg=new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]]);function Ig(b,c,d){var e=this;this.a=b;this.g=c;this.f=d;this.h=!1;this.b=new K;this.c=new Jg(b);Gg(this.a,HTMLMediaElement.HAVE_METADATA,this.b,function(){Kg(e,e.f)})}Ig.prototype.release=function(){this.b&&(this.b.release(),this.b=null);null!=this.c&&(this.c.release(),this.c=null);this.g=function(){};this.a=null};function Lg(b){return b.h?b.a.currentTime:b.f}function Mg(b,c){0<b.a.readyState?Ng(b.c,c):Gg(b.a,HTMLMediaElement.HAVE_METADATA,b.b,function(){Kg(b,b.f)})}
function Kg(b,c){.001>Math.abs(b.a.currentTime-c)?Og(b):(b.b.oa(b.a,"seeking",function(){Og(b)}),Ng(b.c,0==b.a.currentTime?c:b.a.currentTime))}function Og(b){b.h=!0;b.b.B(b.a,"seeking",function(){return b.g()})}function Jg(b){var c=this;this.b=b;this.h=10;this.g=this.c=this.f=0;this.a=new C(function(){0>=c.f?(A.j(["Failed to move playhead from",c.c,"to",c.g].join(" ")),c.a.stop()):c.b.currentTime!=c.c?c.a.stop():(c.b.currentTime=c.g,c.f--)})}
Jg.prototype.release=function(){this.a&&(this.a.stop(),this.a=null);this.b=null};function Ng(b,c){b.c=b.b.currentTime;b.g=c;b.f=b.h;b.b.currentTime=c;b.a.Ca(.1)};function Pg(b){function c(){null==d.c?d.f=!0:(d.b.oa(d.a,"seeking",function(){d.f=!0}),d.a.currentTime=Math.max(0,d.a.currentTime+d.c))}var d=this;this.a=b;this.f=!1;this.c=null;this.b=new K;Gg(this.a,HTMLMediaElement.HAVE_CURRENT_DATA,this.b,function(){c()})}Pg.prototype.release=function(){this.b&&(this.b.release(),this.b=null);this.a=null};Pg.prototype.o=function(b){this.c=this.f?this.c:b};Pg.prototype.g=function(){return(this.f?this.a.currentTime:this.c)||0};Pg.prototype.u=function(){};
function Qg(b,c,d,e,f,g){var h=this;this.c=b;this.a=c.presentationTimeline;this.C=c.minBufferTime||0;this.h=d;this.w=f;this.m=null;this.f=new wg(b,c.presentationTimeline,d,Rg(b,d),g);this.b=new Ig(b,function(){a:{var b=h.f;b.i=!0;b.h=!1;b.c=!1;b=Lg(h.b);var c=Sg(h,b);if(.001<Math.abs(c-b)){var d=Date.now()/1E3;if(!h.m||h.m<d-1){h.m=d;Mg(h.b,c);b=void 0;break a}}A.A("Seek to "+b);h.w();b=void 0}return b},Tg(this,e));this.i=(new C(function(){if(0!=h.c.readyState&&!h.c.paused){var b=Lg(h.b),c=h.a.pb(),
d=h.a.za();3>d-c&&(c=d-3);b<c&&(c=Sg(h,b),A.info("Jumping forward "+(c-b)+" seconds to catch up with the seek range."),h.c.currentTime=c)}})).Ca(.25)}Qg.prototype.release=function(){this.b&&(this.b.release(),this.b=null);this.f&&(this.f.release(),this.f=null);this.i&&(this.i.stop(),this.i=null);this.c=this.b=this.a=this.h=null;this.w=function(){}};Qg.prototype.o=function(b){Mg(this.b,b)};Qg.prototype.g=function(){var b=Lg(this.b);return 0<this.c.readyState&&!this.c.paused?Ug(this,b):b};
function Tg(b,c){null==c?c=Infinity>b.a.ba()?b.a.pb():b.a.za():0>c&&(c=b.a.za()+c);return Vg(b,Ug(b,c))}Qg.prototype.u=function(){this.f.Mc()};function Vg(b,c){var d=b.a.ba();return c>=d?d-b.h.durationBackoff:c}
function Sg(b,c){var d=fd.bind(null,b.c.buffered),e=Math.max(b.C,b.h.rebufferingGoal),f=b.h.safeSeekOffset,g=b.a.pb(),h=b.a.za(),k=b.a.ba();3>h-g&&(g=h-3);var m=b.a.Db(e),n=b.a.Db(f);e=b.a.Db(e+f);if(c>=k)return A.A("Playhead past duration."),Vg(b,c);if(c>h)return A.A("Playhead past end."),h;if(c<g){if(d(n))return A.A("Playhead before start & start is buffered"),n;A.A("Playhead before start & start is unbuffered");return e}if(c>=m||d(c))return A.A("Playhead in safe region or in buffered region."),
c;A.A("Playhead outside safe region & in unbuffered region.");return e}function Ug(b,c){var d=b.a.pb();if(c<d)return d;d=b.a.za();return c>d?d:c}function Rg(b,c){if(!c.stallEnabled)return null;var d=c.stallSkip,e=new sg(new vg(b),c.stallThreshold);ug(e,function(c,e){A.debug("Stall detected at "+c+" for "+e+" seconds.");d?(A.debug("Seeking forward "+d+" seconds to break stall."),b.currentTime+=d):(A.debug("Pausing and unpausing to break stall."),b.pause(),b.play())});return e};function Wg(b){var c=this;this.b=function(){};this.a=new Set;this.f=b;this.c=(new C(function(){for(var b=c.f(),e=q(c.a),f=e.next();!f.done;f=e.next())f=f.value,f.endTime<b.start&&c.a["delete"](f)})).Ca(2)}Wg.prototype.release=function(){this.b=function(){};this.a.clear();this.c.stop()};function Xg(b,c){b.b=c};function Yg(b){var c=this;this.h=b;this.f=new Map;this.a=function(){};this.b=function(){};this.c=function(){};this.i=[{eb:null,cb:Zg,Ua:function(b,e){return c.a(b,e)}},{eb:$g,cb:Zg,Ua:function(b,e){return c.a(b,e)}},{eb:ah,cb:Zg,Ua:function(b,e){return c.a(b,e)}},{eb:Zg,cb:$g,Ua:function(b,e){return c.b(b,e)}},{eb:Zg,cb:ah,Ua:function(b,e){return c.b(b,e)}},{eb:$g,cb:ah,Ua:function(b,e){return c.c(b,e)}},{eb:ah,cb:$g,Ua:function(b,e){return c.c(b,e)}}]}
Yg.prototype.release=function(){this.h=null;this.f.clear();this.a=function(){};this.b=function(){};this.c=function(){}};Yg.prototype.g=function(b,c){for(var d=q(this.h.a),e=d.next();!e.done;e=d.next()){e=e.value;var f=this.f.get(e),g=b<e.startTime?$g:b>e.endTime?ah:Zg;this.f.set(e,g);for(var h=q(this.i),k=h.next();!k.done;k=h.next())k=k.value,k.eb==f&&k.cb==g&&k.Ua(e,c)}};function bh(b,c,d,e){b.a=c;b.b=d;b.c=e}var $g=1,Zg=2,ah=3;function ch(b,c){this.a=c;this.c=b;this.g=null;this.m=1;this.w=Promise.resolve();this.h=[];this.i=new Map;this.b=new Map;this.u=!1;this.M=null;this.L=this.f=this.o=!1;this.C=0}ch.prototype.destroy=function(){var b=this;return t(function d(){var e,f;return y(d,function(d){switch(d.l){case 1:e=[];for(var g=q(b.b.values()),k=g.next();!k.done;k=g.next())f=k.value,dh(f),e.push(eh(f));return v(d,Promise.all(e),2);case 2:b.b.clear(),b.i.clear(),b.a=null,b.c=null,b.w=null,b.h=null,b.g=null,b.f=!0,x(d)}})})};
ch.prototype.configure=function(b){this.g=b;this.M=new nb({maxAttempts:Math.max(b.retryParameters.maxAttempts,2),baseDelay:b.retryParameters.baseDelay,backoffFactor:b.retryParameters.backoffFactor,fuzzFactor:b.retryParameters.fuzzFactor,timeout:0},!0)};
ch.prototype.start=function(){var b=this;return t(function d(){var e,f,g;return y(d,function(d){switch(d.l){case 1:return e=b.a.Sa(),f=fh(b,e),g=b.a.td(b.c.periods[f]),g.variant||g.text?v(d,gh(b,g.variant?g.variant.audio:null,g.variant?g.variant.video:null,g.text,e),2):(A.error("init: no Streams chosen"),d["return"](new D(2,5,5005)));case 2:if(b.f)return d["return"]();A.debug("init: completed initial Stream setup");b.a&&b.a.Be&&(A.A("init: calling onInitialStreamsSetup()..."),b.a.Be());x(d)}})})};
function hh(b){return ih(b,"audio")}function jh(b){return ih(b,"video")}function ih(b,c){var d=b.b.get(c);return d?d.Ka||d.stream:null}
function kh(b,c){return t(function e(){var f,g,h,k,m,n,p,r,u,w;return y(e,function(e){switch(e.l){case 1:return f=kd,v(e,Yd(b.a.I,f.xa),2);case 2:return b.C++,b.L=!1,g=b.C,h=b.a.I,k=new Map,m=new Set,k.set(f.xa,c),m.add(c),v(e,h.init(k,!1),3);case 3:return b.f?e["return"]():v(e,lh(b,m),4);case 4:if(b.f)return e["return"]();p=(n=b.a.I.g.isTextVisible())||b.g.alwaysStreamText;b.C!=g||b.b.has(f.xa)||b.L||!p||(r=b.a.Sa(),u=fh(b,r),w=mh(c,u,0),b.b.set(f.xa,w),nh(b,w,0));x(e)}})})}
function oh(b){b.L=!0;var c=b.b.get("text");c&&(dh(c),eh(c)["catch"](function(){}),b.b["delete"]("text"))}function ph(b,c){var d=b.b.get("video");if(d){var e=d.stream;if(e)if(A.debug("setTrickPlay",c),c){var f=e.trickModeVideo;f&&!d.Ka&&(A.debug("Engaging trick mode stream",f),qh(b,f,!1,0,!1),d.Ka=e)}else if(e=d.Ka)A.debug("Restoring non-trick-mode stream",e),d.Ka=null,qh(b,e,!0,0,!1)}}
function rh(b,c,d,e){var f=!1;if(c.video){var g=qh(b,c.video,d,e,!1);f=f||g}c.audio&&(b=qh(b,c.audio,d,e,!1),f=f||b);return f}
function qh(b,c,d,e,f){var g=b.b.get(c.type);if(!g&&"text"==c.type&&b.g.ignoreTextStreamFailures)return kh(b,c),!0;if(!g)return!1;var h=sh(b,c),k=Array.from(b.b.values()).every(function(b){return b.ha==g.ha});if(d&&h!=g.ha&&k)return A.debug("switch: switching to stream in another Period; clearing buffer and changing Periods"),b.b.forEach(function(c){th(b,c)}),!0;g.Ka&&(A.debug("switch during trick play mode",c),c.trickModeVideo?(g.Ka=c,c=c.trickModeVideo,A.debug("switch found trick play stream",c)):
(g.Ka=null,A.debug("switch found no special trick play stream")));k=b.h[h];if(!k||!k.zb)return!1;k=b.i.get(c.id);if(!k||!k.zb)return!1;if(g.stream==c&&!f)return A.debug("switch: Stream "+Y(g)+" already active"),!1;"text"==c.type&&Pd(b.a.I,dc(c.mimeType,c.codecs));g.stream=c;g.Zb=!0;A.debug("switch: switching to Stream "+Y(g));uh(b,g,h)&&(A.info("Aborting current segment request to switch."),g.Ya.abort());d&&(g.Qa?g.jc=!0:g.Ja?(g.Oa=!0,g.Rb=e,g.jc=!0):(dh(g),vh(b,g,!0,e)["catch"](function(c){if(b.a)b.a.onError(c)})));
return!0}function uh(b,c,d){if(!c.Ya)return!1;var e=b.a.Sa(),f=Td(b.a.I,c.type),g=wh(b,c,e,f,d);d=g?g.a?g.a-g.b:null:null;g&&!d&&(d=(g.endTime-g.Cc())*c.stream.bandwidth/8);if(isNaN(d))return!1;(g=c.stream.initSegmentReference)&&(d+=(g.a?g.a-g.b:null)||0);g=b.a.getBandwidthEstimate();return 8*d/g<f-e-Math.max(b.c.minBufferTime||0,b.g.rebufferingGoal)||c.Ya.b.a>d?!0:!1}
function xh(b){function c(c){var f=b.a.I;"text"==c?(c=f.a,c=null==c.a||null==c.b?!1:d>=c.a&&d<c.b):(c=Sd(f,c),c=fd(c,d,e));return c}var d=b.a.Sa(),e=b.g.smallGapLimit,f=!1,g=fh(b,d);if(ac(b.b.values(),function(b){return b.ha==g}))for(var h=q(b.b.keys()),k=h.next();!k.done;k=h.next())k=k.value,c(k)||(th(b,b.b.get(k)),f=!0);else ac(b.b.keys(),c)||(A.debug("(all): seeked: unbuffered seek: clearing all buffers"),b.b.forEach(function(c){th(b,c)}),f=!0);f||A.debug("(all): seeked: buffered seek: presentationTime="+
d)}function th(b,c){var d=Y(c);c.Qa?A.debug(d,"clear: already clearing the buffer"):c.Oa?A.debug(d,"clear: already waiting"):c.Ja?(A.debug(d,"clear: currently updating"),c.Oa=!0,c.Rb=0):null==Rd(b.a.I,c.type)?(A.debug(d,"clear: nothing buffered"),null==c.Da&&nh(b,c,0)):(A.debug(d,"clear: handling right now"),dh(c),vh(b,c,!1,0)["catch"](function(c){if(b.a)b.a.onError(c)}))}
function gh(b,c,d,e,f){return t(function h(){var k,m,n,p,r,u,w;return y(h,function(h){switch(h.l){case 1:return k=b.a.Sa(),m=fh(b,k),n=kd,p=new Map,r=new Set,c&&(p.set(n.Nd,c),r.add(c)),d&&(p.set(n.dd,d),r.add(d)),e&&(p.set(n.xa,e),r.add(e)),u=b.a.I,w=b.g.forceTransmuxTS,v(h,u.init(p,w),2);case 2:if(b.f)return h["return"]();yh(b);return v(h,lh(b,r),3);case 3:if(b.f)return h["return"]();p.forEach(function(c,d){if(!b.b.has(d)){var e=mh(c,m,f);b.b.set(d,e);nh(b,e,0)}});x(h)}})})}
function mh(b,c,d){return{stream:b,type:b.type,Va:null,va:null,Ka:null,Zb:!0,ha:c,endOfStream:!1,Ja:!1,Da:null,Oa:!1,Rb:0,jc:!1,Qa:!1,Pc:!1,Eb:!1,Sc:d||0,Ya:null}}
function zh(b,c){var d=b.h[c];if(d)return A.debug("(all) Period "+c+" is being or has been set up"),d.promise;A.debug("(all) setting up Period "+c);d={promise:new E,zb:!1};b.h[c]=d;for(var e=new Set,f=q(b.c.periods[c].variants),g=f.next();!g.done;g=f.next())g=g.value,g.video&&e.add(g.video),g.video&&g.video.trickModeVideo&&e.add(g.video.trickModeVideo),g.audio&&e.add(g.audio);f=q(b.c.periods[c].textStreams);for(g=f.next();!g.done;g=f.next())e.add(g.value);b.w=b.w.then(function(){if(!this.f)return lh(this,
e)}.bind(b)).then(function(){this.f||(this.h[c].promise.resolve(),this.h[c].zb=!0,A.A("(all) setup Period "+c))}.bind(b))["catch"](function(b){this.f||(this.h[c].promise["catch"](function(){}),this.h[c].promise.reject(),delete this.h[c],A.j("(all) failed to setup Period "+c),this.a.onError(b))}.bind(b));return d.promise}
function lh(b,c){return t(function e(){var f,g,h,k,m,n,p;return y(e,function(e){switch(e.l){case 1:f=[];for(var r=q(c),w=r.next();!w.done;w=r.next())g=w.value,(h=b.i.get(g.id))?(A.debug("(all) Stream "+g.id+" is being or has been set up"),f.push(h.promise)):(A.A("(all) setting up Stream "+g.id),b.i.set(g.id,{promise:new E,zb:!1}),f.push(g.createSegmentIndex()));e.U=2;return v(e,Promise.all(f),4);case 4:if(b.f)return e["return"]();Da(e,3);break;case 2:k=Ea(e);if(b.f)return e["return"]();e=q(c);for(w=
e.next();!w.done;w=e.next())m=w.value,b.i.get(m.id).promise["catch"](function(){}),b.i.get(m.id).promise.reject(),b.i["delete"](m.id);throw k;case 3:r=q(c);for(w=r.next();!w.done;w=r.next())n=w.value,p=b.i.get(n.id),p.zb||(p.promise.resolve(),p.zb=!0,A.A("(all) setup Stream "+n.id));x(e)}})})}function yh(b){var c=b.c.presentationTimeline.ba();Infinity>c?b.a.I.$a(c):b.a.I.$a(Math.pow(2,32))}
function Ah(b,c){if(!b.f){var d=Y(c);if(!c.Ja&&null!=c.Da&&!c.Qa)if(c.Da=null,c.Oa)A.debug(d,"skipping update and clearing the buffer"),vh(b,c,c.jc,c.Rb);else{try{var e=Bh(b,c);null!=e&&(nh(b,c,e),c.Eb=!1)}catch(f){Ch(b,f);return}e=Array.from(b.b.values());Dh(b,c);b.u&&e.every(function(b){return b.endOfStream})&&(A.A(d,"calling endOfStream()..."),b.a.I.endOfStream().then(function(){if(!this.f){var b=this.a.I.ba();0!=b&&b<this.c.presentationTimeline.ba()&&this.c.presentationTimeline.$a(b)}}.bind(b)))}}}
function Bh(b,c){if(Eh(c))return Xd(b.a.I,c.stream.originalId||""),null;var d=Y(c),e=b.a.Sa(),f=Fh(b,c,e);A.H(d,"timeNeeded="+f);var g=sh(b,c.stream),h=fh(b,f),k=Ud(b.a.I,c.type,e);A.H(d,"update_:","presentationTime="+e,"bufferedAhead="+k);var m=Math.max(b.c.minBufferTime||0,b.g.rebufferingGoal,b.g.bufferingGoal)*b.m;if(f>=b.c.presentationTimeline.ba())return A.debug(d,"buffered to end of presentation"),c.endOfStream=!0,"video"==c.type&&(f=b.b.get("text"))&&"application/cea-608"==f.stream.mimeType&&
(f.endOfStream=!0),null;c.endOfStream=!1;c.ha=h;if(h!=g)return A.debug(d,"need Period "+h,"presentationTime="+e,"timeNeeded="+f,"currentPeriodIndex="+g),null;if(k>=m)return A.H(d,"buffering goal met"),.5;d=Td(b.a.I,c.type);d=wh(b,c,e,d,g);if(!d)return 1;var n=Infinity;Array.from(b.b.values()).forEach(function(c){Eh(c)||(c=Fh(b,c,e),n=Math.min(n,c))});if(f>=n+b.c.presentationTimeline.a)return 1;c.Sc=0;Gh(b,c,e,g,d);return null}
function Fh(b,c,d){if(!c.Va||!c.va)return Math.max(d,c.Sc);d=sh(b,c.Va);return b.c.periods[d].startTime+c.va.endTime}function wh(b,c,d,e,f){var g=Y(c);if(c.va&&c.stream==c.Va)return d=c.va.position+1,A.H(g,"next position known:","position="+d),Hh(b,c,f,d);c.va?(A.A(g,"next position unknown: another Stream buffered"),g=sh(b,c.Va),g=Ih(b,c,b.c.periods[g].startTime+c.va.endTime,f)):(A.A(g,"next position unknown: nothing buffered"),g=Ih(b,c,e||d,f));return null==g?null:Hh(b,c,f,g)}
function Ih(b,c,d,e){var f=Y(c);b=b.c.periods[e];A.debug(f,"looking up segment:","presentationTime="+d,"currentPeriod.startTime="+b.startTime);d=Math.max(0,d-b.startTime);c=c.stream.findSegmentPosition(d);null==c&&A.j(f,"cannot find segment:","currentPeriod.startTime="+b.startTime,"lookupTime="+d);return c}
function Hh(b,c,d,e){var f=Y(c);d=b.c.periods[d];c=c.stream.getSegmentReference(e);if(!c)return A.A(f,"segment does not exist:","currentPeriod.startTime="+d.startTime,"position="+e),null;e=b.c.presentationTimeline;b=e.Wb();e=e.qb();return d.startTime+c.endTime<b||d.startTime+c.startTime>e?(A.H(f,"segment is not available:","currentPeriod.startTime="+d.startTime,"reference.startTime="+c.startTime,"reference.endTime="+c.endTime,"availabilityStart="+b,"availabilityEnd="+e),null):c}
function Gh(b,c,d,e,f){t(function h(){var k,m,n,p,r,u,w,F,B,H,M,aa,xa,na,ja,ra,Ua,bb,ha,ya;return y(h,function(h){switch(h.l){case 1:return k=kd,m=Y(c),n=b.c.periods[e],A.A(m,"fetchAndAppend_:","presentationTime="+d,"currentPeriod.startTime="+n.startTime,"reference.position="+f.position,"reference.startTime="+f.startTime,"reference.endTime="+f.endTime),p=c.stream,r=b.c.presentationTimeline.ba(),u=b.c.periods[e+1],w=Math.max(0,n.startTime-.1),F=u?u.startTime+.01:r,B=Jh(b,c,e,w,F),c.Ja=!0,c.Zb=!1,A.H(m,
"fetching segment"),H=function(){return b.f||b.o},M=[],aa=!1,na=xa=0,ja=new Uint8Array(0),ra=function(e,h){return t(function Lc(){var k,m;return y(Lc,function(r){switch(r.l){case 1:return k=xa,v(r,B,2);case 2:return v(r,Promise.all(M),3);case 3:if(H()||aa&&!h||k!==xa)return r["return"]();if(h){if(na===e.byteLength)return r["return"]()}else na+=e.byteLength;m=Kh(b,c,d,n,p,f,e);M.push(m);return r["return"](m)}})})},Ua=function(b){ja=Lh(ja,b);var c=!1,d=0;(new S).J("mdat",function(b){d=b.size+b.start;
c=!0}).parse(ja,!1,!0);c&&(b=ja.subarray(0,d),ja=ja.subarray(d),ra(b,!1)["catch"](function(){}))},bb=function(){ja=new Uint8Array(0);M=[];xa++;na=0},h.U=2,v(h,Mh(b,c,p,f,Ua,bb),4);case 4:ha=h.N;if(H())return h["return"]();aa=!0;return v(h,ra(ha,!0),5);case 5:if(H())return h["return"]();c.Ja=!1;c.Pc=!1;c.Va=p;c.va=f;c.Oa||b.a.Mc();nh(b,c,0);Nh(b,c,p);A.A(m,"finished fetch and append");Da(h,0);break;case 2:ya=Ea(h);if(b.f||b.o)return h["return"]();c.Ja=!1;c.type==k.xa&&b.g.ignoreTextStreamFailures?
(1001==ya.code?A.j(m,"Text stream failed to download. Proceeding without it."):A.j(m,"Text stream failed to parse. Proceeding without it."),b.b["delete"](k.xa)):7001==ya.code?(c.Ja=!1,c.Da=null,nh(b,c,0)):3017==ya.code?Oh(b,c,ya):(A.error(m,"failed fetch and append: code="+ya.code),c.Eb=!0,ya.severity=2,Ch(b,ya));x(h)}})})}function Lh(b,c){var d=new Uint8Array(b.length+c.length);d.set(b);d.set(c,b.length);return d}
function Oh(b,c,d){var e=Y(c);if(Array.from(b.b.values()).some(function(b){return b!=c&&b.Pc}))A.debug(e,"MediaSource threw QuotaExceededError:","waiting for another stream to recover...");else{var f=Math.round(100*b.m);if(20<f)b.m-=.2;else if(4<f)b.m-=.04;else{A.error(e,"MediaSource threw QuotaExceededError too many times");c.Eb=!0;b.o=!0;b.a.onError(d);return}A.j(e,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-Math.round(100*b.m))+"%");c.Pc=!0}nh(b,c,4)}
function Jh(b,c,d,e,f){if(!c.Zb)return Promise.resolve();var g=Y(c);d=b.c.periods[d].startTime-c.stream.presentationTimeOffset;A.A(g,"setting timestamp offset to "+d);A.A(g,"setting append window start to "+e);A.A(g,"setting append window end to "+f);e=Zd(b.a.I,c.type,d,e,f);if(!c.stream.initSegmentReference)return e;A.A(g,"fetching init segment");b=Mh(b,c,c.stream,c.stream.initSegmentReference).then(function(b){if(!this.f)return A.A(g,"appending init segment"),Vd(this.a.I,c.type,b,null,null,c.stream.closedCaptions&&
0<c.stream.closedCaptions.size)}.bind(b))["catch"](function(b){c.Zb=!0;return Promise.reject(b)});return Promise.all([e,b])}
function Kh(b,c,d,e,f,g,h){var k=Y(c),m=f.closedCaptions&&0<f.closedCaptions.size;null!=f.emsgSchemeIdUris&&0<f.emsgSchemeIdUris.length&&(new S).sa("emsg",b.S.bind(b,e,g,f.emsgSchemeIdUris)).parse(h);return Ph(b,c,d).then(function(){if(!this.f)return A.A(k,"appending media segment"),Vd(this.a.I,c.type,h,g.startTime+e.startTime,g.endTime+e.startTime,m)}.bind(b)).then(function(){if(!this.f)return A.H(k,"appended media segment"),c.Va=f,c.va=g,Promise.resolve()}.bind(b))}
ch.prototype.S=function(b,c,d,e){var f=e.reader.Nc(),g=e.reader.Nc(),h=e.reader.G(),k=e.reader.G(),m=e.reader.G(),n=e.reader.G();e=e.reader.Za(e.reader.F.byteLength-e.reader.ca());b=b.startTime+c.startTime+k/h;if(d.includes(f))if("urn:mpeg:dash:event:2012"==f)this.a.Ce();else this.a.onEvent(new I("emsg",{detail:{startTime:b,endTime:b+m/h,schemeIdUri:f,value:g,timescale:h,presentationTimeDelta:k,eventDuration:m,id:n,messageData:e}}))};
function Ph(b,c,d){var e=Y(c);A.H(e,"checking buffer length");var f=Math.max(b.g.bufferBehind,b.c.presentationTimeline.a),g=Rd(b.a.I,c.type);if(null==g)return A.H(e,"buffer behind okay because nothing buffered:","presentationTime="+d,"bufferBehind="+f),Promise.resolve();var h=d-g,k=h-f;if(0>=k)return A.H(e,"buffer behind okay:","presentationTime="+d,"bufferedBehind="+h,"bufferBehind="+f,"underflow="+-k),Promise.resolve();A.A(e,"buffer behind too large:","presentationTime="+d,"bufferedBehind="+h,"bufferBehind="+
f,"overflow="+k);return b.a.I.remove(c.type,g,g+k).then(function(){this.f||A.A(e,"evicted "+k+" seconds")}.bind(b))}
function Nh(b,c,d){if(!b.u){var e=Y(c);c=Array.from(b.b.values());if(1!=c.length||"text"!=c[0].type)b.u=c.every(function(b){return"text"==b.type?!0:!b.Oa&&!b.Qa&&b.va});if(b.u){A.debug(e,"startup complete");d=sh(b,d);b.h[d]||zh(b,d).then(function(){this.f||(A.A(e,"calling onCanSwitch()..."),this.a.sd())}.bind(b))["catch"](id.ac);for(d=0;d<b.c.periods.length;++d)zh(b,d)["catch"](id.ac);b.a.Ie&&(A.A(e,"calling onStartupComplete()..."),b.a.Ie())}}}
function Dh(b,c){var d=Y(c),e=sh(b,c.stream);if(c.ha!=e){var f=c.ha,g=Array.from(b.b.values());g.every(function(b){return b.ha==f||Eh(b)})?g.every(Qh)?(A.debug(d,"all need Period "+f),zh(b,f).then(function(){if(!this.f)if(g.every(function(b){var c=Qh(b),d=sh(this,b.stream);return Eh(b)?!0:c&&b.ha==f&&d!=f}.bind(this))){var b=this.c.periods[f];A.A(d,"calling onChooseStreams()...");var c=this.a.td(b),e=new Map;c.variant&&c.variant.video&&e.set("video",c.variant.video);c.variant&&c.variant.audio&&e.set("audio",
c.variant.audio);c.text&&e.set("text",c.text);c=q(this.b.keys());for(var n=c.next();!n.done;n=c.next())if(n=n.value,!e.has(n)&&"text"!=n){A.error(d,"invalid Streams chosen: missing "+n+" Stream");this.a.onError(new D(2,5,5005));return}c=q(Array.from(e.keys()));for(n=c.next();!n.done;n=c.next())if(n=n.value,!this.b.has(n))if("text"==n)gh(this,null,null,e.get("text"),b.startTime),e["delete"](n);else{A.error(d,"invalid Streams chosen: unusable "+n+" Stream");this.a.onError(new D(2,5,5005));return}c=
q(Array.from(this.b.keys()));for(n=c.next();!n.done;n=c.next()){n=n.value;var p=this.b.get(n),r=e.get(n);if(r){var u=Eh(p);u&&(p.ha=f,p.Sc=b.startTime);qh(this,r,!1,0,!1);u&&Eh(p)||nh(this,this.b.get(n),0)}else this.b["delete"](n)}A.A(d,"calling onCanSwitch()...");this.a.sd()}else A.debug(d,"ignoring transition to Period",f,"since another is happening")}.bind(b))["catch"](id.ac)):A.debug(d,"all MediaStates need Period "+f+", but not all MediaStates are idle"):A.debug(d,"not all MediaStates need Period "+
f)}}function Eh(b){return b&&"text"==b.type&&"application/cea-608"==b.stream.mimeType}function Qh(b){return!b.Ja&&null==b.Da&&!b.Oa&&!b.Qa}function fh(b,c){var d=Bg(b.c.periods,c+ld);return d?b.c.periods.indexOf(d):0}
function sh(b,c){for(var d=b.c.periods,e=0;e<d.length;e++){for(var f=d[e],g=new Set,h=q(f.variants),k=h.next();!k.done;k=h.next())k=k.value,k.audio&&g.add(k.audio),k.video&&g.add(k.video),k.video&&k.video.trickModeVideo&&g.add(k.video.trickModeVideo);f=q(f.textStreams);for(h=f.next();!h.done;h=f.next())g.add(h.value);if(g.has(c))return e}return-1}
function Mh(b,c,d,e,f,g){d=Af(e.c(),e.b,e.a,b.g.retryParameters,d,f,g);A.H("fetching: reference=",e);b=b.a.$b.request(1,d);c.Ya=b;return b.promise.then(function(b){c.Ya=null;return b.data})}
function vh(b,c,d,e){return t(function g(){var h,k,m,n;return y(g,function(g){switch(g.l){case 1:return h=Y(c),c.Oa=!1,c.jc=!1,c.Rb=0,c.Qa=!0,c.Va=null,c.va=null,A.debug(h,"clearing buffer"),e?(m=b.a.Sa(),n=b.a.I.ba(),k=b.a.I.remove(c.type,m+e,n)):k=Yd(b.a.I,c.type).then(function(){if(!this.f&&d)return this.a.I.flush(c.type)}.bind(b)),v(g,k,2);case 2:if(b.f)return g["return"]();A.debug(h,"cleared buffer");c.Qa=!1;c.endOfStream=!1;nh(b,c,0);x(g)}})})}
function nh(b,c,d){A.H(Y(c),"updating in "+d+" seconds");c.Da=(new mb(function(){return t(function f(){var d;return y(f,function(f){switch(f.l){case 1:return f.U=2,v(f,Ah(b,c),4);case 4:Da(f,0);break;case 2:d=Ea(f);if(b.a)b.a.onError(d);x(f)}})})})).V(d)}function dh(b){null!=b.Da&&(b.Da.stop(),b.Da=null)}function eh(b){return t(function d(){return y(d,function(d){switch(d.l){case 1:if(b.Ya)return v(d,b.Ya.abort(),0);d.l=0}})})}
function Ch(b,c){pb(b.M).then(function(){this.f||(this.a.onError(c),c.handled||this.g.failureCallback(c))}.bind(b))}function Y(b){return"("+b.type+":"+b.stream.id+")"};function Rh(b,c,d,e,f,g){if(200<=d&&299>=d&&202!=d)return{uri:f||e,Cf:e,data:c,headers:b,fromCache:!!b["x-shaka-from-cache"]};f=null;try{f=Yb(c)}catch(h){}A.debug("HTTP error text:",f);throw new D(401==d||403==d?2:1,1,1001,e,d,f,b,g);};function Sh(b,c,d,e){var f=new Sh.b;bc(c.headers).forEach(function(b,c){f.append(c,b)});var g=new Sh.a,h={qc:!1,ad:!1};b=Sh.h(b,d,{body:c.body||void 0,headers:f,method:c.method,signal:g.signal,credentials:c.allowCrossSiteCredentials?"include":void 0},h,e,c.streamDataCallback);b=new G(b,function(){h.qc=!0;g.abort();return Promise.resolve()});if(c=c.retryParameters.timeout){var k=new C(function(){h.ad=!0;g.abort()});k.V(c/1E3);b["finally"](function(){k.stop()})}return b}
z("shaka.net.HttpFetchPlugin",Sh);
Sh.h=function(b,c,d,e,f,g){return t(function k(){var m,n,p,r,u,w,F,B,H,M,aa,xa,na,ja,ra,Ua;return y(k,function(k){switch(k.l){case 1:return m=Sh.g,n=Sh.c,w=u=0,F=Date.now(),B=!1,H=function(){return!B&&!e.qc&&!e.ad},k.U=2,v(k,m(b,d),4);case 4:return p=k.N,M=p.clone().body.getReader(),xa=(aa=p.headers.get("Content-Length"))?parseInt(aa,10):0,na=function(b){function c(){return t(function cb(){var d,e,k;return y(cb,function(m){switch(m.l){case 1:return m.U=2,v(m,M.read(),4);case 4:d=m.N;Da(m,3);break;
case 2:return e=Ea(m),A.A("error reading from stream",e.message),m["return"]();case 3:d.done||(u+=d.value.byteLength,g&&H()&&g(d.value));k=Date.now();if(100<k-F||d.done)f(k-F,u-w,xa-u),w=u,F=k;d.done?b.close():(b.enqueue(d.value),c());x(m)}})})}c()},new n({start:na}),v(k,p.arrayBuffer(),5);case 5:r=k.N;Da(k,3);break;case 2:ja=Ea(k);B=!0;if(e.qc)throw new D(1,1,7001,b,c);if(e.ad)throw new D(1,1,1003,b,c);throw new D(1,1,1002,b,ja,c);case 3:return ra={},Ua=p.headers,Ua.forEach(function(b,c){ra[c.trim()]=
b}),k["return"](Rh(ra,r,p.status,b,p.url,c))}})})};Sh.isSupported=function(){if(window.ReadableStream)try{new ReadableStream({})}catch(b){return!1}else return!1;return!(!window.fetch||!window.AbortController)};Sh.isSupported=Sh.isSupported;Sh.g=window.fetch;Sh.a=window.AbortController;Sh.c=window.ReadableStream;Sh.b=window.Headers;Sh.isSupported()&&(Gb("http",Sh,2),Gb("https",Sh,2));function Th(b,c,d,e){var f=new Th.f,g=Date.now(),h=0,k=new Promise(function(k,n){f.open(c.method,b,!0);f.responseType="arraybuffer";f.timeout=c.retryParameters.timeout;f.withCredentials=c.allowCrossSiteCredentials;f.onabort=function(){n(new D(1,1,7001,b,d))};f.onload=function(c){c=c.target;var e=c.getAllResponseHeaders().trim().split("\r\n"),f={};e=q(e);for(var g=e.next();!g.done;g=e.next())g=g.value.split(": "),f[g[0].toLowerCase()]=g.slice(1).join(": ");try{var h=Rh(f,c.response,c.status,b,c.responseURL,
d);k(h)}catch(H){n(H)}};f.onerror=function(c){n(new D(1,1,1002,b,c,d))};f.ontimeout=function(){n(new D(1,1,1003,b,d))};f.onprogress=function(b){var c=Date.now();if(100<c-g||b.lengthComputable&&b.loaded==b.total)e(c-g,b.loaded-h,b.total-b.loaded),h=b.loaded,g=c};for(var m in c.headers)f.setRequestHeader(m.toLowerCase(),c.headers[m]);f.send(c.body)});return new G(k,function(){f.abort();return Promise.resolve()})}z("shaka.net.HttpXHRPlugin",Th);Th.f=window.XMLHttpRequest;Gb("http",Th,1);
Gb("https",Th,1);function Uh(b,c){var d=Vh(),e=this;this.h=c;this.c=b;this.f=d;this.i=null;this.g=[];this.b=this.a=null;this.m=!0;this.o=Promise.resolve().then(function(){return Wh(e)})}Uh.prototype.destroy=function(){var b=this;return t(function d(){var e;return y(d,function(d){switch(d.l){case 1:return b.m=!1,b.b&&b.b.abort(),Xh(b),v(d,b.o,2);case 2:b.a&&b.a.wa.Xa();for(var f=q(b.g),h=f.next();!h.done;h=f.next())e=h.value,e.wa.Xa();b.a=null;b.g=[];b.h=null;x(d)}})})};
function Yh(b,c){var d={ub:function(){},cc:function(){},Xa:function(){},onError:function(){},dc:function(){},Bf:function(){}};b.g.push({create:c,wa:d});b.b&&b.b.abort();Xh(b);return d}
function Wh(b){return t(function d(){return y(d,function(d){switch(d.l){case 1:if(b.m){if(0==b.g.length||b.a&&!b.a.Ta)var e=!1;else{b.a&&(b.a.wa.Xa(),b.a=null);e=b.g.shift();var g=e.create(b.f);g?(e.wa.ub(),b.a={node:g.node,payload:g.payload,Ta:g.Ta,wa:e.wa}):e.wa.dc();e=!0}e?e=Promise.resolve():b.a?e=Zh(b):(b.h.Ae(b.c),b.i=new E,e=b.i);return v(d,e,1)}d.l=0}})})}
function Zh(b){return t(function d(){var e,f;return y(d,function(d){switch(d.l){case 1:return b.c=b.h.oe(b.c,b.f,b.a.node,b.a.payload),d.U=2,b.b=b.h.Wd(b.c,b.f,b.a.payload),v(d,b.b.promise,4);case 4:b.b=null;b.c==b.a.node&&(b.a.wa.cc(),b.a=null);Da(d,0);break;case 2:e=Ea(d);if(7001==e.code)b.a.wa.Xa();else b.a.wa.onError(e);b.a=null;b.b=null;f=b;return v(d,b.h.handleError(b.f,e),5);case 5:f.c=d.N,x(d)}})})}function Xh(b){b.i&&(b.i.resolve(),b.i=null)};function $h(b){this.a=null;for(var c=0;c<b.textTracks.length;++c){var d=b.textTracks[c];d.mode="disabled";"Shaka Player TextTrack"==d.label&&(this.a=d)}this.a||(this.a=b.addTextTrack("subtitles","Shaka Player TextTrack"));this.a.mode="hidden"}z("shaka.text.SimpleTextDisplayer",$h);$h.prototype.remove=function(b,c){if(!this.a)return!1;ai(this.a,function(d){return d.startTime<c&&d.endTime>b});return!0};$h.prototype.remove=$h.prototype.remove;
$h.prototype.append=function(b){var c=bi,d=b.map(function(b){if(b.nestedCues.length){var c=b.nestedCues.map(function(b){return b.spacer?"\n":b.payload+" "}).join("").replace(/ $/m,"");b=b.clone();b.nestedCues=[];b.payload=c}return b}),e=[];b=this.a.cues?Array.from(this.a.cues):[];var f={};d=q(d);for(var g=d.next();!g.done;f={sb:f.sb},g=d.next())f.sb=g.value,b.some(function(b){return function(c){return c.startTime==b.sb.startTime&&c.endTime==b.sb.endTime&&c.text==b.sb.payload?!0:!1}}(f))||(g=c(f.sb))&&
e.push(g);e.slice().sort(function(b,c){return b.startTime!=c.startTime?b.startTime-c.startTime:b.endTime!=c.endTime?b.endTime-c.startTime:"line"in VTTCue.prototype?e.indexOf(c)-e.indexOf(b):e.indexOf(b)-e.indexOf(c)}).forEach(function(b){this.a.addCue(b)}.bind(this))};$h.prototype.append=$h.prototype.append;$h.prototype.destroy=function(){this.a&&ai(this.a,function(){return!0});this.a=null;return Promise.resolve()};$h.prototype.destroy=$h.prototype.destroy;
$h.prototype.isTextVisible=function(){return"showing"==this.a.mode};$h.prototype.isTextVisible=$h.prototype.isTextVisible;$h.prototype.setTextVisibility=function(b){this.a.mode=b?"showing":"hidden"};$h.prototype.setTextVisibility=$h.prototype.setTextVisibility;
function bi(b){if(b.startTime>=b.endTime)return A.j("Invalid cue times: "+b.startTime+" - "+b.endTime),null;var c=new VTTCue(b.startTime,b.endTime,b.payload);c.lineAlign=b.lineAlign;c.positionAlign=b.positionAlign;b.size&&(c.size=b.size);try{c.align=b.textAlign}catch(d){}"center"==b.textAlign&&"center"!=c.align&&(c.align="middle");"vertical-lr"==b.writingMode?c.vertical="lr":"vertical-rl"==b.writingMode&&(c.vertical="rl");1==b.lineInterpretation&&(c.snapToLines=!1);null!=b.line&&(c.line=b.line);null!=
b.position&&(c.position=b.position);return c}function ai(b,c){var d=b.mode;b.mode="showing"==d?"showing":"hidden";for(var e=b.cues,f=e.length-1;0<=f;f--){var g=e[f];g&&c(g)&&b.removeCue(g)}b.mode=d};function ci(b,c,d,e,f){var g=f in e,h=!0,k;for(k in c){var m=f+"."+k,n=g?e[f]:d[k];g||k in d?void 0===c[k]?void 0===n||g?delete b[k]:b[k]=Ab(n):n.constructor==Object&&c[k]&&c[k].constructor==Object?(b[k]||(b[k]=Ab(n)),m=ci(b[k],c[k],n,e,m),h=h&&m):typeof c[k]!=typeof n||null==c[k]||"function"!=typeof c[k]&&c[k].constructor!=n.constructor?(A.Pb("Invalid config, wrong type for "+m),h=!1):("function"==typeof d[k]&&d[k].length!=c[k].length&&A.qa("Unexpected number of arguments for "+m),b[k]=c[k]):(A.Pb("Invalid config, unrecognized key "+
m),h=!1)}return h}z("shaka.util.ConfigUtils.mergeConfigObjects",ci);function di(b,c){for(var d={},e=d,f=0,g=0;;){f=b.indexOf(".",f);if(0>f)break;if(0==f||"\\"!=b[f-1])g=b.substring(g,f).replace(/\\\./g,"."),e[g]={},e=e[g],g=f+1;f+=1}e[b.substring(g).replace(/\\\./g,".")]=c;return d}z("shaka.util.ConfigUtils.convertToConfigObject",di);function ei(){}z("shaka.util.PlayerConfiguration",ei);
function fi(){var b=5E5,c=Infinity;navigator.connection&&(navigator.connection.downlink&&(b=1E6*navigator.connection.downlink),navigator.connection.saveData&&(c=360));var d={retryParameters:ob(),servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:Sc,fairPlayTransform:!0,updateExpirationTime:1},e={retryParameters:ob(),availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,dash:{customScheme:function(b){if(b)return null},clockSyncUri:"",ignoreDrmInfo:!1,
xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,autoCorrectDrift:!0,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1},hls:{ignoreTextStreamFailures:!1,useFullSegmentsForStartTime:!1}},f={retryParameters:ob(),failureCallback:function(b){A.error("Unhandled streaming error",b);return[b]},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,
forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0};if(mc("Web0S")||mc("Tizen")||mc("CrKey"))f.stallSkip=0;var g={trackSelectionCallback:function(b){return t(function n(){return y(n,function(c){switch(c.l){case 1:return c["return"](b)}})})},progressCallback:function(b,c){return[b,c]},usePersistentLicense:!0},h={drm:d,manifest:e,streaming:f,offline:g,abrFactory:Q,abr:{enabled:!0,defaultBandwidthEstimate:b,switchInterval:8,bandwidthUpgradeTarget:.85,
bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:Infinity,minHeight:0,maxHeight:c,minPixels:0,maxPixels:Infinity,minFrameRate:0,maxFrameRate:Infinity,minBandwidth:0,maxBandwidth:Infinity}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:Infinity,minHeight:0,maxHeight:Infinity,minPixels:0,maxPixels:Infinity,minFrameRate:0,maxFrameRate:Infinity,minBandwidth:0,maxBandwidth:Infinity},
playRangeStart:0,playRangeEnd:Infinity,textDisplayFactory:function(){return null}};g.trackSelectionCallback=function(b){return t(function n(){return y(n,function(c){switch(c.l){case 1:return c["return"](gi(b,h.preferredAudioLanguage))}})})};return h}
function hi(b,c,d){var e={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return ci(b,c,d||fi(),e,"")}ei.mergeConfigObjects=hi;
function gi(b,c){var d=b.filter(function(b){return"variant"==b.type}),e=[],f=fe(c,d.map(function(b){return b.language}));f&&(e=d.filter(function(b){return P(b.language)==f}));0==e.length&&(e=d.filter(function(b){return b.primary}));0==e.length&&(1<(new Set(d.map(function(b){return b.language}))).size&&A.j("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),e=d);var g=e.filter(function(b){return b.height&&480>=b.height});g.length&&
(g.sort(function(b,c){return c.height-b.height}),e=g.filter(function(b){return b.height==g[0].height}));d=[];if(e.length){var h=Math.floor(e.length/2);e.sort(function(b,c){return b.bandwidth-c.bandwidth});d.push(e[h])}e=q(b);for(h=e.next();!h.done;h=e.next())h=h.value,"text"==h.type&&d.push(h);return d};function ii(){this.a=null;this.b=[]}function ji(b,c){if(null==b.a)b.a={timestamp:Date.now()/1E3,state:c,duration:0};else{var d=Date.now()/1E3;b.a.duration=d-b.a.timestamp;b.a.state!=c&&(b.b.push(b.a),b.a={timestamp:d,state:c,duration:0})}}function ki(b,c){var d=0;b.a&&b.a.state==c&&(d+=b.a.duration);for(var e=q(b.b),f=e.next();!f.done;f=e.next())f=f.value,d+=f.state==c?f.duration:0;return d}
function li(b){function c(b){return{timestamp:b.timestamp,state:b.state,duration:b.duration}}for(var d=[],e=q(b.b),f=e.next();!f.done;f=e.next())d.push(c(f.value));b.a&&d.push(c(b.a));return d};function mi(){this.b=this.c=null;this.a=[]};function ni(){this.f=this.u=this.h=this.b=this.i=this.m=this.o=this.g=this.w=NaN;this.a=new ii;this.c=new mi};function Z(b,c){var d=this;zb.call(this);this.i=oi;this.a=null;this.ib=!1;this.g=new K;this.lc=this.m=this.fb=this.c=this.u=this.f=this.Ob=this.C=this.Lb=this.M=this.kb=this.o=this.L=this.h=this.Z=null;this.nd=1E9;this.Mb=new Set;this.mb=!0;this.na=null;this.ld=!1;this.hd=0;this.ma=null;this.ka=new Wf;this.b=pi(this);this.Nb={width:Infinity,height:Infinity};this.w=null;this.Ab=new eg(this.b.preferredAudioLanguage,this.b.preferredVariantRole,this.b.preferredAudioChannelCount);this.la=this.b.preferredTextLanguage;
this.gb=this.b.preferredTextRole;this.mc=[];c&&c(this);this.Z=qi(this);this.g.B(window,"online",function(){d.Tc()});this.S={name:"detach"};this.$={name:"attach"};this.Ea={name:"unload"};this.sc={name:"manifest-parser"};this.pc={name:"manifest"};this.jb={name:"media-source"};this.kc={name:"drm-engine"};this.fa={name:"load"};this.tc={name:"src-equals-drm-engine"};this.lb={name:"src-equals"};var e=new Map;e.set(this.$,function(b,c){return vb(ri(d,b,c))});e.set(this.S,function(b){b.s&&(d.g.ja(b.s,"error"),
b.s=null);d.a=null;b=Promise.resolve();return vb(b)});e.set(this.Ea,function(b){return vb(si(d,b))});e.set(this.jb,function(b){b=ti(d,b);return vb(b)});e.set(this.sc,function(b,c){var e=ui(d,b,c);return vb(e)});e.set(this.pc,function(b){return vi(d,b)});e.set(this.kc,function(){var b=wi(d);return vb(b)});e.set(this.fa,function(b,c){return vb(xi(d,b,c))});e.set(this.tc,function(b){b=yi(d,b);return vb(b)});e.set(this.lb,function(b,c){return zi(d,b,c)});this.Pa=new Uh(this.S,{oe:function(b,c,e,k){var f=
null;b==d.S&&(f=e==d.S?d.S:d.$);b==d.$&&(f=e==d.S||c.s!=k.s?d.S:e==d.$?d.$:e==d.jb||e==d.fa?d.jb:e==d.lb?d.tc:null);b==d.jb&&(f=e==d.fa&&c.s==k.s?d.sc:d.Ea);b==d.sc&&(f=Ai(d.fa,d.pc,d.Ea,e,c,k));b==d.pc&&(f=Ai(d.fa,d.kc,d.Ea,e,c,k));b==d.kc&&(f=Ai(d.fa,d.fa,d.Ea,e,c,k));b==d.tc&&(f=e==d.lb&&c.s==k.s?d.lb:d.Ea);if(b==d.fa||b==d.lb)f=d.Ea;b==d.Ea&&(f=k.s&&c.s==k.s?d.$:d.S);return f},Wd:function(b,c,h){d.dispatchEvent(new I("onstatechange",{state:b.name}));return e.get(b)(c,h)},handleError:function(b,
c){return t(function k(){return y(k,function(e){switch(e.l){case 1:return A.j("The walker saw an error:"),c instanceof D?A.j("Error Code:",c.code):(A.j("Error Message:",c.message),A.j("Error Stack:",c.stack)),v(e,si(d,b),2);case 2:return e["return"](b.s?d.$:d.S)}})})},Ae:function(b){d.dispatchEvent(new I("onstateidle",{state:b.name}))}});b&&this.Bb(b,!0)}Qa(Z,zb);z("shaka.Player",Z);
Z.prototype.destroy=function(){var b=this;return t(function d(){var e;return y(d,function(d){switch(d.l){case 1:if(b.i==Bi)return d["return"]();b.i=Bi;e=Yh(b.Pa,function(){return{node:b.S,payload:Vh(),Ta:!1}});return v(d,new Promise(function(d){e.ub=function(){A.info("Preparing to destroy walker...")};e.cc=function(){d();b.dispatchEvent(new I("loaded"))};e.Xa=function(){d()};e.onError=function(){d()};e.dc=function(){d()}}),2);case 2:return v(d,b.Pa.destroy(),3);case 3:b.g&&(b.g.release(),b.g=null);
b.lc=null;b.m=null;b.b=null;if(!b.Z){d.l=0;break}return v(d,b.Z.destroy(),5);case 5:b.Z=null,x(d)}})})};Z.prototype.destroy=Z.prototype.destroy;Z.version="2.5.17-yandex-patched-custom-build-prev-segment2-5-ge6149b42-dirty";var Ci=["","5"];Tf=new function(b){this.a=b;this.c=Uf;this.b=Vf}(new Rf(Number(Ci[0]),Number(Ci[1])));var Di=["output-restricted","internal-error"],Ei={};Z.registerSupportPlugin=function(b,c){Ei[b]=c};
Z.isBrowserSupported=function(){if(!(window.Promise&&window.Uint8Array&&Array.prototype.forEach))return!1;var b=nc();return b&&12>b||!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration)?!1:hc()?!0:ic("application/x-mpegurl")};
Z.probeSupport=function(){return Yc().then(function(b){for(var c=W.Se(),d={},e=q('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),f=
e.next();!f.done;f=e.next()){f=f.value;d[f]=hc()?Id(f)?!0:MediaSource.isTypeSupported(f)||nd(f):ic(f);var g=f.split(";")[0];d[g]=d[g]||d[f]}b={manifest:c,media:d,drm:b};for(var h in Ei)b[h]=Ei[h]();return b})};Z.prototype.Bb=function(b,c){c=void 0===c?!0:c;if(this.i==Bi)return Promise.reject(Fi());var d=Vh();d.s=b;hc()||(c=!1);var e=c?this.jb:this.$,f=Yh(this.Pa,function(){return{node:e,payload:d,Ta:!1}});f.ub=function(){return A.info("Starting attach...")};return Gi(f)};Z.prototype.attach=Z.prototype.Bb;
Z.prototype.detach=function(){var b=this;if(this.i==Bi)return Promise.reject(Fi());var c=Yh(this.Pa,function(){return{node:b.S,payload:Vh(),Ta:!1}});c.ub=function(){return A.info("Starting detach...")};return Gi(c)};Z.prototype.detach=Z.prototype.detach;
Z.prototype.nf=function(b){var c=this;b=void 0===b?!0:b;if(this.i==Bi)return Promise.reject(Fi());hc()||(b=!1);var d=Vh(),e=Yh(this.Pa,function(e){var f=e.s&&b?c.jb:e.s?c.$:c.S;d.s=e.s;return{node:f,payload:d,Ta:!1}});e.ub=function(){return A.info("Starting unload...")};return Gi(e)};Z.prototype.unload=Z.prototype.nf;
Z.prototype.load=function(b,c,d){if(this.i==Bi)return Promise.reject(Fi());this.dispatchEvent(new I("loading"));var e=Vh();e.uri=b;e.Zc=Date.now()/1E3;d&&"string"!=typeof d&&(Sf("Loading with a manifest parser factory","Please register a manifest parser and for the mime-type."),e.ya=function(){return new d});d&&"string"==typeof d&&(e.mimeType=d);void 0!==c&&(e.startTime=c);var f=Hi(this,e)?this.lb:this.fa,g=Yh(this.Pa,function(b){if(null==b.s)return null;e.s=b.s;return{node:f,payload:e,Ta:!0}});g.ub=
function(){return A.info("Starting load of "+b+"...")};return new Promise(function(b,c){g.dc=function(){return c(new D(2,7,7002))};g.cc=function(){return b()};g.Xa=function(){return c(Fi())};g.onError=function(b){return c(b)}})};Z.prototype.load=Z.prototype.load;
function Hi(b,c){if(c.ya)return!1;if(!hc())return!0;var d=c.mimeType,e=c.uri||"";d||(d={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"}[W.getExtension(e)]);return d?""==(c.s||jc()).canPlayType(d)?!1:W.isSupported(e,d)?lc()&&b.b.streaming.useNativeHlsOnSafari:!0:!1}
function ri(b,c,d){null==c.s&&(c.s=d.s,b.g.B(c.s,"error",function(){var c=Ii(b);c&&b.Ma(c)}));b.a=c.s;return Promise.resolve()}
function si(b,c){return t(function e(){var f;return y(e,function(e){switch(e.l){case 1:return b.i!=Bi&&(b.i=oi),f=b.mc.map(function(b){return b()}),b.mc=[],v(e,Promise.all(f),2);case 2:b.dispatchEvent(new I("unloading"));c.ya=null;c.mimeType=null;c.startTime=null;c.uri=null;c.s&&(b.g.ja(c.s,"loadedmetadata"),b.g.ja(c.s,"playing"),b.g.ja(c.s,"pause"),b.g.ja(c.s,"ended"),b.g.ja(c.s,"ratechange"));b.kb&&(b.kb.release(),b.kb=null);b.Lb&&(b.Lb.stop(),b.Lb=null);if(!b.u){e.l=3;break}return v(e,b.u.stop(),
4);case 4:b.u=null;case 3:if(!b.m){e.l=5;break}return v(e,b.m.stop(),5);case 5:if(!b.f){e.l=7;break}return v(e,b.f.destroy(),8);case 8:b.f=null;case 7:b.M&&(b.M.release(),b.M=null);b.o&&(b.o.release(),b.o=null);if(!b.L){e.l=9;break}return v(e,b.L.destroy(),10);case 10:b.L=null;case 9:if(!c.s||!c.s.src){e.l=11;break}return v(e,new Promise(function(b){return(new C(b)).V(.1)}),12);case 12:c.s.removeAttribute("src"),c.s.load();case 11:if(!b.h){e.l=13;break}return v(e,b.h.destroy(),14);case 14:b.h=null;
case 13:b.ka.a.clear(),b.fb=null,b.C=null,b.Mb.clear(),b.c=null,b.w=null,b.nc=null,b.mb=!0,Ji(b),x(e)}})})}function ti(b,c){return t(function e(){var f,g,h,k;return y(e,function(e){switch(e.l){case 1:return f=window.muxjs?new cd:new dd,g=b.b.textDisplayFactory,h=new g,b.nc=g,k=new Md(c.s,f,h),v(e,k.u,2);case 2:b.L=k,x(e)}})})}
function ui(b,c,d){return t(function f(){var g,h,k,m;return y(f,function(f){switch(f.l){case 1:c.ya=d.ya;c.mimeType=d.mimeType;c.uri=d.uri;g=c.uri;h=b.Z;b.fb=g;if(c.ya){b.u=c.ya();f.l=2;break}k=b;return v(f,W.create(g,h,b.b.manifest.retryParameters,c.mimeType),3);case 3:k.u=f.N;case 2:m=Ab(b.b.manifest),d.s&&"AUDIO"===d.s.nodeName&&(m.disableVideo=!0),b.u.configure(m),x(f)}})})}
function vi(b,c){var d=c.uri,e=b.Z;b.Ob=new Wg(function(){return b.Fd()});Xg(b.Ob,function(c){Ki(b,"timelineregionadded",c)});var f={networkingEngine:e,filterNewPeriod:function(c){return b.vc(c)},filterAllPeriods:function(c){return Li(b,c)},onTimelineRegionAdded:function(c){var d=b.Ob;a:{var e=q(d.a);for(var f=e.next();!f.done;f=e.next())if(f=f.value,f.schemeIdUri==c.schemeIdUri&&f.id==c.id&&f.startTime==c.startTime&&f.endTime==c.endTime){e=f;break a}e=null}null==e&&(d.a.add(c),d.b(c))},onEvent:function(c){return b.dispatchEvent(c)},
onError:function(c){return b.Ma(c)}};return new G(Promise.resolve().then(function(){return t(function h(){var c;return y(h,function(e){switch(e.l){case 1:return c=b,v(e,b.u.start(d,f),2);case 2:c.c=e.N;b.dispatchEvent(new I("manifestparsed"));if(0==b.c.periods.length)throw new D(2,4,4014);Mi(b.c.periods);x(e)}})})}),function(){A.info("Aborting parser step...");return b.u.stop()})}
function wi(b){return t(function d(){return y(d,function(d){switch(d.l){case 1:return b.h=Ni(b,{$b:b.Z,onError:function(d){b.Ma(d)},ud:function(d){Oi(b,d)},onExpirationUpdated:function(d,e){Pi(b,d,e)},onEvent:function(d){b.dispatchEvent(d)}}),b.h.configure(b.b.drm),v(d,Ac(b.h,Ag(b.c.periods),b.c.offlineSessionIds),2);case 2:Li(b,b.c.periods),x(d)}})})}
function xi(b,c,d){return t(function f(){var g,h,k,m,n,p,r,u,w,F;return y(f,function(f){switch(f.l){case 1:return c.startTime=d.startTime,g=c.s,h=c.uri,b.fb=h,b.M=new Eg({Vb:function(){return c.s.playbackRate},Xc:function(b){c.s.playbackRate=b},qd:function(b){c.s.currentTime+=b}}),b.w=new ni,k=function(){return Qi(b)},m=function(){return Ri(b)},b.g.B(g,"playing",k),b.g.B(g,"pause",k),b.g.B(g,"ended",k),b.g.B(g,"ratechange",m),n=b.b.abrFactory,b.m&&b.lc==n||(b.lc=n,b.m=new n,b.m.configure(b.b.abr)),
Si(b,b.c.periods),b.Ab=new eg(b.b.preferredAudioLanguage,b.b.preferredVariantRole,b.b.preferredAudioChannelCount),b.la=b.b.preferredTextLanguage,Ti(b.c.presentationTimeline,b.b.playRangeStart,b.b.playRangeEnd),v(f,b.h.Bb(g),2);case 2:return b.m.init(function(c,d,f){d=void 0===d?!1:d;f=void 0===f?0:f;A.debug("switch_");a:{var g=q(b.c.periods);for(var h=g.next();!h.done;h=g.next())if(h=h.value,h.variants.includes(c)){g=h;break a}g=null}Ui(b,g,c,!0);b.f&&rh(b.f,c,d,f)&&Vi(b)}),b.o=Wi(b,c.startTime),
b.kb=Xi(b),p=Math.max(b.c.minBufferTime,b.b.streaming.rebufferingGoal),Yi(b,p),b.f=Zi(b),b.f.configure(b.b.streaming),ge(b.c,b.b.preferredAudioChannelCount),b.i=$i,b.dispatchEvent(new I("streaming")),v(f,b.f.start(),3);case 3:b.b.streaming.startAtSegmentBoundary&&(r=b.o.g(),u=aj(b,r),b.o.o(u)),b.c.periods.forEach(b.vc.bind(b)),bj(b),Vi(b),w=cj(b)||b.c.periods[0],F=w.variants.some(function(b){return b.primary}),b.b.preferredAudioLanguage||F||A.j("No preferred audio language set.  We will choose an arbitrary language initially"),
dj(b,w.variants),b.g.oa(g,"loadedmetadata",function(){b.w.b=Date.now()/1E3-d.Zc}),x(f)}})})}
function yi(b,c){return t(function e(){var f,g;return y(e,function(e){switch(e.l){case 1:return f=kd,b.h=Ni(b,{$b:b.Z,onError:function(c){b.Ma(c)},ud:function(c){Oi(b,c)},onExpirationUpdated:function(c,e){Pi(b,c,e)},onEvent:function(c){b.dispatchEvent(c)}}),b.h.configure(b.b.drm),g={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,
presentationTimeOffset:0,mimeType:"video/mp4",codecs:"",encrypted:!0,keyId:null,language:"und",label:null,type:f.dd,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},v(e,Ac(b.h,[g],[]),2);case 2:return v(e,b.h.Bb(c.s),0)}})})}
function zi(b,c,d){function e(){return Qi(b)}c.uri=d.uri;c.startTime=d.startTime;b.fb=c.uri;b.w=new ni;b.o=new Pg(c.s);null!=c.startTime&&b.o.o(c.startTime);b.M=new Eg({Vb:function(){return c.s.playbackRate},Xc:function(b){c.s.playbackRate=b},qd:function(b){c.s.currentTime+=b}});Yi(b,b.b.streaming.rebufferingGoal);b.g.B(c.s,"playing",e);b.g.B(c.s,"pause",e);b.g.B(c.s,"ended",e);b.g.B(c.s,"ratechange",function(){return Ri(b)});"none"!=b.a.preload&&b.g.oa(c.s,"loadedmetadata",function(){b.w.b=Date.now()/
1E3-d.Zc});b.a.audioTracks&&(b.g.B(b.a.audioTracks,"addtrack",function(){return bj(b)}),b.g.B(b.a.audioTracks,"removetrack",function(){return bj(b)}),b.g.B(b.a.audioTracks,"change",function(){return bj(b)}));if(b.a.textTracks){var f=b.a.textTracks;b.g.B(f,"addtrack",function(){return bj(b)});b.g.B(f,"removetrack",function(){return bj(b)});b.g.B(f,"change",function(){return bj(b)})}c.s.src=c.uri;(mc("Tizen")||mc("Web0S"))&&c.s.load();b.i=ej;b.dispatchEvent(new I("streaming"));var g=new E;Gg(b.a,HTMLMediaElement.HAVE_METADATA,
b.g,function(){g.resolve()});var h=!1;b.mc.push(function(){h=!0});Gg(b.a,HTMLMediaElement.HAVE_CURRENT_DATA,b.g,function(){return t(function m(){var c;return y(m,function(d){switch(d.l){case 1:if(h)return d["return"]();fj(b);c=gj(b);if(c.find(function(b){return"disabled"!=b.mode})){d.l=2;break}return v(d,new Promise(function(c){b.g.oa(b.a.textTracks,"change",c);(new C(c)).V(1)}),2);case 2:if(h)return d["return"]();hj(b);x(d)}})})});b.a.error?g.reject(Ii(b)):"none"==b.a.preload&&(A.qa('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),
g.resolve());b.g.oa(b.a,"error",function(){g.reject(Ii(b))});return new G(g,function(){g.reject(new D(2,7,7001));return Promise.resolve()})}function fj(b){var c=b.b.preferredAudioLanguage;if(""!=c){b.Uc(c);var d=b.b.preferredVariantRole;""!=d&&b.Uc(c,d)}}function hj(b){var c=b.b.preferredTextLanguage;if(""!=c){b.Vc(c);var d=b.b.preferredTextRole;""!=d&&b.Vc(c,d)}}
function Mi(b){function c(b){return b.video&&b.audio||b.video&&b.video.codecs.includes(",")}b.some(function(b){return b.variants.some(c)})&&(A.debug("Found variant with audio and video content, so filtering out audio-only content in all periods."),b.forEach(function(b){b.variants=b.variants.filter(c)}))}function Ni(b,c){return new vc(c,b.b.drm.updateExpirationTime)}function qi(b){return new J(function(c,d){b.m&&b.m.segmentDownloaded(c,d)})}
function Wi(b,c){return new Qg(b.a,b.c,b.b.streaming,c,function(){b.kb&&zg(b.kb,!0);b.f&&xh(b.f);b.C&&ij(b)},function(c){return b.dispatchEvent(c)})}function Xi(b){var c=new Cg(b.c);Dg(c,function(){bj(b)});var d=new Yg(b.Ob);bh(d,function(c){Ki(b,"timelineregionenter",c)},function(c){Ki(b,"timelineregionexit",c)},function(c,d){d||(Ki(b,"timelineregionenter",c),Ki(b,"timelineregionexit",c))});var e=new yg(b.a);e.a.add(c);e.a.add(d);return e}
function Yi(b,c){b.C=new ig;b.C.a=qg;rg(b.C,c,Math.min(.5,c/2));Ji(b);b.Lb=(new C(function(){ij(b)})).Ca(.25)}function ij(b){switch(b.i){case ej:var c=b.a.ended?!0:ed(b.a.buffered)>=b.a.duration-1;break;case $i:a:if(b.a.ended||Qd(b.L))c=!0;else{if(b.c.presentationTimeline.da()){var d=b.c.presentationTimeline.qb();if(ed(b.a.buffered)>=d){c=!0;break a}}c=!1}break;default:c=!1}var e=gd(b.a.buffered,b.a.currentTime);d=b.C;var f=c,g=d.b.get(d.a);c=d.a;e=f||e>=g?jg:qg;d.a=e;c!=e&&Ji(b)}
function Zi(b){return new ch(b.c,{Sa:function(){return b.o.g()},getBandwidthEstimate:function(){return b.m.getBandwidthEstimate()},I:b.L,$b:b.Z,td:b.ze.bind(b),sd:b.Rd.bind(b),onError:b.Ma.bind(b),onEvent:function(c){return b.dispatchEvent(c)},Ce:b.De.bind(b),Mc:b.He.bind(b)})}Z.prototype.configure=function(b,c){2==arguments.length&&"string"==typeof b&&(b=di(b,c));var d=hi(this.b,b,pi(this));jj(this);return d};Z.prototype.configure=Z.prototype.configure;
function jj(b){if(b.u){var c=Ab(b.b.manifest);b.a&&"AUDIO"===b.a.nodeName&&(c.disableVideo=!0);b.u.configure(c)}b.h&&b.h.configure(b.b.drm);if(b.f){b.f.configure(b.b.streaming);try{b.c.periods.forEach(b.vc.bind(b))}catch(g){b.Ma(g)}var d=hh(b.f),e=jh(b.f);c=cj(b);d=ze(d,e,c.variants);b.m&&d&&d.allowedByApplication&&d.allowedByKeySystem?dj(b,c.variants):(A.debug("Choosing new streams after changing configuration"),kj(b,c))}if(b.L&&(c=b.b.textDisplayFactory,b.nc!=c)){d=new c;e=b.L;var f=e.g;e.g=d;f&&
(d.setTextVisibility(f.isTextVisible()),f.destroy());e.a&&(e.a.c=d);b.nc=c;b.f&&(c=b.f,(d=c.b.get("text"))&&qh(c,d.stream,!0,0,!0))}b.m&&(b.m.configure(b.b.abr),b.b.abr.enabled&&!b.mb?b.m.enable():b.m.disable(),lj(b));b.C&&(c=b.b.streaming.rebufferingGoal,b.c&&(c=Math.max(c,b.c.minBufferTime)),rg(b.C,c,Math.min(.5,c/2)))}Z.prototype.getConfiguration=function(){var b=pi(this);hi(b,this.b,pi(this));return b};Z.prototype.getConfiguration=Z.prototype.getConfiguration;
Z.prototype.Ye=function(){for(var b in this.b)delete this.b[b];hi(this.b,pi(this),pi(this));jj(this)};Z.prototype.resetConfiguration=Z.prototype.Ye;Z.prototype.ge=function(){return this.i};Z.prototype.getLoadMode=Z.prototype.ge;Z.prototype.le=function(){return this.a};Z.prototype.getMediaElement=Z.prototype.le;Z.prototype.ne=function(){return this.Z};Z.prototype.getNetworkingEngine=Z.prototype.ne;Z.prototype.$d=function(){return this.fb};Z.prototype.getAssetUri=Z.prototype.$d;
Z.prototype.je=function(){Sf("getManifestUri",'Please use "getAssetUri" instead.');return this.fb};Z.prototype.getManifestUri=Z.prototype.je;Z.prototype.da=function(){return this.c?this.c.presentationTimeline.da():this.a&&this.a.src?Infinity==this.a.duration:!1};Z.prototype.isLive=Z.prototype.da;Z.prototype.tb=function(){return this.c?this.c.presentationTimeline.tb():!1};Z.prototype.isInProgress=Z.prototype.tb;
Z.prototype.we=function(){if(this.c){if(!this.c.periods.length)return!1;var b=this.c.periods[0].variants;return b.length?!b[0].video:!1}return this.a&&this.a.src?this.a.videoTracks?0==this.a.videoTracks.length:0==this.a.videoHeight:!1};Z.prototype.isAudioOnly=Z.prototype.we;Z.prototype.Fd=function(){if(this.c){var b=this.c.presentationTimeline;return{start:b.pb(),end:b.za()}}return this.a&&this.a.src&&(b=this.a.seekable,b.length)?{start:b.start(0),end:b.end(b.length-1)}:{start:0,end:0}};
Z.prototype.seekRange=Z.prototype.Fd;Z.prototype.keySystem=function(){return Pc(this.drmInfo())};Z.prototype.keySystem=Z.prototype.keySystem;Z.prototype.drmInfo=function(){return this.h?this.h.a:null};Z.prototype.drmInfo=Z.prototype.drmInfo;Z.prototype.Ac=function(){return this.h?this.h.Ac():Infinity};Z.prototype.getExpiration=Z.prototype.Ac;Z.prototype.pd=function(){return this.C?this.C.a==qg:!1};Z.prototype.isBuffering=Z.prototype.pd;
Z.prototype.pe=function(){if(this.M){var b=this.M;b=b.f?0:b.c}else b=0;return b};Z.prototype.getPlaybackRate=Z.prototype.pe;Z.prototype.mf=function(b){0==b?A.qa("A trick play rate of 0 is unsupported!"):(this.a.paused&&this.a.play(),this.M&&this.M.set(b),this.i==$i&&ph(this.f,1<Math.abs(b)))};Z.prototype.trickPlay=Z.prototype.mf;Z.prototype.Sd=function(){this.i==ej&&this.M.set(1);this.i==$i&&(this.M.set(1),ph(this.f,!1))};Z.prototype.cancelTrickPlay=Z.prototype.Sd;
Z.prototype.Dc=function(){if(this.c&&this.o){for(var b=mj(this),c=[],d=q(nj(this)),e=d.next();!e.done;e=d.next()){e=e.value;var f=qe(e);f.active=e==b;c.push(f)}return c}return this.a&&this.a.audioTracks?Array.from(this.a.audioTracks).map(function(b){return ue(b)}):[]};Z.prototype.getVariantTracks=Z.prototype.Dc;
Z.prototype.rb=function(){if(this.c&&this.o){for(var b=oj(this),c=[],d=q(pj(this)),e=d.next();!e.done;e=d.next()){e=e.value;var f=re(e);f.active=e==b;c.push(f)}return c}return this.a&&this.a.src&&this.a.textTracks?gj(this).map(function(b){var c=ve(b);c.active="disabled"!=b.mode;c.type="text";c.originalTextId=b.id;"captions"==b.kind&&(c.mimeType="application/cea-608");b.kind&&(c.roles=[b.kind]);return c}):[]};Z.prototype.getTextTracks=Z.prototype.rb;
Z.prototype.Wc=function(b){if(this.c&&this.f){var c=cj(this),d=c.textStreams.find(function(c){return c.id==b.id});d?(qj(this,c,d,!1),rj(this,d),this.la=d.language):A.error("No stream with id",b.id)}else if(this.a&&this.a.src&&this.a.textTracks){c=gj(this);c=q(c);for(d=c.next();!d.done;d=c.next())d=d.value,se(d)==b.id?d.mode=this.ib?"showing":"hidden":d.mode="disabled";sj(this)}};Z.prototype.selectTextTrack=Z.prototype.Wc;
Z.prototype.af=function(){Sf("selectEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack.");var b=this.rb().filter(function(b){return"application/cea-608"==b.mimeType});0<b.length?this.Wc(b[0]):A.j("Unable to find the text track embedded in the video.")};Z.prototype.selectEmbeddedTextTrack=Z.prototype.af;
Z.prototype.tf=function(){Sf("usingEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text.");var b=this.rb().filter(function(b){return b.active})[0];return b?"application/cea-608"==b.mimeType:!1};Z.prototype.usingEmbeddedTextTrack=Z.prototype.tf;
Z.prototype.bf=function(b,c,d){d=void 0===d?0:d;if(this.c&&this.f){var e=cj(this);this.b.abr.enabled&&A.qa("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var f=e.variants.find(function(c){return c.id==b.id});f?we(f)?(Ui(this,e,f,!1),tj(this,f,c,d),this.Ab=new dg(f),dj(this,e.variants)):A.error("Unable to switch to restricted track",b.id):A.error("No variant with id",b.id)}else if(this.a&&
this.a.audioTracks){c=Array.from(this.a.audioTracks);c=q(c);for(d=c.next();!d.done;d=c.next())d=d.value,se(d)==b.id&&(d.enabled=!0);uj(this)}};Z.prototype.selectVariantTrack=Z.prototype.bf;Z.prototype.be=function(){return vj(this.Dc())};Z.prototype.getAudioLanguagesAndRoles=Z.prototype.be;Z.prototype.ue=function(){return vj(this.rb())};Z.prototype.getTextLanguagesAndRoles=Z.prototype.ue;Z.prototype.ae=function(){return Array.from(wj(this.Dc()))};Z.prototype.getAudioLanguages=Z.prototype.ae;
Z.prototype.te=function(){return Array.from(wj(this.rb()))};Z.prototype.getTextLanguages=Z.prototype.te;Z.prototype.Uc=function(b,c){if(this.c&&this.o){var d=cj(this);this.Ab=new eg(b,c||"",0,"","audio");xj(this,d)}else if(this.a&&this.a.audioTracks){var e=Array.from(this.a.audioTracks);d=P(b);e=q(e);for(var f=e.next();!f.done;f=e.next()){f=f.value;var g=ue(f);P(g.language)!=d||c&&!g.roles.includes(c)||(f.enabled=!0)}uj(this)}};Z.prototype.selectAudioLanguage=Z.prototype.Uc;
Z.prototype.Vc=function(b,c){if(this.c&&this.o){var d=cj(this);this.la=b;this.gb=c||"";var e=xe(d.textStreams,this.la,this.gb)[0]||null;e&&(qj(this,d,e,!1),(this.b.streaming.alwaysStreamText||this.Yb())&&rj(this,e))}else{var f=P(b);(d=this.rb().filter(function(b){return P(b.language)==f&&(!c||b.roles.includes(c))})[0])&&this.Wc(d)}};Z.prototype.selectTextLanguage=Z.prototype.Vc;
Z.prototype.cf=function(b){if(this.c&&this.o){for(var c=cj(this),d=null,e=q(nj(this)),f=e.next();!f.done;f=e.next())if(f=f.value,f.audio.label==b){d=f;break}null==d?A.j("No variants were found with label: "+b+". Ignoring the request to switch."):(this.Ab=new eg(d.language,"",0,b),xj(this,c))}};Z.prototype.selectVariantsByLabel=Z.prototype.cf;
Z.prototype.Yb=function(){var b=this.ib;return this.L?this.L.g.isTextVisible():this.a&&this.a.src&&this.a.textTracks?gj(this).some(function(b){return"showing"==b.mode}):b};Z.prototype.isTextTrackVisible=Z.prototype.Yb;function gj(b){return Array.from(b.a.textTracks).filter(function(b){return"metadata"!=b.kind&&"Shaka Player TextTrack"!=b.label})}
Z.prototype.gf=function(b){var c=this;return t(function e(){var f,g,h,k,m,n;return y(e,function(e){switch(e.l){case 1:f=c.ib;g=!!b;if(f==g)return e["return"]();c.ib=g;if(c.i!=$i){if(c.a&&c.a.src&&c.a.textTracks){h=gj(c);for(var p=q(h),u=p.next();!u.done;u=p.next())k=u.value,"disabled"!=k.mode&&(k.mode=g?"showing":"hidden")}e.l=2;break}c.L.g.setTextVisibility(g);if(c.b.streaming.alwaysStreamText){e.l=2;break}if(!g){oh(c.f);e.l=2;break}if(ih(c.f,"text")){e.l=2;break}m=cj(c);n=xe(m.textStreams,c.la,
c.gb);if(!(0<n.length)){e.l=2;break}return v(e,kh(c.f,n[0]),2);case 2:yj(c),x(e)}})})};Z.prototype.setTextTrackVisibility=Z.prototype.gf;
Z.prototype.qe=function(){if(!this.da())return A.j("getPlayheadTimeAsDate is for live streams!"),null;var b=this.Pa.f,c=0;if(this.o)c=this.o.g();else if(b){if(null==b.startTime)return new Date;c=b.startTime}if(this.c)return new Date(1E3*(this.c.presentationTimeline.f+this.a.currentTime));if(this.a&&this.a.getStartDate)return b=this.a.getStartDate(),isNaN(b.getTime())?(A.j("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(b.getTime()+1E3*c);A.j("No way to get playhead time as Date!");
return null};Z.prototype.getPlayheadTimeAsDate=Z.prototype.qe;Z.prototype.se=function(){if(!this.da())return A.j("getPresentationStartTimeAsDate is for live streams!"),null;if(this.c)return new Date(1E3*this.c.presentationTimeline.f);if(this.a&&this.a.getStartDate){var b=this.a.getStartDate();return isNaN(b.getTime())?(A.j("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):b}A.j("No way to get presentation start time as Date!");return null};
Z.prototype.getPresentationStartTimeAsDate=Z.prototype.se;Z.prototype.yc=function(){var b={total:[],audio:[],video:[],text:[]};this.i==ej&&(b.total=hd(this.a.buffered));this.i==$i&&this.L.yc(b);return b};Z.prototype.getBufferedInfo=Z.prototype.yc;
Z.prototype.getStats=function(){if(this.i!=$i&&this.i!=ej)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,switchHistory:[],stateHistory:[]};Qi(this);var b=this.a;if(b.getVideoPlaybackQuality){b=b.getVideoPlaybackQuality();var c=this.w,d=Number(b.totalVideoFrames);c.o=Number(b.droppedVideoFrames);c.m=d;this.w.i=Number(b.corruptedVideoFrames)}this.h?
(b=this.h,b=b.M?b.M:NaN):b=NaN;this.w.h=b;if(this.i==$i){if(b=mj(this))this.w.u=b.bandwidth;b&&b.video&&(c=this.w,d=b.video.height||NaN,c.w=b.video.width||NaN,c.g=d);b=this.m.getBandwidthEstimate();this.w.f=b}var e=this.w;b=e.w;c=e.g;d=e.u;var f=e.m,g=e.o,h=e.i,k=e.f,m=e.b,n=ki(e.a,"playing"),p=ki(e.a,"paused"),r=ki(e.a,"buffering"),u=e.h,w=li(e.a),F=[];e=q(e.c.a);for(var B=e.next();!B.done;B=e.next())B=B.value,F.push({timestamp:B.timestamp,id:B.id,type:B.type,fromAdaptation:B.fromAdaptation,bandwidth:B.bandwidth});
return{width:b,height:c,streamBandwidth:d,decodedFrames:f,droppedFrames:g,corruptedFrames:h,estimatedBandwidth:k,loadLatency:m,playTime:n,pauseTime:p,bufferingTime:r,licenseTime:u,stateHistory:w,switchHistory:F}};Z.prototype.getStats=Z.prototype.getStats;
Z.prototype.addTextTrack=function(b,c,d,e,f,g){var h=this;return t(function m(){var n,p,r,u,w,F,B,H,M;return y(m,function(m){switch(m.l){case 1:if(h.i==ej)throw A.error("Cannot add text when loaded with src="),Error("State error!");if(h.i!=$i)throw A.error("Must call load() and wait for it to resolve before adding text tracks."),Error("State error!");n=cj(h);p=kd;r=h.c.periods.indexOf(n);u=r+1;w=u>=h.c.periods.length?h.c.presentationTimeline.ba():h.c.periods[u].startTime;F=w-n.startTime;if(Infinity==
F)throw new D(1,4,4033);B=new U(1,0,F,function(){return[b]},0,null);H={id:h.nd++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(b){return 1==b?B:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:e,codecs:f||"",kind:d,encrypted:!1,keyId:null,language:c,label:g||null,type:p.xa,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,
audioSamplingRate:null,closedCaptions:null};h.Mb.add(H);n.textStreams.push(H);return v(m,kh(h.f,H),2);case 2:return(M=ih(h.f,"text"))&&Xf(h.ka,n,M),h.Mb["delete"](H),A.debug("Choosing new streams after adding a text stream"),kj(h,n),bj(h),m["return"](re(H))}})})};Z.prototype.addTextTrack=Z.prototype.addTextTrack;Z.prototype.ff=function(b,c){this.Nb.width=b;this.Nb.height=c};Z.prototype.setMaxHardwareResolution=Z.prototype.ff;
Z.prototype.Tc=function(){if(this.i==$i){var b=this.f;if(b.f)A.error("Unable to retry after StreamingEngine is destroyed!"),b=!1;else if(b.o)A.error("Unable to retry after StreamingEngine encountered a fatal error!"),b=!1;else{for(var c=q(b.b.values()),d=c.next();!d.done;d=c.next()){d=d.value;var e=Y(d);d.Eb&&(A.info(e,"Retrying after failure..."),d.Eb=!1,nh(b,d,.1))}b=!0}}else b=!1;return b};Z.prototype.retryStreaming=Z.prototype.Tc;Z.prototype.he=function(){return this.c};
Z.prototype.getManifest=Z.prototype.he;Z.prototype.ie=function(){return this.u?this.u.constructor:null};Z.prototype.getManifestParserFactory=Z.prototype.ie;function Ui(b,c,d,e){Yf(b.ka,c).variant=d;b=b.w.c;b.c!=d&&(b.c=d,b.a.push({timestamp:Date.now()/1E3,id:d.id,type:"variant",fromAdaptation:e,bandwidth:d.bandwidth}))}function qj(b,c,d,e){Xf(b.ka,c,d);b=b.w.c;b.b!=d&&(b.b=d,b.a.push({timestamp:Date.now()/1E3,id:d.id,type:"text",fromAdaptation:e,bandwidth:null}))}
function pi(b){var c=fi();c.streaming.failureCallback=function(c){var d=[1001,1002,1003];b.da()&&d.includes(c.code)&&(c.severity=1,A.j("Live streaming error.  Retrying automatically..."),b.Tc())};c.textDisplayFactory=function(){return new $h(b.a)};return c}
function Si(b,c){for(var d=0;d<c.length;d++){for(var e=c[d],f=new Map,g=q(e.variants),h=g.next();!h.done;h=g.next())if(h=h.value,h.video&&h.video.closedCaptions){h=h.video;for(var k=q(h.closedCaptions.keys()),m=k.next();!m.done;m=k.next())if(m=m.value,!f.has(m)){var n={id:b.nd++,originalId:m,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"application/cea-608",
codecs:"",kind:"caption",encrypted:!1,keyId:null,language:h.closedCaptions.get(m),label:null,type:"text",primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:h.roles,channelsCount:null,audioSamplingRate:null,closedCaptions:null};f.set(m,n)}}f=q(f.values());for(g=f.next();!g.done;g=f.next())e.textStreams.push(g.value)}}
function Li(b,c){var d=b.f?hh(b.f):null,e=b.f?jh(b.f):null;c.forEach(ne.bind(null,b.h,d,e));d=Cb(c,function(b){return b.variants.some(we)});if(0==d)throw new D(2,4,4032);if(d<c.length)throw new D(2,4,4011);c.forEach(function(b){me(b.variants,this.b.restrictions,this.Nb)&&this.f&&cj(this)==b&&bj(this);zj(this,b.variants)}.bind(b))}l=Z.prototype;
l.vc=function(b){var c=this.f?hh(this.f):null,d=this.f?jh(this.f):null;ne(this.h,c,d,b);c=b.variants;if(!c.some(we))throw new D(2,4,4011);zj(this,b.variants);me(c,this.b.restrictions,this.Nb)&&this.f&&cj(this)==b&&bj(this);if(b=this.h?this.h.a:null)for(c=q(c),d=c.next();!d.done;d=c.next()){d=q(d.value.drmInfos);for(var e=d.next();!e.done;e=d.next())if(e=e.value,e.keySystem==b.keySystem){e=q(e.initData||[]);for(var f=e.next();!f.done;f=e.next())f=f.value,Kc(this.h,f.initDataType,f.initData)}}};
function tj(b,c,d,e){d=void 0===d?!1:d;e=void 0===e?0:e;if(b.mb)return b.na=c,b.ld=d,b.hd=e,!0;(c=rh(b.f,c,d,e))&&uj(b);return c}function rj(b,c){if(b.mb)return b.ma=c,!0;var d=qh(b.f,c,!0,0,!1);d&&sj(b);return d}function aj(b,c){function d(b,c){if(!b)return null;var d=b.findSegmentPosition(c-g.startTime);return null==d?null:(d=b.getSegmentReference(d))?d.startTime+g.startTime:null}var e=hh(b.f),f=jh(b.f),g=cj(b);e=d(e,c);f=d(f,c);return null!=f&&null!=e?Math.max(f,e):null!=f?f:null!=e?e:c}
function Ji(b){var c=b.pd();if(b.w&&b.C&&b.o){var d=b.M;d.f=c;Fg(d);Qi(b)}b.dispatchEvent(new I("buffering",{buffering:c}))}function Ri(b){var c=b.a.playbackRate;0!=c&&b.M.set(c)}function Qi(b){if(b.w&&b.C){var c=b.w.a;b.C.a==qg?ji(c,"buffering"):b.a.paused?ji(c,"paused"):b.a.ended?ji(c,"ended"):ji(c,"playing")}}function dj(b,c){try{zj(b,c)}catch(e){return b.Ma(e),null}var d=c.filter(function(b){return we(b)});d=b.Ab.create(d);b.m.setVariants(Array.from(d.values()));return b.m.chooseVariant()}
function kj(b,c){var d=xj(b,c,!1),e=xe(c.textStreams,b.la,b.gb)[0]||null,f=!1;e&&(b.b.streaming.alwaysStreamText||b.Yb())&&(qj(b,c,e,!0),f=rj(b,e));(d||f)&&Vi(b)}function xj(b,c,d){d=void 0===d?!0:d;var e=dj(b,c.variants),f=!1;e&&(Ui(b,c,e,!0),f=tj(b,e,!0));d&&f&&Vi(b);return f}
l.ze=function(b){A.debug("onChooseStreams_",b);try{A.H("onChooseStreams_, choosing variant from ",b.variants);A.H("onChooseStreams_, choosing text from ",b.textStreams);this.mb=!0;this.m.disable();lj(this);A.debug("Choosing new streams after period changed");var c=dj(this,b.variants),d=xe(b.textStreams,this.la,this.gb)[0]||null;this.na&&(b.variants.includes(this.na)&&(c=this.na),this.na=null);this.ma&&(b.textStreams.includes(this.ma)&&(d=this.ma),this.ma=null);c&&Ui(this,b,c,!0);d&&qj(this,b,d,!0);
var e=this.f,f=e.b.get("video");if(f)var g=e.c.periods[f.ha];else{var h=e.b.get("audio");g=h?e.c.periods[h.ha]:null}var k=c?c.audio:null;if(!g&&d){var m;if(m=k){b=d;var n=P(this.b.preferredTextLanguage),p=P(k.language),r=P(b.language);m=be(r,n)&&!be(p,r)}m&&(this.ib=!0);this.ib&&this.L.g.setTextVisibility(!0);yj(this)}var u=this.b.streaming.alwaysStreamText||this.Yb()?{variant:c,text:d}:{variant:c,text:null};A.H("onChooseStreams_, chose variant ",u.variant);A.H("onChooseStreams_, chose text ",u.text);
return u}catch(w){return this.Ma(w),{variant:null,text:null}}};l.Rd=function(){A.debug("canSwitch_");this.mb=!1;this.b.abr.enabled&&(this.m.enable(),lj(this));this.na&&(rh(this.f,this.na,this.ld,this.hd),uj(this),this.na=null);this.ma&&(qh(this.f,this.ma,!0,0,!1),sj(this),this.ma=null)};l.De=function(){this.u&&this.u.update&&this.u.update()};l.He=function(){this.o&&this.o.u()};function Vi(b){Aj(b,new I("adaptation"))}function bj(b){Aj(b,new I("trackschanged"))}
function uj(b){Aj(b,new I("variantchanged"))}function sj(b){Aj(b,new I("textchanged"))}function yj(b){Aj(b,new I("texttrackvisibility"))}function lj(b){Aj(b,new I("abrstatuschanged",{Af:b.b.abr.enabled}))}l.Ma=function(b){if(this.i!=Bi){var c=new I("error",{detail:b});this.dispatchEvent(c);c.defaultPrevented&&(b.handled=!0)}};function Ki(b,c,d){b.dispatchEvent(new I(c,{detail:{schemeIdUri:d.schemeIdUri,value:d.value,startTime:d.startTime,endTime:d.endTime,id:d.id,eventElement:d.eventElement}}))}
function Ii(b){if(!b.a.error)return null;var c=b.a.error.code;if(1==c)return null;var d=b.a.error.msExtendedCode;d&&(0>d&&(d+=Math.pow(2,32)),d=d.toString(16));return new D(2,3,3016,c,d,b.a.error.message)}
function Oi(b,c){if(b.f){var d=cj(b),e=!1,f=Object.keys(c);0==f.length&&A.j("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var g=1==f.length&&"00"==f[0];g&&A.j("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");f.length&&b.c.periods.forEach(function(b){b.variants.forEach(function(b){Ae(b).forEach(function(d){var f=
b.allowedByKeySystem;d.keyId&&(d=c[g?"00":d.keyId],b.allowedByKeySystem=!!d&&!Di.includes(d));f!=b.allowedByKeySystem&&(e=!0)})})});f=hh(b.f);var h=jh(b.f);(f=ze(f,h,d.variants))&&!f.allowedByKeySystem&&(A.debug("Choosing new variants after key status changed"),xj(b,d));e&&(bj(b),dj(b,d.variants))}}function Pi(b,c,d){if(b.u&&b.u.onExpirationUpdated)b.u.onExpirationUpdated(c,d);b.dispatchEvent(new I("expirationupdated"))}
function Ti(b,c,d){0<c&&(b.da()?A.j("|playRangeStart| has been configured for live content. Ignoring the setting."):b.Kd(c));d<b.ba()&&(b.da()?A.j("|playRangeEnd| has been configured for live content. Ignoring the setting."):b.$a(d))}
function zj(b,c){var d=b.h?cc(b.h.fa):{},e=Object.keys(d);e=e.length&&"00"==e[0];for(var f=!1,g=!1,h=[],k=[],m=q(c),n=m.next();!n.done;n=m.next()){n=n.value;var p=[];n.audio&&p.push(n.audio);n.video&&p.push(n.video);p=q(p);for(var r=p.next();!r.done;r=p.next())if(r=r.value,r.keyId){var u=d[e?"00":r.keyId];u?Di.includes(u)&&(k.includes(u)||k.push(u)):h.includes(r.keyId)||h.push(r.keyId)}n.allowedByApplication?n.allowedByKeySystem&&(f=!0):g=!0}if(!f)throw new D(2,4,4012,{hasAppRestrictions:g,missingKeys:h,
restrictedKeyStatuses:k});}function Aj(b,c){t(function e(){return y(e,function(e){switch(e.l){case 1:return v(e,Promise.resolve(),2);case 2:b.i!=Bi&&b.dispatchEvent(c),x(e)}})})}function wj(b){var c=new Set;b=q(b);for(var d=b.next();!d.done;d=b.next())d=d.value,d.language?c.add(P(d.language)):c.add("und");return c}
function vj(b){var c=new Map;b=q(b);for(var d=b.next();!d.done;d=b.next()){var e=d.value;d="und";var f=[];e.language&&(d=P(e.language));"variant"==e.type?f=e.audioRoles:f=e.roles;f&&f.length||(f=[""]);c.has(d)||c.set(d,new Set);e=q(f);for(f=e.next();!f.done;f=e.next())f=f.value,c.get(d).add(f)}var g=[];c.forEach(function(b,c){for(var d=q(b),e=d.next();!e.done;e=d.next())g.push({language:c,role:e.value})});return g}
function nj(b){b=cj(b);return null==b?[]:b.variants.filter(function(b){return we(b)})}function pj(b){var c=cj(b);return null==c?[]:c.textStreams.filter(function(c){return!b.Mb.has(c)})}function cj(b){var c=b.o.g(),d=null;b=q(b.c.periods);for(var e=b.next();!e.done;e=b.next())e=e.value,e.startTime<=c&&(d=e);return d}function mj(b){var c=cj(b);return Yf(b.ka,c).variant}
function oj(b){var c=cj(b);if(null==c)return null;if(!Yf(b.ka,c).text){var d=xe(c.textStreams,b.la,b.gb);d.length&&Xf(b.ka,c,d[0])}return Yf(b.ka,c).text}function Fi(){return new D(2,7,7E3)}function Ai(b,c,d,e,f,g){return e==b&&f.s==g.s&&f.uri==g.uri&&f.mimeType==g.mimeType&&f.ya==g.ya?c:d}function Vh(){return{ya:null,s:null,mimeType:null,startTime:null,Zc:null,uri:null}}
function Gi(b){return new Promise(function(c,d){b.Xa=function(){return d(Fi())};b.cc=function(){return c()};b.onError=function(b){return d(b)};b.dc=function(){return d(Fi())}})}var Bi=0,oi=1,$i=2,ej=3;Z.LoadMode={DESTROYED:Bi,NOT_LOADED:oi,MEDIA_SOURCE:$i,SRC_EQUALS:ej};z("shaka.polyfill.installAll",function(){for(var b=0;b<Bj.length;++b)try{Bj[b].Qd()}catch(c){A.qa("Error installing polyfill!",c)}});var Bj=[];function Cj(b,c){c=c||0;for(var d={priority:c,Qd:b},e=0;e<Bj.length;e++)if(Bj[e].priority<c){Bj.splice(e,0,d);return}Bj.push(d)}z("shaka.polyfill.register",Cj);Cj(function(){Dj()},-1);function Ej(b,c,d){if("input"==b)switch(this.type){case "range":b="change"}HTMLInputElement.prototype.originalAddEventListener.call(this,b,c,d)}Cj(function(){A.debug("InputEvent.install");mc("Trident/")&&!HTMLInputElement.prototype.originalAddEventListener&&(A.info("Patching input event support on IE."),HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=Ej)});Cj(function(){navigator.languages||Object.defineProperty(navigator,"languages",{get:function(){return navigator.language?[navigator.language]:["en"]}})});Cj(function(){A.debug("mathRound.install")});function Fj(){var b=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(c){for(var d=[],e=0;e<arguments.length;++e)d[e]=arguments[e];d=b.apply(this,d);d.abort=function(){};return d}}function Ij(){var b=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(c,d){return b.call(this,c,d-.001)}}function Jj(){var b=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(c){return"mp2t"==c.split(/ *; */)[0].split("/")[1].toLowerCase()?!1:b(c)}}
function Kj(){var b=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(c){return"opus"!=gc(c)[0]&&b(c)}}function Lj(){var b=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(c){var d=c.split(/ *; */);d.shift();return d.some(function(b){return b.startsWith("codecs=")})?cast.__platform__.canDisplayType(c):b(c)}}
Cj(function(){A.debug("MediaSource.install");var b=nc();window.MediaSource?window.cast&&cast.__platform__&&cast.__platform__.canDisplayType?(A.info("Patching Chromecast MSE bugs."),Lj()):b?(Jj(),12>=b?(A.info("Patching Safari 11 & 12 MSE bugs."),Fj(),Ij()):(A.info("Patching Safari 13 MSE bugs."),Fj())):mc("Tizen 2")||mc("Tizen 3")||mc("Tizen 4")?Kj():A.info("Using native MSE as-is."):A.info("No MSE implementation available.")});function Mj(b,c){A.debug("PatchedMediaKeysMs.requestMediaKeySystemAccess");try{var d=new Nj(b,c);return Promise.resolve(d)}catch(e){return Promise.reject(e)}}
function Nj(b,c){A.debug("PatchedMediaKeysMs.MediaKeySystemAccess");this.keySystem=b;for(var d=!1,e=0;e<c.length;++e){var f=c[e],g={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:f.initDataTypes,sessionTypes:["temporary"],label:f.label},h=!1;if(f.audioCapabilities)for(var k=0;k<f.audioCapabilities.length;++k){var m=f.audioCapabilities[k];if(m.contentType){h=!0;var n=m.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,
n)&&(g.audioCapabilities.push(m),d=!0)}}if(f.videoCapabilities)for(k=0;k<f.videoCapabilities.length;++k)m=f.videoCapabilities[k],m.contentType&&(h=!0,n=m.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,n)&&(g.videoCapabilities.push(m),d=!0));h||(d=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));"required"==f.persistentState&&(d=!1);if(d){this.a=g;return}}d=Error("Unsupported keySystem");d.name="NotSupportedError";d.code=DOMException.NOT_SUPPORTED_ERR;throw d;}
Nj.prototype.createMediaKeys=function(){A.debug("PatchedMediaKeysMs.MediaKeySystemAccess.createMediaKeys");var b=new Oj(this.keySystem);return Promise.resolve(b)};Nj.prototype.getConfiguration=function(){A.debug("PatchedMediaKeysMs.MediaKeySystemAccess.getConfiguration");return this.a};function Pj(b){A.debug("PatchedMediaKeysMs.setMediaKeys");var c=this.mediaKeys;c&&c!=b&&Qj(c,null);delete this.mediaKeys;return(this.mediaKeys=b)?Qj(b,this):Promise.resolve()}
function Oj(b){A.debug("PatchedMediaKeysMs.MediaKeys");this.b=new MSMediaKeys(b);this.a=new K}Oj.prototype.createSession=function(b){A.debug("PatchedMediaKeysMs.MediaKeys.createSession");b=b||"temporary";if("temporary"!=b)throw new TypeError("Session type "+b+" is unsupported on this platform.");return new Rj(this.b,b)};Oj.prototype.setServerCertificate=function(){A.debug("PatchedMediaKeysMs.MediaKeys.setServerCertificate");return Promise.resolve(!1)};
function Qj(b,c){b.a.Ib();if(!c)return Promise.resolve();b.a.B(c,"msneedkey",Sj);try{return Gg(c,HTMLMediaElement.HAVE_METADATA,b.a,function(){c.msSetMediaKeys(b.b)}),Promise.resolve()}catch(d){return Promise.reject(d)}}function Rj(b){A.debug("PatchedMediaKeysMs.MediaKeySession");zb.call(this);this.c=null;this.g=b;this.b=this.a=null;this.f=new K;this.sessionId="";this.expiration=NaN;this.closed=new E;this.keyStatuses=new Tj}Qa(Rj,zb);l=Rj.prototype;
l.generateRequest=function(b,c){A.debug("PatchedMediaKeysMs.MediaKeySession.generateRequest");this.a=new E;try{this.c=this.g.createSession("video/mp4",new Uint8Array(c),null),this.f.B(this.c,"mskeymessage",this.Ge.bind(this)),this.f.B(this.c,"mskeyadded",this.Ee.bind(this)),this.f.B(this.c,"mskeyerror",this.Fe.bind(this)),Uj(this,"status-pending")}catch(d){this.a.reject(d)}return this.a};l.load=function(){A.debug("PatchedMediaKeysMs.MediaKeySession.load");return Promise.reject(Error("MediaKeySession.load not yet supported"))};
l.update=function(b){A.debug("PatchedMediaKeysMs.MediaKeySession.update");this.b=new E;try{this.c.update(new Uint8Array(b))}catch(c){this.b.reject(c)}return this.b};l.close=function(){A.debug("PatchedMediaKeysMs.MediaKeySession.close");try{this.c.close(),this.closed.resolve(),this.f.Ib()}catch(b){this.closed.reject(b)}return this.closed};l.remove=function(){A.debug("PatchedMediaKeysMs.MediaKeySession.remove");return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};
function Sj(b){A.debug("PatchedMediaKeysMs.onMsNeedKey_",b);if(b.initData){var c=document.createEvent("CustomEvent");c.initCustomEvent("encrypted",!1,!1,null);c.initDataType="cenc";c.initData=Ke(b.initData).buffer;this.dispatchEvent(c)}}l.Ge=function(b){A.debug("PatchedMediaKeysMs.onMsKeyMessage_",b);this.a&&(this.a.resolve(),this.a=null);this.dispatchEvent(new I("message",{messageType:void 0==this.keyStatuses.a?"license-request":"license-renewal",message:b.message.buffer}))};
l.Ee=function(b){A.debug("PatchedMediaKeysMs.onMsKeyAdded_",b);this.a?(A.debug("Simulating completion for a PR persistent license."),Uj(this,"usable"),this.a.resolve(),this.a=null):this.b&&(Uj(this,"usable"),this.b.resolve(),this.b=null)};
l.Fe=function(b){A.debug("PatchedMediaKeysMs.onMsKeyError_",b);b=Error("EME PatchedMediaKeysMs key error");b.errorCode=this.c.error;if(null!=this.a)this.a.reject(b),this.a=null;else if(null!=this.b)this.b.reject(b),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:Uj(this,"output-not-allowed");break;default:Uj(this,"internal-error")}};
function Uj(b,c){var d=b.keyStatuses;d.size=void 0==c?0:1;d.a=c;b.dispatchEvent(new I("keystatuseschange"))}function Tj(){this.size=0;this.a=void 0}var Vj;l=Tj.prototype;l.forEach=function(b){this.a&&b(this.a,Vj)};l.get=function(b){if(this.has(b))return this.a};l.has=function(b){var c=Vj;return this.a&&L.Ga(new Uint8Array(b),new Uint8Array(c))?!0:!1};l.entries=function(){};l.keys=function(){};l.values=function(){};
Cj(function(){!window.HTMLVideoElement||!window.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(A.info("Using ms-prefixed EME v20140218"),Vj=(new Uint8Array([0])).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Pj,window.MediaKeys=Oj,window.MediaKeySystemAccess=Nj,navigator.requestMediaKeySystemAccess=Mj)});function Wj(){A.debug("PatchedMediaKeysNop.requestMediaKeySystemAccess");return Promise.reject(Error("The key system specified is not supported."))}function Xj(b){A.debug("PatchedMediaKeysNop.setMediaKeys");return null==b?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function Yj(){throw new TypeError("Illegal constructor.");}Yj.prototype.createSession=function(){};Yj.prototype.setServerCertificate=function(){};function Zj(){throw new TypeError("Illegal constructor.");}
Zj.prototype.getConfiguration=function(){};Zj.prototype.createMediaKeys=function(){};Cj(function(){!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(A.info("EME not available."),navigator.requestMediaKeySystemAccess=Wj,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Xj,window.MediaKeys=Yj,window.MediaKeySystemAccess=Zj)},-10);var ak="";function bk(b){var c=ak;return c?c+b.charAt(0).toUpperCase()+b.slice(1):b}function ck(b,c){A.debug("PatchedMediaKeysWebkit.requestMediaKeySystemAccess");try{var d=new dk(b,c);return Promise.resolve(d)}catch(e){return Promise.reject(e)}}function ek(b){A.debug("PatchedMediaKeysWebkit.setMediaKeys");var c=this.mediaKeys;c&&c!=b&&fk(c,null);delete this.mediaKeys;(this.mediaKeys=b)&&fk(b,this);return Promise.resolve()}
function dk(b,c){A.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess");this.a=this.keySystem=b;var d=!1;"org.w3.clearkey"==b&&(this.a="webkit-org.w3.clearkey",d=!1);var e=!1;var f=document.getElementsByTagName("video");f=f.length?f[0]:document.createElement("video");for(var g=0;g<c.length;++g){var h=c[g],k={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:h.initDataTypes,sessionTypes:["temporary"],label:h.label},m=!1;if(h.audioCapabilities)for(var n=
0;n<h.audioCapabilities.length;++n){var p=h.audioCapabilities[n];if(p.contentType){m=!0;var r=p.contentType.split(";")[0];f.canPlayType(r,this.a)&&(k.audioCapabilities.push(p),e=!0)}}if(h.videoCapabilities)for(n=0;n<h.videoCapabilities.length;++n)p=h.videoCapabilities[n],p.contentType&&(m=!0,f.canPlayType(p.contentType,this.a)&&(k.videoCapabilities.push(p),e=!0));m||(e=f.canPlayType("video/mp4",this.a)||f.canPlayType("video/webm",this.a));"required"==h.persistentState&&(d?(k.persistentState="required",
k.sessionTypes=["persistent-license"]):e=!1);if(e){this.b=k;return}}d="Unsupported keySystem";if("org.w3.clearkey"==b||"com.widevine.alpha"==b)d="None of the requested configurations were supported.";d=Error(d);d.name="NotSupportedError";d.code=DOMException.NOT_SUPPORTED_ERR;throw d;}dk.prototype.createMediaKeys=function(){A.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var b=new gk(this.a);return Promise.resolve(b)};
dk.prototype.getConfiguration=function(){A.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration");return this.b};function gk(b){A.debug("PatchedMediaKeysWebkit.MediaKeys");this.g=b;this.b=null;this.a=new K;this.c=[];this.f={}}function fk(b,c){b.b=c;b.a.Ib();var d=ak;c&&(b.a.B(c,d+"needkey",b.Me.bind(b)),b.a.B(c,d+"keymessage",b.Le.bind(b)),b.a.B(c,d+"keyadded",b.Je.bind(b)),b.a.B(c,d+"keyerror",b.Ke.bind(b)))}l=gk.prototype;
l.createSession=function(b){A.debug("PatchedMediaKeysWebkit.MediaKeys.createSession");b=b||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+b+" is unsupported on this platform.");var c=this.b||document.createElement("video");c.src||(c.src="about:blank");b=new hk(c,this.g,b);this.c.push(b);return b};l.setServerCertificate=function(){A.debug("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate");return Promise.resolve(!1)};
l.Me=function(b){A.debug("PatchedMediaKeysWebkit.onWebkitNeedKey_",b);var c=document.createEvent("CustomEvent");c.initCustomEvent("encrypted",!1,!1,null);c.initDataType="cenc";b.initData instanceof ArrayBuffer?c.initData=b.initData:c.initData=b.initData.buffer;this.b.dispatchEvent(c)};
l.Le=function(b){A.debug("PatchedMediaKeysWebkit.onWebkitKeyMessage_",b);var c=ik(this,b.sessionId);c?(b=new I("message",{messageType:void 0==c.keyStatuses.a?"licenserequest":"licenserenewal",message:b.message}),A.debug("PatchedMediaKeysWebkit.MediaKeySession.generated"),c.b&&(c.b.resolve(),c.b=null),c.dispatchEvent(b)):A.error("Session not found",b.sessionId)};
l.Je=function(b){A.debug("PatchedMediaKeysWebkit.onWebkitKeyAdded_",b);if(b=ik(this,b.sessionId))A.debug("PatchedMediaKeysWebkit.MediaKeySession.ready"),jk(b,"usable"),b.a&&b.a.resolve(),b.a=null};l.Ke=function(b){A.debug("PatchedMediaKeysWebkit.onWebkitKeyError_",b);var c=ik(this,b.sessionId);c&&c.handleError(b)};
function ik(b,c){var d=b.f[c];return d?(A.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",d),d):(d=b.c.shift())?(d.sessionId=c,b.f[c]=d,A.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",d),d):null}function hk(b,c,d){A.debug("PatchedMediaKeysWebkit.MediaKeySession");zb.call(this);this.f=b;this.h=!1;this.a=this.b=null;this.c=c;this.g=d;this.sessionId="";this.expiration=NaN;this.closed=new E;this.keyStatuses=new kk}Qa(hk,zb);l=hk.prototype;
l.handleError=function(b){A.debug("PatchedMediaKeysWebkit.MediaKeySession.handleError",b);var c=Error("EME v0.1b key error"),d=b.errorCode;d.systemCode=b.systemCode;c.errorCode=d;!b.sessionId&&this.b?(45==b.systemCode&&(c.message="Unsupported session type."),this.b.reject(c),this.b=null):b.sessionId&&this.a?(this.a.reject(c),this.a=null):(c=b.systemCode,b.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?jk(this,"output-restricted"):1==c?jk(this,"expired"):jk(this,"internal-error"))};
function lk(b,c,d){if(b.h)return Promise.reject(Error("The session is already initialized."));b.h=!0;try{if("persistent-license"==b.g)if(d)var e=new Uint8Array(tc("LOAD_SESSION|"+d));else{var f=tc("PERSISTENT|"),g=new Uint8Array(f.byteLength+c.byteLength);g.set(new Uint8Array(f),0);g.set(new Uint8Array(c),f.byteLength);e=g}else e=new Uint8Array(c)}catch(k){return Promise.reject(k)}b.b=new E;var h=bk("generateKeyRequest");try{b.f[h](b.c,e)}catch(k){if("InvalidStateError"!=k.name)return b.b=null,Promise.reject(k);
(new C(function(){try{b.f[h](b.c,e)}catch(m){b.b.reject(m),b.b=null}})).V(.01)}return b.b}
l.Yc=function(b,c){if(this.a)this.a.then(this.Yc.bind(this,b,c))["catch"](this.Yc.bind(this,b,c));else{this.a=b;if("webkit-org.w3.clearkey"==this.c){var d=qc(c);var e=JSON.parse(d);"oct"!=e.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null);d=L.Ha(e.keys[0].k);e=L.Ha(e.keys[0].kid)}else d=new Uint8Array(c),e=null;var f=bk("addKey");try{this.f[f](this.c,d,e,this.sessionId)}catch(g){this.a.reject(g),this.a=null}}};
function jk(b,c){var d=b.keyStatuses;d.size=void 0==c?0:1;d.a=c;b.dispatchEvent(new I("keystatuseschange"))}l.generateRequest=function(b,c){A.debug("PatchedMediaKeysWebkit.MediaKeySession.generateRequest");return lk(this,c,null)};l.load=function(b){A.debug("PatchedMediaKeysWebkit.MediaKeySession.load");return"persistent-license"==this.g?lk(this,null,b):Promise.reject(Error("Not a persistent session."))};
l.update=function(b){A.debug("PatchedMediaKeysWebkit.MediaKeySession.update",b);var c=new E;this.Yc(c,b);return c};l.close=function(){A.debug("PatchedMediaKeysWebkit.MediaKeySession.close");if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var b=bk("cancelKeyRequest");try{this.f[b](this.c,this.sessionId)}catch(c){}}this.closed.resolve();return this.closed};
l.remove=function(){A.debug("PatchedMediaKeysWebkit.MediaKeySession.remove");return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()};function kk(){this.size=0;this.a=void 0}var mk;l=kk.prototype;l.forEach=function(b){this.a&&b(this.a,mk)};l.get=function(b){if(this.has(b))return this.a};l.has=function(b){var c=mk;return this.a&&L.Ga(new Uint8Array(b),new Uint8Array(c))?!0:!1};l.entries=function(){};l.keys=function(){};l.values=function(){};
Cj(function(){if(!(!window.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)A.info("Using webkit-prefixed EME v0.1b"),ak="webkit";else if(HTMLMediaElement.prototype.generateKeyRequest)A.info("Using nonprefixed EME v0.1b");else return;mk=(new Uint8Array([0])).buffer;navigator.requestMediaKeySystemAccess=ck;delete HTMLMediaElement.prototype.mediaKeys;HTMLMediaElement.prototype.mediaKeys=
null;HTMLMediaElement.prototype.setMediaKeys=ek;window.MediaKeys=gk;window.MediaKeySystemAccess=dk}});Cj(function(){A.debug("VideoPlayPromise.install");if(window.HTMLMediaElement){var b=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var c=b.apply(this);c&&c["catch"](function(){});return c}}});function nk(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}Cj(function(){if(window.HTMLVideoElement){var b=HTMLVideoElement.prototype;!b.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in b&&(b.getVideoPlaybackQuality=nk)}});function ok(b,c,d){return new window.TextTrackCue(b,c,d)}function pk(b,c,d){return new window.TextTrackCue(b+"-"+c+"-"+d,b,c,d)}
Cj(function(){if(window.VTTCue)A.info("Using native VTTCue.");else if(window.TextTrackCue){var b=TextTrackCue.length;if(3==b)A.info("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=ok;else if(6==b)A.info("Using VTTCue polyfill from 6 argument TextTrackCue."),window.VTTCue=pk;else{try{var c=!!ok(1,2,"")}catch(d){c=!1}c&&(A.info("Using VTTCue polyfill from 3 argument TextTrackCue."),window.VTTCue=ok)}}else A.error("VTTCue not available.")});function qk(){}z("shaka.text.TtmlTextParser",qk);qk.prototype.parseInit=function(){};qk.prototype.parseInit=qk.prototype.parseInit;
qk.prototype.parseMedia=function(b,c){var d=qc(b),e=[],f=new DOMParser,g=null;if(""==d)return e;try{g=f.parseFromString(d,"text/xml")}catch(xa){throw new D(2,2,2005,"Failed to parse TTML.");}if(g){if(d=g.getElementsByTagName("parsererror")[0])throw new D(2,2,2005,d.textContent);if(f=g.getElementsByTagName("tt")[0]){var h=T.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter","frameRate");var k=T.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter","subFrameRate");var m=T.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter",
"frameRateMultiplier");var n=T.getAttributeNS(f,"http://www.w3.org/ns/ttml#parameter","tickRate");g=f.getAttribute("xml:space")||"default";d=T.getAttributeNS(f,"http://www.w3.org/ns/ttml#styling","extent")}else throw new D(2,2,2005,"TTML does not contain <tt> tag.");if("default"!=g&&"preserve"!=g)throw new D(2,2,2005,"Invalid xml:space value: "+g);g="default"==g;h=new rk(h,k,m,n);k=sk(f.getElementsByTagName("metadata")[0]);m=sk(f.getElementsByTagName("styling")[0]);n=sk(f.getElementsByTagName("layout")[0]);
for(var p=[],r=0;r<n.length;r++){var u=n[r],w=m,F=d;var B=new rd;var H=u.getAttribute("xml:id");if(H){B.id=H;H=null;F&&(H=tk.exec(F)||uk.exec(F));F=H?Number(H[1]):null;H=H?Number(H[2]):null;var M,aa;if(M=vk(u,w,"extent"))M=(aa=tk.exec(M))||uk.exec(M),null!=M&&(B.width=null!=F?100*Number(M[1])/F:Number(M[1]),B.height=null!=H?100*Number(M[2])/H:Number(M[2]),B.widthUnits=aa||null!=F?Ed:0,B.heightUnits=aa||null!=H?Ed:0);if(u=vk(u,w,"origin"))M=(aa=tk.exec(u))||uk.exec(u),null!=M&&(B.viewportAnchorX=null!=
H?100*Number(M[1])/H:Number(M[1]),B.viewportAnchorY=null!=F?100*Number(M[2])/F:Number(M[2]),B.viewportAnchorUnits=aa||null!=F?Ed:0)}else A.j("TtmlTextParser parser encountered a region with no id. Region will be ignored."),B=null;B&&p.push(B)}d=wk(f.getElementsByTagName("body")[0]);d=q(d);for(f=d.next();!f.done;f=d.next())(f=xk(f.value,c.periodStart,h,k,m,n,p,g,!1))&&e.push(f)}return e};qk.prototype.parseMedia=qk.prototype.parseMedia;
var tk=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,yk=/^(\d+px|\d+em)$/,uk=/^(\d+)px (\d+)px$/,zk=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Ak=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,Bk=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,Ck=/^(\d*(?:\.\d*)?)f$/,Dk=/^(\d*(?:\.\d*)?)t$/,Ek=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,Fk={left:wd,center:"center",right:"end",start:wd,end:"end"},Gk={left:"line-left",center:"center",right:"line-right"};
function sk(b){var c=[];if(!b)return c;for(var d=q(b.childNodes),e=d.next();!e.done;e=d.next())e=e.value,e.nodeType==Node.ELEMENT_NODE&&"br"!==e.nodeName&&(e=sk(e),c=c.concat(e));c.length||c.push(b);return c}function wk(b){if(!b)return[];var c=[];b=q(b.childNodes);for(var d=b.next();!d.done;d=b.next())d=d.value,d instanceof Element&&(d.hasAttribute("begin")?c.push(d):c=c.concat(wk(d)));return c}
function Hk(b,c){for(var d="",e=q(b.childNodes),f=e.next();!f.done;f=e.next())f=f.value,"br"==f.nodeName&&b.childNodes[0]!==f?d+="\n":f.childNodes&&0<f.childNodes.length?d+=Hk(f,c):c?(f=f.textContent.trim(),f=f.replace(/\s+/g," "),d+=f):d+=f.textContent;return d}
function xk(b,c,d,e,f,g,h,k,m){if(m&&"br"==b.nodeName)return b=new O(0,0,""),b.spacer=!0,b;var n=/^[\s\n]*$/.test(b.textContent),p=b.nodeType==Node.ELEMENT_NODE&&!b.hasAttribute("begin")&&!b.hasAttribute("end");if(b.nodeType!=Node.ELEMENT_NODE||p&&n||p&&!m)return null;n=Ik(b.getAttribute("begin"),d);p=Ik(b.getAttribute("end"),d);var r=Ik(b.getAttribute("dur"),d);null==p&&null!=r&&(p=n+r);if(!m&&(null==n||null==p))throw new D(2,2,2001);n=m&&null==n?0:n+c;p=m&&null==p?0:p+c;r="";m=[];if(Array.from(b.childNodes).find(function(b){return b.nodeType===
Node.TEXT_NODE&&/\S+/.test(b.textContent)}))r=Hk(b,k);else for(var u=q(b.childNodes),w=u.next();!w.done;w=u.next())if(w=xk(w.value,c,d,e,f,g,h,k,!0))w.startTime=w.startTime||n,w.endTime=w.endTime||p,m.push(w);c=new O(n,p,r);c.nestedCues=m;if((g=Jk(b,"region",g,"")[0])&&g.getAttribute("xml:id")){var F=g.getAttribute("xml:id");c.region=h.filter(function(b){return b.id==F})[0]}e=Jk(b,"smpte:backgroundImage",e,"#")[0];Kk(c,b,g,e,f);return c}
function Kk(b,c,d,e,f){"rtl"==Lk(c,d,f,"direction")&&(b.direction="rtl");var g=Lk(c,d,f,"writingMode");"tb"==g||"tblr"==g?b.writingMode="vertical-lr":"tbrl"==g?b.writingMode="vertical-rl":"rltb"==g||"rl"==g?b.direction="rtl":g&&(b.direction=qd);(g=Lk(c,d,f,"textAlign"))?(b.positionAlign=Gk[g],b.lineAlign=Fk[g],b.textAlign=Ad[g.toUpperCase()]):b.textAlign="start";if(g=Lk(c,d,f,"displayAlign"))b.displayAlign=Bd[g.toUpperCase()];if(g=Lk(c,d,f,"color"))b.color=g;if(g=Lk(c,d,f,"backgroundColor"))b.backgroundColor=
g;if(g=Lk(c,d,f,"fontFamily"))b.fontFamily=g;(g=Lk(c,d,f,"fontWeight"))&&"bold"==g&&(b.fontWeight=700);(g=Lk(c,d,f,"wrapOption"))&&"noWrap"==g&&(b.wrapLine=!1);(g=Lk(c,d,f,"lineHeight"))&&g.match(yk)&&(b.lineHeight=g);(g=Lk(c,d,f,"fontSize"))&&g.match(yk)&&(b.fontSize=g);if(g=Lk(c,d,f,"fontStyle"))b.fontStyle=Dd[g.toUpperCase()];if(e){g=e.getAttribute("imagetype");var h=e.getAttribute("encoding");e=e.textContent.trim();"PNG"==g&&"Base64"==h&&e&&(b.backgroundImage="data:image/png;base64,"+e)}(d=vk(d,
f,"textDecoration"))&&Mk(b,d);(c=Nk(c,f,"textDecoration"))&&Mk(b,c)}
function Mk(b,c){for(var d=c.split(" "),e=0;e<d.length;e++)switch(d[e]){case "underline":b.textDecoration.includes("underline")||b.textDecoration.push("underline");break;case "noUnderline":b.textDecoration.includes("underline")&&Bb(b.textDecoration,"underline");break;case "lineThrough":b.textDecoration.includes("lineThrough")||b.textDecoration.push("lineThrough");break;case "noLineThrough":b.textDecoration.includes("lineThrough")&&Bb(b.textDecoration,"lineThrough");break;case "overline":b.textDecoration.includes("overline")||
b.textDecoration.push("overline");break;case "noOverline":b.textDecoration.includes("overline")&&Bb(b.textDecoration,"overline")}}function Lk(b,c,d,e){return(b=Nk(b,d,e))?b:vk(c,d,e)}function vk(b,c,d){if(!b)return null;for(var e=sk(b),f=0;f<e.length;f++){var g=T.getAttributeNS(e[f],"http://www.w3.org/ns/ttml#styling",d);if(g)return g}return Ok(b,c,d)}function Nk(b,c,d){var e=T.getAttributeNS(b,"http://www.w3.org/ns/ttml#styling",d);return e?e:Ok(b,c,d)}
function Ok(b,c,d){b=Jk(b,"style",c,"");for(var e=null,f=0;f<b.length;f++){var g=T.getAttributeNS(b[f],"http://www.w3.org/ns/ttml#styling",d);g||(g=Nk(b[f],c,d));g&&(e=g)}return e}
function Jk(b,c,d,e){var f=[];if(!b||1>d.length)return f;var g=b;for(b=null;g&&!(b=g.getAttribute(c))&&(g=g.parentNode,g instanceof Element););if(c=b)for(c=c.split(" "),c=q(c),b=c.next();!b.done;b=c.next()){b=b.value;g=q(d);for(var h=g.next();!h.done;h=g.next())if(h=h.value,e+h.getAttribute("xml:id")==b){f.push(h);break}}return f}
function Ik(b,c){var d=null;if(zk.test(b)){d=zk.exec(b);var e=Number(d[1]),f=Number(d[2]),g=Number(d[3]),h=Number(d[4]);h+=(Number(d[5])||0)/c.b;g+=h/c.frameRate;d=g+60*f+3600*e}else Ak.test(b)?d=Pk(Ak,b):Bk.test(b)?d=Pk(Bk,b):Ck.test(b)?(d=Ck.exec(b),d=Number(d[1])/c.frameRate):Dk.test(b)?(d=Dk.exec(b),d=Number(d[1])/c.a):Ek.test(b)&&(d=Pk(Ek,b));return d}
function Pk(b,c){var d=b.exec(c);return null==d||""==d[0]?null:(Number(d[4])||0)/1E3+(Number(d[3])||0)+60*(Number(d[2])||0)+3600*(Number(d[1])||0)}function rk(b,c,d,e){this.frameRate=Number(b)||30;this.b=Number(c)||1;this.a=Number(e);0==this.a&&(this.a=b?this.frameRate*this.b:1);d&&(b=/^(\d+) (\d+)$/g.exec(d))&&(this.frameRate*=Number(b[1])/Number(b[2]))}Hd["application/ttml+xml"]=qk;function Qk(){this.a=new qk}z("shaka.text.Mp4TtmlParser",Qk);Qk.prototype.parseInit=function(b){var c=!1;(new S).J("moov",Ge).J("trak",Ge).J("mdia",Ge).J("minf",Ge).J("stbl",Ge).sa("stsd",He).J("stpp",function(b){c=!0;b.parser.stop()}).parse(b);if(!c)throw new D(2,2,2007);};Qk.prototype.parseInit=Qk.prototype.parseInit;Qk.prototype.parseMedia=function(b,c){var d=!1,e=[];(new S).J("mdat",Ie(function(b){d=!0;e=e.concat(this.a.parseMedia(b,c))}.bind(this))).parse(b);if(!d)throw new D(2,2,2007);return e};
Qk.prototype.parseMedia=Qk.prototype.parseMedia;Hd['application/mp4; codecs="stpp"']=Qk;Hd['application/mp4; codecs="stpp.ttml.im1t"']=Qk;Hd['application/mp4; codecs="stpp.TTML.im1t"']=Qk;function Rk(b){this.b=b;this.a=0}function Sk(b){Tk(b,/[ \t]+/gm)}function Tk(b,c){c.lastIndex=b.a;var d=c.exec(b.b);d=null==d?null:{position:d.index,length:d[0].length,Ze:d};if(b.a==b.b.length||null==d||d.position!=b.a)return null;b.a+=d.length;return d.Ze}function Uk(b){return b.a==b.b.length?null:(b=Tk(b,/[^ \t\n]*/gm))?b[0]:null};function Vk(){}z("shaka.text.VttTextParser",Vk);Vk.prototype.parseInit=function(){};Vk.prototype.parseInit=Vk.prototype.parseInit;
Vk.prototype.parseMedia=function(b,c){var d=qc(b);d=d.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n");d=d.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(d[0]))throw new D(2,2,2E3);var e=c.segmentStart;if(null==e&&(e=0,d[0].includes("X-TIMESTAMP-MAP"))){var f=d[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),g=d[0].match(/MPEGTS:(\d+)/m);if(f&&g){e=Wk(new Rk(f[1]));if(null==e)throw new D(2,2,2E3);e=c.periodStart+(Number(g[1])/9E4-e)}}g=[];var h=d[0].split("\n");for(f=1;f<h.length;f++)if(/^Region:/.test(h[f])){var k=
new Rk(h[f]),m=new rd;Uk(k);Sk(k);for(var n=Uk(k);n;){var p;a:{var r=m,u=n;if(p=/^id=(.*)$/.exec(u))r.id=p[1];else if(p=/^width=(\d{1,2}|100)%$/.exec(u))r.width=Number(p[1]);else if(p=/^lines=(\d+)$/.exec(u))r.height=Number(p[1]),r.heightUnits=2;else if(p=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(u))r.regionAnchorX=Number(p[1]),r.regionAnchorY=Number(p[2]);else if(p=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(u))r.viewportAnchorX=Number(p[1]),r.viewportAnchorY=Number(p[2]);else if(/^scroll=up$/.exec(u))r.scroll=
"up";else{p=!1;break a}p=!0}p||A.j("VTT parser encountered an invalid VTTRegion setting: ",n," The setting will be ignored.");Sk(k);n=Uk(k)}g.push(m)}f=[];for(k=1;k<d.length;k++){h=d[k].split("\n");p=h;r=e;h=g;if(1==p.length&&!p[0]||/^NOTE($|[ \t])/.test(p[0])||"STYLE"==p[0])h=null;else{m=null;p[0].includes("--\x3e")||(m=p[0],p.splice(0,1));n=new Rk(p[0]);u=Wk(n);var w=Tk(n,/[ \t]+--\x3e[ \t]+/g),F=Wk(n);if(null==u||null==w||null==F)throw new D(2,2,2001);p=new O(u+r,F+r,p.slice(1).join("\n").trim());
Sk(n);for(r=Uk(n);r;)Xk(p,r,h)||A.j("VTT parser encountered an invalid VTT setting: ",r," The setting will be ignored."),Sk(n),r=Uk(n);null!=m&&(p.id=m);h=p}h&&f.push(h)}return f};Vk.prototype.parseMedia=Vk.prototype.parseMedia;
function Xk(b,c,d){var e;if(e=/^align:(start|middle|center|end|left|right)$/.exec(c))c=e[1],"middle"==c?b.textAlign=td:b.textAlign=Ad[c.toUpperCase()];else if(e=/^vertical:(lr|rl)$/.exec(c))b.writingMode="lr"==e[1]?"vertical-lr":"vertical-rl";else if(e=/^size:([\d.]+)%$/.exec(c))b.size=Number(e[1]);else if(e=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(c))b.position=Number(e[1]),e[2]&&(c=e[2],b.positionAlign="line-left"==c||"start"==c?"line-left":"line-right"==c||"end"==
c?"line-right":"center");else if(e=/^region:(.*)$/.exec(c)){if(c=Yk(d,e[1]))b.region=c}else{a:{if(d=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(c))b.lineInterpretation=1,b.line=Number(d[1]),d[2]&&(b.lineAlign=Cd[d[2].toUpperCase()]);else if(d=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(c))b.lineInterpretation=vd,b.line=Number(d[1]),d[2]&&(b.lineAlign=Cd[d[2].toUpperCase()]);else{b=!1;break a}b=!0}return b}return!0}
function Yk(b,c){var d=b.filter(function(b){return b.id==c});return d.length?d[0]:(A.j("VTT parser could not find a region with id: ",c," The region will be ignored."),null)}function Wk(b){b=Tk(b,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g);if(null==b)return null;var c=Number(b[2]),d=Number(b[3]);return 59<c||59<d?null:Number(b[4])/1E3+d+60*c+3600*(Number(b[1])||0)}Hd["text/vtt"]=Vk;Hd['text/vtt; codecs="vtt"']=Vk;Hd['text/vtt; codecs="wvtt"']=Vk;function Zk(){this.a=null}z("shaka.text.Mp4VttParser",Zk);Zk.prototype.parseInit=function(b){var c=!1;(new S).J("moov",Ge).J("trak",Ge).J("mdia",Ge).sa("mdhd",function(b){0==b.version?(b.reader.R(4),b.reader.R(4),this.a=b.reader.G(),b.reader.R(4)):(b.reader.R(8),b.reader.R(8),this.a=b.reader.G(),b.reader.R(8));b.reader.R(4)}.bind(this)).J("minf",Ge).J("stbl",Ge).sa("stsd",He).J("wvtt",function(){c=!0}).parse(b);if(!this.a)throw new D(2,2,2008);if(!c)throw new D(2,2,2008);};
Zk.prototype.parseInit=Zk.prototype.parseInit;
Zk.prototype.parseMedia=function(b,c){var d=this;if(!this.a)throw A.error("No init segment for MP4+VTT!"),new D(2,2,2008);var e=0,f=[],g,h=[],k=!1,m=!1,n=!1,p=null;(new S).J("moof",Ge).J("traf",Ge).sa("tfdt",function(b){k=!0;e=0==b.version?b.reader.G():b.reader.Hb()}).sa("tfhd",function(b){var c=b.flags;b=b.reader;b.R(4);c&1&&b.R(8);c&2&&b.R(4);p=c&8?b.G():null}).sa("trun",function(b){m=!0;var c=b.version,d=b.flags;b=b.reader;var e=b.G();d&1&&b.R(4);d&4&&b.R(4);for(var g=[],h=0;h<e;h++){var k={duration:null,
sampleSize:null,$c:null};d&256&&(k.duration=b.G());d&512&&(k.sampleSize=b.G());d&1024&&b.R(4);d&2048&&(k.$c=0==c?b.G():b.Ad());g.push(k)}f=g}).J("mdat",Ie(function(b){n=!0;g=b})).parse(b);if(!n&&!k&&!m)throw new D(2,2,2008);var r=e,u=new DataView(g.buffer,g.byteOffset,g.byteLength),w=new R(u,0);f.forEach(function(b){var f=b.duration||p,g=b.$c?e+b.$c:r;r=g+(f||0);var k=0;do{var m=w.G();k+=m;var n=w.G();n=Fe(n);var u=null;"vttc"==n?8<m&&(u=w.Za(m-8)):("vtte"!=n&&A.error("Unknown box "+n+"! Skipping!"),
w.R(m-8));f?u&&h.push($k(u,c.periodStart+g/d.a,c.periodStart+r/d.a)):A.error("WVTT sample duration unknown, and no default found!")}while(b.sampleSize&&k<b.sampleSize)});return h.filter(id.Ia)};Zk.prototype.parseMedia=Zk.prototype.parseMedia;function $k(b,c,d){var e,f,g;(new S).J("payl",Ie(function(b){e=qc(b)})).J("iden",Ie(function(b){f=qc(b)})).J("sttg",Ie(function(b){g=qc(b)})).parse(b);return e?al(e,f,g,c,d):null}
function al(b,c,d,e,f){b=new O(e,f,b);c&&(b.id=c);if(d)for(c=new Rk(d),d=Uk(c);d;)Xk(b,d,[])||A.j("VTT parser encountered an invalid VTT setting: ",d," The setting will be ignored."),Sk(c),d=Uk(c);return b}Hd['application/mp4; codecs="wvtt"']=Zk;z("shaka.util.Dom.createHTMLElement",function(b){return document.createElement(b)});z("shaka.util.Dom.createVideoElement",function(){var b=document.createElement("video");b.muted=!0;b.width=600;b.height=400;return b});z("shaka.util.Dom.asHTMLElement",function(b){return b});z("shaka.util.Dom.asHTMLMediaElement",function(b){return b});z("shaka.util.Dom.removeAllChildren",function(b){for(;b.firstChild;)b.removeChild(b.firstChild)});/*
 @license
 EME Encryption Scheme Polyfill
 Copyright 2019 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
function bl(){}var cl;z("EmeEncryptionSchemePolyfill",bl);function dl(){cl?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(cl=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=el):console.debug("EmeEncryptionSchemePolyfill: EME not found")}bl.install=dl;
function el(b,c){var d=this;return t(function f(){var g;return y(f,function(f){switch(f.l){case 1:return console.assert(d==navigator,'bad "this" for requestMediaKeySystemAccess'),v(f,cl.call(d,b,c),2);case 2:g=f.N;if(fl(g))return console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=cl,f["return"](g);console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support.");navigator.requestMediaKeySystemAccess=
gl;return f["return"](gl.call(d,b,c))}})})}
function gl(b,c){var d=this;return t(function f(){var g,h,k,m,n,p,r,u;return y(f,function(f){switch(f.l){case 1:console.assert(d==navigator,'bad "this" for requestMediaKeySystemAccess');g=hl(b);h=[];for(var w=q(c),B=w.next();!B.done;B=w.next())k=B.value,m=il(k.videoCapabilities,g),n=il(k.audioCapabilities,g),k.videoCapabilities&&k.videoCapabilities.length&&!m.length||k.audioCapabilities&&k.audioCapabilities.length&&!n.length||(p=Object.assign({},k),p.videoCapabilities=m,p.audioCapabilities=n,h.push(p));
if(!h.length)throw r=Error("Unsupported keySystem or supportedConfigurations."),r.name="NotSupportedError",r.code=DOMException.NOT_SUPPORTED_ERR,r;return v(f,cl.call(d,b,h),2);case 2:return u=f.N,f["return"](new jl(u,g))}})})}function il(b,c){return b?b.filter(function(b){return!b.encryptionScheme||b.encryptionScheme==c}):b}function kl(){}var ll;z("McEncryptionSchemePolyfill",kl);
function ml(){navigator.mediaCapabilities?(ll=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=nl):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}kl.install=ml;
function nl(b){var c=this;return t(function e(){var f,g;return y(e,function(e){switch(e.l){case 1:return console.assert(c==navigator.mediaCapabilities,'bad "this" for decodingInfo'),v(e,ll.call(c,b),2);case 2:f=e.N;if(!b.keySystemConfiguration)return e["return"](f);g=f.keySystemAccess;if(fl(g))return console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=ll,e["return"](f);console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support.");
navigator.mediaCapabilities.decodingInfo=ol;return e["return"](ol.call(c,b))}})})}
function ol(b){var c=this;return t(function e(){var f,g,h,k,m,n,p;return y(e,function(e){switch(e.l){case 1:return console.assert(c==navigator.mediaCapabilities,'bad "this" for decodingInfo'),f=null,b.keySystemConfiguration&&(g=b.keySystemConfiguration,h=g.keySystem,k=g.audio&&g.audio.encryptionScheme,m=g.video&&g.video.encryptionScheme,f=hl(h),n={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:b},k&&k!=f||m&&m!=f)?e["return"](n):v(e,ll.call(c,b),2);case 2:return p=e.N,
p.keySystemAccess&&(p.keySystemAccess=new jl(p.keySystemAccess,f)),e["return"](p)}})})}function jl(b,c){this.b=b;this.a=c;this.keySystem=b.keySystem}jl.prototype.getConfiguration=function(){var b=this.b.getConfiguration();if(b.videoCapabilities)for(var c=q(b.videoCapabilities),d=c.next();!d.done;d=c.next())d.value.encryptionScheme=this.a;if(b.audioCapabilities)for(c=q(b.audioCapabilities),d=c.next();!d.done;d=c.next())d.value.encryptionScheme=this.a;return b};jl.prototype.createMediaKeys=function(){return this.b.createMediaKeys()};
function hl(b){if(b.startsWith("com.widevine")||b.startsWith("com.microsoft")||b.startsWith("com.adobe")||b.startsWith("org.w3"))return"cenc";if(b.startsWith("com.apple"))return"cbcs-1-9";console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",b,"Please contribute!");return null}function fl(b){b=b.getConfiguration();var c=b.audioCapabilities&&b.audioCapabilities[0];return(b=b.videoCapabilities&&b.videoCapabilities[0]||c)&&void 0!==b.encryptionScheme?!0:!1}function pl(){}
z("EncryptionSchemePolyfills",pl);function Dj(){dl();ml()}pl.install=Dj;"undefined"!==typeof module&&module.Yd&&(module.Yd=pl);}).call(exportTo,innerGlobal,innerGlobal,undefined);if(typeof exports!="undefined")for(var k in exportTo.shaka)exports[k]=exportTo.shaka[k];else if(typeof define=="function"&&define.amd)define(function(){return exportTo.shaka});else innerGlobal.shaka=exportTo.shaka})();

//# sourceMappingURL=shaka-player.compiled.map